var ug=h=>{throw TypeError(h)};var nh=(h,t,e)=>t.has(h)||ug("Cannot "+e);var Zt=(h,t,e)=>(nh(h,t,"read from private field"),e?e.call(h):t.get(h)),kn=(h,t,e)=>t.has(h)?ug("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(h):t.set(h,e),Ge=(h,t,e,s)=>(nh(h,t,"write to private field"),s?s.call(h,e):t.set(h,e),e),On=(h,t,e)=>(nh(h,t,"access private method"),e);var hg=(h,t,e,s)=>({set _(a){Ge(h,t,a,e)},get _(){return Zt(h,t,s)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function e(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(a){if(a.ep)return;a.ep=!0;const o=e(a);fetch(a.href,o)}})();function b0(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var ih={exports:{}},or={};var dg;function e1(){if(dg)return or;dg=1;var h=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(s,a,o){var l=null;if(o!==void 0&&(l=""+o),a.key!==void 0&&(l=""+a.key),"key"in a){o={};for(var u in a)u!=="key"&&(o[u]=a[u])}else o=a;return a=o.ref,{$$typeof:h,type:s,key:l,ref:a!==void 0?a:null,props:o}}return or.Fragment=t,or.jsx=e,or.jsxs=e,or}var fg;function n1(){return fg||(fg=1,ih.exports=e1()),ih.exports}var _=n1(),sh={exports:{}},vt={};var pg;function i1(){if(pg)return vt;pg=1;var h=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),y=Symbol.for("react.activity"),b=Symbol.iterator;function v(N){return N===null||typeof N!="object"?null:(N=b&&N[b]||N["@@iterator"],typeof N=="function"?N:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,x={};function E(N,I,Q){this.props=N,this.context=I,this.refs=x,this.updater=Q||S}E.prototype.isReactComponent={},E.prototype.setState=function(N,I){if(typeof N!="object"&&typeof N!="function"&&N!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,N,I,"setState")},E.prototype.forceUpdate=function(N){this.updater.enqueueForceUpdate(this,N,"forceUpdate")};function M(){}M.prototype=E.prototype;function C(N,I,Q){this.props=N,this.context=I,this.refs=x,this.updater=Q||S}var R=C.prototype=new M;R.constructor=C,w(R,E.prototype),R.isPureReactComponent=!0;var k=Array.isArray;function L(){}var P={H:null,A:null,T:null,S:null},$=Object.prototype.hasOwnProperty;function K(N,I,Q){var tt=Q.ref;return{$$typeof:h,type:N,key:I,ref:tt!==void 0?tt:null,props:Q}}function J(N,I){return K(N.type,I,N.props)}function Z(N){return typeof N=="object"&&N!==null&&N.$$typeof===h}function ht(N){var I={"=":"=0",":":"=2"};return"$"+N.replace(/[=:]/g,function(Q){return I[Q]})}var St=/\/+/g;function ot(N,I){return typeof N=="object"&&N!==null&&N.key!=null?ht(""+N.key):I.toString(36)}function et(N){switch(N.status){case"fulfilled":return N.value;case"rejected":throw N.reason;default:switch(typeof N.status=="string"?N.then(L,L):(N.status="pending",N.then(function(I){N.status==="pending"&&(N.status="fulfilled",N.value=I)},function(I){N.status==="pending"&&(N.status="rejected",N.reason=I)})),N.status){case"fulfilled":return N.value;case"rejected":throw N.reason}}throw N}function O(N,I,Q,tt,ut){var gt=typeof N;(gt==="undefined"||gt==="boolean")&&(N=null);var dt=!1;if(N===null)dt=!0;else switch(gt){case"bigint":case"string":case"number":dt=!0;break;case"object":switch(N.$$typeof){case h:case t:dt=!0;break;case m:return dt=N._init,O(dt(N._payload),I,Q,tt,ut)}}if(dt)return ut=ut(N),dt=tt===""?"."+ot(N,0):tt,k(ut)?(Q="",dt!=null&&(Q=dt.replace(St,"$&/")+"/"),O(ut,I,Q,"",function(Fi){return Fi})):ut!=null&&(Z(ut)&&(ut=J(ut,Q+(ut.key==null||N&&N.key===ut.key?"":(""+ut.key).replace(St,"$&/")+"/")+dt)),I.push(ut)),1;dt=0;var re=tt===""?".":tt+":";if(k(N))for(var Xt=0;Xt<N.length;Xt++)tt=N[Xt],gt=re+ot(tt,Xt),dt+=O(tt,I,Q,gt,ut);else if(Xt=v(N),typeof Xt=="function")for(N=Xt.call(N),Xt=0;!(tt=N.next()).done;)tt=tt.value,gt=re+ot(tt,Xt++),dt+=O(tt,I,Q,gt,ut);else if(gt==="object"){if(typeof N.then=="function")return O(et(N),I,Q,tt,ut);throw I=String(N),Error("Objects are not valid as a React child (found: "+(I==="[object Object]"?"object with keys {"+Object.keys(N).join(", ")+"}":I)+"). If you meant to render a collection of children, use an array instead.")}return dt}function H(N,I,Q){if(N==null)return N;var tt=[],ut=0;return O(N,tt,"","",function(gt){return I.call(Q,gt,ut++)}),tt}function W(N){if(N._status===-1){var I=N._result;I=I(),I.then(function(Q){(N._status===0||N._status===-1)&&(N._status=1,N._result=Q)},function(Q){(N._status===0||N._status===-1)&&(N._status=2,N._result=Q)}),N._status===-1&&(N._status=0,N._result=I)}if(N._status===1)return N._result.default;throw N._result}var pt=typeof reportError=="function"?reportError:function(N){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var I=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof N=="object"&&N!==null&&typeof N.message=="string"?String(N.message):String(N),error:N});if(!window.dispatchEvent(I))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",N);return}console.error(N)},Et={map:H,forEach:function(N,I,Q){H(N,function(){I.apply(this,arguments)},Q)},count:function(N){var I=0;return H(N,function(){I++}),I},toArray:function(N){return H(N,function(I){return I})||[]},only:function(N){if(!Z(N))throw Error("React.Children.only expected to receive a single React element child.");return N}};return vt.Activity=y,vt.Children=Et,vt.Component=E,vt.Fragment=e,vt.Profiler=a,vt.PureComponent=C,vt.StrictMode=s,vt.Suspense=d,vt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=P,vt.__COMPILER_RUNTIME={__proto__:null,c:function(N){return P.H.useMemoCache(N)}},vt.cache=function(N){return function(){return N.apply(null,arguments)}},vt.cacheSignal=function(){return null},vt.cloneElement=function(N,I,Q){if(N==null)throw Error("The argument must be a React element, but you passed "+N+".");var tt=w({},N.props),ut=N.key;if(I!=null)for(gt in I.key!==void 0&&(ut=""+I.key),I)!$.call(I,gt)||gt==="key"||gt==="__self"||gt==="__source"||gt==="ref"&&I.ref===void 0||(tt[gt]=I[gt]);var gt=arguments.length-2;if(gt===1)tt.children=Q;else if(1<gt){for(var dt=Array(gt),re=0;re<gt;re++)dt[re]=arguments[re+2];tt.children=dt}return K(N.type,ut,tt)},vt.createContext=function(N){return N={$$typeof:l,_currentValue:N,_currentValue2:N,_threadCount:0,Provider:null,Consumer:null},N.Provider=N,N.Consumer={$$typeof:o,_context:N},N},vt.createElement=function(N,I,Q){var tt,ut={},gt=null;if(I!=null)for(tt in I.key!==void 0&&(gt=""+I.key),I)$.call(I,tt)&&tt!=="key"&&tt!=="__self"&&tt!=="__source"&&(ut[tt]=I[tt]);var dt=arguments.length-2;if(dt===1)ut.children=Q;else if(1<dt){for(var re=Array(dt),Xt=0;Xt<dt;Xt++)re[Xt]=arguments[Xt+2];ut.children=re}if(N&&N.defaultProps)for(tt in dt=N.defaultProps,dt)ut[tt]===void 0&&(ut[tt]=dt[tt]);return K(N,gt,ut)},vt.createRef=function(){return{current:null}},vt.forwardRef=function(N){return{$$typeof:u,render:N}},vt.isValidElement=Z,vt.lazy=function(N){return{$$typeof:m,_payload:{_status:-1,_result:N},_init:W}},vt.memo=function(N,I){return{$$typeof:f,type:N,compare:I===void 0?null:I}},vt.startTransition=function(N){var I=P.T,Q={};P.T=Q;try{var tt=N(),ut=P.S;ut!==null&&ut(Q,tt),typeof tt=="object"&&tt!==null&&typeof tt.then=="function"&&tt.then(L,pt)}catch(gt){pt(gt)}finally{I!==null&&Q.types!==null&&(I.types=Q.types),P.T=I}},vt.unstable_useCacheRefresh=function(){return P.H.useCacheRefresh()},vt.use=function(N){return P.H.use(N)},vt.useActionState=function(N,I,Q){return P.H.useActionState(N,I,Q)},vt.useCallback=function(N,I){return P.H.useCallback(N,I)},vt.useContext=function(N){return P.H.useContext(N)},vt.useDebugValue=function(){},vt.useDeferredValue=function(N,I){return P.H.useDeferredValue(N,I)},vt.useEffect=function(N,I){return P.H.useEffect(N,I)},vt.useEffectEvent=function(N){return P.H.useEffectEvent(N)},vt.useId=function(){return P.H.useId()},vt.useImperativeHandle=function(N,I,Q){return P.H.useImperativeHandle(N,I,Q)},vt.useInsertionEffect=function(N,I){return P.H.useInsertionEffect(N,I)},vt.useLayoutEffect=function(N,I){return P.H.useLayoutEffect(N,I)},vt.useMemo=function(N,I){return P.H.useMemo(N,I)},vt.useOptimistic=function(N,I){return P.H.useOptimistic(N,I)},vt.useReducer=function(N,I,Q){return P.H.useReducer(N,I,Q)},vt.useRef=function(N){return P.H.useRef(N)},vt.useState=function(N){return P.H.useState(N)},vt.useSyncExternalStore=function(N,I,Q){return P.H.useSyncExternalStore(N,I,Q)},vt.useTransition=function(){return P.H.useTransition()},vt.version="19.2.4",vt}var mg;function zh(){return mg||(mg=1,sh.exports=i1()),sh.exports}var it=zh();const mr=b0(it);var ah={exports:{}},lr={},rh={exports:{}},oh={};var gg;function s1(){return gg||(gg=1,(function(h){function t(O,H){var W=O.length;O.push(H);t:for(;0<W;){var pt=W-1>>>1,Et=O[pt];if(0<a(Et,H))O[pt]=H,O[W]=Et,W=pt;else break t}}function e(O){return O.length===0?null:O[0]}function s(O){if(O.length===0)return null;var H=O[0],W=O.pop();if(W!==H){O[0]=W;t:for(var pt=0,Et=O.length,N=Et>>>1;pt<N;){var I=2*(pt+1)-1,Q=O[I],tt=I+1,ut=O[tt];if(0>a(Q,W))tt<Et&&0>a(ut,Q)?(O[pt]=ut,O[tt]=W,pt=tt):(O[pt]=Q,O[I]=W,pt=I);else if(tt<Et&&0>a(ut,W))O[pt]=ut,O[tt]=W,pt=tt;else break t}}return H}function a(O,H){var W=O.sortIndex-H.sortIndex;return W!==0?W:O.id-H.id}if(h.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;h.unstable_now=function(){return o.now()}}else{var l=Date,u=l.now();h.unstable_now=function(){return l.now()-u}}var d=[],f=[],m=1,y=null,b=3,v=!1,S=!1,w=!1,x=!1,E=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function R(O){for(var H=e(f);H!==null;){if(H.callback===null)s(f);else if(H.startTime<=O)s(f),H.sortIndex=H.expirationTime,t(d,H);else break;H=e(f)}}function k(O){if(w=!1,R(O),!S)if(e(d)!==null)S=!0,L||(L=!0,ht());else{var H=e(f);H!==null&&et(k,H.startTime-O)}}var L=!1,P=-1,$=5,K=-1;function J(){return x?!0:!(h.unstable_now()-K<$)}function Z(){if(x=!1,L){var O=h.unstable_now();K=O;var H=!0;try{t:{S=!1,w&&(w=!1,M(P),P=-1),v=!0;var W=b;try{e:{for(R(O),y=e(d);y!==null&&!(y.expirationTime>O&&J());){var pt=y.callback;if(typeof pt=="function"){y.callback=null,b=y.priorityLevel;var Et=pt(y.expirationTime<=O);if(O=h.unstable_now(),typeof Et=="function"){y.callback=Et,R(O),H=!0;break e}y===e(d)&&s(d),R(O)}else s(d);y=e(d)}if(y!==null)H=!0;else{var N=e(f);N!==null&&et(k,N.startTime-O),H=!1}}break t}finally{y=null,b=W,v=!1}H=void 0}}finally{H?ht():L=!1}}}var ht;if(typeof C=="function")ht=function(){C(Z)};else if(typeof MessageChannel<"u"){var St=new MessageChannel,ot=St.port2;St.port1.onmessage=Z,ht=function(){ot.postMessage(null)}}else ht=function(){E(Z,0)};function et(O,H){P=E(function(){O(h.unstable_now())},H)}h.unstable_IdlePriority=5,h.unstable_ImmediatePriority=1,h.unstable_LowPriority=4,h.unstable_NormalPriority=3,h.unstable_Profiling=null,h.unstable_UserBlockingPriority=2,h.unstable_cancelCallback=function(O){O.callback=null},h.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<O?Math.floor(1e3/O):5},h.unstable_getCurrentPriorityLevel=function(){return b},h.unstable_next=function(O){switch(b){case 1:case 2:case 3:var H=3;break;default:H=b}var W=b;b=H;try{return O()}finally{b=W}},h.unstable_requestPaint=function(){x=!0},h.unstable_runWithPriority=function(O,H){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var W=b;b=O;try{return H()}finally{b=W}},h.unstable_scheduleCallback=function(O,H,W){var pt=h.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?pt+W:pt):W=pt,O){case 1:var Et=-1;break;case 2:Et=250;break;case 5:Et=1073741823;break;case 4:Et=1e4;break;default:Et=5e3}return Et=W+Et,O={id:m++,callback:H,priorityLevel:O,startTime:W,expirationTime:Et,sortIndex:-1},W>pt?(O.sortIndex=W,t(f,O),e(d)===null&&O===e(f)&&(w?(M(P),P=-1):w=!0,et(k,W-pt))):(O.sortIndex=Et,t(d,O),S||v||(S=!0,L||(L=!0,ht()))),O},h.unstable_shouldYield=J,h.unstable_wrapCallback=function(O){var H=b;return function(){var W=b;b=H;try{return O.apply(this,arguments)}finally{b=W}}}})(oh)),oh}var yg;function a1(){return yg||(yg=1,rh.exports=s1()),rh.exports}var lh={exports:{}},Re={};var bg;function r1(){if(bg)return Re;bg=1;var h=zh();function t(d){var f="https://react.dev/errors/"+d;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)f+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+d+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var s={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(d,f,m){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:y==null?null:""+y,children:d,containerInfo:f,implementation:m}}var l=h.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(d,f){if(d==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Re.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Re.createPortal=function(d,f){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return o(d,f,null,m)},Re.flushSync=function(d){var f=l.T,m=s.p;try{if(l.T=null,s.p=2,d)return d()}finally{l.T=f,s.p=m,s.d.f()}},Re.preconnect=function(d,f){typeof d=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,s.d.C(d,f))},Re.prefetchDNS=function(d){typeof d=="string"&&s.d.D(d)},Re.preinit=function(d,f){if(typeof d=="string"&&f&&typeof f.as=="string"){var m=f.as,y=u(m,f.crossOrigin),b=typeof f.integrity=="string"?f.integrity:void 0,v=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;m==="style"?s.d.S(d,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:y,integrity:b,fetchPriority:v}):m==="script"&&s.d.X(d,{crossOrigin:y,integrity:b,fetchPriority:v,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Re.preinitModule=function(d,f){if(typeof d=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var m=u(f.as,f.crossOrigin);s.d.M(d,{crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&s.d.M(d)},Re.preload=function(d,f){if(typeof d=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var m=f.as,y=u(m,f.crossOrigin);s.d.L(d,m,{crossOrigin:y,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Re.preloadModule=function(d,f){if(typeof d=="string")if(f){var m=u(f.as,f.crossOrigin);s.d.m(d,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else s.d.m(d)},Re.requestFormReset=function(d){s.d.r(d)},Re.unstable_batchedUpdates=function(d,f){return d(f)},Re.useFormState=function(d,f,m){return l.H.useFormState(d,f,m)},Re.useFormStatus=function(){return l.H.useHostTransitionStatus()},Re.version="19.2.4",Re}var vg;function o1(){if(vg)return lh.exports;vg=1;function h(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(h)}catch(t){console.error(t)}}return h(),lh.exports=r1(),lh.exports}var Ag;function l1(){if(Ag)return lr;Ag=1;var h=a1(),t=zh(),e=o1();function s(n){var i="https://react.dev/errors/"+n;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)i+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+n+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function o(n){var i=n,r=n;if(n.alternate)for(;i.return;)i=i.return;else{n=i;do i=n,(i.flags&4098)!==0&&(r=i.return),n=i.return;while(n)}return i.tag===3?r:null}function l(n){if(n.tag===13){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function u(n){if(n.tag===31){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function d(n){if(o(n)!==n)throw Error(s(188))}function f(n){var i=n.alternate;if(!i){if(i=o(n),i===null)throw Error(s(188));return i!==n?null:n}for(var r=n,c=i;;){var p=r.return;if(p===null)break;var g=p.alternate;if(g===null){if(c=p.return,c!==null){r=c;continue}break}if(p.child===g.child){for(g=p.child;g;){if(g===r)return d(p),n;if(g===c)return d(p),i;g=g.sibling}throw Error(s(188))}if(r.return!==c.return)r=p,c=g;else{for(var A=!1,T=p.child;T;){if(T===r){A=!0,r=p,c=g;break}if(T===c){A=!0,c=p,r=g;break}T=T.sibling}if(!A){for(T=g.child;T;){if(T===r){A=!0,r=g,c=p;break}if(T===c){A=!0,c=g,r=p;break}T=T.sibling}if(!A)throw Error(s(189))}}if(r.alternate!==c)throw Error(s(190))}if(r.tag!==3)throw Error(s(188));return r.stateNode.current===r?n:i}function m(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n;for(n=n.child;n!==null;){if(i=m(n),i!==null)return i;n=n.sibling}return null}var y=Object.assign,b=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),S=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),M=Symbol.for("react.consumer"),C=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),$=Symbol.for("react.lazy"),K=Symbol.for("react.activity"),J=Symbol.for("react.memo_cache_sentinel"),Z=Symbol.iterator;function ht(n){return n===null||typeof n!="object"?null:(n=Z&&n[Z]||n["@@iterator"],typeof n=="function"?n:null)}var St=Symbol.for("react.client.reference");function ot(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===St?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case w:return"Fragment";case E:return"Profiler";case x:return"StrictMode";case k:return"Suspense";case L:return"SuspenseList";case K:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case S:return"Portal";case C:return n.displayName||"Context";case M:return(n._context.displayName||"Context")+".Consumer";case R:var i=n.render;return n=n.displayName,n||(n=i.displayName||i.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case P:return i=n.displayName||null,i!==null?i:ot(n.type)||"Memo";case $:i=n._payload,n=n._init;try{return ot(n(i))}catch{}}return null}var et=Array.isArray,O=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,H=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W={pending:!1,data:null,method:null,action:null},pt=[],Et=-1;function N(n){return{current:n}}function I(n){0>Et||(n.current=pt[Et],pt[Et]=null,Et--)}function Q(n,i){Et++,pt[Et]=n.current,n.current=i}var tt=N(null),ut=N(null),gt=N(null),dt=N(null);function re(n,i){switch(Q(gt,i),Q(ut,n),Q(tt,null),i.nodeType){case 9:case 11:n=(n=i.documentElement)&&(n=n.namespaceURI)?Om(n):0;break;default:if(n=i.tagName,i=i.namespaceURI)i=Om(i),n=Lm(i,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}I(tt),Q(tt,n)}function Xt(){I(tt),I(ut),I(gt)}function Fi(n){n.memoizedState!==null&&Q(dt,n);var i=tt.current,r=Lm(i,n.type);i!==r&&(Q(ut,n),Q(tt,r))}function oi(n){ut.current===n&&(I(tt),I(ut)),dt.current===n&&(I(dt),ir._currentValue=W)}var zi,pa;function zn(n){if(zi===void 0)try{throw Error()}catch(r){var i=r.stack.trim().match(/\n( *(at )?)/);zi=i&&i[1]||"",pa=-1<r.stack.indexOf(`
    at`)?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return`
`+zi+n+pa}var zl=!1;function Ul(n,i){if(!n||zl)return"";zl=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(i){var Y=function(){throw Error()};if(Object.defineProperty(Y.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Y,[])}catch(V){var U=V}Reflect.construct(n,[],Y)}else{try{Y.call()}catch(V){U=V}n.call(Y.prototype)}}else{try{throw Error()}catch(V){U=V}(Y=n())&&typeof Y.catch=="function"&&Y.catch(function(){})}}catch(V){if(V&&U&&typeof V.stack=="string")return[V.stack,U.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=c.DetermineComponentFrameRoot(),A=g[0],T=g[1];if(A&&T){var D=A.split(`
`),z=T.split(`
`);for(p=c=0;c<D.length&&!D[c].includes("DetermineComponentFrameRoot");)c++;for(;p<z.length&&!z[p].includes("DetermineComponentFrameRoot");)p++;if(c===D.length||p===z.length)for(c=D.length-1,p=z.length-1;1<=c&&0<=p&&D[c]!==z[p];)p--;for(;1<=c&&0<=p;c--,p--)if(D[c]!==z[p]){if(c!==1||p!==1)do if(c--,p--,0>p||D[c]!==z[p]){var q=`
`+D[c].replace(" at new "," at ");return n.displayName&&q.includes("<anonymous>")&&(q=q.replace("<anonymous>",n.displayName)),q}while(1<=c&&0<=p);break}}}finally{zl=!1,Error.prepareStackTrace=r}return(r=n?n.displayName||n.name:"")?zn(r):""}function ky(n,i){switch(n.tag){case 26:case 27:case 5:return zn(n.type);case 16:return zn("Lazy");case 13:return n.child!==i&&i!==null?zn("Suspense Fallback"):zn("Suspense");case 19:return zn("SuspenseList");case 0:case 15:return Ul(n.type,!1);case 11:return Ul(n.type.render,!1);case 1:return Ul(n.type,!0);case 31:return zn("Activity");default:return""}}function cd(n){try{var i="",r=null;do i+=ky(n,r),r=n,n=n.return;while(n);return i}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var Il=Object.prototype.hasOwnProperty,Hl=h.unstable_scheduleCallback,Gl=h.unstable_cancelCallback,Oy=h.unstable_shouldYield,Ly=h.unstable_requestPaint,$e=h.unstable_now,By=h.unstable_getCurrentPriorityLevel,ud=h.unstable_ImmediatePriority,hd=h.unstable_UserBlockingPriority,Pr=h.unstable_NormalPriority,Py=h.unstable_LowPriority,dd=h.unstable_IdlePriority,jy=h.log,Fy=h.unstable_setDisableYieldValue,ma=null,Ke=null;function li(n){if(typeof jy=="function"&&Fy(n),Ke&&typeof Ke.setStrictMode=="function")try{Ke.setStrictMode(ma,n)}catch{}}var Qe=Math.clz32?Math.clz32:Iy,zy=Math.log,Uy=Math.LN2;function Iy(n){return n>>>=0,n===0?32:31-(zy(n)/Uy|0)|0}var jr=256,Fr=262144,zr=4194304;function Ui(n){var i=n&42;if(i!==0)return i;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Ur(n,i,r){var c=n.pendingLanes;if(c===0)return 0;var p=0,g=n.suspendedLanes,A=n.pingedLanes;n=n.warmLanes;var T=c&134217727;return T!==0?(c=T&~g,c!==0?p=Ui(c):(A&=T,A!==0?p=Ui(A):r||(r=T&~n,r!==0&&(p=Ui(r))))):(T=c&~g,T!==0?p=Ui(T):A!==0?p=Ui(A):r||(r=c&~n,r!==0&&(p=Ui(r)))),p===0?0:i!==0&&i!==p&&(i&g)===0&&(g=p&-p,r=i&-i,g>=r||g===32&&(r&4194048)!==0)?i:p}function ga(n,i){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&i)===0}function Hy(n,i){switch(n){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function fd(){var n=zr;return zr<<=1,(zr&62914560)===0&&(zr=4194304),n}function Vl(n){for(var i=[],r=0;31>r;r++)i.push(n);return i}function ya(n,i){n.pendingLanes|=i,i!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function Gy(n,i,r,c,p,g){var A=n.pendingLanes;n.pendingLanes=r,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=r,n.entangledLanes&=r,n.errorRecoveryDisabledLanes&=r,n.shellSuspendCounter=0;var T=n.entanglements,D=n.expirationTimes,z=n.hiddenUpdates;for(r=A&~r;0<r;){var q=31-Qe(r),Y=1<<q;T[q]=0,D[q]=-1;var U=z[q];if(U!==null)for(z[q]=null,q=0;q<U.length;q++){var V=U[q];V!==null&&(V.lane&=-536870913)}r&=~Y}c!==0&&pd(n,c,0),g!==0&&p===0&&n.tag!==0&&(n.suspendedLanes|=g&~(A&~i))}function pd(n,i,r){n.pendingLanes|=i,n.suspendedLanes&=~i;var c=31-Qe(i);n.entangledLanes|=i,n.entanglements[c]=n.entanglements[c]|1073741824|r&261930}function md(n,i){var r=n.entangledLanes|=i;for(n=n.entanglements;r;){var c=31-Qe(r),p=1<<c;p&i|n[c]&i&&(n[c]|=i),r&=~p}}function gd(n,i){var r=i&-i;return r=(r&42)!==0?1:ql(r),(r&(n.suspendedLanes|i))!==0?0:r}function ql(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function Xl(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function yd(){var n=H.p;return n!==0?n:(n=window.event,n===void 0?32:ig(n.type))}function bd(n,i){var r=H.p;try{return H.p=n,i()}finally{H.p=r}}var ci=Math.random().toString(36).slice(2),xe="__reactFiber$"+ci,Pe="__reactProps$"+ci,ms="__reactContainer$"+ci,Yl="__reactEvents$"+ci,Vy="__reactListeners$"+ci,qy="__reactHandles$"+ci,vd="__reactResources$"+ci,ba="__reactMarker$"+ci;function $l(n){delete n[xe],delete n[Pe],delete n[Yl],delete n[Vy],delete n[qy]}function gs(n){var i=n[xe];if(i)return i;for(var r=n.parentNode;r;){if(i=r[ms]||r[xe]){if(r=i.alternate,i.child!==null||r!==null&&r.child!==null)for(n=Im(n);n!==null;){if(r=n[xe])return r;n=Im(n)}return i}n=r,r=n.parentNode}return null}function ys(n){if(n=n[xe]||n[ms]){var i=n.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return n}return null}function va(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n.stateNode;throw Error(s(33))}function bs(n){var i=n[vd];return i||(i=n[vd]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function ve(n){n[ba]=!0}var Ad=new Set,Sd={};function Ii(n,i){vs(n,i),vs(n+"Capture",i)}function vs(n,i){for(Sd[n]=i,n=0;n<i.length;n++)Ad.add(i[n])}var Xy=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),wd={},xd={};function Yy(n){return Il.call(xd,n)?!0:Il.call(wd,n)?!1:Xy.test(n)?xd[n]=!0:(wd[n]=!0,!1)}function Ir(n,i,r){if(Yy(i))if(r===null)n.removeAttribute(i);else{switch(typeof r){case"undefined":case"function":case"symbol":n.removeAttribute(i);return;case"boolean":var c=i.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){n.removeAttribute(i);return}}n.setAttribute(i,""+r)}}function Hr(n,i,r){if(r===null)n.removeAttribute(i);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(i);return}n.setAttribute(i,""+r)}}function Un(n,i,r,c){if(c===null)n.removeAttribute(r);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(r);return}n.setAttributeNS(i,r,""+c)}}function ln(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Ed(n){var i=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function $y(n,i,r){var c=Object.getOwnPropertyDescriptor(n.constructor.prototype,i);if(!n.hasOwnProperty(i)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var p=c.get,g=c.set;return Object.defineProperty(n,i,{configurable:!0,get:function(){return p.call(this)},set:function(A){r=""+A,g.call(this,A)}}),Object.defineProperty(n,i,{enumerable:c.enumerable}),{getValue:function(){return r},setValue:function(A){r=""+A},stopTracking:function(){n._valueTracker=null,delete n[i]}}}}function Kl(n){if(!n._valueTracker){var i=Ed(n)?"checked":"value";n._valueTracker=$y(n,i,""+n[i])}}function Td(n){if(!n)return!1;var i=n._valueTracker;if(!i)return!0;var r=i.getValue(),c="";return n&&(c=Ed(n)?n.checked?"true":"false":n.value),n=c,n!==r?(i.setValue(n),!0):!1}function Gr(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var Ky=/[\n"\\]/g;function cn(n){return n.replace(Ky,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function Ql(n,i,r,c,p,g,A,T){n.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?n.type=A:n.removeAttribute("type"),i!=null?A==="number"?(i===0&&n.value===""||n.value!=i)&&(n.value=""+ln(i)):n.value!==""+ln(i)&&(n.value=""+ln(i)):A!=="submit"&&A!=="reset"||n.removeAttribute("value"),i!=null?Wl(n,A,ln(i)):r!=null?Wl(n,A,ln(r)):c!=null&&n.removeAttribute("value"),p==null&&g!=null&&(n.defaultChecked=!!g),p!=null&&(n.checked=p&&typeof p!="function"&&typeof p!="symbol"),T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?n.name=""+ln(T):n.removeAttribute("name")}function _d(n,i,r,c,p,g,A,T){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(n.type=g),i!=null||r!=null){if(!(g!=="submit"&&g!=="reset"||i!=null)){Kl(n);return}r=r!=null?""+ln(r):"",i=i!=null?""+ln(i):r,T||i===n.value||(n.value=i),n.defaultValue=i}c=c??p,c=typeof c!="function"&&typeof c!="symbol"&&!!c,n.checked=T?n.checked:!!c,n.defaultChecked=!!c,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(n.name=A),Kl(n)}function Wl(n,i,r){i==="number"&&Gr(n.ownerDocument)===n||n.defaultValue===""+r||(n.defaultValue=""+r)}function As(n,i,r,c){if(n=n.options,i){i={};for(var p=0;p<r.length;p++)i["$"+r[p]]=!0;for(r=0;r<n.length;r++)p=i.hasOwnProperty("$"+n[r].value),n[r].selected!==p&&(n[r].selected=p),p&&c&&(n[r].defaultSelected=!0)}else{for(r=""+ln(r),i=null,p=0;p<n.length;p++){if(n[p].value===r){n[p].selected=!0,c&&(n[p].defaultSelected=!0);return}i!==null||n[p].disabled||(i=n[p])}i!==null&&(i.selected=!0)}}function Cd(n,i,r){if(i!=null&&(i=""+ln(i),i!==n.value&&(n.value=i),r==null)){n.defaultValue!==i&&(n.defaultValue=i);return}n.defaultValue=r!=null?""+ln(r):""}function Md(n,i,r,c){if(i==null){if(c!=null){if(r!=null)throw Error(s(92));if(et(c)){if(1<c.length)throw Error(s(93));c=c[0]}r=c}r==null&&(r=""),i=r}r=ln(i),n.defaultValue=r,c=n.textContent,c===r&&c!==""&&c!==null&&(n.value=c),Kl(n)}function Ss(n,i){if(i){var r=n.firstChild;if(r&&r===n.lastChild&&r.nodeType===3){r.nodeValue=i;return}}n.textContent=i}var Qy=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Dd(n,i,r){var c=i.indexOf("--")===0;r==null||typeof r=="boolean"||r===""?c?n.setProperty(i,""):i==="float"?n.cssFloat="":n[i]="":c?n.setProperty(i,r):typeof r!="number"||r===0||Qy.has(i)?i==="float"?n.cssFloat=r:n[i]=(""+r).trim():n[i]=r+"px"}function Nd(n,i,r){if(i!=null&&typeof i!="object")throw Error(s(62));if(n=n.style,r!=null){for(var c in r)!r.hasOwnProperty(c)||i!=null&&i.hasOwnProperty(c)||(c.indexOf("--")===0?n.setProperty(c,""):c==="float"?n.cssFloat="":n[c]="");for(var p in i)c=i[p],i.hasOwnProperty(p)&&r[p]!==c&&Dd(n,p,c)}else for(var g in i)i.hasOwnProperty(g)&&Dd(n,g,i[g])}function Zl(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Wy=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Zy=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Vr(n){return Zy.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function In(){}var Jl=null;function tc(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var ws=null,xs=null;function Rd(n){var i=ys(n);if(i&&(n=i.stateNode)){var r=n[Pe]||null;t:switch(n=i.stateNode,i.type){case"input":if(Ql(n,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),i=r.name,r.type==="radio"&&i!=null){for(r=n;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+cn(""+i)+'"][type="radio"]'),i=0;i<r.length;i++){var c=r[i];if(c!==n&&c.form===n.form){var p=c[Pe]||null;if(!p)throw Error(s(90));Ql(c,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(i=0;i<r.length;i++)c=r[i],c.form===n.form&&Td(c)}break t;case"textarea":Cd(n,r.value,r.defaultValue);break t;case"select":i=r.value,i!=null&&As(n,!!r.multiple,i,!1)}}}var ec=!1;function kd(n,i,r){if(ec)return n(i,r);ec=!0;try{var c=n(i);return c}finally{if(ec=!1,(ws!==null||xs!==null)&&(ko(),ws&&(i=ws,n=xs,xs=ws=null,Rd(i),n)))for(i=0;i<n.length;i++)Rd(n[i])}}function Aa(n,i){var r=n.stateNode;if(r===null)return null;var c=r[Pe]||null;if(c===null)return null;r=c[i];t:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(n=n.type,c=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!c;break t;default:n=!1}if(n)return null;if(r&&typeof r!="function")throw Error(s(231,i,typeof r));return r}var Hn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),nc=!1;if(Hn)try{var Sa={};Object.defineProperty(Sa,"passive",{get:function(){nc=!0}}),window.addEventListener("test",Sa,Sa),window.removeEventListener("test",Sa,Sa)}catch{nc=!1}var ui=null,ic=null,qr=null;function Od(){if(qr)return qr;var n,i=ic,r=i.length,c,p="value"in ui?ui.value:ui.textContent,g=p.length;for(n=0;n<r&&i[n]===p[n];n++);var A=r-n;for(c=1;c<=A&&i[r-c]===p[g-c];c++);return qr=p.slice(n,1<c?1-c:void 0)}function Xr(n){var i=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&i===13&&(n=13)):n=i,n===10&&(n=13),32<=n||n===13?n:0}function Yr(){return!0}function Ld(){return!1}function je(n){function i(r,c,p,g,A){this._reactName=r,this._targetInst=p,this.type=c,this.nativeEvent=g,this.target=A,this.currentTarget=null;for(var T in n)n.hasOwnProperty(T)&&(r=n[T],this[T]=r?r(g):g[T]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?Yr:Ld,this.isPropagationStopped=Ld,this}return y(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Yr)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Yr)},persist:function(){},isPersistent:Yr}),i}var Hi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$r=je(Hi),wa=y({},Hi,{view:0,detail:0}),Jy=je(wa),sc,ac,xa,Kr=y({},wa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:oc,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==xa&&(xa&&n.type==="mousemove"?(sc=n.screenX-xa.screenX,ac=n.screenY-xa.screenY):ac=sc=0,xa=n),sc)},movementY:function(n){return"movementY"in n?n.movementY:ac}}),Bd=je(Kr),tb=y({},Kr,{dataTransfer:0}),eb=je(tb),nb=y({},wa,{relatedTarget:0}),rc=je(nb),ib=y({},Hi,{animationName:0,elapsedTime:0,pseudoElement:0}),sb=je(ib),ab=y({},Hi,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),rb=je(ab),ob=y({},Hi,{data:0}),Pd=je(ob),lb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},cb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ub={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function hb(n){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(n):(n=ub[n])?!!i[n]:!1}function oc(){return hb}var db=y({},wa,{key:function(n){if(n.key){var i=lb[n.key]||n.key;if(i!=="Unidentified")return i}return n.type==="keypress"?(n=Xr(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?cb[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:oc,charCode:function(n){return n.type==="keypress"?Xr(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Xr(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),fb=je(db),pb=y({},Kr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),jd=je(pb),mb=y({},wa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:oc}),gb=je(mb),yb=y({},Hi,{propertyName:0,elapsedTime:0,pseudoElement:0}),bb=je(yb),vb=y({},Kr,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Ab=je(vb),Sb=y({},Hi,{newState:0,oldState:0}),wb=je(Sb),xb=[9,13,27,32],lc=Hn&&"CompositionEvent"in window,Ea=null;Hn&&"documentMode"in document&&(Ea=document.documentMode);var Eb=Hn&&"TextEvent"in window&&!Ea,Fd=Hn&&(!lc||Ea&&8<Ea&&11>=Ea),zd=" ",Ud=!1;function Id(n,i){switch(n){case"keyup":return xb.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hd(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Es=!1;function Tb(n,i){switch(n){case"compositionend":return Hd(i);case"keypress":return i.which!==32?null:(Ud=!0,zd);case"textInput":return n=i.data,n===zd&&Ud?null:n;default:return null}}function _b(n,i){if(Es)return n==="compositionend"||!lc&&Id(n,i)?(n=Od(),qr=ic=ui=null,Es=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Fd&&i.locale!=="ko"?null:i.data;default:return null}}var Cb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gd(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i==="input"?!!Cb[n.type]:i==="textarea"}function Vd(n,i,r,c){ws?xs?xs.push(c):xs=[c]:ws=c,i=zo(i,"onChange"),0<i.length&&(r=new $r("onChange","change",null,r,c),n.push({event:r,listeners:i}))}var Ta=null,_a=null;function Mb(n){Cm(n,0)}function Qr(n){var i=va(n);if(Td(i))return n}function qd(n,i){if(n==="change")return i}var Xd=!1;if(Hn){var cc;if(Hn){var uc="oninput"in document;if(!uc){var Yd=document.createElement("div");Yd.setAttribute("oninput","return;"),uc=typeof Yd.oninput=="function"}cc=uc}else cc=!1;Xd=cc&&(!document.documentMode||9<document.documentMode)}function $d(){Ta&&(Ta.detachEvent("onpropertychange",Kd),_a=Ta=null)}function Kd(n){if(n.propertyName==="value"&&Qr(_a)){var i=[];Vd(i,_a,n,tc(n)),kd(Mb,i)}}function Db(n,i,r){n==="focusin"?($d(),Ta=i,_a=r,Ta.attachEvent("onpropertychange",Kd)):n==="focusout"&&$d()}function Nb(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Qr(_a)}function Rb(n,i){if(n==="click")return Qr(i)}function kb(n,i){if(n==="input"||n==="change")return Qr(i)}function Ob(n,i){return n===i&&(n!==0||1/n===1/i)||n!==n&&i!==i}var We=typeof Object.is=="function"?Object.is:Ob;function Ca(n,i){if(We(n,i))return!0;if(typeof n!="object"||n===null||typeof i!="object"||i===null)return!1;var r=Object.keys(n),c=Object.keys(i);if(r.length!==c.length)return!1;for(c=0;c<r.length;c++){var p=r[c];if(!Il.call(i,p)||!We(n[p],i[p]))return!1}return!0}function Qd(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Wd(n,i){var r=Qd(n);n=0;for(var c;r;){if(r.nodeType===3){if(c=n+r.textContent.length,n<=i&&c>=i)return{node:r,offset:i-n};n=c}t:{for(;r;){if(r.nextSibling){r=r.nextSibling;break t}r=r.parentNode}r=void 0}r=Qd(r)}}function Zd(n,i){return n&&i?n===i?!0:n&&n.nodeType===3?!1:i&&i.nodeType===3?Zd(n,i.parentNode):"contains"in n?n.contains(i):n.compareDocumentPosition?!!(n.compareDocumentPosition(i)&16):!1:!1}function Jd(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var i=Gr(n.document);i instanceof n.HTMLIFrameElement;){try{var r=typeof i.contentWindow.location.href=="string"}catch{r=!1}if(r)n=i.contentWindow;else break;i=Gr(n.document)}return i}function hc(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i&&(i==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||i==="textarea"||n.contentEditable==="true")}var Lb=Hn&&"documentMode"in document&&11>=document.documentMode,Ts=null,dc=null,Ma=null,fc=!1;function tf(n,i,r){var c=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;fc||Ts==null||Ts!==Gr(c)||(c=Ts,"selectionStart"in c&&hc(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Ma&&Ca(Ma,c)||(Ma=c,c=zo(dc,"onSelect"),0<c.length&&(i=new $r("onSelect","select",null,i,r),n.push({event:i,listeners:c}),i.target=Ts)))}function Gi(n,i){var r={};return r[n.toLowerCase()]=i.toLowerCase(),r["Webkit"+n]="webkit"+i,r["Moz"+n]="moz"+i,r}var _s={animationend:Gi("Animation","AnimationEnd"),animationiteration:Gi("Animation","AnimationIteration"),animationstart:Gi("Animation","AnimationStart"),transitionrun:Gi("Transition","TransitionRun"),transitionstart:Gi("Transition","TransitionStart"),transitioncancel:Gi("Transition","TransitionCancel"),transitionend:Gi("Transition","TransitionEnd")},pc={},ef={};Hn&&(ef=document.createElement("div").style,"AnimationEvent"in window||(delete _s.animationend.animation,delete _s.animationiteration.animation,delete _s.animationstart.animation),"TransitionEvent"in window||delete _s.transitionend.transition);function Vi(n){if(pc[n])return pc[n];if(!_s[n])return n;var i=_s[n],r;for(r in i)if(i.hasOwnProperty(r)&&r in ef)return pc[n]=i[r];return n}var nf=Vi("animationend"),sf=Vi("animationiteration"),af=Vi("animationstart"),Bb=Vi("transitionrun"),Pb=Vi("transitionstart"),jb=Vi("transitioncancel"),rf=Vi("transitionend"),of=new Map,mc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");mc.push("scrollEnd");function xn(n,i){of.set(n,i),Ii(i,[n])}var Wr=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},un=[],Cs=0,gc=0;function Zr(){for(var n=Cs,i=gc=Cs=0;i<n;){var r=un[i];un[i++]=null;var c=un[i];un[i++]=null;var p=un[i];un[i++]=null;var g=un[i];if(un[i++]=null,c!==null&&p!==null){var A=c.pending;A===null?p.next=p:(p.next=A.next,A.next=p),c.pending=p}g!==0&&lf(r,p,g)}}function Jr(n,i,r,c){un[Cs++]=n,un[Cs++]=i,un[Cs++]=r,un[Cs++]=c,gc|=c,n.lanes|=c,n=n.alternate,n!==null&&(n.lanes|=c)}function yc(n,i,r,c){return Jr(n,i,r,c),to(n)}function qi(n,i){return Jr(n,null,null,i),to(n)}function lf(n,i,r){n.lanes|=r;var c=n.alternate;c!==null&&(c.lanes|=r);for(var p=!1,g=n.return;g!==null;)g.childLanes|=r,c=g.alternate,c!==null&&(c.childLanes|=r),g.tag===22&&(n=g.stateNode,n===null||n._visibility&1||(p=!0)),n=g,g=g.return;return n.tag===3?(g=n.stateNode,p&&i!==null&&(p=31-Qe(r),n=g.hiddenUpdates,c=n[p],c===null?n[p]=[i]:c.push(i),i.lane=r|536870912),g):null}function to(n){if(50<Qa)throw Qa=0,_u=null,Error(s(185));for(var i=n.return;i!==null;)n=i,i=n.return;return n.tag===3?n.stateNode:null}var Ms={};function Fb(n,i,r,c){this.tag=n,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ze(n,i,r,c){return new Fb(n,i,r,c)}function bc(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Gn(n,i){var r=n.alternate;return r===null?(r=Ze(n.tag,i,n.key,n.mode),r.elementType=n.elementType,r.type=n.type,r.stateNode=n.stateNode,r.alternate=n,n.alternate=r):(r.pendingProps=i,r.type=n.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=n.flags&65011712,r.childLanes=n.childLanes,r.lanes=n.lanes,r.child=n.child,r.memoizedProps=n.memoizedProps,r.memoizedState=n.memoizedState,r.updateQueue=n.updateQueue,i=n.dependencies,r.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},r.sibling=n.sibling,r.index=n.index,r.ref=n.ref,r.refCleanup=n.refCleanup,r}function cf(n,i){n.flags&=65011714;var r=n.alternate;return r===null?(n.childLanes=0,n.lanes=i,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=r.childLanes,n.lanes=r.lanes,n.child=r.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=r.memoizedProps,n.memoizedState=r.memoizedState,n.updateQueue=r.updateQueue,n.type=r.type,i=r.dependencies,n.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),n}function eo(n,i,r,c,p,g){var A=0;if(c=n,typeof n=="function")bc(n)&&(A=1);else if(typeof n=="string")A=Gv(n,r,tt.current)?26:n==="html"||n==="head"||n==="body"?27:5;else t:switch(n){case K:return n=Ze(31,r,i,p),n.elementType=K,n.lanes=g,n;case w:return Xi(r.children,p,g,i);case x:A=8,p|=24;break;case E:return n=Ze(12,r,i,p|2),n.elementType=E,n.lanes=g,n;case k:return n=Ze(13,r,i,p),n.elementType=k,n.lanes=g,n;case L:return n=Ze(19,r,i,p),n.elementType=L,n.lanes=g,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case C:A=10;break t;case M:A=9;break t;case R:A=11;break t;case P:A=14;break t;case $:A=16,c=null;break t}A=29,r=Error(s(130,n===null?"null":typeof n,"")),c=null}return i=Ze(A,r,i,p),i.elementType=n,i.type=c,i.lanes=g,i}function Xi(n,i,r,c){return n=Ze(7,n,c,i),n.lanes=r,n}function vc(n,i,r){return n=Ze(6,n,null,i),n.lanes=r,n}function uf(n){var i=Ze(18,null,null,0);return i.stateNode=n,i}function Ac(n,i,r){return i=Ze(4,n.children!==null?n.children:[],n.key,i),i.lanes=r,i.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},i}var hf=new WeakMap;function hn(n,i){if(typeof n=="object"&&n!==null){var r=hf.get(n);return r!==void 0?r:(i={value:n,source:i,stack:cd(i)},hf.set(n,i),i)}return{value:n,source:i,stack:cd(i)}}var Ds=[],Ns=0,no=null,Da=0,dn=[],fn=0,hi=null,Mn=1,Dn="";function Vn(n,i){Ds[Ns++]=Da,Ds[Ns++]=no,no=n,Da=i}function df(n,i,r){dn[fn++]=Mn,dn[fn++]=Dn,dn[fn++]=hi,hi=n;var c=Mn;n=Dn;var p=32-Qe(c)-1;c&=~(1<<p),r+=1;var g=32-Qe(i)+p;if(30<g){var A=p-p%5;g=(c&(1<<A)-1).toString(32),c>>=A,p-=A,Mn=1<<32-Qe(i)+p|r<<p|c,Dn=g+n}else Mn=1<<g|r<<p|c,Dn=n}function Sc(n){n.return!==null&&(Vn(n,1),df(n,1,0))}function wc(n){for(;n===no;)no=Ds[--Ns],Ds[Ns]=null,Da=Ds[--Ns],Ds[Ns]=null;for(;n===hi;)hi=dn[--fn],dn[fn]=null,Dn=dn[--fn],dn[fn]=null,Mn=dn[--fn],dn[fn]=null}function ff(n,i){dn[fn++]=Mn,dn[fn++]=Dn,dn[fn++]=hi,Mn=i.id,Dn=i.overflow,hi=n}var Ee=null,Kt=null,Dt=!1,di=null,pn=!1,xc=Error(s(519));function fi(n){var i=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Na(hn(i,n)),xc}function pf(n){var i=n.stateNode,r=n.type,c=n.memoizedProps;switch(i[xe]=n,i[Pe]=c,r){case"dialog":_t("cancel",i),_t("close",i);break;case"iframe":case"object":case"embed":_t("load",i);break;case"video":case"audio":for(r=0;r<Za.length;r++)_t(Za[r],i);break;case"source":_t("error",i);break;case"img":case"image":case"link":_t("error",i),_t("load",i);break;case"details":_t("toggle",i);break;case"input":_t("invalid",i),_d(i,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":_t("invalid",i);break;case"textarea":_t("invalid",i),Md(i,c.value,c.defaultValue,c.children)}r=c.children,typeof r!="string"&&typeof r!="number"&&typeof r!="bigint"||i.textContent===""+r||c.suppressHydrationWarning===!0||Rm(i.textContent,r)?(c.popover!=null&&(_t("beforetoggle",i),_t("toggle",i)),c.onScroll!=null&&_t("scroll",i),c.onScrollEnd!=null&&_t("scrollend",i),c.onClick!=null&&(i.onclick=In),i=!0):i=!1,i||fi(n,!0)}function mf(n){for(Ee=n.return;Ee;)switch(Ee.tag){case 5:case 31:case 13:pn=!1;return;case 27:case 3:pn=!0;return;default:Ee=Ee.return}}function Rs(n){if(n!==Ee)return!1;if(!Dt)return mf(n),Dt=!0,!1;var i=n.tag,r;if((r=i!==3&&i!==27)&&((r=i===5)&&(r=n.type,r=!(r!=="form"&&r!=="button")||Iu(n.type,n.memoizedProps)),r=!r),r&&Kt&&fi(n),mf(n),i===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(s(317));Kt=Um(n)}else if(i===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(s(317));Kt=Um(n)}else i===27?(i=Kt,Ci(n.type)?(n=Xu,Xu=null,Kt=n):Kt=i):Kt=Ee?gn(n.stateNode.nextSibling):null;return!0}function Yi(){Kt=Ee=null,Dt=!1}function Ec(){var n=di;return n!==null&&(Ie===null?Ie=n:Ie.push.apply(Ie,n),di=null),n}function Na(n){di===null?di=[n]:di.push(n)}var Tc=N(null),$i=null,qn=null;function pi(n,i,r){Q(Tc,i._currentValue),i._currentValue=r}function Xn(n){n._currentValue=Tc.current,I(Tc)}function _c(n,i,r){for(;n!==null;){var c=n.alternate;if((n.childLanes&i)!==i?(n.childLanes|=i,c!==null&&(c.childLanes|=i)):c!==null&&(c.childLanes&i)!==i&&(c.childLanes|=i),n===r)break;n=n.return}}function Cc(n,i,r,c){var p=n.child;for(p!==null&&(p.return=n);p!==null;){var g=p.dependencies;if(g!==null){var A=p.child;g=g.firstContext;t:for(;g!==null;){var T=g;g=p;for(var D=0;D<i.length;D++)if(T.context===i[D]){g.lanes|=r,T=g.alternate,T!==null&&(T.lanes|=r),_c(g.return,r,n),c||(A=null);break t}g=T.next}}else if(p.tag===18){if(A=p.return,A===null)throw Error(s(341));A.lanes|=r,g=A.alternate,g!==null&&(g.lanes|=r),_c(A,r,n),A=null}else A=p.child;if(A!==null)A.return=p;else for(A=p;A!==null;){if(A===n){A=null;break}if(p=A.sibling,p!==null){p.return=A.return,A=p;break}A=A.return}p=A}}function ks(n,i,r,c){n=null;for(var p=i,g=!1;p!==null;){if(!g){if((p.flags&524288)!==0)g=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var A=p.alternate;if(A===null)throw Error(s(387));if(A=A.memoizedProps,A!==null){var T=p.type;We(p.pendingProps.value,A.value)||(n!==null?n.push(T):n=[T])}}else if(p===dt.current){if(A=p.alternate,A===null)throw Error(s(387));A.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(n!==null?n.push(ir):n=[ir])}p=p.return}n!==null&&Cc(i,n,r,c),i.flags|=262144}function io(n){for(n=n.firstContext;n!==null;){if(!We(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function Ki(n){$i=n,qn=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Te(n){return gf($i,n)}function so(n,i){return $i===null&&Ki(n),gf(n,i)}function gf(n,i){var r=i._currentValue;if(i={context:i,memoizedValue:r,next:null},qn===null){if(n===null)throw Error(s(308));qn=i,n.dependencies={lanes:0,firstContext:i},n.flags|=524288}else qn=qn.next=i;return r}var zb=typeof AbortController<"u"?AbortController:function(){var n=[],i=this.signal={aborted:!1,addEventListener:function(r,c){n.push(c)}};this.abort=function(){i.aborted=!0,n.forEach(function(r){return r()})}},Ub=h.unstable_scheduleCallback,Ib=h.unstable_NormalPriority,ue={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Mc(){return{controller:new zb,data:new Map,refCount:0}}function Ra(n){n.refCount--,n.refCount===0&&Ub(Ib,function(){n.controller.abort()})}var ka=null,Dc=0,Os=0,Ls=null;function Hb(n,i){if(ka===null){var r=ka=[];Dc=0,Os=ku(),Ls={status:"pending",value:void 0,then:function(c){r.push(c)}}}return Dc++,i.then(yf,yf),i}function yf(){if(--Dc===0&&ka!==null){Ls!==null&&(Ls.status="fulfilled");var n=ka;ka=null,Os=0,Ls=null;for(var i=0;i<n.length;i++)(0,n[i])()}}function Gb(n,i){var r=[],c={status:"pending",value:null,reason:null,then:function(p){r.push(p)}};return n.then(function(){c.status="fulfilled",c.value=i;for(var p=0;p<r.length;p++)(0,r[p])(i)},function(p){for(c.status="rejected",c.reason=p,p=0;p<r.length;p++)(0,r[p])(void 0)}),c}var bf=O.S;O.S=function(n,i){em=$e(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&Hb(n,i),bf!==null&&bf(n,i)};var Qi=N(null);function Nc(){var n=Qi.current;return n!==null?n:Yt.pooledCache}function ao(n,i){i===null?Q(Qi,Qi.current):Q(Qi,i.pool)}function vf(){var n=Nc();return n===null?null:{parent:ue._currentValue,pool:n}}var Bs=Error(s(460)),Rc=Error(s(474)),ro=Error(s(542)),oo={then:function(){}};function Af(n){return n=n.status,n==="fulfilled"||n==="rejected"}function Sf(n,i,r){switch(r=n[r],r===void 0?n.push(i):r!==i&&(i.then(In,In),i=r),i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,xf(n),n;default:if(typeof i.status=="string")i.then(In,In);else{if(n=Yt,n!==null&&100<n.shellSuspendCounter)throw Error(s(482));n=i,n.status="pending",n.then(function(c){if(i.status==="pending"){var p=i;p.status="fulfilled",p.value=c}},function(c){if(i.status==="pending"){var p=i;p.status="rejected",p.reason=c}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,xf(n),n}throw Zi=i,Bs}}function Wi(n){try{var i=n._init;return i(n._payload)}catch(r){throw r!==null&&typeof r=="object"&&typeof r.then=="function"?(Zi=r,Bs):r}}var Zi=null;function wf(){if(Zi===null)throw Error(s(459));var n=Zi;return Zi=null,n}function xf(n){if(n===Bs||n===ro)throw Error(s(483))}var Ps=null,Oa=0;function lo(n){var i=Oa;return Oa+=1,Ps===null&&(Ps=[]),Sf(Ps,n,i)}function La(n,i){i=i.props.ref,n.ref=i!==void 0?i:null}function co(n,i){throw i.$$typeof===b?Error(s(525)):(n=Object.prototype.toString.call(i),Error(s(31,n==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":n)))}function Ef(n){function i(j,B){if(n){var F=j.deletions;F===null?(j.deletions=[B],j.flags|=16):F.push(B)}}function r(j,B){if(!n)return null;for(;B!==null;)i(j,B),B=B.sibling;return null}function c(j){for(var B=new Map;j!==null;)j.key!==null?B.set(j.key,j):B.set(j.index,j),j=j.sibling;return B}function p(j,B){return j=Gn(j,B),j.index=0,j.sibling=null,j}function g(j,B,F){return j.index=F,n?(F=j.alternate,F!==null?(F=F.index,F<B?(j.flags|=67108866,B):F):(j.flags|=67108866,B)):(j.flags|=1048576,B)}function A(j){return n&&j.alternate===null&&(j.flags|=67108866),j}function T(j,B,F,X){return B===null||B.tag!==6?(B=vc(F,j.mode,X),B.return=j,B):(B=p(B,F),B.return=j,B)}function D(j,B,F,X){var lt=F.type;return lt===w?q(j,B,F.props.children,X,F.key):B!==null&&(B.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===$&&Wi(lt)===B.type)?(B=p(B,F.props),La(B,F),B.return=j,B):(B=eo(F.type,F.key,F.props,null,j.mode,X),La(B,F),B.return=j,B)}function z(j,B,F,X){return B===null||B.tag!==4||B.stateNode.containerInfo!==F.containerInfo||B.stateNode.implementation!==F.implementation?(B=Ac(F,j.mode,X),B.return=j,B):(B=p(B,F.children||[]),B.return=j,B)}function q(j,B,F,X,lt){return B===null||B.tag!==7?(B=Xi(F,j.mode,X,lt),B.return=j,B):(B=p(B,F),B.return=j,B)}function Y(j,B,F){if(typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint")return B=vc(""+B,j.mode,F),B.return=j,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case v:return F=eo(B.type,B.key,B.props,null,j.mode,F),La(F,B),F.return=j,F;case S:return B=Ac(B,j.mode,F),B.return=j,B;case $:return B=Wi(B),Y(j,B,F)}if(et(B)||ht(B))return B=Xi(B,j.mode,F,null),B.return=j,B;if(typeof B.then=="function")return Y(j,lo(B),F);if(B.$$typeof===C)return Y(j,so(j,B),F);co(j,B)}return null}function U(j,B,F,X){var lt=B!==null?B.key:null;if(typeof F=="string"&&F!==""||typeof F=="number"||typeof F=="bigint")return lt!==null?null:T(j,B,""+F,X);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case v:return F.key===lt?D(j,B,F,X):null;case S:return F.key===lt?z(j,B,F,X):null;case $:return F=Wi(F),U(j,B,F,X)}if(et(F)||ht(F))return lt!==null?null:q(j,B,F,X,null);if(typeof F.then=="function")return U(j,B,lo(F),X);if(F.$$typeof===C)return U(j,B,so(j,F),X);co(j,F)}return null}function V(j,B,F,X,lt){if(typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint")return j=j.get(F)||null,T(B,j,""+X,lt);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case v:return j=j.get(X.key===null?F:X.key)||null,D(B,j,X,lt);case S:return j=j.get(X.key===null?F:X.key)||null,z(B,j,X,lt);case $:return X=Wi(X),V(j,B,F,X,lt)}if(et(X)||ht(X))return j=j.get(F)||null,q(B,j,X,lt,null);if(typeof X.then=="function")return V(j,B,F,lo(X),lt);if(X.$$typeof===C)return V(j,B,F,so(B,X),lt);co(B,X)}return null}function at(j,B,F,X){for(var lt=null,kt=null,rt=B,xt=B=0,Mt=null;rt!==null&&xt<F.length;xt++){rt.index>xt?(Mt=rt,rt=null):Mt=rt.sibling;var Ot=U(j,rt,F[xt],X);if(Ot===null){rt===null&&(rt=Mt);break}n&&rt&&Ot.alternate===null&&i(j,rt),B=g(Ot,B,xt),kt===null?lt=Ot:kt.sibling=Ot,kt=Ot,rt=Mt}if(xt===F.length)return r(j,rt),Dt&&Vn(j,xt),lt;if(rt===null){for(;xt<F.length;xt++)rt=Y(j,F[xt],X),rt!==null&&(B=g(rt,B,xt),kt===null?lt=rt:kt.sibling=rt,kt=rt);return Dt&&Vn(j,xt),lt}for(rt=c(rt);xt<F.length;xt++)Mt=V(rt,j,xt,F[xt],X),Mt!==null&&(n&&Mt.alternate!==null&&rt.delete(Mt.key===null?xt:Mt.key),B=g(Mt,B,xt),kt===null?lt=Mt:kt.sibling=Mt,kt=Mt);return n&&rt.forEach(function(ki){return i(j,ki)}),Dt&&Vn(j,xt),lt}function ft(j,B,F,X){if(F==null)throw Error(s(151));for(var lt=null,kt=null,rt=B,xt=B=0,Mt=null,Ot=F.next();rt!==null&&!Ot.done;xt++,Ot=F.next()){rt.index>xt?(Mt=rt,rt=null):Mt=rt.sibling;var ki=U(j,rt,Ot.value,X);if(ki===null){rt===null&&(rt=Mt);break}n&&rt&&ki.alternate===null&&i(j,rt),B=g(ki,B,xt),kt===null?lt=ki:kt.sibling=ki,kt=ki,rt=Mt}if(Ot.done)return r(j,rt),Dt&&Vn(j,xt),lt;if(rt===null){for(;!Ot.done;xt++,Ot=F.next())Ot=Y(j,Ot.value,X),Ot!==null&&(B=g(Ot,B,xt),kt===null?lt=Ot:kt.sibling=Ot,kt=Ot);return Dt&&Vn(j,xt),lt}for(rt=c(rt);!Ot.done;xt++,Ot=F.next())Ot=V(rt,j,xt,Ot.value,X),Ot!==null&&(n&&Ot.alternate!==null&&rt.delete(Ot.key===null?xt:Ot.key),B=g(Ot,B,xt),kt===null?lt=Ot:kt.sibling=Ot,kt=Ot);return n&&rt.forEach(function(t1){return i(j,t1)}),Dt&&Vn(j,xt),lt}function Vt(j,B,F,X){if(typeof F=="object"&&F!==null&&F.type===w&&F.key===null&&(F=F.props.children),typeof F=="object"&&F!==null){switch(F.$$typeof){case v:t:{for(var lt=F.key;B!==null;){if(B.key===lt){if(lt=F.type,lt===w){if(B.tag===7){r(j,B.sibling),X=p(B,F.props.children),X.return=j,j=X;break t}}else if(B.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===$&&Wi(lt)===B.type){r(j,B.sibling),X=p(B,F.props),La(X,F),X.return=j,j=X;break t}r(j,B);break}else i(j,B);B=B.sibling}F.type===w?(X=Xi(F.props.children,j.mode,X,F.key),X.return=j,j=X):(X=eo(F.type,F.key,F.props,null,j.mode,X),La(X,F),X.return=j,j=X)}return A(j);case S:t:{for(lt=F.key;B!==null;){if(B.key===lt)if(B.tag===4&&B.stateNode.containerInfo===F.containerInfo&&B.stateNode.implementation===F.implementation){r(j,B.sibling),X=p(B,F.children||[]),X.return=j,j=X;break t}else{r(j,B);break}else i(j,B);B=B.sibling}X=Ac(F,j.mode,X),X.return=j,j=X}return A(j);case $:return F=Wi(F),Vt(j,B,F,X)}if(et(F))return at(j,B,F,X);if(ht(F)){if(lt=ht(F),typeof lt!="function")throw Error(s(150));return F=lt.call(F),ft(j,B,F,X)}if(typeof F.then=="function")return Vt(j,B,lo(F),X);if(F.$$typeof===C)return Vt(j,B,so(j,F),X);co(j,F)}return typeof F=="string"&&F!==""||typeof F=="number"||typeof F=="bigint"?(F=""+F,B!==null&&B.tag===6?(r(j,B.sibling),X=p(B,F),X.return=j,j=X):(r(j,B),X=vc(F,j.mode,X),X.return=j,j=X),A(j)):r(j,B)}return function(j,B,F,X){try{Oa=0;var lt=Vt(j,B,F,X);return Ps=null,lt}catch(rt){if(rt===Bs||rt===ro)throw rt;var kt=Ze(29,rt,null,j.mode);return kt.lanes=X,kt.return=j,kt}}}var Ji=Ef(!0),Tf=Ef(!1),mi=!1;function kc(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Oc(n,i){n=n.updateQueue,i.updateQueue===n&&(i.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function gi(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function yi(n,i,r){var c=n.updateQueue;if(c===null)return null;if(c=c.shared,(Lt&2)!==0){var p=c.pending;return p===null?i.next=i:(i.next=p.next,p.next=i),c.pending=i,i=to(n),lf(n,null,r),i}return Jr(n,c,i,r),to(n)}function Ba(n,i,r){if(i=i.updateQueue,i!==null&&(i=i.shared,(r&4194048)!==0)){var c=i.lanes;c&=n.pendingLanes,r|=c,i.lanes=r,md(n,r)}}function Lc(n,i){var r=n.updateQueue,c=n.alternate;if(c!==null&&(c=c.updateQueue,r===c)){var p=null,g=null;if(r=r.firstBaseUpdate,r!==null){do{var A={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};g===null?p=g=A:g=g.next=A,r=r.next}while(r!==null);g===null?p=g=i:g=g.next=i}else p=g=i;r={baseState:c.baseState,firstBaseUpdate:p,lastBaseUpdate:g,shared:c.shared,callbacks:c.callbacks},n.updateQueue=r;return}n=r.lastBaseUpdate,n===null?r.firstBaseUpdate=i:n.next=i,r.lastBaseUpdate=i}var Bc=!1;function Pa(){if(Bc){var n=Ls;if(n!==null)throw n}}function ja(n,i,r,c){Bc=!1;var p=n.updateQueue;mi=!1;var g=p.firstBaseUpdate,A=p.lastBaseUpdate,T=p.shared.pending;if(T!==null){p.shared.pending=null;var D=T,z=D.next;D.next=null,A===null?g=z:A.next=z,A=D;var q=n.alternate;q!==null&&(q=q.updateQueue,T=q.lastBaseUpdate,T!==A&&(T===null?q.firstBaseUpdate=z:T.next=z,q.lastBaseUpdate=D))}if(g!==null){var Y=p.baseState;A=0,q=z=D=null,T=g;do{var U=T.lane&-536870913,V=U!==T.lane;if(V?(Ct&U)===U:(c&U)===U){U!==0&&U===Os&&(Bc=!0),q!==null&&(q=q.next={lane:0,tag:T.tag,payload:T.payload,callback:null,next:null});t:{var at=n,ft=T;U=i;var Vt=r;switch(ft.tag){case 1:if(at=ft.payload,typeof at=="function"){Y=at.call(Vt,Y,U);break t}Y=at;break t;case 3:at.flags=at.flags&-65537|128;case 0:if(at=ft.payload,U=typeof at=="function"?at.call(Vt,Y,U):at,U==null)break t;Y=y({},Y,U);break t;case 2:mi=!0}}U=T.callback,U!==null&&(n.flags|=64,V&&(n.flags|=8192),V=p.callbacks,V===null?p.callbacks=[U]:V.push(U))}else V={lane:U,tag:T.tag,payload:T.payload,callback:T.callback,next:null},q===null?(z=q=V,D=Y):q=q.next=V,A|=U;if(T=T.next,T===null){if(T=p.shared.pending,T===null)break;V=T,T=V.next,V.next=null,p.lastBaseUpdate=V,p.shared.pending=null}}while(!0);q===null&&(D=Y),p.baseState=D,p.firstBaseUpdate=z,p.lastBaseUpdate=q,g===null&&(p.shared.lanes=0),wi|=A,n.lanes=A,n.memoizedState=Y}}function _f(n,i){if(typeof n!="function")throw Error(s(191,n));n.call(i)}function Cf(n,i){var r=n.callbacks;if(r!==null)for(n.callbacks=null,n=0;n<r.length;n++)_f(r[n],i)}var js=N(null),uo=N(0);function Mf(n,i){n=ei,Q(uo,n),Q(js,i),ei=n|i.baseLanes}function Pc(){Q(uo,ei),Q(js,js.current)}function jc(){ei=uo.current,I(js),I(uo)}var Je=N(null),mn=null;function bi(n){var i=n.alternate;Q(oe,oe.current&1),Q(Je,n),mn===null&&(i===null||js.current!==null||i.memoizedState!==null)&&(mn=n)}function Fc(n){Q(oe,oe.current),Q(Je,n),mn===null&&(mn=n)}function Df(n){n.tag===22?(Q(oe,oe.current),Q(Je,n),mn===null&&(mn=n)):vi()}function vi(){Q(oe,oe.current),Q(Je,Je.current)}function tn(n){I(Je),mn===n&&(mn=null),I(oe)}var oe=N(0);function ho(n){for(var i=n;i!==null;){if(i.tag===13){var r=i.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||Vu(r)||qu(r)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Yn=0,wt=null,Ht=null,he=null,fo=!1,Fs=!1,ts=!1,po=0,Fa=0,zs=null,Vb=0;function ie(){throw Error(s(321))}function zc(n,i){if(i===null)return!1;for(var r=0;r<i.length&&r<n.length;r++)if(!We(n[r],i[r]))return!1;return!0}function Uc(n,i,r,c,p,g){return Yn=g,wt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,O.H=n===null||n.memoizedState===null?dp:eu,ts=!1,g=r(c,p),ts=!1,Fs&&(g=Rf(i,r,c,p)),Nf(n),g}function Nf(n){O.H=Ia;var i=Ht!==null&&Ht.next!==null;if(Yn=0,he=Ht=wt=null,fo=!1,Fa=0,zs=null,i)throw Error(s(300));n===null||de||(n=n.dependencies,n!==null&&io(n)&&(de=!0))}function Rf(n,i,r,c){wt=n;var p=0;do{if(Fs&&(zs=null),Fa=0,Fs=!1,25<=p)throw Error(s(301));if(p+=1,he=Ht=null,n.updateQueue!=null){var g=n.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}O.H=fp,g=i(r,c)}while(Fs);return g}function qb(){var n=O.H,i=n.useState()[0];return i=typeof i.then=="function"?za(i):i,n=n.useState()[0],(Ht!==null?Ht.memoizedState:null)!==n&&(wt.flags|=1024),i}function Ic(){var n=po!==0;return po=0,n}function Hc(n,i,r){i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~r}function Gc(n){if(fo){for(n=n.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}fo=!1}Yn=0,he=Ht=wt=null,Fs=!1,Fa=po=0,zs=null}function Oe(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return he===null?wt.memoizedState=he=n:he=he.next=n,he}function le(){if(Ht===null){var n=wt.alternate;n=n!==null?n.memoizedState:null}else n=Ht.next;var i=he===null?wt.memoizedState:he.next;if(i!==null)he=i,Ht=n;else{if(n===null)throw wt.alternate===null?Error(s(467)):Error(s(310));Ht=n,n={memoizedState:Ht.memoizedState,baseState:Ht.baseState,baseQueue:Ht.baseQueue,queue:Ht.queue,next:null},he===null?wt.memoizedState=he=n:he=he.next=n}return he}function mo(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function za(n){var i=Fa;return Fa+=1,zs===null&&(zs=[]),n=Sf(zs,n,i),i=wt,(he===null?i.memoizedState:he.next)===null&&(i=i.alternate,O.H=i===null||i.memoizedState===null?dp:eu),n}function go(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return za(n);if(n.$$typeof===C)return Te(n)}throw Error(s(438,String(n)))}function Vc(n){var i=null,r=wt.updateQueue;if(r!==null&&(i=r.memoCache),i==null){var c=wt.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(i={data:c.data.map(function(p){return p.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),r===null&&(r=mo(),wt.updateQueue=r),r.memoCache=i,r=i.data[i.index],r===void 0)for(r=i.data[i.index]=Array(n),c=0;c<n;c++)r[c]=J;return i.index++,r}function $n(n,i){return typeof i=="function"?i(n):i}function yo(n){var i=le();return qc(i,Ht,n)}function qc(n,i,r){var c=n.queue;if(c===null)throw Error(s(311));c.lastRenderedReducer=r;var p=n.baseQueue,g=c.pending;if(g!==null){if(p!==null){var A=p.next;p.next=g.next,g.next=A}i.baseQueue=p=g,c.pending=null}if(g=n.baseState,p===null)n.memoizedState=g;else{i=p.next;var T=A=null,D=null,z=i,q=!1;do{var Y=z.lane&-536870913;if(Y!==z.lane?(Ct&Y)===Y:(Yn&Y)===Y){var U=z.revertLane;if(U===0)D!==null&&(D=D.next={lane:0,revertLane:0,gesture:null,action:z.action,hasEagerState:z.hasEagerState,eagerState:z.eagerState,next:null}),Y===Os&&(q=!0);else if((Yn&U)===U){z=z.next,U===Os&&(q=!0);continue}else Y={lane:0,revertLane:z.revertLane,gesture:null,action:z.action,hasEagerState:z.hasEagerState,eagerState:z.eagerState,next:null},D===null?(T=D=Y,A=g):D=D.next=Y,wt.lanes|=U,wi|=U;Y=z.action,ts&&r(g,Y),g=z.hasEagerState?z.eagerState:r(g,Y)}else U={lane:Y,revertLane:z.revertLane,gesture:z.gesture,action:z.action,hasEagerState:z.hasEagerState,eagerState:z.eagerState,next:null},D===null?(T=D=U,A=g):D=D.next=U,wt.lanes|=Y,wi|=Y;z=z.next}while(z!==null&&z!==i);if(D===null?A=g:D.next=T,!We(g,n.memoizedState)&&(de=!0,q&&(r=Ls,r!==null)))throw r;n.memoizedState=g,n.baseState=A,n.baseQueue=D,c.lastRenderedState=g}return p===null&&(c.lanes=0),[n.memoizedState,c.dispatch]}function Xc(n){var i=le(),r=i.queue;if(r===null)throw Error(s(311));r.lastRenderedReducer=n;var c=r.dispatch,p=r.pending,g=i.memoizedState;if(p!==null){r.pending=null;var A=p=p.next;do g=n(g,A.action),A=A.next;while(A!==p);We(g,i.memoizedState)||(de=!0),i.memoizedState=g,i.baseQueue===null&&(i.baseState=g),r.lastRenderedState=g}return[g,c]}function kf(n,i,r){var c=wt,p=le(),g=Dt;if(g){if(r===void 0)throw Error(s(407));r=r()}else r=i();var A=!We((Ht||p).memoizedState,r);if(A&&(p.memoizedState=r,de=!0),p=p.queue,Kc(Bf.bind(null,c,p,n),[n]),p.getSnapshot!==i||A||he!==null&&he.memoizedState.tag&1){if(c.flags|=2048,Us(9,{destroy:void 0},Lf.bind(null,c,p,r,i),null),Yt===null)throw Error(s(349));g||(Yn&127)!==0||Of(c,i,r)}return r}function Of(n,i,r){n.flags|=16384,n={getSnapshot:i,value:r},i=wt.updateQueue,i===null?(i=mo(),wt.updateQueue=i,i.stores=[n]):(r=i.stores,r===null?i.stores=[n]:r.push(n))}function Lf(n,i,r,c){i.value=r,i.getSnapshot=c,Pf(i)&&jf(n)}function Bf(n,i,r){return r(function(){Pf(i)&&jf(n)})}function Pf(n){var i=n.getSnapshot;n=n.value;try{var r=i();return!We(n,r)}catch{return!0}}function jf(n){var i=qi(n,2);i!==null&&He(i,n,2)}function Yc(n){var i=Oe();if(typeof n=="function"){var r=n;if(n=r(),ts){li(!0);try{r()}finally{li(!1)}}}return i.memoizedState=i.baseState=n,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:$n,lastRenderedState:n},i}function Ff(n,i,r,c){return n.baseState=r,qc(n,Ht,typeof c=="function"?c:$n)}function Xb(n,i,r,c,p){if(Ao(n))throw Error(s(485));if(n=i.action,n!==null){var g={payload:p,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){g.listeners.push(A)}};O.T!==null?r(!0):g.isTransition=!1,c(g),r=i.pending,r===null?(g.next=i.pending=g,zf(i,g)):(g.next=r.next,i.pending=r.next=g)}}function zf(n,i){var r=i.action,c=i.payload,p=n.state;if(i.isTransition){var g=O.T,A={};O.T=A;try{var T=r(p,c),D=O.S;D!==null&&D(A,T),Uf(n,i,T)}catch(z){$c(n,i,z)}finally{g!==null&&A.types!==null&&(g.types=A.types),O.T=g}}else try{g=r(p,c),Uf(n,i,g)}catch(z){$c(n,i,z)}}function Uf(n,i,r){r!==null&&typeof r=="object"&&typeof r.then=="function"?r.then(function(c){If(n,i,c)},function(c){return $c(n,i,c)}):If(n,i,r)}function If(n,i,r){i.status="fulfilled",i.value=r,Hf(i),n.state=r,i=n.pending,i!==null&&(r=i.next,r===i?n.pending=null:(r=r.next,i.next=r,zf(n,r)))}function $c(n,i,r){var c=n.pending;if(n.pending=null,c!==null){c=c.next;do i.status="rejected",i.reason=r,Hf(i),i=i.next;while(i!==c)}n.action=null}function Hf(n){n=n.listeners;for(var i=0;i<n.length;i++)(0,n[i])()}function Gf(n,i){return i}function Vf(n,i){if(Dt){var r=Yt.formState;if(r!==null){t:{var c=wt;if(Dt){if(Kt){e:{for(var p=Kt,g=pn;p.nodeType!==8;){if(!g){p=null;break e}if(p=gn(p.nextSibling),p===null){p=null;break e}}g=p.data,p=g==="F!"||g==="F"?p:null}if(p){Kt=gn(p.nextSibling),c=p.data==="F!";break t}}fi(c)}c=!1}c&&(i=r[0])}}return r=Oe(),r.memoizedState=r.baseState=i,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Gf,lastRenderedState:i},r.queue=c,r=cp.bind(null,wt,c),c.dispatch=r,c=Yc(!1),g=tu.bind(null,wt,!1,c.queue),c=Oe(),p={state:i,dispatch:null,action:n,pending:null},c.queue=p,r=Xb.bind(null,wt,p,g,r),p.dispatch=r,c.memoizedState=n,[i,r,!1]}function qf(n){var i=le();return Xf(i,Ht,n)}function Xf(n,i,r){if(i=qc(n,i,Gf)[0],n=yo($n)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var c=za(i)}catch(A){throw A===Bs?ro:A}else c=i;i=le();var p=i.queue,g=p.dispatch;return r!==i.memoizedState&&(wt.flags|=2048,Us(9,{destroy:void 0},Yb.bind(null,p,r),null)),[c,g,n]}function Yb(n,i){n.action=i}function Yf(n){var i=le(),r=Ht;if(r!==null)return Xf(i,r,n);le(),i=i.memoizedState,r=le();var c=r.queue.dispatch;return r.memoizedState=n,[i,c,!1]}function Us(n,i,r,c){return n={tag:n,create:r,deps:c,inst:i,next:null},i=wt.updateQueue,i===null&&(i=mo(),wt.updateQueue=i),r=i.lastEffect,r===null?i.lastEffect=n.next=n:(c=r.next,r.next=n,n.next=c,i.lastEffect=n),n}function $f(){return le().memoizedState}function bo(n,i,r,c){var p=Oe();wt.flags|=n,p.memoizedState=Us(1|i,{destroy:void 0},r,c===void 0?null:c)}function vo(n,i,r,c){var p=le();c=c===void 0?null:c;var g=p.memoizedState.inst;Ht!==null&&c!==null&&zc(c,Ht.memoizedState.deps)?p.memoizedState=Us(i,g,r,c):(wt.flags|=n,p.memoizedState=Us(1|i,g,r,c))}function Kf(n,i){bo(8390656,8,n,i)}function Kc(n,i){vo(2048,8,n,i)}function $b(n){wt.flags|=4;var i=wt.updateQueue;if(i===null)i=mo(),wt.updateQueue=i,i.events=[n];else{var r=i.events;r===null?i.events=[n]:r.push(n)}}function Qf(n){var i=le().memoizedState;return $b({ref:i,nextImpl:n}),function(){if((Lt&2)!==0)throw Error(s(440));return i.impl.apply(void 0,arguments)}}function Wf(n,i){return vo(4,2,n,i)}function Zf(n,i){return vo(4,4,n,i)}function Jf(n,i){if(typeof i=="function"){n=n();var r=i(n);return function(){typeof r=="function"?r():i(null)}}if(i!=null)return n=n(),i.current=n,function(){i.current=null}}function tp(n,i,r){r=r!=null?r.concat([n]):null,vo(4,4,Jf.bind(null,i,n),r)}function Qc(){}function ep(n,i){var r=le();i=i===void 0?null:i;var c=r.memoizedState;return i!==null&&zc(i,c[1])?c[0]:(r.memoizedState=[n,i],n)}function np(n,i){var r=le();i=i===void 0?null:i;var c=r.memoizedState;if(i!==null&&zc(i,c[1]))return c[0];if(c=n(),ts){li(!0);try{n()}finally{li(!1)}}return r.memoizedState=[c,i],c}function Wc(n,i,r){return r===void 0||(Yn&1073741824)!==0&&(Ct&261930)===0?n.memoizedState=i:(n.memoizedState=r,n=im(),wt.lanes|=n,wi|=n,r)}function ip(n,i,r,c){return We(r,i)?r:js.current!==null?(n=Wc(n,r,c),We(n,i)||(de=!0),n):(Yn&42)===0||(Yn&1073741824)!==0&&(Ct&261930)===0?(de=!0,n.memoizedState=r):(n=im(),wt.lanes|=n,wi|=n,i)}function sp(n,i,r,c,p){var g=H.p;H.p=g!==0&&8>g?g:8;var A=O.T,T={};O.T=T,tu(n,!1,i,r);try{var D=p(),z=O.S;if(z!==null&&z(T,D),D!==null&&typeof D=="object"&&typeof D.then=="function"){var q=Gb(D,c);Ua(n,i,q,sn(n))}else Ua(n,i,c,sn(n))}catch(Y){Ua(n,i,{then:function(){},status:"rejected",reason:Y},sn())}finally{H.p=g,A!==null&&T.types!==null&&(A.types=T.types),O.T=A}}function Kb(){}function Zc(n,i,r,c){if(n.tag!==5)throw Error(s(476));var p=ap(n).queue;sp(n,p,i,W,r===null?Kb:function(){return rp(n),r(c)})}function ap(n){var i=n.memoizedState;if(i!==null)return i;i={memoizedState:W,baseState:W,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:$n,lastRenderedState:W},next:null};var r={};return i.next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:$n,lastRenderedState:r},next:null},n.memoizedState=i,n=n.alternate,n!==null&&(n.memoizedState=i),i}function rp(n){var i=ap(n);i.next===null&&(i=n.alternate.memoizedState),Ua(n,i.next.queue,{},sn())}function Jc(){return Te(ir)}function op(){return le().memoizedState}function lp(){return le().memoizedState}function Qb(n){for(var i=n.return;i!==null;){switch(i.tag){case 24:case 3:var r=sn();n=gi(r);var c=yi(i,n,r);c!==null&&(He(c,i,r),Ba(c,i,r)),i={cache:Mc()},n.payload=i;return}i=i.return}}function Wb(n,i,r){var c=sn();r={lane:c,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},Ao(n)?up(i,r):(r=yc(n,i,r,c),r!==null&&(He(r,n,c),hp(r,i,c)))}function cp(n,i,r){var c=sn();Ua(n,i,r,c)}function Ua(n,i,r,c){var p={lane:c,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null};if(Ao(n))up(i,p);else{var g=n.alternate;if(n.lanes===0&&(g===null||g.lanes===0)&&(g=i.lastRenderedReducer,g!==null))try{var A=i.lastRenderedState,T=g(A,r);if(p.hasEagerState=!0,p.eagerState=T,We(T,A))return Jr(n,i,p,0),Yt===null&&Zr(),!1}catch{}if(r=yc(n,i,p,c),r!==null)return He(r,n,c),hp(r,i,c),!0}return!1}function tu(n,i,r,c){if(c={lane:2,revertLane:ku(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Ao(n)){if(i)throw Error(s(479))}else i=yc(n,r,c,2),i!==null&&He(i,n,2)}function Ao(n){var i=n.alternate;return n===wt||i!==null&&i===wt}function up(n,i){Fs=fo=!0;var r=n.pending;r===null?i.next=i:(i.next=r.next,r.next=i),n.pending=i}function hp(n,i,r){if((r&4194048)!==0){var c=i.lanes;c&=n.pendingLanes,r|=c,i.lanes=r,md(n,r)}}var Ia={readContext:Te,use:go,useCallback:ie,useContext:ie,useEffect:ie,useImperativeHandle:ie,useLayoutEffect:ie,useInsertionEffect:ie,useMemo:ie,useReducer:ie,useRef:ie,useState:ie,useDebugValue:ie,useDeferredValue:ie,useTransition:ie,useSyncExternalStore:ie,useId:ie,useHostTransitionStatus:ie,useFormState:ie,useActionState:ie,useOptimistic:ie,useMemoCache:ie,useCacheRefresh:ie};Ia.useEffectEvent=ie;var dp={readContext:Te,use:go,useCallback:function(n,i){return Oe().memoizedState=[n,i===void 0?null:i],n},useContext:Te,useEffect:Kf,useImperativeHandle:function(n,i,r){r=r!=null?r.concat([n]):null,bo(4194308,4,Jf.bind(null,i,n),r)},useLayoutEffect:function(n,i){return bo(4194308,4,n,i)},useInsertionEffect:function(n,i){bo(4,2,n,i)},useMemo:function(n,i){var r=Oe();i=i===void 0?null:i;var c=n();if(ts){li(!0);try{n()}finally{li(!1)}}return r.memoizedState=[c,i],c},useReducer:function(n,i,r){var c=Oe();if(r!==void 0){var p=r(i);if(ts){li(!0);try{r(i)}finally{li(!1)}}}else p=i;return c.memoizedState=c.baseState=p,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:p},c.queue=n,n=n.dispatch=Wb.bind(null,wt,n),[c.memoizedState,n]},useRef:function(n){var i=Oe();return n={current:n},i.memoizedState=n},useState:function(n){n=Yc(n);var i=n.queue,r=cp.bind(null,wt,i);return i.dispatch=r,[n.memoizedState,r]},useDebugValue:Qc,useDeferredValue:function(n,i){var r=Oe();return Wc(r,n,i)},useTransition:function(){var n=Yc(!1);return n=sp.bind(null,wt,n.queue,!0,!1),Oe().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,i,r){var c=wt,p=Oe();if(Dt){if(r===void 0)throw Error(s(407));r=r()}else{if(r=i(),Yt===null)throw Error(s(349));(Ct&127)!==0||Of(c,i,r)}p.memoizedState=r;var g={value:r,getSnapshot:i};return p.queue=g,Kf(Bf.bind(null,c,g,n),[n]),c.flags|=2048,Us(9,{destroy:void 0},Lf.bind(null,c,g,r,i),null),r},useId:function(){var n=Oe(),i=Yt.identifierPrefix;if(Dt){var r=Dn,c=Mn;r=(c&~(1<<32-Qe(c)-1)).toString(32)+r,i="_"+i+"R_"+r,r=po++,0<r&&(i+="H"+r.toString(32)),i+="_"}else r=Vb++,i="_"+i+"r_"+r.toString(32)+"_";return n.memoizedState=i},useHostTransitionStatus:Jc,useFormState:Vf,useActionState:Vf,useOptimistic:function(n){var i=Oe();i.memoizedState=i.baseState=n;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=r,i=tu.bind(null,wt,!0,r),r.dispatch=i,[n,i]},useMemoCache:Vc,useCacheRefresh:function(){return Oe().memoizedState=Qb.bind(null,wt)},useEffectEvent:function(n){var i=Oe(),r={impl:n};return i.memoizedState=r,function(){if((Lt&2)!==0)throw Error(s(440));return r.impl.apply(void 0,arguments)}}},eu={readContext:Te,use:go,useCallback:ep,useContext:Te,useEffect:Kc,useImperativeHandle:tp,useInsertionEffect:Wf,useLayoutEffect:Zf,useMemo:np,useReducer:yo,useRef:$f,useState:function(){return yo($n)},useDebugValue:Qc,useDeferredValue:function(n,i){var r=le();return ip(r,Ht.memoizedState,n,i)},useTransition:function(){var n=yo($n)[0],i=le().memoizedState;return[typeof n=="boolean"?n:za(n),i]},useSyncExternalStore:kf,useId:op,useHostTransitionStatus:Jc,useFormState:qf,useActionState:qf,useOptimistic:function(n,i){var r=le();return Ff(r,Ht,n,i)},useMemoCache:Vc,useCacheRefresh:lp};eu.useEffectEvent=Qf;var fp={readContext:Te,use:go,useCallback:ep,useContext:Te,useEffect:Kc,useImperativeHandle:tp,useInsertionEffect:Wf,useLayoutEffect:Zf,useMemo:np,useReducer:Xc,useRef:$f,useState:function(){return Xc($n)},useDebugValue:Qc,useDeferredValue:function(n,i){var r=le();return Ht===null?Wc(r,n,i):ip(r,Ht.memoizedState,n,i)},useTransition:function(){var n=Xc($n)[0],i=le().memoizedState;return[typeof n=="boolean"?n:za(n),i]},useSyncExternalStore:kf,useId:op,useHostTransitionStatus:Jc,useFormState:Yf,useActionState:Yf,useOptimistic:function(n,i){var r=le();return Ht!==null?Ff(r,Ht,n,i):(r.baseState=n,[n,r.queue.dispatch])},useMemoCache:Vc,useCacheRefresh:lp};fp.useEffectEvent=Qf;function nu(n,i,r,c){i=n.memoizedState,r=r(c,i),r=r==null?i:y({},i,r),n.memoizedState=r,n.lanes===0&&(n.updateQueue.baseState=r)}var iu={enqueueSetState:function(n,i,r){n=n._reactInternals;var c=sn(),p=gi(c);p.payload=i,r!=null&&(p.callback=r),i=yi(n,p,c),i!==null&&(He(i,n,c),Ba(i,n,c))},enqueueReplaceState:function(n,i,r){n=n._reactInternals;var c=sn(),p=gi(c);p.tag=1,p.payload=i,r!=null&&(p.callback=r),i=yi(n,p,c),i!==null&&(He(i,n,c),Ba(i,n,c))},enqueueForceUpdate:function(n,i){n=n._reactInternals;var r=sn(),c=gi(r);c.tag=2,i!=null&&(c.callback=i),i=yi(n,c,r),i!==null&&(He(i,n,r),Ba(i,n,r))}};function pp(n,i,r,c,p,g,A){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(c,g,A):i.prototype&&i.prototype.isPureReactComponent?!Ca(r,c)||!Ca(p,g):!0}function mp(n,i,r,c){n=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(r,c),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(r,c),i.state!==n&&iu.enqueueReplaceState(i,i.state,null)}function es(n,i){var r=i;if("ref"in i){r={};for(var c in i)c!=="ref"&&(r[c]=i[c])}if(n=n.defaultProps){r===i&&(r=y({},r));for(var p in n)r[p]===void 0&&(r[p]=n[p])}return r}function gp(n){Wr(n)}function yp(n){console.error(n)}function bp(n){Wr(n)}function So(n,i){try{var r=n.onUncaughtError;r(i.value,{componentStack:i.stack})}catch(c){setTimeout(function(){throw c})}}function vp(n,i,r){try{var c=n.onCaughtError;c(r.value,{componentStack:r.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function su(n,i,r){return r=gi(r),r.tag=3,r.payload={element:null},r.callback=function(){So(n,i)},r}function Ap(n){return n=gi(n),n.tag=3,n}function Sp(n,i,r,c){var p=r.type.getDerivedStateFromError;if(typeof p=="function"){var g=c.value;n.payload=function(){return p(g)},n.callback=function(){vp(i,r,c)}}var A=r.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(n.callback=function(){vp(i,r,c),typeof p!="function"&&(xi===null?xi=new Set([this]):xi.add(this));var T=c.stack;this.componentDidCatch(c.value,{componentStack:T!==null?T:""})})}function Zb(n,i,r,c,p){if(r.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(i=r.alternate,i!==null&&ks(i,r,p,!0),r=Je.current,r!==null){switch(r.tag){case 31:case 13:return mn===null?Oo():r.alternate===null&&se===0&&(se=3),r.flags&=-257,r.flags|=65536,r.lanes=p,c===oo?r.flags|=16384:(i=r.updateQueue,i===null?r.updateQueue=new Set([c]):i.add(c),Du(n,c,p)),!1;case 22:return r.flags|=65536,c===oo?r.flags|=16384:(i=r.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([c])},r.updateQueue=i):(r=i.retryQueue,r===null?i.retryQueue=new Set([c]):r.add(c)),Du(n,c,p)),!1}throw Error(s(435,r.tag))}return Du(n,c,p),Oo(),!1}if(Dt)return i=Je.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=p,c!==xc&&(n=Error(s(422),{cause:c}),Na(hn(n,r)))):(c!==xc&&(i=Error(s(423),{cause:c}),Na(hn(i,r))),n=n.current.alternate,n.flags|=65536,p&=-p,n.lanes|=p,c=hn(c,r),p=su(n.stateNode,c,p),Lc(n,p),se!==4&&(se=2)),!1;var g=Error(s(520),{cause:c});if(g=hn(g,r),Ka===null?Ka=[g]:Ka.push(g),se!==4&&(se=2),i===null)return!0;c=hn(c,r),r=i;do{switch(r.tag){case 3:return r.flags|=65536,n=p&-p,r.lanes|=n,n=su(r.stateNode,c,n),Lc(r,n),!1;case 1:if(i=r.type,g=r.stateNode,(r.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(xi===null||!xi.has(g))))return r.flags|=65536,p&=-p,r.lanes|=p,p=Ap(p),Sp(p,n,r,c),Lc(r,p),!1}r=r.return}while(r!==null);return!1}var au=Error(s(461)),de=!1;function _e(n,i,r,c){i.child=n===null?Tf(i,null,r,c):Ji(i,n.child,r,c)}function wp(n,i,r,c,p){r=r.render;var g=i.ref;if("ref"in c){var A={};for(var T in c)T!=="ref"&&(A[T]=c[T])}else A=c;return Ki(i),c=Uc(n,i,r,A,g,p),T=Ic(),n!==null&&!de?(Hc(n,i,p),Kn(n,i,p)):(Dt&&T&&Sc(i),i.flags|=1,_e(n,i,c,p),i.child)}function xp(n,i,r,c,p){if(n===null){var g=r.type;return typeof g=="function"&&!bc(g)&&g.defaultProps===void 0&&r.compare===null?(i.tag=15,i.type=g,Ep(n,i,g,c,p)):(n=eo(r.type,null,c,i,i.mode,p),n.ref=i.ref,n.return=i,i.child=n)}if(g=n.child,!fu(n,p)){var A=g.memoizedProps;if(r=r.compare,r=r!==null?r:Ca,r(A,c)&&n.ref===i.ref)return Kn(n,i,p)}return i.flags|=1,n=Gn(g,c),n.ref=i.ref,n.return=i,i.child=n}function Ep(n,i,r,c,p){if(n!==null){var g=n.memoizedProps;if(Ca(g,c)&&n.ref===i.ref)if(de=!1,i.pendingProps=c=g,fu(n,p))(n.flags&131072)!==0&&(de=!0);else return i.lanes=n.lanes,Kn(n,i,p)}return ru(n,i,r,c,p)}function Tp(n,i,r,c){var p=c.children,g=n!==null?n.memoizedState:null;if(n===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((i.flags&128)!==0){if(g=g!==null?g.baseLanes|r:r,n!==null){for(c=i.child=n.child,p=0;c!==null;)p=p|c.lanes|c.childLanes,c=c.sibling;c=p&~g}else c=0,i.child=null;return _p(n,i,g,r,c)}if((r&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},n!==null&&ao(i,g!==null?g.cachePool:null),g!==null?Mf(i,g):Pc(),Df(i);else return c=i.lanes=536870912,_p(n,i,g!==null?g.baseLanes|r:r,r,c)}else g!==null?(ao(i,g.cachePool),Mf(i,g),vi(),i.memoizedState=null):(n!==null&&ao(i,null),Pc(),vi());return _e(n,i,p,r),i.child}function Ha(n,i){return n!==null&&n.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function _p(n,i,r,c,p){var g=Nc();return g=g===null?null:{parent:ue._currentValue,pool:g},i.memoizedState={baseLanes:r,cachePool:g},n!==null&&ao(i,null),Pc(),Df(i),n!==null&&ks(n,i,c,!0),i.childLanes=p,null}function wo(n,i){return i=Eo({mode:i.mode,children:i.children},n.mode),i.ref=n.ref,n.child=i,i.return=n,i}function Cp(n,i,r){return Ji(i,n.child,null,r),n=wo(i,i.pendingProps),n.flags|=2,tn(i),i.memoizedState=null,n}function Jb(n,i,r){var c=i.pendingProps,p=(i.flags&128)!==0;if(i.flags&=-129,n===null){if(Dt){if(c.mode==="hidden")return n=wo(i,c),i.lanes=536870912,Ha(null,n);if(Fc(i),(n=Kt)?(n=zm(n,pn),n=n!==null&&n.data==="&"?n:null,n!==null&&(i.memoizedState={dehydrated:n,treeContext:hi!==null?{id:Mn,overflow:Dn}:null,retryLane:536870912,hydrationErrors:null},r=uf(n),r.return=i,i.child=r,Ee=i,Kt=null)):n=null,n===null)throw fi(i);return i.lanes=536870912,null}return wo(i,c)}var g=n.memoizedState;if(g!==null){var A=g.dehydrated;if(Fc(i),p)if(i.flags&256)i.flags&=-257,i=Cp(n,i,r);else if(i.memoizedState!==null)i.child=n.child,i.flags|=128,i=null;else throw Error(s(558));else if(de||ks(n,i,r,!1),p=(r&n.childLanes)!==0,de||p){if(c=Yt,c!==null&&(A=gd(c,r),A!==0&&A!==g.retryLane))throw g.retryLane=A,qi(n,A),He(c,n,A),au;Oo(),i=Cp(n,i,r)}else n=g.treeContext,Kt=gn(A.nextSibling),Ee=i,Dt=!0,di=null,pn=!1,n!==null&&ff(i,n),i=wo(i,c),i.flags|=4096;return i}return n=Gn(n.child,{mode:c.mode,children:c.children}),n.ref=i.ref,i.child=n,n.return=i,n}function xo(n,i){var r=i.ref;if(r===null)n!==null&&n.ref!==null&&(i.flags|=4194816);else{if(typeof r!="function"&&typeof r!="object")throw Error(s(284));(n===null||n.ref!==r)&&(i.flags|=4194816)}}function ru(n,i,r,c,p){return Ki(i),r=Uc(n,i,r,c,void 0,p),c=Ic(),n!==null&&!de?(Hc(n,i,p),Kn(n,i,p)):(Dt&&c&&Sc(i),i.flags|=1,_e(n,i,r,p),i.child)}function Mp(n,i,r,c,p,g){return Ki(i),i.updateQueue=null,r=Rf(i,c,r,p),Nf(n),c=Ic(),n!==null&&!de?(Hc(n,i,g),Kn(n,i,g)):(Dt&&c&&Sc(i),i.flags|=1,_e(n,i,r,g),i.child)}function Dp(n,i,r,c,p){if(Ki(i),i.stateNode===null){var g=Ms,A=r.contextType;typeof A=="object"&&A!==null&&(g=Te(A)),g=new r(c,g),i.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=iu,i.stateNode=g,g._reactInternals=i,g=i.stateNode,g.props=c,g.state=i.memoizedState,g.refs={},kc(i),A=r.contextType,g.context=typeof A=="object"&&A!==null?Te(A):Ms,g.state=i.memoizedState,A=r.getDerivedStateFromProps,typeof A=="function"&&(nu(i,r,A,c),g.state=i.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(A=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),A!==g.state&&iu.enqueueReplaceState(g,g.state,null),ja(i,c,g,p),Pa(),g.state=i.memoizedState),typeof g.componentDidMount=="function"&&(i.flags|=4194308),c=!0}else if(n===null){g=i.stateNode;var T=i.memoizedProps,D=es(r,T);g.props=D;var z=g.context,q=r.contextType;A=Ms,typeof q=="object"&&q!==null&&(A=Te(q));var Y=r.getDerivedStateFromProps;q=typeof Y=="function"||typeof g.getSnapshotBeforeUpdate=="function",T=i.pendingProps!==T,q||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(T||z!==A)&&mp(i,g,c,A),mi=!1;var U=i.memoizedState;g.state=U,ja(i,c,g,p),Pa(),z=i.memoizedState,T||U!==z||mi?(typeof Y=="function"&&(nu(i,r,Y,c),z=i.memoizedState),(D=mi||pp(i,r,D,c,U,z,A))?(q||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(i.flags|=4194308)):(typeof g.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=c,i.memoizedState=z),g.props=c,g.state=z,g.context=A,c=D):(typeof g.componentDidMount=="function"&&(i.flags|=4194308),c=!1)}else{g=i.stateNode,Oc(n,i),A=i.memoizedProps,q=es(r,A),g.props=q,Y=i.pendingProps,U=g.context,z=r.contextType,D=Ms,typeof z=="object"&&z!==null&&(D=Te(z)),T=r.getDerivedStateFromProps,(z=typeof T=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(A!==Y||U!==D)&&mp(i,g,c,D),mi=!1,U=i.memoizedState,g.state=U,ja(i,c,g,p),Pa();var V=i.memoizedState;A!==Y||U!==V||mi||n!==null&&n.dependencies!==null&&io(n.dependencies)?(typeof T=="function"&&(nu(i,r,T,c),V=i.memoizedState),(q=mi||pp(i,r,q,c,U,V,D)||n!==null&&n.dependencies!==null&&io(n.dependencies))?(z||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(c,V,D),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(c,V,D)),typeof g.componentDidUpdate=="function"&&(i.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof g.componentDidUpdate!="function"||A===n.memoizedProps&&U===n.memoizedState||(i.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||A===n.memoizedProps&&U===n.memoizedState||(i.flags|=1024),i.memoizedProps=c,i.memoizedState=V),g.props=c,g.state=V,g.context=D,c=q):(typeof g.componentDidUpdate!="function"||A===n.memoizedProps&&U===n.memoizedState||(i.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||A===n.memoizedProps&&U===n.memoizedState||(i.flags|=1024),c=!1)}return g=c,xo(n,i),c=(i.flags&128)!==0,g||c?(g=i.stateNode,r=c&&typeof r.getDerivedStateFromError!="function"?null:g.render(),i.flags|=1,n!==null&&c?(i.child=Ji(i,n.child,null,p),i.child=Ji(i,null,r,p)):_e(n,i,r,p),i.memoizedState=g.state,n=i.child):n=Kn(n,i,p),n}function Np(n,i,r,c){return Yi(),i.flags|=256,_e(n,i,r,c),i.child}var ou={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function lu(n){return{baseLanes:n,cachePool:vf()}}function cu(n,i,r){return n=n!==null?n.childLanes&~r:0,i&&(n|=nn),n}function Rp(n,i,r){var c=i.pendingProps,p=!1,g=(i.flags&128)!==0,A;if((A=g)||(A=n!==null&&n.memoizedState===null?!1:(oe.current&2)!==0),A&&(p=!0,i.flags&=-129),A=(i.flags&32)!==0,i.flags&=-33,n===null){if(Dt){if(p?bi(i):vi(),(n=Kt)?(n=zm(n,pn),n=n!==null&&n.data!=="&"?n:null,n!==null&&(i.memoizedState={dehydrated:n,treeContext:hi!==null?{id:Mn,overflow:Dn}:null,retryLane:536870912,hydrationErrors:null},r=uf(n),r.return=i,i.child=r,Ee=i,Kt=null)):n=null,n===null)throw fi(i);return qu(n)?i.lanes=32:i.lanes=536870912,null}var T=c.children;return c=c.fallback,p?(vi(),p=i.mode,T=Eo({mode:"hidden",children:T},p),c=Xi(c,p,r,null),T.return=i,c.return=i,T.sibling=c,i.child=T,c=i.child,c.memoizedState=lu(r),c.childLanes=cu(n,A,r),i.memoizedState=ou,Ha(null,c)):(bi(i),uu(i,T))}var D=n.memoizedState;if(D!==null&&(T=D.dehydrated,T!==null)){if(g)i.flags&256?(bi(i),i.flags&=-257,i=hu(n,i,r)):i.memoizedState!==null?(vi(),i.child=n.child,i.flags|=128,i=null):(vi(),T=c.fallback,p=i.mode,c=Eo({mode:"visible",children:c.children},p),T=Xi(T,p,r,null),T.flags|=2,c.return=i,T.return=i,c.sibling=T,i.child=c,Ji(i,n.child,null,r),c=i.child,c.memoizedState=lu(r),c.childLanes=cu(n,A,r),i.memoizedState=ou,i=Ha(null,c));else if(bi(i),qu(T)){if(A=T.nextSibling&&T.nextSibling.dataset,A)var z=A.dgst;A=z,c=Error(s(419)),c.stack="",c.digest=A,Na({value:c,source:null,stack:null}),i=hu(n,i,r)}else if(de||ks(n,i,r,!1),A=(r&n.childLanes)!==0,de||A){if(A=Yt,A!==null&&(c=gd(A,r),c!==0&&c!==D.retryLane))throw D.retryLane=c,qi(n,c),He(A,n,c),au;Vu(T)||Oo(),i=hu(n,i,r)}else Vu(T)?(i.flags|=192,i.child=n.child,i=null):(n=D.treeContext,Kt=gn(T.nextSibling),Ee=i,Dt=!0,di=null,pn=!1,n!==null&&ff(i,n),i=uu(i,c.children),i.flags|=4096);return i}return p?(vi(),T=c.fallback,p=i.mode,D=n.child,z=D.sibling,c=Gn(D,{mode:"hidden",children:c.children}),c.subtreeFlags=D.subtreeFlags&65011712,z!==null?T=Gn(z,T):(T=Xi(T,p,r,null),T.flags|=2),T.return=i,c.return=i,c.sibling=T,i.child=c,Ha(null,c),c=i.child,T=n.child.memoizedState,T===null?T=lu(r):(p=T.cachePool,p!==null?(D=ue._currentValue,p=p.parent!==D?{parent:D,pool:D}:p):p=vf(),T={baseLanes:T.baseLanes|r,cachePool:p}),c.memoizedState=T,c.childLanes=cu(n,A,r),i.memoizedState=ou,Ha(n.child,c)):(bi(i),r=n.child,n=r.sibling,r=Gn(r,{mode:"visible",children:c.children}),r.return=i,r.sibling=null,n!==null&&(A=i.deletions,A===null?(i.deletions=[n],i.flags|=16):A.push(n)),i.child=r,i.memoizedState=null,r)}function uu(n,i){return i=Eo({mode:"visible",children:i},n.mode),i.return=n,n.child=i}function Eo(n,i){return n=Ze(22,n,null,i),n.lanes=0,n}function hu(n,i,r){return Ji(i,n.child,null,r),n=uu(i,i.pendingProps.children),n.flags|=2,i.memoizedState=null,n}function kp(n,i,r){n.lanes|=i;var c=n.alternate;c!==null&&(c.lanes|=i),_c(n.return,i,r)}function du(n,i,r,c,p,g){var A=n.memoizedState;A===null?n.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:c,tail:r,tailMode:p,treeForkCount:g}:(A.isBackwards=i,A.rendering=null,A.renderingStartTime=0,A.last=c,A.tail=r,A.tailMode=p,A.treeForkCount=g)}function Op(n,i,r){var c=i.pendingProps,p=c.revealOrder,g=c.tail;c=c.children;var A=oe.current,T=(A&2)!==0;if(T?(A=A&1|2,i.flags|=128):A&=1,Q(oe,A),_e(n,i,c,r),c=Dt?Da:0,!T&&n!==null&&(n.flags&128)!==0)t:for(n=i.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&kp(n,r,i);else if(n.tag===19)kp(n,r,i);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break t;for(;n.sibling===null;){if(n.return===null||n.return===i)break t;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(p){case"forwards":for(r=i.child,p=null;r!==null;)n=r.alternate,n!==null&&ho(n)===null&&(p=r),r=r.sibling;r=p,r===null?(p=i.child,i.child=null):(p=r.sibling,r.sibling=null),du(i,!1,p,r,g,c);break;case"backwards":case"unstable_legacy-backwards":for(r=null,p=i.child,i.child=null;p!==null;){if(n=p.alternate,n!==null&&ho(n)===null){i.child=p;break}n=p.sibling,p.sibling=r,r=p,p=n}du(i,!0,r,null,g,c);break;case"together":du(i,!1,null,null,void 0,c);break;default:i.memoizedState=null}return i.child}function Kn(n,i,r){if(n!==null&&(i.dependencies=n.dependencies),wi|=i.lanes,(r&i.childLanes)===0)if(n!==null){if(ks(n,i,r,!1),(r&i.childLanes)===0)return null}else return null;if(n!==null&&i.child!==n.child)throw Error(s(153));if(i.child!==null){for(n=i.child,r=Gn(n,n.pendingProps),i.child=r,r.return=i;n.sibling!==null;)n=n.sibling,r=r.sibling=Gn(n,n.pendingProps),r.return=i;r.sibling=null}return i.child}function fu(n,i){return(n.lanes&i)!==0?!0:(n=n.dependencies,!!(n!==null&&io(n)))}function tv(n,i,r){switch(i.tag){case 3:re(i,i.stateNode.containerInfo),pi(i,ue,n.memoizedState.cache),Yi();break;case 27:case 5:Fi(i);break;case 4:re(i,i.stateNode.containerInfo);break;case 10:pi(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,Fc(i),null;break;case 13:var c=i.memoizedState;if(c!==null)return c.dehydrated!==null?(bi(i),i.flags|=128,null):(r&i.child.childLanes)!==0?Rp(n,i,r):(bi(i),n=Kn(n,i,r),n!==null?n.sibling:null);bi(i);break;case 19:var p=(n.flags&128)!==0;if(c=(r&i.childLanes)!==0,c||(ks(n,i,r,!1),c=(r&i.childLanes)!==0),p){if(c)return Op(n,i,r);i.flags|=128}if(p=i.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),Q(oe,oe.current),c)break;return null;case 22:return i.lanes=0,Tp(n,i,r,i.pendingProps);case 24:pi(i,ue,n.memoizedState.cache)}return Kn(n,i,r)}function Lp(n,i,r){if(n!==null)if(n.memoizedProps!==i.pendingProps)de=!0;else{if(!fu(n,r)&&(i.flags&128)===0)return de=!1,tv(n,i,r);de=(n.flags&131072)!==0}else de=!1,Dt&&(i.flags&1048576)!==0&&df(i,Da,i.index);switch(i.lanes=0,i.tag){case 16:t:{var c=i.pendingProps;if(n=Wi(i.elementType),i.type=n,typeof n=="function")bc(n)?(c=es(n,c),i.tag=1,i=Dp(null,i,n,c,r)):(i.tag=0,i=ru(null,i,n,c,r));else{if(n!=null){var p=n.$$typeof;if(p===R){i.tag=11,i=wp(null,i,n,c,r);break t}else if(p===P){i.tag=14,i=xp(null,i,n,c,r);break t}}throw i=ot(n)||n,Error(s(306,i,""))}}return i;case 0:return ru(n,i,i.type,i.pendingProps,r);case 1:return c=i.type,p=es(c,i.pendingProps),Dp(n,i,c,p,r);case 3:t:{if(re(i,i.stateNode.containerInfo),n===null)throw Error(s(387));c=i.pendingProps;var g=i.memoizedState;p=g.element,Oc(n,i),ja(i,c,null,r);var A=i.memoizedState;if(c=A.cache,pi(i,ue,c),c!==g.cache&&Cc(i,[ue],r,!0),Pa(),c=A.element,g.isDehydrated)if(g={element:c,isDehydrated:!1,cache:A.cache},i.updateQueue.baseState=g,i.memoizedState=g,i.flags&256){i=Np(n,i,c,r);break t}else if(c!==p){p=hn(Error(s(424)),i),Na(p),i=Np(n,i,c,r);break t}else for(n=i.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,Kt=gn(n.firstChild),Ee=i,Dt=!0,di=null,pn=!0,r=Tf(i,null,c,r),i.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Yi(),c===p){i=Kn(n,i,r);break t}_e(n,i,c,r)}i=i.child}return i;case 26:return xo(n,i),n===null?(r=qm(i.type,null,i.pendingProps,null))?i.memoizedState=r:Dt||(r=i.type,n=i.pendingProps,c=Uo(gt.current).createElement(r),c[xe]=i,c[Pe]=n,Ce(c,r,n),ve(c),i.stateNode=c):i.memoizedState=qm(i.type,n.memoizedProps,i.pendingProps,n.memoizedState),null;case 27:return Fi(i),n===null&&Dt&&(c=i.stateNode=Hm(i.type,i.pendingProps,gt.current),Ee=i,pn=!0,p=Kt,Ci(i.type)?(Xu=p,Kt=gn(c.firstChild)):Kt=p),_e(n,i,i.pendingProps.children,r),xo(n,i),n===null&&(i.flags|=4194304),i.child;case 5:return n===null&&Dt&&((p=c=Kt)&&(c=Nv(c,i.type,i.pendingProps,pn),c!==null?(i.stateNode=c,Ee=i,Kt=gn(c.firstChild),pn=!1,p=!0):p=!1),p||fi(i)),Fi(i),p=i.type,g=i.pendingProps,A=n!==null?n.memoizedProps:null,c=g.children,Iu(p,g)?c=null:A!==null&&Iu(p,A)&&(i.flags|=32),i.memoizedState!==null&&(p=Uc(n,i,qb,null,null,r),ir._currentValue=p),xo(n,i),_e(n,i,c,r),i.child;case 6:return n===null&&Dt&&((n=r=Kt)&&(r=Rv(r,i.pendingProps,pn),r!==null?(i.stateNode=r,Ee=i,Kt=null,n=!0):n=!1),n||fi(i)),null;case 13:return Rp(n,i,r);case 4:return re(i,i.stateNode.containerInfo),c=i.pendingProps,n===null?i.child=Ji(i,null,c,r):_e(n,i,c,r),i.child;case 11:return wp(n,i,i.type,i.pendingProps,r);case 7:return _e(n,i,i.pendingProps,r),i.child;case 8:return _e(n,i,i.pendingProps.children,r),i.child;case 12:return _e(n,i,i.pendingProps.children,r),i.child;case 10:return c=i.pendingProps,pi(i,i.type,c.value),_e(n,i,c.children,r),i.child;case 9:return p=i.type._context,c=i.pendingProps.children,Ki(i),p=Te(p),c=c(p),i.flags|=1,_e(n,i,c,r),i.child;case 14:return xp(n,i,i.type,i.pendingProps,r);case 15:return Ep(n,i,i.type,i.pendingProps,r);case 19:return Op(n,i,r);case 31:return Jb(n,i,r);case 22:return Tp(n,i,r,i.pendingProps);case 24:return Ki(i),c=Te(ue),n===null?(p=Nc(),p===null&&(p=Yt,g=Mc(),p.pooledCache=g,g.refCount++,g!==null&&(p.pooledCacheLanes|=r),p=g),i.memoizedState={parent:c,cache:p},kc(i),pi(i,ue,p)):((n.lanes&r)!==0&&(Oc(n,i),ja(i,null,null,r),Pa()),p=n.memoizedState,g=i.memoizedState,p.parent!==c?(p={parent:c,cache:c},i.memoizedState=p,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=p),pi(i,ue,c)):(c=g.cache,pi(i,ue,c),c!==p.cache&&Cc(i,[ue],r,!0))),_e(n,i,i.pendingProps.children,r),i.child;case 29:throw i.pendingProps}throw Error(s(156,i.tag))}function Qn(n){n.flags|=4}function pu(n,i,r,c,p){if((i=(n.mode&32)!==0)&&(i=!1),i){if(n.flags|=16777216,(p&335544128)===p)if(n.stateNode.complete)n.flags|=8192;else if(om())n.flags|=8192;else throw Zi=oo,Rc}else n.flags&=-16777217}function Bp(n,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!Qm(i))if(om())n.flags|=8192;else throw Zi=oo,Rc}function To(n,i){i!==null&&(n.flags|=4),n.flags&16384&&(i=n.tag!==22?fd():536870912,n.lanes|=i,Vs|=i)}function Ga(n,i){if(!Dt)switch(n.tailMode){case"hidden":i=n.tail;for(var r=null;i!==null;)i.alternate!==null&&(r=i),i=i.sibling;r===null?n.tail=null:r.sibling=null;break;case"collapsed":r=n.tail;for(var c=null;r!==null;)r.alternate!==null&&(c=r),r=r.sibling;c===null?i||n.tail===null?n.tail=null:n.tail.sibling=null:c.sibling=null}}function Qt(n){var i=n.alternate!==null&&n.alternate.child===n.child,r=0,c=0;if(i)for(var p=n.child;p!==null;)r|=p.lanes|p.childLanes,c|=p.subtreeFlags&65011712,c|=p.flags&65011712,p.return=n,p=p.sibling;else for(p=n.child;p!==null;)r|=p.lanes|p.childLanes,c|=p.subtreeFlags,c|=p.flags,p.return=n,p=p.sibling;return n.subtreeFlags|=c,n.childLanes=r,i}function ev(n,i,r){var c=i.pendingProps;switch(wc(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qt(i),null;case 1:return Qt(i),null;case 3:return r=i.stateNode,c=null,n!==null&&(c=n.memoizedState.cache),i.memoizedState.cache!==c&&(i.flags|=2048),Xn(ue),Xt(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(Rs(i)?Qn(i):n===null||n.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Ec())),Qt(i),null;case 26:var p=i.type,g=i.memoizedState;return n===null?(Qn(i),g!==null?(Qt(i),Bp(i,g)):(Qt(i),pu(i,p,null,c,r))):g?g!==n.memoizedState?(Qn(i),Qt(i),Bp(i,g)):(Qt(i),i.flags&=-16777217):(n=n.memoizedProps,n!==c&&Qn(i),Qt(i),pu(i,p,n,c,r)),null;case 27:if(oi(i),r=gt.current,p=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==c&&Qn(i);else{if(!c){if(i.stateNode===null)throw Error(s(166));return Qt(i),null}n=tt.current,Rs(i)?pf(i):(n=Hm(p,c,r),i.stateNode=n,Qn(i))}return Qt(i),null;case 5:if(oi(i),p=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==c&&Qn(i);else{if(!c){if(i.stateNode===null)throw Error(s(166));return Qt(i),null}if(g=tt.current,Rs(i))pf(i);else{var A=Uo(gt.current);switch(g){case 1:g=A.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:g=A.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":g=A.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":g=A.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":g=A.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof c.is=="string"?A.createElement("select",{is:c.is}):A.createElement("select"),c.multiple?g.multiple=!0:c.size&&(g.size=c.size);break;default:g=typeof c.is=="string"?A.createElement(p,{is:c.is}):A.createElement(p)}}g[xe]=i,g[Pe]=c;t:for(A=i.child;A!==null;){if(A.tag===5||A.tag===6)g.appendChild(A.stateNode);else if(A.tag!==4&&A.tag!==27&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===i)break t;for(;A.sibling===null;){if(A.return===null||A.return===i)break t;A=A.return}A.sibling.return=A.return,A=A.sibling}i.stateNode=g;t:switch(Ce(g,p,c),p){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break t;case"img":c=!0;break t;default:c=!1}c&&Qn(i)}}return Qt(i),pu(i,i.type,n===null?null:n.memoizedProps,i.pendingProps,r),null;case 6:if(n&&i.stateNode!=null)n.memoizedProps!==c&&Qn(i);else{if(typeof c!="string"&&i.stateNode===null)throw Error(s(166));if(n=gt.current,Rs(i)){if(n=i.stateNode,r=i.memoizedProps,c=null,p=Ee,p!==null)switch(p.tag){case 27:case 5:c=p.memoizedProps}n[xe]=i,n=!!(n.nodeValue===r||c!==null&&c.suppressHydrationWarning===!0||Rm(n.nodeValue,r)),n||fi(i,!0)}else n=Uo(n).createTextNode(c),n[xe]=i,i.stateNode=n}return Qt(i),null;case 31:if(r=i.memoizedState,n===null||n.memoizedState!==null){if(c=Rs(i),r!==null){if(n===null){if(!c)throw Error(s(318));if(n=i.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(s(557));n[xe]=i}else Yi(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Qt(i),n=!1}else r=Ec(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=r),n=!0;if(!n)return i.flags&256?(tn(i),i):(tn(i),null);if((i.flags&128)!==0)throw Error(s(558))}return Qt(i),null;case 13:if(c=i.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(p=Rs(i),c!==null&&c.dehydrated!==null){if(n===null){if(!p)throw Error(s(318));if(p=i.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(s(317));p[xe]=i}else Yi(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Qt(i),p=!1}else p=Ec(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=p),p=!0;if(!p)return i.flags&256?(tn(i),i):(tn(i),null)}return tn(i),(i.flags&128)!==0?(i.lanes=r,i):(r=c!==null,n=n!==null&&n.memoizedState!==null,r&&(c=i.child,p=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(p=c.alternate.memoizedState.cachePool.pool),g=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(g=c.memoizedState.cachePool.pool),g!==p&&(c.flags|=2048)),r!==n&&r&&(i.child.flags|=8192),To(i,i.updateQueue),Qt(i),null);case 4:return Xt(),n===null&&Pu(i.stateNode.containerInfo),Qt(i),null;case 10:return Xn(i.type),Qt(i),null;case 19:if(I(oe),c=i.memoizedState,c===null)return Qt(i),null;if(p=(i.flags&128)!==0,g=c.rendering,g===null)if(p)Ga(c,!1);else{if(se!==0||n!==null&&(n.flags&128)!==0)for(n=i.child;n!==null;){if(g=ho(n),g!==null){for(i.flags|=128,Ga(c,!1),n=g.updateQueue,i.updateQueue=n,To(i,n),i.subtreeFlags=0,n=r,r=i.child;r!==null;)cf(r,n),r=r.sibling;return Q(oe,oe.current&1|2),Dt&&Vn(i,c.treeForkCount),i.child}n=n.sibling}c.tail!==null&&$e()>No&&(i.flags|=128,p=!0,Ga(c,!1),i.lanes=4194304)}else{if(!p)if(n=ho(g),n!==null){if(i.flags|=128,p=!0,n=n.updateQueue,i.updateQueue=n,To(i,n),Ga(c,!0),c.tail===null&&c.tailMode==="hidden"&&!g.alternate&&!Dt)return Qt(i),null}else 2*$e()-c.renderingStartTime>No&&r!==536870912&&(i.flags|=128,p=!0,Ga(c,!1),i.lanes=4194304);c.isBackwards?(g.sibling=i.child,i.child=g):(n=c.last,n!==null?n.sibling=g:i.child=g,c.last=g)}return c.tail!==null?(n=c.tail,c.rendering=n,c.tail=n.sibling,c.renderingStartTime=$e(),n.sibling=null,r=oe.current,Q(oe,p?r&1|2:r&1),Dt&&Vn(i,c.treeForkCount),n):(Qt(i),null);case 22:case 23:return tn(i),jc(),c=i.memoizedState!==null,n!==null?n.memoizedState!==null!==c&&(i.flags|=8192):c&&(i.flags|=8192),c?(r&536870912)!==0&&(i.flags&128)===0&&(Qt(i),i.subtreeFlags&6&&(i.flags|=8192)):Qt(i),r=i.updateQueue,r!==null&&To(i,r.retryQueue),r=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(r=n.memoizedState.cachePool.pool),c=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),c!==r&&(i.flags|=2048),n!==null&&I(Qi),null;case 24:return r=null,n!==null&&(r=n.memoizedState.cache),i.memoizedState.cache!==r&&(i.flags|=2048),Xn(ue),Qt(i),null;case 25:return null;case 30:return null}throw Error(s(156,i.tag))}function nv(n,i){switch(wc(i),i.tag){case 1:return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 3:return Xn(ue),Xt(),n=i.flags,(n&65536)!==0&&(n&128)===0?(i.flags=n&-65537|128,i):null;case 26:case 27:case 5:return oi(i),null;case 31:if(i.memoizedState!==null){if(tn(i),i.alternate===null)throw Error(s(340));Yi()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 13:if(tn(i),n=i.memoizedState,n!==null&&n.dehydrated!==null){if(i.alternate===null)throw Error(s(340));Yi()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 19:return I(oe),null;case 4:return Xt(),null;case 10:return Xn(i.type),null;case 22:case 23:return tn(i),jc(),n!==null&&I(Qi),n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 24:return Xn(ue),null;case 25:return null;default:return null}}function Pp(n,i){switch(wc(i),i.tag){case 3:Xn(ue),Xt();break;case 26:case 27:case 5:oi(i);break;case 4:Xt();break;case 31:i.memoizedState!==null&&tn(i);break;case 13:tn(i);break;case 19:I(oe);break;case 10:Xn(i.type);break;case 22:case 23:tn(i),jc(),n!==null&&I(Qi);break;case 24:Xn(ue)}}function Va(n,i){try{var r=i.updateQueue,c=r!==null?r.lastEffect:null;if(c!==null){var p=c.next;r=p;do{if((r.tag&n)===n){c=void 0;var g=r.create,A=r.inst;c=g(),A.destroy=c}r=r.next}while(r!==p)}}catch(T){It(i,i.return,T)}}function Ai(n,i,r){try{var c=i.updateQueue,p=c!==null?c.lastEffect:null;if(p!==null){var g=p.next;c=g;do{if((c.tag&n)===n){var A=c.inst,T=A.destroy;if(T!==void 0){A.destroy=void 0,p=i;var D=r,z=T;try{z()}catch(q){It(p,D,q)}}}c=c.next}while(c!==g)}}catch(q){It(i,i.return,q)}}function jp(n){var i=n.updateQueue;if(i!==null){var r=n.stateNode;try{Cf(i,r)}catch(c){It(n,n.return,c)}}}function Fp(n,i,r){r.props=es(n.type,n.memoizedProps),r.state=n.memoizedState;try{r.componentWillUnmount()}catch(c){It(n,i,c)}}function qa(n,i){try{var r=n.ref;if(r!==null){switch(n.tag){case 26:case 27:case 5:var c=n.stateNode;break;case 30:c=n.stateNode;break;default:c=n.stateNode}typeof r=="function"?n.refCleanup=r(c):r.current=c}}catch(p){It(n,i,p)}}function Nn(n,i){var r=n.ref,c=n.refCleanup;if(r!==null)if(typeof c=="function")try{c()}catch(p){It(n,i,p)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof r=="function")try{r(null)}catch(p){It(n,i,p)}else r.current=null}function zp(n){var i=n.type,r=n.memoizedProps,c=n.stateNode;try{t:switch(i){case"button":case"input":case"select":case"textarea":r.autoFocus&&c.focus();break t;case"img":r.src?c.src=r.src:r.srcSet&&(c.srcset=r.srcSet)}}catch(p){It(n,n.return,p)}}function mu(n,i,r){try{var c=n.stateNode;Ev(c,n.type,r,i),c[Pe]=i}catch(p){It(n,n.return,p)}}function Up(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Ci(n.type)||n.tag===4}function gu(n){t:for(;;){for(;n.sibling===null;){if(n.return===null||Up(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Ci(n.type)||n.flags&2||n.child===null||n.tag===4)continue t;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function yu(n,i,r){var c=n.tag;if(c===5||c===6)n=n.stateNode,i?(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r).insertBefore(n,i):(i=r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,i.appendChild(n),r=r._reactRootContainer,r!=null||i.onclick!==null||(i.onclick=In));else if(c!==4&&(c===27&&Ci(n.type)&&(r=n.stateNode,i=null),n=n.child,n!==null))for(yu(n,i,r),n=n.sibling;n!==null;)yu(n,i,r),n=n.sibling}function _o(n,i,r){var c=n.tag;if(c===5||c===6)n=n.stateNode,i?r.insertBefore(n,i):r.appendChild(n);else if(c!==4&&(c===27&&Ci(n.type)&&(r=n.stateNode),n=n.child,n!==null))for(_o(n,i,r),n=n.sibling;n!==null;)_o(n,i,r),n=n.sibling}function Ip(n){var i=n.stateNode,r=n.memoizedProps;try{for(var c=n.type,p=i.attributes;p.length;)i.removeAttributeNode(p[0]);Ce(i,c,r),i[xe]=n,i[Pe]=r}catch(g){It(n,n.return,g)}}var Wn=!1,fe=!1,bu=!1,Hp=typeof WeakSet=="function"?WeakSet:Set,Ae=null;function iv(n,i){if(n=n.containerInfo,zu=Yo,n=Jd(n),hc(n)){if("selectionStart"in n)var r={start:n.selectionStart,end:n.selectionEnd};else t:{r=(r=n.ownerDocument)&&r.defaultView||window;var c=r.getSelection&&r.getSelection();if(c&&c.rangeCount!==0){r=c.anchorNode;var p=c.anchorOffset,g=c.focusNode;c=c.focusOffset;try{r.nodeType,g.nodeType}catch{r=null;break t}var A=0,T=-1,D=-1,z=0,q=0,Y=n,U=null;e:for(;;){for(var V;Y!==r||p!==0&&Y.nodeType!==3||(T=A+p),Y!==g||c!==0&&Y.nodeType!==3||(D=A+c),Y.nodeType===3&&(A+=Y.nodeValue.length),(V=Y.firstChild)!==null;)U=Y,Y=V;for(;;){if(Y===n)break e;if(U===r&&++z===p&&(T=A),U===g&&++q===c&&(D=A),(V=Y.nextSibling)!==null)break;Y=U,U=Y.parentNode}Y=V}r=T===-1||D===-1?null:{start:T,end:D}}else r=null}r=r||{start:0,end:0}}else r=null;for(Uu={focusedElem:n,selectionRange:r},Yo=!1,Ae=i;Ae!==null;)if(i=Ae,n=i.child,(i.subtreeFlags&1028)!==0&&n!==null)n.return=i,Ae=n;else for(;Ae!==null;){switch(i=Ae,g=i.alternate,n=i.flags,i.tag){case 0:if((n&4)!==0&&(n=i.updateQueue,n=n!==null?n.events:null,n!==null))for(r=0;r<n.length;r++)p=n[r],p.ref.impl=p.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&g!==null){n=void 0,r=i,p=g.memoizedProps,g=g.memoizedState,c=r.stateNode;try{var at=es(r.type,p);n=c.getSnapshotBeforeUpdate(at,g),c.__reactInternalSnapshotBeforeUpdate=n}catch(ft){It(r,r.return,ft)}}break;case 3:if((n&1024)!==0){if(n=i.stateNode.containerInfo,r=n.nodeType,r===9)Gu(n);else if(r===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":Gu(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(s(163))}if(n=i.sibling,n!==null){n.return=i.return,Ae=n;break}Ae=i.return}}function Gp(n,i,r){var c=r.flags;switch(r.tag){case 0:case 11:case 15:Jn(n,r),c&4&&Va(5,r);break;case 1:if(Jn(n,r),c&4)if(n=r.stateNode,i===null)try{n.componentDidMount()}catch(A){It(r,r.return,A)}else{var p=es(r.type,i.memoizedProps);i=i.memoizedState;try{n.componentDidUpdate(p,i,n.__reactInternalSnapshotBeforeUpdate)}catch(A){It(r,r.return,A)}}c&64&&jp(r),c&512&&qa(r,r.return);break;case 3:if(Jn(n,r),c&64&&(n=r.updateQueue,n!==null)){if(i=null,r.child!==null)switch(r.child.tag){case 27:case 5:i=r.child.stateNode;break;case 1:i=r.child.stateNode}try{Cf(n,i)}catch(A){It(r,r.return,A)}}break;case 27:i===null&&c&4&&Ip(r);case 26:case 5:Jn(n,r),i===null&&c&4&&zp(r),c&512&&qa(r,r.return);break;case 12:Jn(n,r);break;case 31:Jn(n,r),c&4&&Xp(n,r);break;case 13:Jn(n,r),c&4&&Yp(n,r),c&64&&(n=r.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(r=dv.bind(null,r),kv(n,r))));break;case 22:if(c=r.memoizedState!==null||Wn,!c){i=i!==null&&i.memoizedState!==null||fe,p=Wn;var g=fe;Wn=c,(fe=i)&&!g?ti(n,r,(r.subtreeFlags&8772)!==0):Jn(n,r),Wn=p,fe=g}break;case 30:break;default:Jn(n,r)}}function Vp(n){var i=n.alternate;i!==null&&(n.alternate=null,Vp(i)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(i=n.stateNode,i!==null&&$l(i)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var Wt=null,Fe=!1;function Zn(n,i,r){for(r=r.child;r!==null;)qp(n,i,r),r=r.sibling}function qp(n,i,r){if(Ke&&typeof Ke.onCommitFiberUnmount=="function")try{Ke.onCommitFiberUnmount(ma,r)}catch{}switch(r.tag){case 26:fe||Nn(r,i),Zn(n,i,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode,r.parentNode.removeChild(r));break;case 27:fe||Nn(r,i);var c=Wt,p=Fe;Ci(r.type)&&(Wt=r.stateNode,Fe=!1),Zn(n,i,r),tr(r.stateNode),Wt=c,Fe=p;break;case 5:fe||Nn(r,i);case 6:if(c=Wt,p=Fe,Wt=null,Zn(n,i,r),Wt=c,Fe=p,Wt!==null)if(Fe)try{(Wt.nodeType===9?Wt.body:Wt.nodeName==="HTML"?Wt.ownerDocument.body:Wt).removeChild(r.stateNode)}catch(g){It(r,i,g)}else try{Wt.removeChild(r.stateNode)}catch(g){It(r,i,g)}break;case 18:Wt!==null&&(Fe?(n=Wt,jm(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,r.stateNode),Zs(n)):jm(Wt,r.stateNode));break;case 4:c=Wt,p=Fe,Wt=r.stateNode.containerInfo,Fe=!0,Zn(n,i,r),Wt=c,Fe=p;break;case 0:case 11:case 14:case 15:Ai(2,r,i),fe||Ai(4,r,i),Zn(n,i,r);break;case 1:fe||(Nn(r,i),c=r.stateNode,typeof c.componentWillUnmount=="function"&&Fp(r,i,c)),Zn(n,i,r);break;case 21:Zn(n,i,r);break;case 22:fe=(c=fe)||r.memoizedState!==null,Zn(n,i,r),fe=c;break;default:Zn(n,i,r)}}function Xp(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{Zs(n)}catch(r){It(i,i.return,r)}}}function Yp(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Zs(n)}catch(r){It(i,i.return,r)}}function sv(n){switch(n.tag){case 31:case 13:case 19:var i=n.stateNode;return i===null&&(i=n.stateNode=new Hp),i;case 22:return n=n.stateNode,i=n._retryCache,i===null&&(i=n._retryCache=new Hp),i;default:throw Error(s(435,n.tag))}}function Co(n,i){var r=sv(n);i.forEach(function(c){if(!r.has(c)){r.add(c);var p=fv.bind(null,n,c);c.then(p,p)}})}function ze(n,i){var r=i.deletions;if(r!==null)for(var c=0;c<r.length;c++){var p=r[c],g=n,A=i,T=A;t:for(;T!==null;){switch(T.tag){case 27:if(Ci(T.type)){Wt=T.stateNode,Fe=!1;break t}break;case 5:Wt=T.stateNode,Fe=!1;break t;case 3:case 4:Wt=T.stateNode.containerInfo,Fe=!0;break t}T=T.return}if(Wt===null)throw Error(s(160));qp(g,A,p),Wt=null,Fe=!1,g=p.alternate,g!==null&&(g.return=null),p.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)$p(i,n),i=i.sibling}var En=null;function $p(n,i){var r=n.alternate,c=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:ze(i,n),Ue(n),c&4&&(Ai(3,n,n.return),Va(3,n),Ai(5,n,n.return));break;case 1:ze(i,n),Ue(n),c&512&&(fe||r===null||Nn(r,r.return)),c&64&&Wn&&(n=n.updateQueue,n!==null&&(c=n.callbacks,c!==null&&(r=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=r===null?c:r.concat(c))));break;case 26:var p=En;if(ze(i,n),Ue(n),c&512&&(fe||r===null||Nn(r,r.return)),c&4){var g=r!==null?r.memoizedState:null;if(c=n.memoizedState,r===null)if(c===null)if(n.stateNode===null){t:{c=n.type,r=n.memoizedProps,p=p.ownerDocument||p;e:switch(c){case"title":g=p.getElementsByTagName("title")[0],(!g||g[ba]||g[xe]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=p.createElement(c),p.head.insertBefore(g,p.querySelector("head > title"))),Ce(g,c,r),g[xe]=n,ve(g),c=g;break t;case"link":var A=$m("link","href",p).get(c+(r.href||""));if(A){for(var T=0;T<A.length;T++)if(g=A[T],g.getAttribute("href")===(r.href==null||r.href===""?null:r.href)&&g.getAttribute("rel")===(r.rel==null?null:r.rel)&&g.getAttribute("title")===(r.title==null?null:r.title)&&g.getAttribute("crossorigin")===(r.crossOrigin==null?null:r.crossOrigin)){A.splice(T,1);break e}}g=p.createElement(c),Ce(g,c,r),p.head.appendChild(g);break;case"meta":if(A=$m("meta","content",p).get(c+(r.content||""))){for(T=0;T<A.length;T++)if(g=A[T],g.getAttribute("content")===(r.content==null?null:""+r.content)&&g.getAttribute("name")===(r.name==null?null:r.name)&&g.getAttribute("property")===(r.property==null?null:r.property)&&g.getAttribute("http-equiv")===(r.httpEquiv==null?null:r.httpEquiv)&&g.getAttribute("charset")===(r.charSet==null?null:r.charSet)){A.splice(T,1);break e}}g=p.createElement(c),Ce(g,c,r),p.head.appendChild(g);break;default:throw Error(s(468,c))}g[xe]=n,ve(g),c=g}n.stateNode=c}else Km(p,n.type,n.stateNode);else n.stateNode=Ym(p,c,n.memoizedProps);else g!==c?(g===null?r.stateNode!==null&&(r=r.stateNode,r.parentNode.removeChild(r)):g.count--,c===null?Km(p,n.type,n.stateNode):Ym(p,c,n.memoizedProps)):c===null&&n.stateNode!==null&&mu(n,n.memoizedProps,r.memoizedProps)}break;case 27:ze(i,n),Ue(n),c&512&&(fe||r===null||Nn(r,r.return)),r!==null&&c&4&&mu(n,n.memoizedProps,r.memoizedProps);break;case 5:if(ze(i,n),Ue(n),c&512&&(fe||r===null||Nn(r,r.return)),n.flags&32){p=n.stateNode;try{Ss(p,"")}catch(at){It(n,n.return,at)}}c&4&&n.stateNode!=null&&(p=n.memoizedProps,mu(n,p,r!==null?r.memoizedProps:p)),c&1024&&(bu=!0);break;case 6:if(ze(i,n),Ue(n),c&4){if(n.stateNode===null)throw Error(s(162));c=n.memoizedProps,r=n.stateNode;try{r.nodeValue=c}catch(at){It(n,n.return,at)}}break;case 3:if(Go=null,p=En,En=Io(i.containerInfo),ze(i,n),En=p,Ue(n),c&4&&r!==null&&r.memoizedState.isDehydrated)try{Zs(i.containerInfo)}catch(at){It(n,n.return,at)}bu&&(bu=!1,Kp(n));break;case 4:c=En,En=Io(n.stateNode.containerInfo),ze(i,n),Ue(n),En=c;break;case 12:ze(i,n),Ue(n);break;case 31:ze(i,n),Ue(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Co(n,c)));break;case 13:ze(i,n),Ue(n),n.child.flags&8192&&n.memoizedState!==null!=(r!==null&&r.memoizedState!==null)&&(Do=$e()),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Co(n,c)));break;case 22:p=n.memoizedState!==null;var D=r!==null&&r.memoizedState!==null,z=Wn,q=fe;if(Wn=z||p,fe=q||D,ze(i,n),fe=q,Wn=z,Ue(n),c&8192)t:for(i=n.stateNode,i._visibility=p?i._visibility&-2:i._visibility|1,p&&(r===null||D||Wn||fe||ns(n)),r=null,i=n;;){if(i.tag===5||i.tag===26){if(r===null){D=r=i;try{if(g=D.stateNode,p)A=g.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{T=D.stateNode;var Y=D.memoizedProps.style,U=Y!=null&&Y.hasOwnProperty("display")?Y.display:null;T.style.display=U==null||typeof U=="boolean"?"":(""+U).trim()}}catch(at){It(D,D.return,at)}}}else if(i.tag===6){if(r===null){D=i;try{D.stateNode.nodeValue=p?"":D.memoizedProps}catch(at){It(D,D.return,at)}}}else if(i.tag===18){if(r===null){D=i;try{var V=D.stateNode;p?Fm(V,!0):Fm(D.stateNode,!1)}catch(at){It(D,D.return,at)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===n)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break t;for(;i.sibling===null;){if(i.return===null||i.return===n)break t;r===i&&(r=null),i=i.return}r===i&&(r=null),i.sibling.return=i.return,i=i.sibling}c&4&&(c=n.updateQueue,c!==null&&(r=c.retryQueue,r!==null&&(c.retryQueue=null,Co(n,r))));break;case 19:ze(i,n),Ue(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Co(n,c)));break;case 30:break;case 21:break;default:ze(i,n),Ue(n)}}function Ue(n){var i=n.flags;if(i&2){try{for(var r,c=n.return;c!==null;){if(Up(c)){r=c;break}c=c.return}if(r==null)throw Error(s(160));switch(r.tag){case 27:var p=r.stateNode,g=gu(n);_o(n,g,p);break;case 5:var A=r.stateNode;r.flags&32&&(Ss(A,""),r.flags&=-33);var T=gu(n);_o(n,T,A);break;case 3:case 4:var D=r.stateNode.containerInfo,z=gu(n);yu(n,z,D);break;default:throw Error(s(161))}}catch(q){It(n,n.return,q)}n.flags&=-3}i&4096&&(n.flags&=-4097)}function Kp(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var i=n;Kp(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),n=n.sibling}}function Jn(n,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)Gp(n,i.alternate,i),i=i.sibling}function ns(n){for(n=n.child;n!==null;){var i=n;switch(i.tag){case 0:case 11:case 14:case 15:Ai(4,i,i.return),ns(i);break;case 1:Nn(i,i.return);var r=i.stateNode;typeof r.componentWillUnmount=="function"&&Fp(i,i.return,r),ns(i);break;case 27:tr(i.stateNode);case 26:case 5:Nn(i,i.return),ns(i);break;case 22:i.memoizedState===null&&ns(i);break;case 30:ns(i);break;default:ns(i)}n=n.sibling}}function ti(n,i,r){for(r=r&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var c=i.alternate,p=n,g=i,A=g.flags;switch(g.tag){case 0:case 11:case 15:ti(p,g,r),Va(4,g);break;case 1:if(ti(p,g,r),c=g,p=c.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(z){It(c,c.return,z)}if(c=g,p=c.updateQueue,p!==null){var T=c.stateNode;try{var D=p.shared.hiddenCallbacks;if(D!==null)for(p.shared.hiddenCallbacks=null,p=0;p<D.length;p++)_f(D[p],T)}catch(z){It(c,c.return,z)}}r&&A&64&&jp(g),qa(g,g.return);break;case 27:Ip(g);case 26:case 5:ti(p,g,r),r&&c===null&&A&4&&zp(g),qa(g,g.return);break;case 12:ti(p,g,r);break;case 31:ti(p,g,r),r&&A&4&&Xp(p,g);break;case 13:ti(p,g,r),r&&A&4&&Yp(p,g);break;case 22:g.memoizedState===null&&ti(p,g,r),qa(g,g.return);break;case 30:break;default:ti(p,g,r)}i=i.sibling}}function vu(n,i){var r=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(r=n.memoizedState.cachePool.pool),n=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(n=i.memoizedState.cachePool.pool),n!==r&&(n!=null&&n.refCount++,r!=null&&Ra(r))}function Au(n,i){n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&Ra(n))}function Tn(n,i,r,c){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Qp(n,i,r,c),i=i.sibling}function Qp(n,i,r,c){var p=i.flags;switch(i.tag){case 0:case 11:case 15:Tn(n,i,r,c),p&2048&&Va(9,i);break;case 1:Tn(n,i,r,c);break;case 3:Tn(n,i,r,c),p&2048&&(n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&Ra(n)));break;case 12:if(p&2048){Tn(n,i,r,c),n=i.stateNode;try{var g=i.memoizedProps,A=g.id,T=g.onPostCommit;typeof T=="function"&&T(A,i.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(D){It(i,i.return,D)}}else Tn(n,i,r,c);break;case 31:Tn(n,i,r,c);break;case 13:Tn(n,i,r,c);break;case 23:break;case 22:g=i.stateNode,A=i.alternate,i.memoizedState!==null?g._visibility&2?Tn(n,i,r,c):Xa(n,i):g._visibility&2?Tn(n,i,r,c):(g._visibility|=2,Is(n,i,r,c,(i.subtreeFlags&10256)!==0||!1)),p&2048&&vu(A,i);break;case 24:Tn(n,i,r,c),p&2048&&Au(i.alternate,i);break;default:Tn(n,i,r,c)}}function Is(n,i,r,c,p){for(p=p&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var g=n,A=i,T=r,D=c,z=A.flags;switch(A.tag){case 0:case 11:case 15:Is(g,A,T,D,p),Va(8,A);break;case 23:break;case 22:var q=A.stateNode;A.memoizedState!==null?q._visibility&2?Is(g,A,T,D,p):Xa(g,A):(q._visibility|=2,Is(g,A,T,D,p)),p&&z&2048&&vu(A.alternate,A);break;case 24:Is(g,A,T,D,p),p&&z&2048&&Au(A.alternate,A);break;default:Is(g,A,T,D,p)}i=i.sibling}}function Xa(n,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var r=n,c=i,p=c.flags;switch(c.tag){case 22:Xa(r,c),p&2048&&vu(c.alternate,c);break;case 24:Xa(r,c),p&2048&&Au(c.alternate,c);break;default:Xa(r,c)}i=i.sibling}}var Ya=8192;function Hs(n,i,r){if(n.subtreeFlags&Ya)for(n=n.child;n!==null;)Wp(n,i,r),n=n.sibling}function Wp(n,i,r){switch(n.tag){case 26:Hs(n,i,r),n.flags&Ya&&n.memoizedState!==null&&Vv(r,En,n.memoizedState,n.memoizedProps);break;case 5:Hs(n,i,r);break;case 3:case 4:var c=En;En=Io(n.stateNode.containerInfo),Hs(n,i,r),En=c;break;case 22:n.memoizedState===null&&(c=n.alternate,c!==null&&c.memoizedState!==null?(c=Ya,Ya=16777216,Hs(n,i,r),Ya=c):Hs(n,i,r));break;default:Hs(n,i,r)}}function Zp(n){var i=n.alternate;if(i!==null&&(n=i.child,n!==null)){i.child=null;do i=n.sibling,n.sibling=null,n=i;while(n!==null)}}function $a(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var r=0;r<i.length;r++){var c=i[r];Ae=c,tm(c,n)}Zp(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)Jp(n),n=n.sibling}function Jp(n){switch(n.tag){case 0:case 11:case 15:$a(n),n.flags&2048&&Ai(9,n,n.return);break;case 3:$a(n);break;case 12:$a(n);break;case 22:var i=n.stateNode;n.memoizedState!==null&&i._visibility&2&&(n.return===null||n.return.tag!==13)?(i._visibility&=-3,Mo(n)):$a(n);break;default:$a(n)}}function Mo(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var r=0;r<i.length;r++){var c=i[r];Ae=c,tm(c,n)}Zp(n)}for(n=n.child;n!==null;){switch(i=n,i.tag){case 0:case 11:case 15:Ai(8,i,i.return),Mo(i);break;case 22:r=i.stateNode,r._visibility&2&&(r._visibility&=-3,Mo(i));break;default:Mo(i)}n=n.sibling}}function tm(n,i){for(;Ae!==null;){var r=Ae;switch(r.tag){case 0:case 11:case 15:Ai(8,r,i);break;case 23:case 22:if(r.memoizedState!==null&&r.memoizedState.cachePool!==null){var c=r.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:Ra(r.memoizedState.cache)}if(c=r.child,c!==null)c.return=r,Ae=c;else t:for(r=n;Ae!==null;){c=Ae;var p=c.sibling,g=c.return;if(Vp(c),c===r){Ae=null;break t}if(p!==null){p.return=g,Ae=p;break t}Ae=g}}}var av={getCacheForType:function(n){var i=Te(ue),r=i.data.get(n);return r===void 0&&(r=n(),i.data.set(n,r)),r},cacheSignal:function(){return Te(ue).controller.signal}},rv=typeof WeakMap=="function"?WeakMap:Map,Lt=0,Yt=null,Tt=null,Ct=0,Ut=0,en=null,Si=!1,Gs=!1,Su=!1,ei=0,se=0,wi=0,is=0,wu=0,nn=0,Vs=0,Ka=null,Ie=null,xu=!1,Do=0,em=0,No=1/0,Ro=null,xi=null,ge=0,Ei=null,qs=null,ni=0,Eu=0,Tu=null,nm=null,Qa=0,_u=null;function sn(){return(Lt&2)!==0&&Ct!==0?Ct&-Ct:O.T!==null?ku():yd()}function im(){if(nn===0)if((Ct&536870912)===0||Dt){var n=Fr;Fr<<=1,(Fr&3932160)===0&&(Fr=262144),nn=n}else nn=536870912;return n=Je.current,n!==null&&(n.flags|=32),nn}function He(n,i,r){(n===Yt&&(Ut===2||Ut===9)||n.cancelPendingCommit!==null)&&(Xs(n,0),Ti(n,Ct,nn,!1)),ya(n,r),((Lt&2)===0||n!==Yt)&&(n===Yt&&((Lt&2)===0&&(is|=r),se===4&&Ti(n,Ct,nn,!1)),Rn(n))}function sm(n,i,r){if((Lt&6)!==0)throw Error(s(327));var c=!r&&(i&127)===0&&(i&n.expiredLanes)===0||ga(n,i),p=c?cv(n,i):Mu(n,i,!0),g=c;do{if(p===0){Gs&&!c&&Ti(n,i,0,!1);break}else{if(r=n.current.alternate,g&&!ov(r)){p=Mu(n,i,!1),g=!1;continue}if(p===2){if(g=i,n.errorRecoveryDisabledLanes&g)var A=0;else A=n.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){i=A;t:{var T=n;p=Ka;var D=T.current.memoizedState.isDehydrated;if(D&&(Xs(T,A).flags|=256),A=Mu(T,A,!1),A!==2){if(Su&&!D){T.errorRecoveryDisabledLanes|=g,is|=g,p=4;break t}g=Ie,Ie=p,g!==null&&(Ie===null?Ie=g:Ie.push.apply(Ie,g))}p=A}if(g=!1,p!==2)continue}}if(p===1){Xs(n,0),Ti(n,i,0,!0);break}t:{switch(c=n,g=p,g){case 0:case 1:throw Error(s(345));case 4:if((i&4194048)!==i)break;case 6:Ti(c,i,nn,!Si);break t;case 2:Ie=null;break;case 3:case 5:break;default:throw Error(s(329))}if((i&62914560)===i&&(p=Do+300-$e(),10<p)){if(Ti(c,i,nn,!Si),Ur(c,0,!0)!==0)break t;ni=i,c.timeoutHandle=Bm(am.bind(null,c,r,Ie,Ro,xu,i,nn,is,Vs,Si,g,"Throttled",-0,0),p);break t}am(c,r,Ie,Ro,xu,i,nn,is,Vs,Si,g,null,-0,0)}}break}while(!0);Rn(n)}function am(n,i,r,c,p,g,A,T,D,z,q,Y,U,V){if(n.timeoutHandle=-1,Y=i.subtreeFlags,Y&8192||(Y&16785408)===16785408){Y={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:In},Wp(i,g,Y);var at=(g&62914560)===g?Do-$e():(g&4194048)===g?em-$e():0;if(at=qv(Y,at),at!==null){ni=g,n.cancelPendingCommit=at(fm.bind(null,n,i,g,r,c,p,A,T,D,q,Y,null,U,V)),Ti(n,g,A,!z);return}}fm(n,i,g,r,c,p,A,T,D)}function ov(n){for(var i=n;;){var r=i.tag;if((r===0||r===11||r===15)&&i.flags&16384&&(r=i.updateQueue,r!==null&&(r=r.stores,r!==null)))for(var c=0;c<r.length;c++){var p=r[c],g=p.getSnapshot;p=p.value;try{if(!We(g(),p))return!1}catch{return!1}}if(r=i.child,i.subtreeFlags&16384&&r!==null)r.return=i,i=r;else{if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Ti(n,i,r,c){i&=~wu,i&=~is,n.suspendedLanes|=i,n.pingedLanes&=~i,c&&(n.warmLanes|=i),c=n.expirationTimes;for(var p=i;0<p;){var g=31-Qe(p),A=1<<g;c[g]=-1,p&=~A}r!==0&&pd(n,r,i)}function ko(){return(Lt&6)===0?(Wa(0),!1):!0}function Cu(){if(Tt!==null){if(Ut===0)var n=Tt.return;else n=Tt,qn=$i=null,Gc(n),Ps=null,Oa=0,n=Tt;for(;n!==null;)Pp(n.alternate,n),n=n.return;Tt=null}}function Xs(n,i){var r=n.timeoutHandle;r!==-1&&(n.timeoutHandle=-1,Cv(r)),r=n.cancelPendingCommit,r!==null&&(n.cancelPendingCommit=null,r()),ni=0,Cu(),Yt=n,Tt=r=Gn(n.current,null),Ct=i,Ut=0,en=null,Si=!1,Gs=ga(n,i),Su=!1,Vs=nn=wu=is=wi=se=0,Ie=Ka=null,xu=!1,(i&8)!==0&&(i|=i&32);var c=n.entangledLanes;if(c!==0)for(n=n.entanglements,c&=i;0<c;){var p=31-Qe(c),g=1<<p;i|=n[p],c&=~g}return ei=i,Zr(),r}function rm(n,i){wt=null,O.H=Ia,i===Bs||i===ro?(i=wf(),Ut=3):i===Rc?(i=wf(),Ut=4):Ut=i===au?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,en=i,Tt===null&&(se=1,So(n,hn(i,n.current)))}function om(){var n=Je.current;return n===null?!0:(Ct&4194048)===Ct?mn===null:(Ct&62914560)===Ct||(Ct&536870912)!==0?n===mn:!1}function lm(){var n=O.H;return O.H=Ia,n===null?Ia:n}function cm(){var n=O.A;return O.A=av,n}function Oo(){se=4,Si||(Ct&4194048)!==Ct&&Je.current!==null||(Gs=!0),(wi&134217727)===0&&(is&134217727)===0||Yt===null||Ti(Yt,Ct,nn,!1)}function Mu(n,i,r){var c=Lt;Lt|=2;var p=lm(),g=cm();(Yt!==n||Ct!==i)&&(Ro=null,Xs(n,i)),i=!1;var A=se;t:do try{if(Ut!==0&&Tt!==null){var T=Tt,D=en;switch(Ut){case 8:Cu(),A=6;break t;case 3:case 2:case 9:case 6:Je.current===null&&(i=!0);var z=Ut;if(Ut=0,en=null,Ys(n,T,D,z),r&&Gs){A=0;break t}break;default:z=Ut,Ut=0,en=null,Ys(n,T,D,z)}}lv(),A=se;break}catch(q){rm(n,q)}while(!0);return i&&n.shellSuspendCounter++,qn=$i=null,Lt=c,O.H=p,O.A=g,Tt===null&&(Yt=null,Ct=0,Zr()),A}function lv(){for(;Tt!==null;)um(Tt)}function cv(n,i){var r=Lt;Lt|=2;var c=lm(),p=cm();Yt!==n||Ct!==i?(Ro=null,No=$e()+500,Xs(n,i)):Gs=ga(n,i);t:do try{if(Ut!==0&&Tt!==null){i=Tt;var g=en;e:switch(Ut){case 1:Ut=0,en=null,Ys(n,i,g,1);break;case 2:case 9:if(Af(g)){Ut=0,en=null,hm(i);break}i=function(){Ut!==2&&Ut!==9||Yt!==n||(Ut=7),Rn(n)},g.then(i,i);break t;case 3:Ut=7;break t;case 4:Ut=5;break t;case 7:Af(g)?(Ut=0,en=null,hm(i)):(Ut=0,en=null,Ys(n,i,g,7));break;case 5:var A=null;switch(Tt.tag){case 26:A=Tt.memoizedState;case 5:case 27:var T=Tt;if(A?Qm(A):T.stateNode.complete){Ut=0,en=null;var D=T.sibling;if(D!==null)Tt=D;else{var z=T.return;z!==null?(Tt=z,Lo(z)):Tt=null}break e}}Ut=0,en=null,Ys(n,i,g,5);break;case 6:Ut=0,en=null,Ys(n,i,g,6);break;case 8:Cu(),se=6;break t;default:throw Error(s(462))}}uv();break}catch(q){rm(n,q)}while(!0);return qn=$i=null,O.H=c,O.A=p,Lt=r,Tt!==null?0:(Yt=null,Ct=0,Zr(),se)}function uv(){for(;Tt!==null&&!Oy();)um(Tt)}function um(n){var i=Lp(n.alternate,n,ei);n.memoizedProps=n.pendingProps,i===null?Lo(n):Tt=i}function hm(n){var i=n,r=i.alternate;switch(i.tag){case 15:case 0:i=Mp(r,i,i.pendingProps,i.type,void 0,Ct);break;case 11:i=Mp(r,i,i.pendingProps,i.type.render,i.ref,Ct);break;case 5:Gc(i);default:Pp(r,i),i=Tt=cf(i,ei),i=Lp(r,i,ei)}n.memoizedProps=n.pendingProps,i===null?Lo(n):Tt=i}function Ys(n,i,r,c){qn=$i=null,Gc(i),Ps=null,Oa=0;var p=i.return;try{if(Zb(n,p,i,r,Ct)){se=1,So(n,hn(r,n.current)),Tt=null;return}}catch(g){if(p!==null)throw Tt=p,g;se=1,So(n,hn(r,n.current)),Tt=null;return}i.flags&32768?(Dt||c===1?n=!0:Gs||(Ct&536870912)!==0?n=!1:(Si=n=!0,(c===2||c===9||c===3||c===6)&&(c=Je.current,c!==null&&c.tag===13&&(c.flags|=16384))),dm(i,n)):Lo(i)}function Lo(n){var i=n;do{if((i.flags&32768)!==0){dm(i,Si);return}n=i.return;var r=ev(i.alternate,i,ei);if(r!==null){Tt=r;return}if(i=i.sibling,i!==null){Tt=i;return}Tt=i=n}while(i!==null);se===0&&(se=5)}function dm(n,i){do{var r=nv(n.alternate,n);if(r!==null){r.flags&=32767,Tt=r;return}if(r=n.return,r!==null&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!i&&(n=n.sibling,n!==null)){Tt=n;return}Tt=n=r}while(n!==null);se=6,Tt=null}function fm(n,i,r,c,p,g,A,T,D){n.cancelPendingCommit=null;do Bo();while(ge!==0);if((Lt&6)!==0)throw Error(s(327));if(i!==null){if(i===n.current)throw Error(s(177));if(g=i.lanes|i.childLanes,g|=gc,Gy(n,r,g,A,T,D),n===Yt&&(Tt=Yt=null,Ct=0),qs=i,Ei=n,ni=r,Eu=g,Tu=p,nm=c,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,pv(Pr,function(){return bm(),null})):(n.callbackNode=null,n.callbackPriority=0),c=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||c){c=O.T,O.T=null,p=H.p,H.p=2,A=Lt,Lt|=4;try{iv(n,i,r)}finally{Lt=A,H.p=p,O.T=c}}ge=1,pm(),mm(),gm()}}function pm(){if(ge===1){ge=0;var n=Ei,i=qs,r=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||r){r=O.T,O.T=null;var c=H.p;H.p=2;var p=Lt;Lt|=4;try{$p(i,n);var g=Uu,A=Jd(n.containerInfo),T=g.focusedElem,D=g.selectionRange;if(A!==T&&T&&T.ownerDocument&&Zd(T.ownerDocument.documentElement,T)){if(D!==null&&hc(T)){var z=D.start,q=D.end;if(q===void 0&&(q=z),"selectionStart"in T)T.selectionStart=z,T.selectionEnd=Math.min(q,T.value.length);else{var Y=T.ownerDocument||document,U=Y&&Y.defaultView||window;if(U.getSelection){var V=U.getSelection(),at=T.textContent.length,ft=Math.min(D.start,at),Vt=D.end===void 0?ft:Math.min(D.end,at);!V.extend&&ft>Vt&&(A=Vt,Vt=ft,ft=A);var j=Wd(T,ft),B=Wd(T,Vt);if(j&&B&&(V.rangeCount!==1||V.anchorNode!==j.node||V.anchorOffset!==j.offset||V.focusNode!==B.node||V.focusOffset!==B.offset)){var F=Y.createRange();F.setStart(j.node,j.offset),V.removeAllRanges(),ft>Vt?(V.addRange(F),V.extend(B.node,B.offset)):(F.setEnd(B.node,B.offset),V.addRange(F))}}}}for(Y=[],V=T;V=V.parentNode;)V.nodeType===1&&Y.push({element:V,left:V.scrollLeft,top:V.scrollTop});for(typeof T.focus=="function"&&T.focus(),T=0;T<Y.length;T++){var X=Y[T];X.element.scrollLeft=X.left,X.element.scrollTop=X.top}}Yo=!!zu,Uu=zu=null}finally{Lt=p,H.p=c,O.T=r}}n.current=i,ge=2}}function mm(){if(ge===2){ge=0;var n=Ei,i=qs,r=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||r){r=O.T,O.T=null;var c=H.p;H.p=2;var p=Lt;Lt|=4;try{Gp(n,i.alternate,i)}finally{Lt=p,H.p=c,O.T=r}}ge=3}}function gm(){if(ge===4||ge===3){ge=0,Ly();var n=Ei,i=qs,r=ni,c=nm;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?ge=5:(ge=0,qs=Ei=null,ym(n,n.pendingLanes));var p=n.pendingLanes;if(p===0&&(xi=null),Xl(r),i=i.stateNode,Ke&&typeof Ke.onCommitFiberRoot=="function")try{Ke.onCommitFiberRoot(ma,i,void 0,(i.current.flags&128)===128)}catch{}if(c!==null){i=O.T,p=H.p,H.p=2,O.T=null;try{for(var g=n.onRecoverableError,A=0;A<c.length;A++){var T=c[A];g(T.value,{componentStack:T.stack})}}finally{O.T=i,H.p=p}}(ni&3)!==0&&Bo(),Rn(n),p=n.pendingLanes,(r&261930)!==0&&(p&42)!==0?n===_u?Qa++:(Qa=0,_u=n):Qa=0,Wa(0)}}function ym(n,i){(n.pooledCacheLanes&=i)===0&&(i=n.pooledCache,i!=null&&(n.pooledCache=null,Ra(i)))}function Bo(){return pm(),mm(),gm(),bm()}function bm(){if(ge!==5)return!1;var n=Ei,i=Eu;Eu=0;var r=Xl(ni),c=O.T,p=H.p;try{H.p=32>r?32:r,O.T=null,r=Tu,Tu=null;var g=Ei,A=ni;if(ge=0,qs=Ei=null,ni=0,(Lt&6)!==0)throw Error(s(331));var T=Lt;if(Lt|=4,Jp(g.current),Qp(g,g.current,A,r),Lt=T,Wa(0,!1),Ke&&typeof Ke.onPostCommitFiberRoot=="function")try{Ke.onPostCommitFiberRoot(ma,g)}catch{}return!0}finally{H.p=p,O.T=c,ym(n,i)}}function vm(n,i,r){i=hn(r,i),i=su(n.stateNode,i,2),n=yi(n,i,2),n!==null&&(ya(n,2),Rn(n))}function It(n,i,r){if(n.tag===3)vm(n,n,r);else for(;i!==null;){if(i.tag===3){vm(i,n,r);break}else if(i.tag===1){var c=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(xi===null||!xi.has(c))){n=hn(r,n),r=Ap(2),c=yi(i,r,2),c!==null&&(Sp(r,c,i,n),ya(c,2),Rn(c));break}}i=i.return}}function Du(n,i,r){var c=n.pingCache;if(c===null){c=n.pingCache=new rv;var p=new Set;c.set(i,p)}else p=c.get(i),p===void 0&&(p=new Set,c.set(i,p));p.has(r)||(Su=!0,p.add(r),n=hv.bind(null,n,i,r),i.then(n,n))}function hv(n,i,r){var c=n.pingCache;c!==null&&c.delete(i),n.pingedLanes|=n.suspendedLanes&r,n.warmLanes&=~r,Yt===n&&(Ct&r)===r&&(se===4||se===3&&(Ct&62914560)===Ct&&300>$e()-Do?(Lt&2)===0&&Xs(n,0):wu|=r,Vs===Ct&&(Vs=0)),Rn(n)}function Am(n,i){i===0&&(i=fd()),n=qi(n,i),n!==null&&(ya(n,i),Rn(n))}function dv(n){var i=n.memoizedState,r=0;i!==null&&(r=i.retryLane),Am(n,r)}function fv(n,i){var r=0;switch(n.tag){case 31:case 13:var c=n.stateNode,p=n.memoizedState;p!==null&&(r=p.retryLane);break;case 19:c=n.stateNode;break;case 22:c=n.stateNode._retryCache;break;default:throw Error(s(314))}c!==null&&c.delete(i),Am(n,r)}function pv(n,i){return Hl(n,i)}var Po=null,$s=null,Nu=!1,jo=!1,Ru=!1,_i=0;function Rn(n){n!==$s&&n.next===null&&($s===null?Po=$s=n:$s=$s.next=n),jo=!0,Nu||(Nu=!0,gv())}function Wa(n,i){if(!Ru&&jo){Ru=!0;do for(var r=!1,c=Po;c!==null;){if(n!==0){var p=c.pendingLanes;if(p===0)var g=0;else{var A=c.suspendedLanes,T=c.pingedLanes;g=(1<<31-Qe(42|n)+1)-1,g&=p&~(A&~T),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(r=!0,Em(c,g))}else g=Ct,g=Ur(c,c===Yt?g:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(g&3)===0||ga(c,g)||(r=!0,Em(c,g));c=c.next}while(r);Ru=!1}}function mv(){Sm()}function Sm(){jo=Nu=!1;var n=0;_i!==0&&_v()&&(n=_i);for(var i=$e(),r=null,c=Po;c!==null;){var p=c.next,g=wm(c,i);g===0?(c.next=null,r===null?Po=p:r.next=p,p===null&&($s=r)):(r=c,(n!==0||(g&3)!==0)&&(jo=!0)),c=p}ge!==0&&ge!==5||Wa(n),_i!==0&&(_i=0)}function wm(n,i){for(var r=n.suspendedLanes,c=n.pingedLanes,p=n.expirationTimes,g=n.pendingLanes&-62914561;0<g;){var A=31-Qe(g),T=1<<A,D=p[A];D===-1?((T&r)===0||(T&c)!==0)&&(p[A]=Hy(T,i)):D<=i&&(n.expiredLanes|=T),g&=~T}if(i=Yt,r=Ct,r=Ur(n,n===i?r:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c=n.callbackNode,r===0||n===i&&(Ut===2||Ut===9)||n.cancelPendingCommit!==null)return c!==null&&c!==null&&Gl(c),n.callbackNode=null,n.callbackPriority=0;if((r&3)===0||ga(n,r)){if(i=r&-r,i===n.callbackPriority)return i;switch(c!==null&&Gl(c),Xl(r)){case 2:case 8:r=hd;break;case 32:r=Pr;break;case 268435456:r=dd;break;default:r=Pr}return c=xm.bind(null,n),r=Hl(r,c),n.callbackPriority=i,n.callbackNode=r,i}return c!==null&&c!==null&&Gl(c),n.callbackPriority=2,n.callbackNode=null,2}function xm(n,i){if(ge!==0&&ge!==5)return n.callbackNode=null,n.callbackPriority=0,null;var r=n.callbackNode;if(Bo()&&n.callbackNode!==r)return null;var c=Ct;return c=Ur(n,n===Yt?c:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c===0?null:(sm(n,c,i),wm(n,$e()),n.callbackNode!=null&&n.callbackNode===r?xm.bind(null,n):null)}function Em(n,i){if(Bo())return null;sm(n,i,!0)}function gv(){Mv(function(){(Lt&6)!==0?Hl(ud,mv):Sm()})}function ku(){if(_i===0){var n=Os;n===0&&(n=jr,jr<<=1,(jr&261888)===0&&(jr=256)),_i=n}return _i}function Tm(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:Vr(""+n)}function _m(n,i){var r=i.ownerDocument.createElement("input");return r.name=i.name,r.value=i.value,n.id&&r.setAttribute("form",n.id),i.parentNode.insertBefore(r,i),n=new FormData(n),r.parentNode.removeChild(r),n}function yv(n,i,r,c,p){if(i==="submit"&&r&&r.stateNode===p){var g=Tm((p[Pe]||null).action),A=c.submitter;A&&(i=(i=A[Pe]||null)?Tm(i.formAction):A.getAttribute("formAction"),i!==null&&(g=i,A=null));var T=new $r("action","action",null,c,p);n.push({event:T,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(_i!==0){var D=A?_m(p,A):new FormData(p);Zc(r,{pending:!0,data:D,method:p.method,action:g},null,D)}}else typeof g=="function"&&(T.preventDefault(),D=A?_m(p,A):new FormData(p),Zc(r,{pending:!0,data:D,method:p.method,action:g},g,D))},currentTarget:p}]})}}for(var Ou=0;Ou<mc.length;Ou++){var Lu=mc[Ou],bv=Lu.toLowerCase(),vv=Lu[0].toUpperCase()+Lu.slice(1);xn(bv,"on"+vv)}xn(nf,"onAnimationEnd"),xn(sf,"onAnimationIteration"),xn(af,"onAnimationStart"),xn("dblclick","onDoubleClick"),xn("focusin","onFocus"),xn("focusout","onBlur"),xn(Bb,"onTransitionRun"),xn(Pb,"onTransitionStart"),xn(jb,"onTransitionCancel"),xn(rf,"onTransitionEnd"),vs("onMouseEnter",["mouseout","mouseover"]),vs("onMouseLeave",["mouseout","mouseover"]),vs("onPointerEnter",["pointerout","pointerover"]),vs("onPointerLeave",["pointerout","pointerover"]),Ii("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ii("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ii("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ii("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ii("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ii("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Za="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Av=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Za));function Cm(n,i){i=(i&4)!==0;for(var r=0;r<n.length;r++){var c=n[r],p=c.event;c=c.listeners;t:{var g=void 0;if(i)for(var A=c.length-1;0<=A;A--){var T=c[A],D=T.instance,z=T.currentTarget;if(T=T.listener,D!==g&&p.isPropagationStopped())break t;g=T,p.currentTarget=z;try{g(p)}catch(q){Wr(q)}p.currentTarget=null,g=D}else for(A=0;A<c.length;A++){if(T=c[A],D=T.instance,z=T.currentTarget,T=T.listener,D!==g&&p.isPropagationStopped())break t;g=T,p.currentTarget=z;try{g(p)}catch(q){Wr(q)}p.currentTarget=null,g=D}}}}function _t(n,i){var r=i[Yl];r===void 0&&(r=i[Yl]=new Set);var c=n+"__bubble";r.has(c)||(Mm(i,n,2,!1),r.add(c))}function Bu(n,i,r){var c=0;i&&(c|=4),Mm(r,n,c,i)}var Fo="_reactListening"+Math.random().toString(36).slice(2);function Pu(n){if(!n[Fo]){n[Fo]=!0,Ad.forEach(function(r){r!=="selectionchange"&&(Av.has(r)||Bu(r,!1,n),Bu(r,!0,n))});var i=n.nodeType===9?n:n.ownerDocument;i===null||i[Fo]||(i[Fo]=!0,Bu("selectionchange",!1,i))}}function Mm(n,i,r,c){switch(ig(i)){case 2:var p=$v;break;case 8:p=Kv;break;default:p=Wu}r=p.bind(null,i,r,n),p=void 0,!nc||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(p=!0),c?p!==void 0?n.addEventListener(i,r,{capture:!0,passive:p}):n.addEventListener(i,r,!0):p!==void 0?n.addEventListener(i,r,{passive:p}):n.addEventListener(i,r,!1)}function ju(n,i,r,c,p){var g=c;if((i&1)===0&&(i&2)===0&&c!==null)t:for(;;){if(c===null)return;var A=c.tag;if(A===3||A===4){var T=c.stateNode.containerInfo;if(T===p)break;if(A===4)for(A=c.return;A!==null;){var D=A.tag;if((D===3||D===4)&&A.stateNode.containerInfo===p)return;A=A.return}for(;T!==null;){if(A=gs(T),A===null)return;if(D=A.tag,D===5||D===6||D===26||D===27){c=g=A;continue t}T=T.parentNode}}c=c.return}kd(function(){var z=g,q=tc(r),Y=[];t:{var U=of.get(n);if(U!==void 0){var V=$r,at=n;switch(n){case"keypress":if(Xr(r)===0)break t;case"keydown":case"keyup":V=fb;break;case"focusin":at="focus",V=rc;break;case"focusout":at="blur",V=rc;break;case"beforeblur":case"afterblur":V=rc;break;case"click":if(r.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":V=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":V=eb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":V=gb;break;case nf:case sf:case af:V=sb;break;case rf:V=bb;break;case"scroll":case"scrollend":V=Jy;break;case"wheel":V=Ab;break;case"copy":case"cut":case"paste":V=rb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":V=jd;break;case"toggle":case"beforetoggle":V=wb}var ft=(i&4)!==0,Vt=!ft&&(n==="scroll"||n==="scrollend"),j=ft?U!==null?U+"Capture":null:U;ft=[];for(var B=z,F;B!==null;){var X=B;if(F=X.stateNode,X=X.tag,X!==5&&X!==26&&X!==27||F===null||j===null||(X=Aa(B,j),X!=null&&ft.push(Ja(B,X,F))),Vt)break;B=B.return}0<ft.length&&(U=new V(U,at,null,r,q),Y.push({event:U,listeners:ft}))}}if((i&7)===0){t:{if(U=n==="mouseover"||n==="pointerover",V=n==="mouseout"||n==="pointerout",U&&r!==Jl&&(at=r.relatedTarget||r.fromElement)&&(gs(at)||at[ms]))break t;if((V||U)&&(U=q.window===q?q:(U=q.ownerDocument)?U.defaultView||U.parentWindow:window,V?(at=r.relatedTarget||r.toElement,V=z,at=at?gs(at):null,at!==null&&(Vt=o(at),ft=at.tag,at!==Vt||ft!==5&&ft!==27&&ft!==6)&&(at=null)):(V=null,at=z),V!==at)){if(ft=Bd,X="onMouseLeave",j="onMouseEnter",B="mouse",(n==="pointerout"||n==="pointerover")&&(ft=jd,X="onPointerLeave",j="onPointerEnter",B="pointer"),Vt=V==null?U:va(V),F=at==null?U:va(at),U=new ft(X,B+"leave",V,r,q),U.target=Vt,U.relatedTarget=F,X=null,gs(q)===z&&(ft=new ft(j,B+"enter",at,r,q),ft.target=F,ft.relatedTarget=Vt,X=ft),Vt=X,V&&at)e:{for(ft=Sv,j=V,B=at,F=0,X=j;X;X=ft(X))F++;X=0;for(var lt=B;lt;lt=ft(lt))X++;for(;0<F-X;)j=ft(j),F--;for(;0<X-F;)B=ft(B),X--;for(;F--;){if(j===B||B!==null&&j===B.alternate){ft=j;break e}j=ft(j),B=ft(B)}ft=null}else ft=null;V!==null&&Dm(Y,U,V,ft,!1),at!==null&&Vt!==null&&Dm(Y,Vt,at,ft,!0)}}t:{if(U=z?va(z):window,V=U.nodeName&&U.nodeName.toLowerCase(),V==="select"||V==="input"&&U.type==="file")var kt=qd;else if(Gd(U))if(Xd)kt=kb;else{kt=Nb;var rt=Db}else V=U.nodeName,!V||V.toLowerCase()!=="input"||U.type!=="checkbox"&&U.type!=="radio"?z&&Zl(z.elementType)&&(kt=qd):kt=Rb;if(kt&&(kt=kt(n,z))){Vd(Y,kt,r,q);break t}rt&&rt(n,U,z),n==="focusout"&&z&&U.type==="number"&&z.memoizedProps.value!=null&&Wl(U,"number",U.value)}switch(rt=z?va(z):window,n){case"focusin":(Gd(rt)||rt.contentEditable==="true")&&(Ts=rt,dc=z,Ma=null);break;case"focusout":Ma=dc=Ts=null;break;case"mousedown":fc=!0;break;case"contextmenu":case"mouseup":case"dragend":fc=!1,tf(Y,r,q);break;case"selectionchange":if(Lb)break;case"keydown":case"keyup":tf(Y,r,q)}var xt;if(lc)t:{switch(n){case"compositionstart":var Mt="onCompositionStart";break t;case"compositionend":Mt="onCompositionEnd";break t;case"compositionupdate":Mt="onCompositionUpdate";break t}Mt=void 0}else Es?Id(n,r)&&(Mt="onCompositionEnd"):n==="keydown"&&r.keyCode===229&&(Mt="onCompositionStart");Mt&&(Fd&&r.locale!=="ko"&&(Es||Mt!=="onCompositionStart"?Mt==="onCompositionEnd"&&Es&&(xt=Od()):(ui=q,ic="value"in ui?ui.value:ui.textContent,Es=!0)),rt=zo(z,Mt),0<rt.length&&(Mt=new Pd(Mt,n,null,r,q),Y.push({event:Mt,listeners:rt}),xt?Mt.data=xt:(xt=Hd(r),xt!==null&&(Mt.data=xt)))),(xt=Eb?Tb(n,r):_b(n,r))&&(Mt=zo(z,"onBeforeInput"),0<Mt.length&&(rt=new Pd("onBeforeInput","beforeinput",null,r,q),Y.push({event:rt,listeners:Mt}),rt.data=xt)),yv(Y,n,z,r,q)}Cm(Y,i)})}function Ja(n,i,r){return{instance:n,listener:i,currentTarget:r}}function zo(n,i){for(var r=i+"Capture",c=[];n!==null;){var p=n,g=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||g===null||(p=Aa(n,r),p!=null&&c.unshift(Ja(n,p,g)),p=Aa(n,i),p!=null&&c.push(Ja(n,p,g))),n.tag===3)return c;n=n.return}return[]}function Sv(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function Dm(n,i,r,c,p){for(var g=i._reactName,A=[];r!==null&&r!==c;){var T=r,D=T.alternate,z=T.stateNode;if(T=T.tag,D!==null&&D===c)break;T!==5&&T!==26&&T!==27||z===null||(D=z,p?(z=Aa(r,g),z!=null&&A.unshift(Ja(r,z,D))):p||(z=Aa(r,g),z!=null&&A.push(Ja(r,z,D)))),r=r.return}A.length!==0&&n.push({event:i,listeners:A})}var wv=/\r\n?/g,xv=/\u0000|\uFFFD/g;function Nm(n){return(typeof n=="string"?n:""+n).replace(wv,`
`).replace(xv,"")}function Rm(n,i){return i=Nm(i),Nm(n)===i}function Gt(n,i,r,c,p,g){switch(r){case"children":typeof c=="string"?i==="body"||i==="textarea"&&c===""||Ss(n,c):(typeof c=="number"||typeof c=="bigint")&&i!=="body"&&Ss(n,""+c);break;case"className":Hr(n,"class",c);break;case"tabIndex":Hr(n,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Hr(n,r,c);break;case"style":Nd(n,c,g);break;case"data":if(i!=="object"){Hr(n,"data",c);break}case"src":case"href":if(c===""&&(i!=="a"||r!=="href")){n.removeAttribute(r);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(r);break}c=Vr(""+c),n.setAttribute(r,c);break;case"action":case"formAction":if(typeof c=="function"){n.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(r==="formAction"?(i!=="input"&&Gt(n,i,"name",p.name,p,null),Gt(n,i,"formEncType",p.formEncType,p,null),Gt(n,i,"formMethod",p.formMethod,p,null),Gt(n,i,"formTarget",p.formTarget,p,null)):(Gt(n,i,"encType",p.encType,p,null),Gt(n,i,"method",p.method,p,null),Gt(n,i,"target",p.target,p,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(r);break}c=Vr(""+c),n.setAttribute(r,c);break;case"onClick":c!=null&&(n.onclick=In);break;case"onScroll":c!=null&&_t("scroll",n);break;case"onScrollEnd":c!=null&&_t("scrollend",n);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(r=c.__html,r!=null){if(p.children!=null)throw Error(s(60));n.innerHTML=r}}break;case"multiple":n.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":n.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){n.removeAttribute("xlink:href");break}r=Vr(""+c),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(r,""+c):n.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(r,""):n.removeAttribute(r);break;case"capture":case"download":c===!0?n.setAttribute(r,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(r,c):n.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?n.setAttribute(r,c):n.removeAttribute(r);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?n.removeAttribute(r):n.setAttribute(r,c);break;case"popover":_t("beforetoggle",n),_t("toggle",n),Ir(n,"popover",c);break;case"xlinkActuate":Un(n,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Un(n,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Un(n,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Un(n,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Un(n,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Un(n,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Un(n,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Un(n,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Un(n,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Ir(n,"is",c);break;case"innerText":case"textContent":break;default:(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(r=Wy.get(r)||r,Ir(n,r,c))}}function Fu(n,i,r,c,p,g){switch(r){case"style":Nd(n,c,g);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(r=c.__html,r!=null){if(p.children!=null)throw Error(s(60));n.innerHTML=r}}break;case"children":typeof c=="string"?Ss(n,c):(typeof c=="number"||typeof c=="bigint")&&Ss(n,""+c);break;case"onScroll":c!=null&&_t("scroll",n);break;case"onScrollEnd":c!=null&&_t("scrollend",n);break;case"onClick":c!=null&&(n.onclick=In);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Sd.hasOwnProperty(r))t:{if(r[0]==="o"&&r[1]==="n"&&(p=r.endsWith("Capture"),i=r.slice(2,p?r.length-7:void 0),g=n[Pe]||null,g=g!=null?g[r]:null,typeof g=="function"&&n.removeEventListener(i,g,p),typeof c=="function")){typeof g!="function"&&g!==null&&(r in n?n[r]=null:n.hasAttribute(r)&&n.removeAttribute(r)),n.addEventListener(i,c,p);break t}r in n?n[r]=c:c===!0?n.setAttribute(r,""):Ir(n,r,c)}}}function Ce(n,i,r){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":_t("error",n),_t("load",n);var c=!1,p=!1,g;for(g in r)if(r.hasOwnProperty(g)){var A=r[g];if(A!=null)switch(g){case"src":c=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,i));default:Gt(n,i,g,A,r,null)}}p&&Gt(n,i,"srcSet",r.srcSet,r,null),c&&Gt(n,i,"src",r.src,r,null);return;case"input":_t("invalid",n);var T=g=A=p=null,D=null,z=null;for(c in r)if(r.hasOwnProperty(c)){var q=r[c];if(q!=null)switch(c){case"name":p=q;break;case"type":A=q;break;case"checked":D=q;break;case"defaultChecked":z=q;break;case"value":g=q;break;case"defaultValue":T=q;break;case"children":case"dangerouslySetInnerHTML":if(q!=null)throw Error(s(137,i));break;default:Gt(n,i,c,q,r,null)}}_d(n,g,T,D,z,A,p,!1);return;case"select":_t("invalid",n),c=A=g=null;for(p in r)if(r.hasOwnProperty(p)&&(T=r[p],T!=null))switch(p){case"value":g=T;break;case"defaultValue":A=T;break;case"multiple":c=T;default:Gt(n,i,p,T,r,null)}i=g,r=A,n.multiple=!!c,i!=null?As(n,!!c,i,!1):r!=null&&As(n,!!c,r,!0);return;case"textarea":_t("invalid",n),g=p=c=null;for(A in r)if(r.hasOwnProperty(A)&&(T=r[A],T!=null))switch(A){case"value":c=T;break;case"defaultValue":p=T;break;case"children":g=T;break;case"dangerouslySetInnerHTML":if(T!=null)throw Error(s(91));break;default:Gt(n,i,A,T,r,null)}Md(n,c,p,g);return;case"option":for(D in r)r.hasOwnProperty(D)&&(c=r[D],c!=null)&&(D==="selected"?n.selected=c&&typeof c!="function"&&typeof c!="symbol":Gt(n,i,D,c,r,null));return;case"dialog":_t("beforetoggle",n),_t("toggle",n),_t("cancel",n),_t("close",n);break;case"iframe":case"object":_t("load",n);break;case"video":case"audio":for(c=0;c<Za.length;c++)_t(Za[c],n);break;case"image":_t("error",n),_t("load",n);break;case"details":_t("toggle",n);break;case"embed":case"source":case"link":_t("error",n),_t("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(z in r)if(r.hasOwnProperty(z)&&(c=r[z],c!=null))switch(z){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,i));default:Gt(n,i,z,c,r,null)}return;default:if(Zl(i)){for(q in r)r.hasOwnProperty(q)&&(c=r[q],c!==void 0&&Fu(n,i,q,c,r,void 0));return}}for(T in r)r.hasOwnProperty(T)&&(c=r[T],c!=null&&Gt(n,i,T,c,r,null))}function Ev(n,i,r,c){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,g=null,A=null,T=null,D=null,z=null,q=null;for(V in r){var Y=r[V];if(r.hasOwnProperty(V)&&Y!=null)switch(V){case"checked":break;case"value":break;case"defaultValue":D=Y;default:c.hasOwnProperty(V)||Gt(n,i,V,null,c,Y)}}for(var U in c){var V=c[U];if(Y=r[U],c.hasOwnProperty(U)&&(V!=null||Y!=null))switch(U){case"type":g=V;break;case"name":p=V;break;case"checked":z=V;break;case"defaultChecked":q=V;break;case"value":A=V;break;case"defaultValue":T=V;break;case"children":case"dangerouslySetInnerHTML":if(V!=null)throw Error(s(137,i));break;default:V!==Y&&Gt(n,i,U,V,c,Y)}}Ql(n,A,T,D,z,q,g,p);return;case"select":V=A=T=U=null;for(g in r)if(D=r[g],r.hasOwnProperty(g)&&D!=null)switch(g){case"value":break;case"multiple":V=D;default:c.hasOwnProperty(g)||Gt(n,i,g,null,c,D)}for(p in c)if(g=c[p],D=r[p],c.hasOwnProperty(p)&&(g!=null||D!=null))switch(p){case"value":U=g;break;case"defaultValue":T=g;break;case"multiple":A=g;default:g!==D&&Gt(n,i,p,g,c,D)}i=T,r=A,c=V,U!=null?As(n,!!r,U,!1):!!c!=!!r&&(i!=null?As(n,!!r,i,!0):As(n,!!r,r?[]:"",!1));return;case"textarea":V=U=null;for(T in r)if(p=r[T],r.hasOwnProperty(T)&&p!=null&&!c.hasOwnProperty(T))switch(T){case"value":break;case"children":break;default:Gt(n,i,T,null,c,p)}for(A in c)if(p=c[A],g=r[A],c.hasOwnProperty(A)&&(p!=null||g!=null))switch(A){case"value":U=p;break;case"defaultValue":V=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(s(91));break;default:p!==g&&Gt(n,i,A,p,c,g)}Cd(n,U,V);return;case"option":for(var at in r)U=r[at],r.hasOwnProperty(at)&&U!=null&&!c.hasOwnProperty(at)&&(at==="selected"?n.selected=!1:Gt(n,i,at,null,c,U));for(D in c)U=c[D],V=r[D],c.hasOwnProperty(D)&&U!==V&&(U!=null||V!=null)&&(D==="selected"?n.selected=U&&typeof U!="function"&&typeof U!="symbol":Gt(n,i,D,U,c,V));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ft in r)U=r[ft],r.hasOwnProperty(ft)&&U!=null&&!c.hasOwnProperty(ft)&&Gt(n,i,ft,null,c,U);for(z in c)if(U=c[z],V=r[z],c.hasOwnProperty(z)&&U!==V&&(U!=null||V!=null))switch(z){case"children":case"dangerouslySetInnerHTML":if(U!=null)throw Error(s(137,i));break;default:Gt(n,i,z,U,c,V)}return;default:if(Zl(i)){for(var Vt in r)U=r[Vt],r.hasOwnProperty(Vt)&&U!==void 0&&!c.hasOwnProperty(Vt)&&Fu(n,i,Vt,void 0,c,U);for(q in c)U=c[q],V=r[q],!c.hasOwnProperty(q)||U===V||U===void 0&&V===void 0||Fu(n,i,q,U,c,V);return}}for(var j in r)U=r[j],r.hasOwnProperty(j)&&U!=null&&!c.hasOwnProperty(j)&&Gt(n,i,j,null,c,U);for(Y in c)U=c[Y],V=r[Y],!c.hasOwnProperty(Y)||U===V||U==null&&V==null||Gt(n,i,Y,U,c,V)}function km(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Tv(){if(typeof performance.getEntriesByType=="function"){for(var n=0,i=0,r=performance.getEntriesByType("resource"),c=0;c<r.length;c++){var p=r[c],g=p.transferSize,A=p.initiatorType,T=p.duration;if(g&&T&&km(A)){for(A=0,T=p.responseEnd,c+=1;c<r.length;c++){var D=r[c],z=D.startTime;if(z>T)break;var q=D.transferSize,Y=D.initiatorType;q&&km(Y)&&(D=D.responseEnd,A+=q*(D<T?1:(T-z)/(D-z)))}if(--c,i+=8*(g+A)/(p.duration/1e3),n++,10<n)break}}if(0<n)return i/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var zu=null,Uu=null;function Uo(n){return n.nodeType===9?n:n.ownerDocument}function Om(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Lm(n,i){if(n===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&i==="foreignObject"?0:n}function Iu(n,i){return n==="textarea"||n==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Hu=null;function _v(){var n=window.event;return n&&n.type==="popstate"?n===Hu?!1:(Hu=n,!0):(Hu=null,!1)}var Bm=typeof setTimeout=="function"?setTimeout:void 0,Cv=typeof clearTimeout=="function"?clearTimeout:void 0,Pm=typeof Promise=="function"?Promise:void 0,Mv=typeof queueMicrotask=="function"?queueMicrotask:typeof Pm<"u"?function(n){return Pm.resolve(null).then(n).catch(Dv)}:Bm;function Dv(n){setTimeout(function(){throw n})}function Ci(n){return n==="head"}function jm(n,i){var r=i,c=0;do{var p=r.nextSibling;if(n.removeChild(r),p&&p.nodeType===8)if(r=p.data,r==="/$"||r==="/&"){if(c===0){n.removeChild(p),Zs(i);return}c--}else if(r==="$"||r==="$?"||r==="$~"||r==="$!"||r==="&")c++;else if(r==="html")tr(n.ownerDocument.documentElement);else if(r==="head"){r=n.ownerDocument.head,tr(r);for(var g=r.firstChild;g;){var A=g.nextSibling,T=g.nodeName;g[ba]||T==="SCRIPT"||T==="STYLE"||T==="LINK"&&g.rel.toLowerCase()==="stylesheet"||r.removeChild(g),g=A}}else r==="body"&&tr(n.ownerDocument.body);r=p}while(r);Zs(i)}function Fm(n,i){var r=n;n=0;do{var c=r.nextSibling;if(r.nodeType===1?i?(r._stashedDisplay=r.style.display,r.style.display="none"):(r.style.display=r._stashedDisplay||"",r.getAttribute("style")===""&&r.removeAttribute("style")):r.nodeType===3&&(i?(r._stashedText=r.nodeValue,r.nodeValue=""):r.nodeValue=r._stashedText||""),c&&c.nodeType===8)if(r=c.data,r==="/$"){if(n===0)break;n--}else r!=="$"&&r!=="$?"&&r!=="$~"&&r!=="$!"||n++;r=c}while(r)}function Gu(n){var i=n.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var r=i;switch(i=i.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":Gu(r),$l(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(r.rel.toLowerCase()==="stylesheet")continue}n.removeChild(r)}}function Nv(n,i,r,c){for(;n.nodeType===1;){var p=r;if(n.nodeName.toLowerCase()!==i.toLowerCase()){if(!c&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(c){if(!n[ba])switch(i){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(g=n.getAttribute("rel"),g==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(g!==p.rel||n.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||n.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||n.getAttribute("title")!==(p.title==null?null:p.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(g=n.getAttribute("src"),(g!==(p.src==null?null:p.src)||n.getAttribute("type")!==(p.type==null?null:p.type)||n.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&g&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(i==="input"&&n.type==="hidden"){var g=p.name==null?null:""+p.name;if(p.type==="hidden"&&n.getAttribute("name")===g)return n}else return n;if(n=gn(n.nextSibling),n===null)break}return null}function Rv(n,i,r){if(i==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!r||(n=gn(n.nextSibling),n===null))return null;return n}function zm(n,i){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!i||(n=gn(n.nextSibling),n===null))return null;return n}function Vu(n){return n.data==="$?"||n.data==="$~"}function qu(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function kv(n,i){var r=n.ownerDocument;if(n.data==="$~")n._reactRetry=i;else if(n.data!=="$?"||r.readyState!=="loading")i();else{var c=function(){i(),r.removeEventListener("DOMContentLoaded",c)};r.addEventListener("DOMContentLoaded",c),n._reactRetry=c}}function gn(n){for(;n!=null;n=n.nextSibling){var i=n.nodeType;if(i===1||i===3)break;if(i===8){if(i=n.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return n}var Xu=null;function Um(n){n=n.nextSibling;for(var i=0;n;){if(n.nodeType===8){var r=n.data;if(r==="/$"||r==="/&"){if(i===0)return gn(n.nextSibling);i--}else r!=="$"&&r!=="$!"&&r!=="$?"&&r!=="$~"&&r!=="&"||i++}n=n.nextSibling}return null}function Im(n){n=n.previousSibling;for(var i=0;n;){if(n.nodeType===8){var r=n.data;if(r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"){if(i===0)return n;i--}else r!=="/$"&&r!=="/&"||i++}n=n.previousSibling}return null}function Hm(n,i,r){switch(i=Uo(r),n){case"html":if(n=i.documentElement,!n)throw Error(s(452));return n;case"head":if(n=i.head,!n)throw Error(s(453));return n;case"body":if(n=i.body,!n)throw Error(s(454));return n;default:throw Error(s(451))}}function tr(n){for(var i=n.attributes;i.length;)n.removeAttributeNode(i[0]);$l(n)}var yn=new Map,Gm=new Set;function Io(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var ii=H.d;H.d={f:Ov,r:Lv,D:Bv,C:Pv,L:jv,m:Fv,X:Uv,S:zv,M:Iv};function Ov(){var n=ii.f(),i=ko();return n||i}function Lv(n){var i=ys(n);i!==null&&i.tag===5&&i.type==="form"?rp(i):ii.r(n)}var Ks=typeof document>"u"?null:document;function Vm(n,i,r){var c=Ks;if(c&&typeof i=="string"&&i){var p=cn(i);p='link[rel="'+n+'"][href="'+p+'"]',typeof r=="string"&&(p+='[crossorigin="'+r+'"]'),Gm.has(p)||(Gm.add(p),n={rel:n,crossOrigin:r,href:i},c.querySelector(p)===null&&(i=c.createElement("link"),Ce(i,"link",n),ve(i),c.head.appendChild(i)))}}function Bv(n){ii.D(n),Vm("dns-prefetch",n,null)}function Pv(n,i){ii.C(n,i),Vm("preconnect",n,i)}function jv(n,i,r){ii.L(n,i,r);var c=Ks;if(c&&n&&i){var p='link[rel="preload"][as="'+cn(i)+'"]';i==="image"&&r&&r.imageSrcSet?(p+='[imagesrcset="'+cn(r.imageSrcSet)+'"]',typeof r.imageSizes=="string"&&(p+='[imagesizes="'+cn(r.imageSizes)+'"]')):p+='[href="'+cn(n)+'"]';var g=p;switch(i){case"style":g=Qs(n);break;case"script":g=Ws(n)}yn.has(g)||(n=y({rel:"preload",href:i==="image"&&r&&r.imageSrcSet?void 0:n,as:i},r),yn.set(g,n),c.querySelector(p)!==null||i==="style"&&c.querySelector(er(g))||i==="script"&&c.querySelector(nr(g))||(i=c.createElement("link"),Ce(i,"link",n),ve(i),c.head.appendChild(i)))}}function Fv(n,i){ii.m(n,i);var r=Ks;if(r&&n){var c=i&&typeof i.as=="string"?i.as:"script",p='link[rel="modulepreload"][as="'+cn(c)+'"][href="'+cn(n)+'"]',g=p;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=Ws(n)}if(!yn.has(g)&&(n=y({rel:"modulepreload",href:n},i),yn.set(g,n),r.querySelector(p)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(nr(g)))return}c=r.createElement("link"),Ce(c,"link",n),ve(c),r.head.appendChild(c)}}}function zv(n,i,r){ii.S(n,i,r);var c=Ks;if(c&&n){var p=bs(c).hoistableStyles,g=Qs(n);i=i||"default";var A=p.get(g);if(!A){var T={loading:0,preload:null};if(A=c.querySelector(er(g)))T.loading=5;else{n=y({rel:"stylesheet",href:n,"data-precedence":i},r),(r=yn.get(g))&&Yu(n,r);var D=A=c.createElement("link");ve(D),Ce(D,"link",n),D._p=new Promise(function(z,q){D.onload=z,D.onerror=q}),D.addEventListener("load",function(){T.loading|=1}),D.addEventListener("error",function(){T.loading|=2}),T.loading|=4,Ho(A,i,c)}A={type:"stylesheet",instance:A,count:1,state:T},p.set(g,A)}}}function Uv(n,i){ii.X(n,i);var r=Ks;if(r&&n){var c=bs(r).hoistableScripts,p=Ws(n),g=c.get(p);g||(g=r.querySelector(nr(p)),g||(n=y({src:n,async:!0},i),(i=yn.get(p))&&$u(n,i),g=r.createElement("script"),ve(g),Ce(g,"link",n),r.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(p,g))}}function Iv(n,i){ii.M(n,i);var r=Ks;if(r&&n){var c=bs(r).hoistableScripts,p=Ws(n),g=c.get(p);g||(g=r.querySelector(nr(p)),g||(n=y({src:n,async:!0,type:"module"},i),(i=yn.get(p))&&$u(n,i),g=r.createElement("script"),ve(g),Ce(g,"link",n),r.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(p,g))}}function qm(n,i,r,c){var p=(p=gt.current)?Io(p):null;if(!p)throw Error(s(446));switch(n){case"meta":case"title":return null;case"style":return typeof r.precedence=="string"&&typeof r.href=="string"?(i=Qs(r.href),r=bs(p).hoistableStyles,c=r.get(i),c||(c={type:"style",instance:null,count:0,state:null},r.set(i,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(r.rel==="stylesheet"&&typeof r.href=="string"&&typeof r.precedence=="string"){n=Qs(r.href);var g=bs(p).hoistableStyles,A=g.get(n);if(A||(p=p.ownerDocument||p,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(n,A),(g=p.querySelector(er(n)))&&!g._p&&(A.instance=g,A.state.loading=5),yn.has(n)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},yn.set(n,r),g||Hv(p,n,r,A.state))),i&&c===null)throw Error(s(528,""));return A}if(i&&c!==null)throw Error(s(529,""));return null;case"script":return i=r.async,r=r.src,typeof r=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Ws(r),r=bs(p).hoistableScripts,c=r.get(i),c||(c={type:"script",instance:null,count:0,state:null},r.set(i,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,n))}}function Qs(n){return'href="'+cn(n)+'"'}function er(n){return'link[rel="stylesheet"]['+n+"]"}function Xm(n){return y({},n,{"data-precedence":n.precedence,precedence:null})}function Hv(n,i,r,c){n.querySelector('link[rel="preload"][as="style"]['+i+"]")?c.loading=1:(i=n.createElement("link"),c.preload=i,i.addEventListener("load",function(){return c.loading|=1}),i.addEventListener("error",function(){return c.loading|=2}),Ce(i,"link",r),ve(i),n.head.appendChild(i))}function Ws(n){return'[src="'+cn(n)+'"]'}function nr(n){return"script[async]"+n}function Ym(n,i,r){if(i.count++,i.instance===null)switch(i.type){case"style":var c=n.querySelector('style[data-href~="'+cn(r.href)+'"]');if(c)return i.instance=c,ve(c),c;var p=y({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return c=(n.ownerDocument||n).createElement("style"),ve(c),Ce(c,"style",p),Ho(c,r.precedence,n),i.instance=c;case"stylesheet":p=Qs(r.href);var g=n.querySelector(er(p));if(g)return i.state.loading|=4,i.instance=g,ve(g),g;c=Xm(r),(p=yn.get(p))&&Yu(c,p),g=(n.ownerDocument||n).createElement("link"),ve(g);var A=g;return A._p=new Promise(function(T,D){A.onload=T,A.onerror=D}),Ce(g,"link",c),i.state.loading|=4,Ho(g,r.precedence,n),i.instance=g;case"script":return g=Ws(r.src),(p=n.querySelector(nr(g)))?(i.instance=p,ve(p),p):(c=r,(p=yn.get(g))&&(c=y({},r),$u(c,p)),n=n.ownerDocument||n,p=n.createElement("script"),ve(p),Ce(p,"link",c),n.head.appendChild(p),i.instance=p);case"void":return null;default:throw Error(s(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(c=i.instance,i.state.loading|=4,Ho(c,r.precedence,n));return i.instance}function Ho(n,i,r){for(var c=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=c.length?c[c.length-1]:null,g=p,A=0;A<c.length;A++){var T=c[A];if(T.dataset.precedence===i)g=T;else if(g!==p)break}g?g.parentNode.insertBefore(n,g.nextSibling):(i=r.nodeType===9?r.head:r,i.insertBefore(n,i.firstChild))}function Yu(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.title==null&&(n.title=i.title)}function $u(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.integrity==null&&(n.integrity=i.integrity)}var Go=null;function $m(n,i,r){if(Go===null){var c=new Map,p=Go=new Map;p.set(r,c)}else p=Go,c=p.get(r),c||(c=new Map,p.set(r,c));if(c.has(n))return c;for(c.set(n,null),r=r.getElementsByTagName(n),p=0;p<r.length;p++){var g=r[p];if(!(g[ba]||g[xe]||n==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var A=g.getAttribute(i)||"";A=n+A;var T=c.get(A);T?T.push(g):c.set(A,[g])}}return c}function Km(n,i,r){n=n.ownerDocument||n,n.head.insertBefore(r,i==="title"?n.querySelector("head > title"):null)}function Gv(n,i,r){if(r===1||i.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;return i.rel==="stylesheet"?(n=i.disabled,typeof i.precedence=="string"&&n==null):!0;case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function Qm(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function Vv(n,i,r,c){if(r.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(r.state.loading&4)===0){if(r.instance===null){var p=Qs(c.href),g=i.querySelector(er(p));if(g){i=g._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(n.count++,n=Vo.bind(n),i.then(n,n)),r.state.loading|=4,r.instance=g,ve(g);return}g=i.ownerDocument||i,c=Xm(c),(p=yn.get(p))&&Yu(c,p),g=g.createElement("link"),ve(g);var A=g;A._p=new Promise(function(T,D){A.onload=T,A.onerror=D}),Ce(g,"link",c),r.instance=g}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(r,i),(i=r.state.preload)&&(r.state.loading&3)===0&&(n.count++,r=Vo.bind(n),i.addEventListener("load",r),i.addEventListener("error",r))}}var Ku=0;function qv(n,i){return n.stylesheets&&n.count===0&&Xo(n,n.stylesheets),0<n.count||0<n.imgCount?function(r){var c=setTimeout(function(){if(n.stylesheets&&Xo(n,n.stylesheets),n.unsuspend){var g=n.unsuspend;n.unsuspend=null,g()}},6e4+i);0<n.imgBytes&&Ku===0&&(Ku=62500*Tv());var p=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&Xo(n,n.stylesheets),n.unsuspend)){var g=n.unsuspend;n.unsuspend=null,g()}},(n.imgBytes>Ku?50:800)+i);return n.unsuspend=r,function(){n.unsuspend=null,clearTimeout(c),clearTimeout(p)}}:null}function Vo(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Xo(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var qo=null;function Xo(n,i){n.stylesheets=null,n.unsuspend!==null&&(n.count++,qo=new Map,i.forEach(Xv,n),qo=null,Vo.call(n))}function Xv(n,i){if(!(i.state.loading&4)){var r=qo.get(n);if(r)var c=r.get(null);else{r=new Map,qo.set(n,r);for(var p=n.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<p.length;g++){var A=p[g];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(r.set(A.dataset.precedence,A),c=A)}c&&r.set(null,c)}p=i.instance,A=p.getAttribute("data-precedence"),g=r.get(A)||c,g===c&&r.set(null,p),r.set(A,p),this.count++,c=Vo.bind(this),p.addEventListener("load",c),p.addEventListener("error",c),g?g.parentNode.insertBefore(p,g.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(p,n.firstChild)),i.state.loading|=4}}var ir={$$typeof:C,Provider:null,Consumer:null,_currentValue:W,_currentValue2:W,_threadCount:0};function Yv(n,i,r,c,p,g,A,T,D){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Vl(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Vl(0),this.hiddenUpdates=Vl(null),this.identifierPrefix=c,this.onUncaughtError=p,this.onCaughtError=g,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=D,this.incompleteTransitions=new Map}function Wm(n,i,r,c,p,g,A,T,D,z,q,Y){return n=new Yv(n,i,r,A,D,z,q,Y,T),i=1,g===!0&&(i|=24),g=Ze(3,null,null,i),n.current=g,g.stateNode=n,i=Mc(),i.refCount++,n.pooledCache=i,i.refCount++,g.memoizedState={element:c,isDehydrated:r,cache:i},kc(g),n}function Zm(n){return n?(n=Ms,n):Ms}function Jm(n,i,r,c,p,g){p=Zm(p),c.context===null?c.context=p:c.pendingContext=p,c=gi(i),c.payload={element:r},g=g===void 0?null:g,g!==null&&(c.callback=g),r=yi(n,c,i),r!==null&&(He(r,n,i),Ba(r,n,i))}function tg(n,i){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var r=n.retryLane;n.retryLane=r!==0&&r<i?r:i}}function Qu(n,i){tg(n,i),(n=n.alternate)&&tg(n,i)}function eg(n){if(n.tag===13||n.tag===31){var i=qi(n,67108864);i!==null&&He(i,n,67108864),Qu(n,67108864)}}function ng(n){if(n.tag===13||n.tag===31){var i=sn();i=ql(i);var r=qi(n,i);r!==null&&He(r,n,i),Qu(n,i)}}var Yo=!0;function $v(n,i,r,c){var p=O.T;O.T=null;var g=H.p;try{H.p=2,Wu(n,i,r,c)}finally{H.p=g,O.T=p}}function Kv(n,i,r,c){var p=O.T;O.T=null;var g=H.p;try{H.p=8,Wu(n,i,r,c)}finally{H.p=g,O.T=p}}function Wu(n,i,r,c){if(Yo){var p=Zu(c);if(p===null)ju(n,i,c,$o,r),sg(n,c);else if(Wv(p,n,i,r,c))c.stopPropagation();else if(sg(n,c),i&4&&-1<Qv.indexOf(n)){for(;p!==null;){var g=ys(p);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var A=Ui(g.pendingLanes);if(A!==0){var T=g;for(T.pendingLanes|=2,T.entangledLanes|=2;A;){var D=1<<31-Qe(A);T.entanglements[1]|=D,A&=~D}Rn(g),(Lt&6)===0&&(No=$e()+500,Wa(0))}}break;case 31:case 13:T=qi(g,2),T!==null&&He(T,g,2),ko(),Qu(g,2)}if(g=Zu(c),g===null&&ju(n,i,c,$o,r),g===p)break;p=g}p!==null&&c.stopPropagation()}else ju(n,i,c,null,r)}}function Zu(n){return n=tc(n),Ju(n)}var $o=null;function Ju(n){if($o=null,n=gs(n),n!==null){var i=o(n);if(i===null)n=null;else{var r=i.tag;if(r===13){if(n=l(i),n!==null)return n;n=null}else if(r===31){if(n=u(i),n!==null)return n;n=null}else if(r===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null)}}return $o=n,null}function ig(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(By()){case ud:return 2;case hd:return 8;case Pr:case Py:return 32;case dd:return 268435456;default:return 32}default:return 32}}var th=!1,Mi=null,Di=null,Ni=null,sr=new Map,ar=new Map,Ri=[],Qv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function sg(n,i){switch(n){case"focusin":case"focusout":Mi=null;break;case"dragenter":case"dragleave":Di=null;break;case"mouseover":case"mouseout":Ni=null;break;case"pointerover":case"pointerout":sr.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":ar.delete(i.pointerId)}}function rr(n,i,r,c,p,g){return n===null||n.nativeEvent!==g?(n={blockedOn:i,domEventName:r,eventSystemFlags:c,nativeEvent:g,targetContainers:[p]},i!==null&&(i=ys(i),i!==null&&eg(i)),n):(n.eventSystemFlags|=c,i=n.targetContainers,p!==null&&i.indexOf(p)===-1&&i.push(p),n)}function Wv(n,i,r,c,p){switch(i){case"focusin":return Mi=rr(Mi,n,i,r,c,p),!0;case"dragenter":return Di=rr(Di,n,i,r,c,p),!0;case"mouseover":return Ni=rr(Ni,n,i,r,c,p),!0;case"pointerover":var g=p.pointerId;return sr.set(g,rr(sr.get(g)||null,n,i,r,c,p)),!0;case"gotpointercapture":return g=p.pointerId,ar.set(g,rr(ar.get(g)||null,n,i,r,c,p)),!0}return!1}function ag(n){var i=gs(n.target);if(i!==null){var r=o(i);if(r!==null){if(i=r.tag,i===13){if(i=l(r),i!==null){n.blockedOn=i,bd(n.priority,function(){ng(r)});return}}else if(i===31){if(i=u(r),i!==null){n.blockedOn=i,bd(n.priority,function(){ng(r)});return}}else if(i===3&&r.stateNode.current.memoizedState.isDehydrated){n.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Ko(n){if(n.blockedOn!==null)return!1;for(var i=n.targetContainers;0<i.length;){var r=Zu(n.nativeEvent);if(r===null){r=n.nativeEvent;var c=new r.constructor(r.type,r);Jl=c,r.target.dispatchEvent(c),Jl=null}else return i=ys(r),i!==null&&eg(i),n.blockedOn=r,!1;i.shift()}return!0}function rg(n,i,r){Ko(n)&&r.delete(i)}function Zv(){th=!1,Mi!==null&&Ko(Mi)&&(Mi=null),Di!==null&&Ko(Di)&&(Di=null),Ni!==null&&Ko(Ni)&&(Ni=null),sr.forEach(rg),ar.forEach(rg)}function Qo(n,i){n.blockedOn===i&&(n.blockedOn=null,th||(th=!0,h.unstable_scheduleCallback(h.unstable_NormalPriority,Zv)))}var Wo=null;function og(n){Wo!==n&&(Wo=n,h.unstable_scheduleCallback(h.unstable_NormalPriority,function(){Wo===n&&(Wo=null);for(var i=0;i<n.length;i+=3){var r=n[i],c=n[i+1],p=n[i+2];if(typeof c!="function"){if(Ju(c||r)===null)continue;break}var g=ys(r);g!==null&&(n.splice(i,3),i-=3,Zc(g,{pending:!0,data:p,method:r.method,action:c},c,p))}}))}function Zs(n){function i(D){return Qo(D,n)}Mi!==null&&Qo(Mi,n),Di!==null&&Qo(Di,n),Ni!==null&&Qo(Ni,n),sr.forEach(i),ar.forEach(i);for(var r=0;r<Ri.length;r++){var c=Ri[r];c.blockedOn===n&&(c.blockedOn=null)}for(;0<Ri.length&&(r=Ri[0],r.blockedOn===null);)ag(r),r.blockedOn===null&&Ri.shift();if(r=(n.ownerDocument||n).$$reactFormReplay,r!=null)for(c=0;c<r.length;c+=3){var p=r[c],g=r[c+1],A=p[Pe]||null;if(typeof g=="function")A||og(r);else if(A){var T=null;if(g&&g.hasAttribute("formAction")){if(p=g,A=g[Pe]||null)T=A.formAction;else if(Ju(p)!==null)continue}else T=A.action;typeof T=="function"?r[c+1]=T:(r.splice(c,3),c-=3),og(r)}}}function lg(){function n(g){g.canIntercept&&g.info==="react-transition"&&g.intercept({handler:function(){return new Promise(function(A){return p=A})},focusReset:"manual",scroll:"manual"})}function i(){p!==null&&(p(),p=null),c||setTimeout(r,20)}function r(){if(!c&&!navigation.transition){var g=navigation.currentEntry;g&&g.url!=null&&navigation.navigate(g.url,{state:g.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,p=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(r,100),function(){c=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),p!==null&&(p(),p=null)}}}function eh(n){this._internalRoot=n}Zo.prototype.render=eh.prototype.render=function(n){var i=this._internalRoot;if(i===null)throw Error(s(409));var r=i.current,c=sn();Jm(r,c,n,i,null,null)},Zo.prototype.unmount=eh.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var i=n.containerInfo;Jm(n.current,2,null,n,null,null),ko(),i[ms]=null}};function Zo(n){this._internalRoot=n}Zo.prototype.unstable_scheduleHydration=function(n){if(n){var i=yd();n={blockedOn:null,target:n,priority:i};for(var r=0;r<Ri.length&&i!==0&&i<Ri[r].priority;r++);Ri.splice(r,0,n),r===0&&ag(n)}};var cg=t.version;if(cg!=="19.2.4")throw Error(s(527,cg,"19.2.4"));H.findDOMNode=function(n){var i=n._reactInternals;if(i===void 0)throw typeof n.render=="function"?Error(s(188)):(n=Object.keys(n).join(","),Error(s(268,n)));return n=f(i),n=n!==null?m(n):null,n=n===null?null:n.stateNode,n};var Jv={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:O,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Jo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Jo.isDisabled&&Jo.supportsFiber)try{ma=Jo.inject(Jv),Ke=Jo}catch{}}return lr.createRoot=function(n,i){if(!a(n))throw Error(s(299));var r=!1,c="",p=gp,g=yp,A=bp;return i!=null&&(i.unstable_strictMode===!0&&(r=!0),i.identifierPrefix!==void 0&&(c=i.identifierPrefix),i.onUncaughtError!==void 0&&(p=i.onUncaughtError),i.onCaughtError!==void 0&&(g=i.onCaughtError),i.onRecoverableError!==void 0&&(A=i.onRecoverableError)),i=Wm(n,1,!1,null,null,r,c,null,p,g,A,lg),n[ms]=i.current,Pu(n),new eh(i)},lr.hydrateRoot=function(n,i,r){if(!a(n))throw Error(s(299));var c=!1,p="",g=gp,A=yp,T=bp,D=null;return r!=null&&(r.unstable_strictMode===!0&&(c=!0),r.identifierPrefix!==void 0&&(p=r.identifierPrefix),r.onUncaughtError!==void 0&&(g=r.onUncaughtError),r.onCaughtError!==void 0&&(A=r.onCaughtError),r.onRecoverableError!==void 0&&(T=r.onRecoverableError),r.formState!==void 0&&(D=r.formState)),i=Wm(n,1,!0,i,r??null,c,p,D,g,A,T,lg),i.context=Zm(null),r=i.current,c=sn(),c=ql(c),p=gi(c),p.callback=null,yi(r,p,c),r=c,i.current.lanes=r,ya(i,r),Rn(i),n[ms]=i.current,Pu(n),new Zo(i)},lr.version="19.2.4",lr}var Sg;function c1(){if(Sg)return ah.exports;Sg=1;function h(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(h)}catch(t){console.error(t)}}return h(),ah.exports=l1(),ah.exports}var u1=c1();const h1=b0(u1);const v0=(...h)=>h.filter((t,e,s)=>!!t&&t.trim()!==""&&s.indexOf(t)===e).join(" ").trim();const d1=h=>h.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const f1=h=>h.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,e,s)=>s?s.toUpperCase():e.toLowerCase());const wg=h=>{const t=f1(h);return t.charAt(0).toUpperCase()+t.slice(1)};var p1={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const m1=h=>{for(const t in h)if(t.startsWith("aria-")||t==="role"||t==="title")return!0;return!1};const g1=it.forwardRef(({color:h="currentColor",size:t=24,strokeWidth:e=2,absoluteStrokeWidth:s,className:a="",children:o,iconNode:l,...u},d)=>it.createElement("svg",{ref:d,...p1,width:t,height:t,stroke:h,strokeWidth:s?Number(e)*24/Number(t):e,className:v0("lucide",a),...!o&&!m1(u)&&{"aria-hidden":"true"},...u},[...l.map(([f,m])=>it.createElement(f,m)),...Array.isArray(o)?o:[o]]));const Rt=(h,t)=>{const e=it.forwardRef(({className:s,...a},o)=>it.createElement(g1,{ref:o,iconNode:t,className:v0(`lucide-${d1(wg(h))}`,`lucide-${h}`,s),...a}));return e.displayName=wg(h),e};const y1=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],b1=Rt("arrow-left",y1);const v1=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Bi=Rt("book-open",v1);const A1=[["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M15 10H9",key:"o6yqo3"}],["path",{d:"M17 3a2 2 0 0 1 2 2v15a1 1 0 0 1-1.496.868l-4.512-2.578a2 2 0 0 0-1.984 0l-4.512 2.578A1 1 0 0 1 5 20V5a2 2 0 0 1 2-2z",key:"oz39mx"}]],S1=Rt("bookmark-plus",A1);const w1=[["path",{d:"M17 3a2 2 0 0 1 2 2v15a1 1 0 0 1-1.496.868l-4.512-2.578a2 2 0 0 0-1.984 0l-4.512 2.578A1 1 0 0 1 5 20V5a2 2 0 0 1 2-2z",key:"oz39mx"}]],xg=Rt("bookmark",w1);const x1=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],A0=Rt("chart-column",x1);const E1=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],T1=Rt("check",E1);const _1=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],C1=Rt("chevron-left",_1);const M1=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],D1=Rt("chevron-right",M1);const N1=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],R1=Rt("circle-check",N1);const k1=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Uh=Rt("clock",k1);const O1=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],L1=Rt("download",O1);const B1=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],gl=Rt("file-text",B1);const P1=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],j1=Rt("flame",P1);const F1=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],z1=Rt("gauge",F1);const U1=[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]],Ih=Rt("headphones",U1);const I1=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],H1=Rt("house",I1);const G1=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],S0=Rt("loader-circle",G1);const V1=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],q1=Rt("map-pin",V1);const X1=[["path",{d:"m11 7.601-5.994 8.19a1 1 0 0 0 .1 1.298l.817.818a1 1 0 0 0 1.314.087L15.09 12",key:"80a601"}],["path",{d:"M16.5 21.174C15.5 20.5 14.372 20 13 20c-2.058 0-3.928 2.356-6 2-2.072-.356-2.775-3.369-1.5-4.5",key:"j0ngtp"}],["circle",{cx:"16",cy:"7",r:"5",key:"d08jfb"}]],w0=Rt("mic-vocal",X1);const Y1=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],$1=Rt("moon",Y1);const K1=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],x0=Rt("pause",K1);const Q1=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],Hh=Rt("play",Q1);const W1=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Z1=Rt("shield",W1);const J1=[["path",{d:"M17.971 4.285A2 2 0 0 1 21 6v12a2 2 0 0 1-3.029 1.715l-9.997-5.998a2 2 0 0 1-.003-3.432z",key:"15892j"}],["path",{d:"M3 20V4",key:"1ptbpl"}]],tA=Rt("skip-back",J1);const eA=[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]],E0=Rt("skip-forward",eA);const nA=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Eg=Rt("sparkles",nA);const iA=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],sA=Rt("sun",iA);const aA=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],T0=Rt("timer",aA);const rA=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],_0=Rt("trash-2",rA);const oA=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],lA=Rt("upload",oA);const cA=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],uA=Rt("volume-2",cA);const hA=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],dA=Rt("volume-x",hA);const fA=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Tr=Rt("x",fA);const pA=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],mA=Rt("zap",pA),Tg=h=>{let t;const e=new Set,s=(f,m)=>{const y=typeof f=="function"?f(t):f;if(!Object.is(y,t)){const b=t;t=m??(typeof y!="object"||y===null)?y:Object.assign({},t,y),e.forEach(v=>v(t,b))}},a=()=>t,u={setState:s,getState:a,getInitialState:()=>d,subscribe:f=>(e.add(f),()=>e.delete(f))},d=t=h(s,a,u);return u},gA=(h=>h?Tg(h):Tg),yA=h=>h;function bA(h,t=yA){const e=mr.useSyncExternalStore(h.subscribe,mr.useCallback(()=>t(h.getState()),[h,t]),mr.useCallback(()=>t(h.getInitialState()),[h,t]));return mr.useDebugValue(e),e}const _g=h=>{const t=gA(h),e=s=>bA(t,s);return Object.assign(e,t),e},vA=(h=>h?_g(h):_g);function AA(h,t){let e;try{e=h()}catch{return}return{getItem:a=>{var o;const l=d=>d===null?null:JSON.parse(d,void 0),u=(o=e.getItem(a))!=null?o:null;return u instanceof Promise?u.then(l):l(u)},setItem:(a,o)=>e.setItem(a,JSON.stringify(o,void 0)),removeItem:a=>e.removeItem(a)}}const Ah=h=>t=>{try{const e=h(t);return e instanceof Promise?e:{then(s){return Ah(s)(e)},catch(s){return this}}}catch(e){return{then(s){return this},catch(s){return Ah(s)(e)}}}},SA=(h,t)=>(e,s,a)=>{let o={storage:AA(()=>window.localStorage),partialize:x=>x,version:0,merge:(x,E)=>({...E,...x}),...t},l=!1,u=0;const d=new Set,f=new Set;let m=o.storage;if(!m)return h((...x)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),e(...x)},s,a);const y=()=>{const x=o.partialize({...s()});return m.setItem(o.name,{state:x,version:o.version})},b=a.setState;a.setState=(x,E)=>(b(x,E),y());const v=h((...x)=>(e(...x),y()),s,a);a.getInitialState=()=>v;let S;const w=()=>{var x,E;if(!m)return;const M=++u;l=!1,d.forEach(R=>{var k;return R((k=s())!=null?k:v)});const C=((E=o.onRehydrateStorage)==null?void 0:E.call(o,(x=s())!=null?x:v))||void 0;return Ah(m.getItem.bind(m))(o.name).then(R=>{if(R)if(typeof R.version=="number"&&R.version!==o.version){if(o.migrate){const k=o.migrate(R.state,R.version);return k instanceof Promise?k.then(L=>[!0,L]):[!0,k]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,R.state];return[!1,void 0]}).then(R=>{var k;if(M!==u)return;const[L,P]=R;if(S=o.merge(P,(k=s())!=null?k:v),e(S,!0),L)return y()}).then(()=>{M===u&&(C?.(S,void 0),S=s(),l=!0,f.forEach(R=>R(S)))}).catch(R=>{M===u&&C?.(void 0,R)})};return a.persist={setOptions:x=>{o={...o,...x},x.storage&&(m=x.storage)},clearStorage:()=>{m?.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>w(),hasHydrated:()=>l,onHydrate:x=>(d.add(x),()=>{d.delete(x)}),onFinishHydration:x=>(f.add(x),()=>{f.delete(x)})},o.skipHydration||w(),S||v},wA=SA,te=vA(wA((h,t)=>({currentBook:null,books:[],setCurrentBook:e=>h({currentBook:e}),setBooks:e=>h({books:e}),addBook:e=>h(s=>({books:[e,...s.books]})),removeBook:e=>h(s=>({books:s.books.filter(a=>a._id!==e),currentBook:s.currentBook?._id===e?null:s.currentBook})),isPlaying:!1,playbackSpeed:1,currentPage:0,currentPosition:0,currentSentenceIndex:0,totalSentences:0,selectedVoice:null,volume:1,setIsPlaying:e=>h({isPlaying:e}),setPlaybackSpeed:e=>h({playbackSpeed:e}),setCurrentPage:e=>h({currentPage:e}),setCurrentPosition:e=>h({currentPosition:e}),setCurrentSentenceIndex:e=>h({currentSentenceIndex:e}),setTotalSentences:e=>h({totalSentences:e}),setSelectedVoice:e=>h({selectedVoice:e}),setVolume:e=>h({volume:e}),completionPercentage:0,totalListeningTime:0,setCompletionPercentage:e=>h({completionPercentage:e}),incrementListeningTime:e=>h(s=>({totalListeningTime:s.totalListeningTime+e})),bookmarks:[],setBookmarks:e=>h({bookmarks:e}),addBookmark:e=>h(s=>({bookmarks:[...s.bookmarks,{...e,id:Date.now(),createdAt:new Date().toISOString()}]})),removeBookmark:e=>h(s=>({bookmarks:s.bookmarks.filter(a=>a.id!==e)})),sleepTimerMinutes:0,sleepTimerEnd:null,sleepTimerActive:!1,setSleepTimer:e=>h({sleepTimerMinutes:e,sleepTimerEnd:e>0?Date.now()+e*60*1e3:null,sleepTimerActive:e>0}),clearSleepTimer:()=>h({sleepTimerMinutes:0,sleepTimerEnd:null,sleepTimerActive:!1}),stats:{totalBooks:0,completedBooks:0,totalMinutesListened:0,dailyStreak:0,lastListenedDate:null,sessionsThisWeek:[]},updateStats:e=>h(s=>({stats:{...s.stats,...e}})),darkMode:!0,showMiniPlayer:!1,showTextViewer:!0,showBookmarks:!1,showStats:!1,activeView:"home",toggleDarkMode:()=>h(e=>({darkMode:!e.darkMode})),setShowMiniPlayer:e=>h({showMiniPlayer:e}),setShowTextViewer:e=>h({showTextViewer:e}),setShowBookmarks:e=>h({showBookmarks:e}),setShowStats:e=>h({showStats:e}),setActiveView:e=>h({activeView:e}),isUploading:!1,uploadProgress:0,setIsUploading:e=>h({isUploading:e}),setUploadProgress:e=>h({uploadProgress:e}),resetPlayer:()=>h({isPlaying:!1,currentPage:0,currentPosition:0,currentSentenceIndex:0,totalSentences:0,completionPercentage:0})}),{name:"audiolize-storage",partialize:h=>({darkMode:h.darkMode,playbackSpeed:h.playbackSpeed,selectedVoice:h.selectedVoice,volume:h.volume,bookmarks:h.bookmarks,stats:h.stats,totalListeningTime:h.totalListeningTime,currentBook:h.currentBook?{_id:h.currentBook._id,title:h.currentBook.title,author:h.currentBook.author,coverColor:h.currentBook.coverColor,totalPages:h.currentBook.totalPages,wordCount:h.currentBook.wordCount,estimatedDuration:h.currentBook.estimatedDuration}:null,currentPage:h.currentPage,currentPosition:h.currentPosition,currentSentenceIndex:h.currentSentenceIndex,completionPercentage:h.completionPercentage})}));function xA({children:h}){const{darkMode:t,toggleDarkMode:e,activeView:s,setActiveView:a,currentBook:o}=te();return it.useEffect(()=>{document.body.className=t?"dark":"light"},[t]),_.jsxs("div",{className:"min-h-screen flex flex-col",children:[_.jsx("header",{className:"glass sticky top-0 z-40 px-4 sm:px-6 py-3",style:{borderBottom:"1px solid rgba(139,92,246,0.1)"},children:_.jsxs("div",{className:"max-w-6xl mx-auto flex items-center justify-between",children:[_.jsxs("div",{className:"flex items-center gap-2.5 cursor-pointer",onClick:()=>a("home"),children:[_.jsx("div",{className:"w-9 h-9 rounded-xl gradient-bg flex items-center justify-center",children:_.jsx(Ih,{className:"w-5 h-5 text-white"})}),_.jsxs("div",{children:[_.jsx("h1",{className:"text-lg font-bold leading-tight gradient-text",children:"Audiolize"}),_.jsx("p",{className:"text-[10px] text-gray-400 -mt-0.5 hidden sm:block",children:"PDF to Audiobook"})]})]}),_.jsxs("nav",{className:"flex items-center gap-1",children:[_.jsxs("button",{onClick:()=>a("home"),className:`flex items-center gap-1.5 px-3 py-2 rounded-lg text-sm transition-all
                ${s==="home"?"bg-primary-500/20 text-primary-300 font-medium":"hover:bg-white/5"}`,children:[_.jsx(H1,{className:"w-4 h-4"}),_.jsx("span",{className:"hidden sm:inline",children:"Home"})]}),o&&_.jsxs("button",{onClick:()=>a("reader"),className:`flex items-center gap-1.5 px-3 py-2 rounded-lg text-sm transition-all
                  ${s==="reader"?"bg-primary-500/20 text-primary-300 font-medium":"hover:bg-white/5"}`,children:[_.jsx(Bi,{className:"w-4 h-4"}),_.jsx("span",{className:"hidden sm:inline",children:"Reader"})]}),_.jsxs("button",{onClick:()=>a("stats"),className:`flex items-center gap-1.5 px-3 py-2 rounded-lg text-sm transition-all
                ${s==="stats"?"bg-primary-500/20 text-primary-300 font-medium":"hover:bg-white/5"}`,children:[_.jsx(A0,{className:"w-4 h-4"}),_.jsx("span",{className:"hidden sm:inline",children:"Stats"})]}),_.jsx("button",{onClick:e,className:"w-9 h-9 rounded-lg flex items-center justify-center hover:bg-white/10 transition-all ml-1",title:t?"Light mode":"Dark mode",children:t?_.jsx(sA,{className:"w-4 h-4 text-yellow-400"}):_.jsx($1,{className:"w-4 h-4 text-primary-500"})})]})]})}),_.jsx("main",{className:"flex-1 px-4 sm:px-6 py-6",children:_.jsx("div",{className:"max-w-4xl mx-auto",children:h})}),_.jsx("footer",{className:"text-center py-4 text-xs text-gray-500 border-t border-white/5",children:_.jsx("p",{children:"Audiolize  Transform your PDFs into audiobooks "})})]})}function EA({onFileSelect:h}){const[t,e]=it.useState(!1),[s,a]=it.useState(""),o=it.useRef(null),{isUploading:l,uploadProgress:u}=te(),d=it.useCallback(b=>{b.preventDefault(),b.stopPropagation(),e(!0)},[]),f=it.useCallback(b=>{b.preventDefault(),b.stopPropagation(),e(!1)},[]),m=it.useCallback(b=>{b.preventDefault(),b.stopPropagation(),e(!1);const v=b.dataTransfer.files;v.length>0&&v[0].type==="application/pdf"&&(a(v[0].name),h(v[0]))},[h]),y=it.useCallback(b=>{const v=b.target.files[0];v&&(a(v.name),h(v))},[h]);return _.jsxs("div",{className:"w-full max-w-2xl mx-auto",children:[_.jsxs("div",{onDragOver:d,onDragLeave:f,onDrop:m,onClick:()=>o.current?.click(),className:`
          relative overflow-hidden rounded-2xl cursor-pointer
          transition-all duration-300 ease-out
          ${t?"drop-active scale-[1.02]":""}
          ${l?"pointer-events-none":""}
        `,style:{border:`2px dashed ${t?"#8b5cf6":"rgba(139, 92, 246, 0.3)"}`,background:t?"rgba(139, 92, 246, 0.08)":"rgba(139, 92, 246, 0.03)",minHeight:"280px"},children:[_.jsx("div",{className:"absolute inset-0 opacity-20 pointer-events-none",style:{background:"radial-gradient(circle at 30% 50%, rgba(139, 92, 246, 0.15), transparent 50%), radial-gradient(circle at 70% 50%, rgba(236, 72, 153, 0.1), transparent 50%)"}}),_.jsx("div",{className:"relative flex flex-col items-center justify-center p-10 text-center h-full min-h-[280px]",children:l?_.jsxs("div",{className:"slide-up",children:[_.jsx(S0,{className:"w-14 h-14 text-primary-500 animate-spin mb-4"}),_.jsx("p",{className:"text-lg font-semibold mb-2",children:"Processing your PDF..."}),_.jsx("div",{className:"w-64 h-2 bg-surface-200 dark:bg-surface-700 rounded-full overflow-hidden",children:_.jsx("div",{className:"h-full gradient-bg rounded-full transition-all duration-300",style:{width:`${u}%`}})}),_.jsxs("p",{className:"text-sm text-gray-400 mt-2",children:[u,"% complete"]})]}):s&&u===100?_.jsxs("div",{className:"slide-up",children:[_.jsx(R1,{className:"w-14 h-14 text-green-400 mb-4"}),_.jsx("p",{className:"text-lg font-semibold",children:s}),_.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Upload another or start reading"})]}):_.jsxs(_.Fragment,{children:[_.jsx("div",{className:"float-animation mb-6",children:_.jsx("div",{className:"w-20 h-20 rounded-2xl gradient-bg flex items-center justify-center glow-purple",children:_.jsx(lA,{className:"w-9 h-9 text-white"})})}),_.jsx("h3",{className:"text-xl font-bold mb-2",children:"Drop your PDF here"}),_.jsx("p",{className:"text-gray-400 mb-4 max-w-sm",children:"Drag and drop a PDF file, or click to browse. We'll extract the text and prepare it for listening."}),_.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 rounded-xl glass text-sm",children:[_.jsx(gl,{className:"w-4 h-4 text-primary-400"}),_.jsx("span",{children:"Supports files up to 50MB"})]})]})})]}),_.jsx("input",{ref:o,type:"file",accept:".pdf,application/pdf",onChange:y,className:"hidden"})]})}function C0(h,t){return function(){return h.apply(t,arguments)}}const{toString:TA}=Object.prototype,{getPrototypeOf:Gh}=Object,{iterator:wl,toStringTag:M0}=Symbol,xl=(h=>t=>{const e=TA.call(t);return h[e]||(h[e]=e.slice(8,-1).toLowerCase())})(Object.create(null)),Cn=h=>(h=h.toLowerCase(),t=>xl(t)===h),El=h=>t=>typeof t===h,{isArray:fa}=Array,ha=El("undefined");function _r(h){return h!==null&&!ha(h)&&h.constructor!==null&&!ha(h.constructor)&&Xe(h.constructor.isBuffer)&&h.constructor.isBuffer(h)}const D0=Cn("ArrayBuffer");function _A(h){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(h):t=h&&h.buffer&&D0(h.buffer),t}const CA=El("string"),Xe=El("function"),N0=El("number"),Cr=h=>h!==null&&typeof h=="object",MA=h=>h===!0||h===!1,ul=h=>{if(xl(h)!=="object")return!1;const t=Gh(h);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(M0 in h)&&!(wl in h)},DA=h=>{if(!Cr(h)||_r(h))return!1;try{return Object.keys(h).length===0&&Object.getPrototypeOf(h)===Object.prototype}catch{return!1}},NA=Cn("Date"),RA=Cn("File"),kA=Cn("Blob"),OA=Cn("FileList"),LA=h=>Cr(h)&&Xe(h.pipe),BA=h=>{let t;return h&&(typeof FormData=="function"&&h instanceof FormData||Xe(h.append)&&((t=xl(h))==="formdata"||t==="object"&&Xe(h.toString)&&h.toString()==="[object FormData]"))},PA=Cn("URLSearchParams"),[jA,FA,zA,UA]=["ReadableStream","Request","Response","Headers"].map(Cn),IA=h=>h.trim?h.trim():h.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Mr(h,t,{allOwnKeys:e=!1}={}){if(h===null||typeof h>"u")return;let s,a;if(typeof h!="object"&&(h=[h]),fa(h))for(s=0,a=h.length;s<a;s++)t.call(null,h[s],s,h);else{if(_r(h))return;const o=e?Object.getOwnPropertyNames(h):Object.keys(h),l=o.length;let u;for(s=0;s<l;s++)u=o[s],t.call(null,h[u],u,h)}}function R0(h,t){if(_r(h))return null;t=t.toLowerCase();const e=Object.keys(h);let s=e.length,a;for(;s-- >0;)if(a=e[s],t===a.toLowerCase())return a;return null}const ss=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,k0=h=>!ha(h)&&h!==ss;function Sh(){const{caseless:h,skipUndefined:t}=k0(this)&&this||{},e={},s=(a,o)=>{if(o==="__proto__"||o==="constructor"||o==="prototype")return;const l=h&&R0(e,o)||o;ul(e[l])&&ul(a)?e[l]=Sh(e[l],a):ul(a)?e[l]=Sh({},a):fa(a)?e[l]=a.slice():(!t||!ha(a))&&(e[l]=a)};for(let a=0,o=arguments.length;a<o;a++)arguments[a]&&Mr(arguments[a],s);return e}const HA=(h,t,e,{allOwnKeys:s}={})=>(Mr(t,(a,o)=>{e&&Xe(a)?Object.defineProperty(h,o,{value:C0(a,e),writable:!0,enumerable:!0,configurable:!0}):Object.defineProperty(h,o,{value:a,writable:!0,enumerable:!0,configurable:!0})},{allOwnKeys:s}),h),GA=h=>(h.charCodeAt(0)===65279&&(h=h.slice(1)),h),VA=(h,t,e,s)=>{h.prototype=Object.create(t.prototype,s),Object.defineProperty(h.prototype,"constructor",{value:h,writable:!0,enumerable:!1,configurable:!0}),Object.defineProperty(h,"super",{value:t.prototype}),e&&Object.assign(h.prototype,e)},qA=(h,t,e,s)=>{let a,o,l;const u={};if(t=t||{},h==null)return t;do{for(a=Object.getOwnPropertyNames(h),o=a.length;o-- >0;)l=a[o],(!s||s(l,h,t))&&!u[l]&&(t[l]=h[l],u[l]=!0);h=e!==!1&&Gh(h)}while(h&&(!e||e(h,t))&&h!==Object.prototype);return t},XA=(h,t,e)=>{h=String(h),(e===void 0||e>h.length)&&(e=h.length),e-=t.length;const s=h.indexOf(t,e);return s!==-1&&s===e},YA=h=>{if(!h)return null;if(fa(h))return h;let t=h.length;if(!N0(t))return null;const e=new Array(t);for(;t-- >0;)e[t]=h[t];return e},$A=(h=>t=>h&&t instanceof h)(typeof Uint8Array<"u"&&Gh(Uint8Array)),KA=(h,t)=>{const s=(h&&h[wl]).call(h);let a;for(;(a=s.next())&&!a.done;){const o=a.value;t.call(h,o[0],o[1])}},QA=(h,t)=>{let e;const s=[];for(;(e=h.exec(t))!==null;)s.push(e);return s},WA=Cn("HTMLFormElement"),ZA=h=>h.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,s,a){return s.toUpperCase()+a}),Cg=(({hasOwnProperty:h})=>(t,e)=>h.call(t,e))(Object.prototype),JA=Cn("RegExp"),O0=(h,t)=>{const e=Object.getOwnPropertyDescriptors(h),s={};Mr(e,(a,o)=>{let l;(l=t(a,o,h))!==!1&&(s[o]=l||a)}),Object.defineProperties(h,s)},tS=h=>{O0(h,(t,e)=>{if(Xe(h)&&["arguments","caller","callee"].indexOf(e)!==-1)return!1;const s=h[e];if(Xe(s)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+e+"'")})}})},eS=(h,t)=>{const e={},s=a=>{a.forEach(o=>{e[o]=!0})};return fa(h)?s(h):s(String(h).split(t)),e},nS=()=>{},iS=(h,t)=>h!=null&&Number.isFinite(h=+h)?h:t;function sS(h){return!!(h&&Xe(h.append)&&h[M0]==="FormData"&&h[wl])}const aS=h=>{const t=new Array(10),e=(s,a)=>{if(Cr(s)){if(t.indexOf(s)>=0)return;if(_r(s))return s;if(!("toJSON"in s)){t[a]=s;const o=fa(s)?[]:{};return Mr(s,(l,u)=>{const d=e(l,a+1);!ha(d)&&(o[u]=d)}),t[a]=void 0,o}}return s};return e(h,0)},rS=Cn("AsyncFunction"),oS=h=>h&&(Cr(h)||Xe(h))&&Xe(h.then)&&Xe(h.catch),L0=((h,t)=>h?setImmediate:t?((e,s)=>(ss.addEventListener("message",({source:a,data:o})=>{a===ss&&o===e&&s.length&&s.shift()()},!1),a=>{s.push(a),ss.postMessage(e,"*")}))(`axios@${Math.random()}`,[]):e=>setTimeout(e))(typeof setImmediate=="function",Xe(ss.postMessage)),lS=typeof queueMicrotask<"u"?queueMicrotask.bind(ss):typeof process<"u"&&process.nextTick||L0,cS=h=>h!=null&&Xe(h[wl]),G={isArray:fa,isArrayBuffer:D0,isBuffer:_r,isFormData:BA,isArrayBufferView:_A,isString:CA,isNumber:N0,isBoolean:MA,isObject:Cr,isPlainObject:ul,isEmptyObject:DA,isReadableStream:jA,isRequest:FA,isResponse:zA,isHeaders:UA,isUndefined:ha,isDate:NA,isFile:RA,isBlob:kA,isRegExp:JA,isFunction:Xe,isStream:LA,isURLSearchParams:PA,isTypedArray:$A,isFileList:OA,forEach:Mr,merge:Sh,extend:HA,trim:IA,stripBOM:GA,inherits:VA,toFlatObject:qA,kindOf:xl,kindOfTest:Cn,endsWith:XA,toArray:YA,forEachEntry:KA,matchAll:QA,isHTMLForm:WA,hasOwnProperty:Cg,hasOwnProp:Cg,reduceDescriptors:O0,freezeMethods:tS,toObjectSet:eS,toCamelCase:ZA,noop:nS,toFiniteNumber:iS,findKey:R0,global:ss,isContextDefined:k0,isSpecCompliantForm:sS,toJSONObject:aS,isAsyncFn:rS,isThenable:oS,setImmediate:L0,asap:lS,isIterable:cS};let mt=class B0 extends Error{static from(t,e,s,a,o,l){const u=new B0(t.message,e||t.code,s,a,o);return u.cause=t,u.name=t.name,l&&Object.assign(u,l),u}constructor(t,e,s,a,o){super(t),this.name="AxiosError",this.isAxiosError=!0,e&&(this.code=e),s&&(this.config=s),a&&(this.request=a),o&&(this.response=o,this.status=o.status)}toJSON(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:G.toJSONObject(this.config),code:this.code,status:this.status}}};mt.ERR_BAD_OPTION_VALUE="ERR_BAD_OPTION_VALUE";mt.ERR_BAD_OPTION="ERR_BAD_OPTION";mt.ECONNABORTED="ECONNABORTED";mt.ETIMEDOUT="ETIMEDOUT";mt.ERR_NETWORK="ERR_NETWORK";mt.ERR_FR_TOO_MANY_REDIRECTS="ERR_FR_TOO_MANY_REDIRECTS";mt.ERR_DEPRECATED="ERR_DEPRECATED";mt.ERR_BAD_RESPONSE="ERR_BAD_RESPONSE";mt.ERR_BAD_REQUEST="ERR_BAD_REQUEST";mt.ERR_CANCELED="ERR_CANCELED";mt.ERR_NOT_SUPPORT="ERR_NOT_SUPPORT";mt.ERR_INVALID_URL="ERR_INVALID_URL";const uS=null;function wh(h){return G.isPlainObject(h)||G.isArray(h)}function P0(h){return G.endsWith(h,"[]")?h.slice(0,-2):h}function Mg(h,t,e){return h?h.concat(t).map(function(a,o){return a=P0(a),!e&&o?"["+a+"]":a}).join(e?".":""):t}function hS(h){return G.isArray(h)&&!h.some(wh)}const dS=G.toFlatObject(G,{},null,function(t){return/^is[A-Z]/.test(t)});function Tl(h,t,e){if(!G.isObject(h))throw new TypeError("target must be an object");t=t||new FormData,e=G.toFlatObject(e,{metaTokens:!0,dots:!1,indexes:!1},!1,function(w,x){return!G.isUndefined(x[w])});const s=e.metaTokens,a=e.visitor||m,o=e.dots,l=e.indexes,d=(e.Blob||typeof Blob<"u"&&Blob)&&G.isSpecCompliantForm(t);if(!G.isFunction(a))throw new TypeError("visitor must be a function");function f(S){if(S===null)return"";if(G.isDate(S))return S.toISOString();if(G.isBoolean(S))return S.toString();if(!d&&G.isBlob(S))throw new mt("Blob is not supported. Use a Buffer instead.");return G.isArrayBuffer(S)||G.isTypedArray(S)?d&&typeof Blob=="function"?new Blob([S]):Buffer.from(S):S}function m(S,w,x){let E=S;if(S&&!x&&typeof S=="object"){if(G.endsWith(w,"{}"))w=s?w:w.slice(0,-2),S=JSON.stringify(S);else if(G.isArray(S)&&hS(S)||(G.isFileList(S)||G.endsWith(w,"[]"))&&(E=G.toArray(S)))return w=P0(w),E.forEach(function(C,R){!(G.isUndefined(C)||C===null)&&t.append(l===!0?Mg([w],R,o):l===null?w:w+"[]",f(C))}),!1}return wh(S)?!0:(t.append(Mg(x,w,o),f(S)),!1)}const y=[],b=Object.assign(dS,{defaultVisitor:m,convertValue:f,isVisitable:wh});function v(S,w){if(!G.isUndefined(S)){if(y.indexOf(S)!==-1)throw Error("Circular reference detected in "+w.join("."));y.push(S),G.forEach(S,function(E,M){(!(G.isUndefined(E)||E===null)&&a.call(t,E,G.isString(M)?M.trim():M,w,b))===!0&&v(E,w?w.concat(M):[M])}),y.pop()}}if(!G.isObject(h))throw new TypeError("data must be an object");return v(h),t}function Dg(h){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(h).replace(/[!'()~]|%20|%00/g,function(s){return t[s]})}function Vh(h,t){this._pairs=[],h&&Tl(h,this,t)}const j0=Vh.prototype;j0.append=function(t,e){this._pairs.push([t,e])};j0.toString=function(t){const e=t?function(s){return t.call(this,s,Dg)}:Dg;return this._pairs.map(function(a){return e(a[0])+"="+e(a[1])},"").join("&")};function fS(h){return encodeURIComponent(h).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function F0(h,t,e){if(!t)return h;const s=e&&e.encode||fS,a=G.isFunction(e)?{serialize:e}:e,o=a&&a.serialize;let l;if(o?l=o(t,a):l=G.isURLSearchParams(t)?t.toString():new Vh(t,a).toString(s),l){const u=h.indexOf("#");u!==-1&&(h=h.slice(0,u)),h+=(h.indexOf("?")===-1?"?":"&")+l}return h}class Ng{constructor(){this.handlers=[]}use(t,e,s){return this.handlers.push({fulfilled:t,rejected:e,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){G.forEach(this.handlers,function(s){s!==null&&t(s)})}}const qh={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1,legacyInterceptorReqResOrdering:!0},pS=typeof URLSearchParams<"u"?URLSearchParams:Vh,mS=typeof FormData<"u"?FormData:null,gS=typeof Blob<"u"?Blob:null,yS={isBrowser:!0,classes:{URLSearchParams:pS,FormData:mS,Blob:gS},protocols:["http","https","file","blob","url","data"]},Xh=typeof window<"u"&&typeof document<"u",xh=typeof navigator=="object"&&navigator||void 0,bS=Xh&&(!xh||["ReactNative","NativeScript","NS"].indexOf(xh.product)<0),vS=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",AS=Xh&&window.location.href||"http://localhost",SS=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Xh,hasStandardBrowserEnv:bS,hasStandardBrowserWebWorkerEnv:vS,navigator:xh,origin:AS},Symbol.toStringTag,{value:"Module"})),ke={...SS,...yS};function wS(h,t){return Tl(h,new ke.classes.URLSearchParams,{visitor:function(e,s,a,o){return ke.isNode&&G.isBuffer(e)?(this.append(s,e.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)},...t})}function xS(h){return G.matchAll(/\w+|\[(\w*)]/g,h).map(t=>t[0]==="[]"?"":t[1]||t[0])}function ES(h){const t={},e=Object.keys(h);let s;const a=e.length;let o;for(s=0;s<a;s++)o=e[s],t[o]=h[o];return t}function z0(h){function t(e,s,a,o){let l=e[o++];if(l==="__proto__")return!0;const u=Number.isFinite(+l),d=o>=e.length;return l=!l&&G.isArray(a)?a.length:l,d?(G.hasOwnProp(a,l)?a[l]=[a[l],s]:a[l]=s,!u):((!a[l]||!G.isObject(a[l]))&&(a[l]=[]),t(e,s,a[l],o)&&G.isArray(a[l])&&(a[l]=ES(a[l])),!u)}if(G.isFormData(h)&&G.isFunction(h.entries)){const e={};return G.forEachEntry(h,(s,a)=>{t(xS(s),a,e,0)}),e}return null}function TS(h,t,e){if(G.isString(h))try{return(t||JSON.parse)(h),G.trim(h)}catch(s){if(s.name!=="SyntaxError")throw s}return(e||JSON.stringify)(h)}const Dr={transitional:qh,adapter:["xhr","http","fetch"],transformRequest:[function(t,e){const s=e.getContentType()||"",a=s.indexOf("application/json")>-1,o=G.isObject(t);if(o&&G.isHTMLForm(t)&&(t=new FormData(t)),G.isFormData(t))return a?JSON.stringify(z0(t)):t;if(G.isArrayBuffer(t)||G.isBuffer(t)||G.isStream(t)||G.isFile(t)||G.isBlob(t)||G.isReadableStream(t))return t;if(G.isArrayBufferView(t))return t.buffer;if(G.isURLSearchParams(t))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(o){if(s.indexOf("application/x-www-form-urlencoded")>-1)return wS(t,this.formSerializer).toString();if((u=G.isFileList(t))||s.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return Tl(u?{"files[]":t}:t,d&&new d,this.formSerializer)}}return o||a?(e.setContentType("application/json",!1),TS(t)):t}],transformResponse:[function(t){const e=this.transitional||Dr.transitional,s=e&&e.forcedJSONParsing,a=this.responseType==="json";if(G.isResponse(t)||G.isReadableStream(t))return t;if(t&&G.isString(t)&&(s&&!this.responseType||a)){const l=!(e&&e.silentJSONParsing)&&a;try{return JSON.parse(t,this.parseReviver)}catch(u){if(l)throw u.name==="SyntaxError"?mt.from(u,mt.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ke.classes.FormData,Blob:ke.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};G.forEach(["delete","get","head","post","put","patch"],h=>{Dr.headers[h]={}});const _S=G.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),CS=h=>{const t={};let e,s,a;return h&&h.split(`
`).forEach(function(l){a=l.indexOf(":"),e=l.substring(0,a).trim().toLowerCase(),s=l.substring(a+1).trim(),!(!e||t[e]&&_S[e])&&(e==="set-cookie"?t[e]?t[e].push(s):t[e]=[s]:t[e]=t[e]?t[e]+", "+s:s)}),t},Rg=Symbol("internals");function cr(h){return h&&String(h).trim().toLowerCase()}function hl(h){return h===!1||h==null?h:G.isArray(h)?h.map(hl):String(h)}function MS(h){const t=Object.create(null),e=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=e.exec(h);)t[s[1]]=s[2];return t}const DS=h=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(h.trim());function ch(h,t,e,s,a){if(G.isFunction(s))return s.call(this,t,e);if(a&&(t=e),!!G.isString(t)){if(G.isString(s))return t.indexOf(s)!==-1;if(G.isRegExp(s))return s.test(t)}}function NS(h){return h.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,e,s)=>e.toUpperCase()+s)}function RS(h,t){const e=G.toCamelCase(" "+t);["get","set","has"].forEach(s=>{Object.defineProperty(h,s+e,{value:function(a,o,l){return this[s].call(this,t,a,o,l)},configurable:!0})})}let Ye=class{constructor(t){t&&this.set(t)}set(t,e,s){const a=this;function o(u,d,f){const m=cr(d);if(!m)throw new Error("header name must be a non-empty string");const y=G.findKey(a,m);(!y||a[y]===void 0||f===!0||f===void 0&&a[y]!==!1)&&(a[y||d]=hl(u))}const l=(u,d)=>G.forEach(u,(f,m)=>o(f,m,d));if(G.isPlainObject(t)||t instanceof this.constructor)l(t,e);else if(G.isString(t)&&(t=t.trim())&&!DS(t))l(CS(t),e);else if(G.isObject(t)&&G.isIterable(t)){let u={},d,f;for(const m of t){if(!G.isArray(m))throw TypeError("Object iterator must return a key-value pair");u[f=m[0]]=(d=u[f])?G.isArray(d)?[...d,m[1]]:[d,m[1]]:m[1]}l(u,e)}else t!=null&&o(e,t,s);return this}get(t,e){if(t=cr(t),t){const s=G.findKey(this,t);if(s){const a=this[s];if(!e)return a;if(e===!0)return MS(a);if(G.isFunction(e))return e.call(this,a,s);if(G.isRegExp(e))return e.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,e){if(t=cr(t),t){const s=G.findKey(this,t);return!!(s&&this[s]!==void 0&&(!e||ch(this,this[s],s,e)))}return!1}delete(t,e){const s=this;let a=!1;function o(l){if(l=cr(l),l){const u=G.findKey(s,l);u&&(!e||ch(s,s[u],u,e))&&(delete s[u],a=!0)}}return G.isArray(t)?t.forEach(o):o(t),a}clear(t){const e=Object.keys(this);let s=e.length,a=!1;for(;s--;){const o=e[s];(!t||ch(this,this[o],o,t,!0))&&(delete this[o],a=!0)}return a}normalize(t){const e=this,s={};return G.forEach(this,(a,o)=>{const l=G.findKey(s,o);if(l){e[l]=hl(a),delete e[o];return}const u=t?NS(o):String(o).trim();u!==o&&delete e[o],e[u]=hl(a),s[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const e=Object.create(null);return G.forEach(this,(s,a)=>{s!=null&&s!==!1&&(e[a]=t&&G.isArray(s)?s.join(", "):s)}),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,e])=>t+": "+e).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...e){const s=new this(t);return e.forEach(a=>s.set(a)),s}static accessor(t){const s=(this[Rg]=this[Rg]={accessors:{}}).accessors,a=this.prototype;function o(l){const u=cr(l);s[u]||(RS(a,l),s[u]=!0)}return G.isArray(t)?t.forEach(o):o(t),this}};Ye.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);G.reduceDescriptors(Ye.prototype,({value:h},t)=>{let e=t[0].toUpperCase()+t.slice(1);return{get:()=>h,set(s){this[e]=s}}});G.freezeMethods(Ye);function uh(h,t){const e=this||Dr,s=t||e,a=Ye.from(s.headers);let o=s.data;return G.forEach(h,function(u){o=u.call(e,o,a.normalize(),t?t.status:void 0)}),a.normalize(),o}function U0(h){return!!(h&&h.__CANCEL__)}let Nr=class extends mt{constructor(t,e,s){super(t??"canceled",mt.ERR_CANCELED,e,s),this.name="CanceledError",this.__CANCEL__=!0}};function I0(h,t,e){const s=e.config.validateStatus;!e.status||!s||s(e.status)?h(e):t(new mt("Request failed with status code "+e.status,[mt.ERR_BAD_REQUEST,mt.ERR_BAD_RESPONSE][Math.floor(e.status/100)-4],e.config,e.request,e))}function kS(h){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(h);return t&&t[1]||""}function OS(h,t){h=h||10;const e=new Array(h),s=new Array(h);let a=0,o=0,l;return t=t!==void 0?t:1e3,function(d){const f=Date.now(),m=s[o];l||(l=f),e[a]=d,s[a]=f;let y=o,b=0;for(;y!==a;)b+=e[y++],y=y%h;if(a=(a+1)%h,a===o&&(o=(o+1)%h),f-l<t)return;const v=m&&f-m;return v?Math.round(b*1e3/v):void 0}}function LS(h,t){let e=0,s=1e3/t,a,o;const l=(f,m=Date.now())=>{e=m,a=null,o&&(clearTimeout(o),o=null),h(...f)};return[(...f)=>{const m=Date.now(),y=m-e;y>=s?l(f,m):(a=f,o||(o=setTimeout(()=>{o=null,l(a)},s-y)))},()=>a&&l(a)]}const yl=(h,t,e=3)=>{let s=0;const a=OS(50,250);return LS(o=>{const l=o.loaded,u=o.lengthComputable?o.total:void 0,d=l-s,f=a(d),m=l<=u;s=l;const y={loaded:l,total:u,progress:u?l/u:void 0,bytes:d,rate:f||void 0,estimated:f&&u&&m?(u-l)/f:void 0,event:o,lengthComputable:u!=null,[t?"download":"upload"]:!0};h(y)},e)},kg=(h,t)=>{const e=h!=null;return[s=>t[0]({lengthComputable:e,total:h,loaded:s}),t[1]]},Og=h=>(...t)=>G.asap(()=>h(...t)),BS=ke.hasStandardBrowserEnv?((h,t)=>e=>(e=new URL(e,ke.origin),h.protocol===e.protocol&&h.host===e.host&&(t||h.port===e.port)))(new URL(ke.origin),ke.navigator&&/(msie|trident)/i.test(ke.navigator.userAgent)):()=>!0,PS=ke.hasStandardBrowserEnv?{write(h,t,e,s,a,o,l){if(typeof document>"u")return;const u=[`${h}=${encodeURIComponent(t)}`];G.isNumber(e)&&u.push(`expires=${new Date(e).toUTCString()}`),G.isString(s)&&u.push(`path=${s}`),G.isString(a)&&u.push(`domain=${a}`),o===!0&&u.push("secure"),G.isString(l)&&u.push(`SameSite=${l}`),document.cookie=u.join("; ")},read(h){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+h+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(h){this.write(h,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function jS(h){return typeof h!="string"?!1:/^([a-z][a-z\d+\-.]*:)?\/\//i.test(h)}function FS(h,t){return t?h.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):h}function H0(h,t,e){let s=!jS(t);return h&&(s||e==!1)?FS(h,t):t}const Lg=h=>h instanceof Ye?{...h}:h;function us(h,t){t=t||{};const e={};function s(f,m,y,b){return G.isPlainObject(f)&&G.isPlainObject(m)?G.merge.call({caseless:b},f,m):G.isPlainObject(m)?G.merge({},m):G.isArray(m)?m.slice():m}function a(f,m,y,b){if(G.isUndefined(m)){if(!G.isUndefined(f))return s(void 0,f,y,b)}else return s(f,m,y,b)}function o(f,m){if(!G.isUndefined(m))return s(void 0,m)}function l(f,m){if(G.isUndefined(m)){if(!G.isUndefined(f))return s(void 0,f)}else return s(void 0,m)}function u(f,m,y){if(y in t)return s(f,m);if(y in h)return s(void 0,f)}const d={url:o,method:o,data:o,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:u,headers:(f,m,y)=>a(Lg(f),Lg(m),y,!0)};return G.forEach(Object.keys({...h,...t}),function(m){if(m==="__proto__"||m==="constructor"||m==="prototype")return;const y=G.hasOwnProp(d,m)?d[m]:a,b=y(h[m],t[m],m);G.isUndefined(b)&&y!==u||(e[m]=b)}),e}const G0=h=>{const t=us({},h);let{data:e,withXSRFToken:s,xsrfHeaderName:a,xsrfCookieName:o,headers:l,auth:u}=t;if(t.headers=l=Ye.from(l),t.url=F0(H0(t.baseURL,t.url,t.allowAbsoluteUrls),h.params,h.paramsSerializer),u&&l.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):""))),G.isFormData(e)){if(ke.hasStandardBrowserEnv||ke.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(G.isFunction(e.getHeaders)){const d=e.getHeaders(),f=["content-type","content-length"];Object.entries(d).forEach(([m,y])=>{f.includes(m.toLowerCase())&&l.set(m,y)})}}if(ke.hasStandardBrowserEnv&&(s&&G.isFunction(s)&&(s=s(t)),s||s!==!1&&BS(t.url))){const d=a&&o&&PS.read(o);d&&l.set(a,d)}return t},zS=typeof XMLHttpRequest<"u",US=zS&&function(h){return new Promise(function(e,s){const a=G0(h);let o=a.data;const l=Ye.from(a.headers).normalize();let{responseType:u,onUploadProgress:d,onDownloadProgress:f}=a,m,y,b,v,S;function w(){v&&v(),S&&S(),a.cancelToken&&a.cancelToken.unsubscribe(m),a.signal&&a.signal.removeEventListener("abort",m)}let x=new XMLHttpRequest;x.open(a.method.toUpperCase(),a.url,!0),x.timeout=a.timeout;function E(){if(!x)return;const C=Ye.from("getAllResponseHeaders"in x&&x.getAllResponseHeaders()),k={data:!u||u==="text"||u==="json"?x.responseText:x.response,status:x.status,statusText:x.statusText,headers:C,config:h,request:x};I0(function(P){e(P),w()},function(P){s(P),w()},k),x=null}"onloadend"in x?x.onloadend=E:x.onreadystatechange=function(){!x||x.readyState!==4||x.status===0&&!(x.responseURL&&x.responseURL.indexOf("file:")===0)||setTimeout(E)},x.onabort=function(){x&&(s(new mt("Request aborted",mt.ECONNABORTED,h,x)),x=null)},x.onerror=function(R){const k=R&&R.message?R.message:"Network Error",L=new mt(k,mt.ERR_NETWORK,h,x);L.event=R||null,s(L),x=null},x.ontimeout=function(){let R=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const k=a.transitional||qh;a.timeoutErrorMessage&&(R=a.timeoutErrorMessage),s(new mt(R,k.clarifyTimeoutError?mt.ETIMEDOUT:mt.ECONNABORTED,h,x)),x=null},o===void 0&&l.setContentType(null),"setRequestHeader"in x&&G.forEach(l.toJSON(),function(R,k){x.setRequestHeader(k,R)}),G.isUndefined(a.withCredentials)||(x.withCredentials=!!a.withCredentials),u&&u!=="json"&&(x.responseType=a.responseType),f&&([b,S]=yl(f,!0),x.addEventListener("progress",b)),d&&x.upload&&([y,v]=yl(d),x.upload.addEventListener("progress",y),x.upload.addEventListener("loadend",v)),(a.cancelToken||a.signal)&&(m=C=>{x&&(s(!C||C.type?new Nr(null,h,x):C),x.abort(),x=null)},a.cancelToken&&a.cancelToken.subscribe(m),a.signal&&(a.signal.aborted?m():a.signal.addEventListener("abort",m)));const M=kS(a.url);if(M&&ke.protocols.indexOf(M)===-1){s(new mt("Unsupported protocol "+M+":",mt.ERR_BAD_REQUEST,h));return}x.send(o||null)})},IS=(h,t)=>{const{length:e}=h=h?h.filter(Boolean):[];if(t||e){let s=new AbortController,a;const o=function(f){if(!a){a=!0,u();const m=f instanceof Error?f:this.reason;s.abort(m instanceof mt?m:new Nr(m instanceof Error?m.message:m))}};let l=t&&setTimeout(()=>{l=null,o(new mt(`timeout of ${t}ms exceeded`,mt.ETIMEDOUT))},t);const u=()=>{h&&(l&&clearTimeout(l),l=null,h.forEach(f=>{f.unsubscribe?f.unsubscribe(o):f.removeEventListener("abort",o)}),h=null)};h.forEach(f=>f.addEventListener("abort",o));const{signal:d}=s;return d.unsubscribe=()=>G.asap(u),d}},HS=function*(h,t){let e=h.byteLength;if(e<t){yield h;return}let s=0,a;for(;s<e;)a=s+t,yield h.slice(s,a),s=a},GS=async function*(h,t){for await(const e of VS(h))yield*HS(e,t)},VS=async function*(h){if(h[Symbol.asyncIterator]){yield*h;return}const t=h.getReader();try{for(;;){const{done:e,value:s}=await t.read();if(e)break;yield s}}finally{await t.cancel()}},Bg=(h,t,e,s)=>{const a=GS(h,t);let o=0,l,u=d=>{l||(l=!0,s&&s(d))};return new ReadableStream({async pull(d){try{const{done:f,value:m}=await a.next();if(f){u(),d.close();return}let y=m.byteLength;if(e){let b=o+=y;e(b)}d.enqueue(new Uint8Array(m))}catch(f){throw u(f),f}},cancel(d){return u(d),a.return()}},{highWaterMark:2})},Pg=64*1024,{isFunction:tl}=G,qS=(({Request:h,Response:t})=>({Request:h,Response:t}))(G.global),{ReadableStream:jg,TextEncoder:Fg}=G.global,zg=(h,...t)=>{try{return!!h(...t)}catch{return!1}},XS=h=>{h=G.merge.call({skipUndefined:!0},qS,h);const{fetch:t,Request:e,Response:s}=h,a=t?tl(t):typeof fetch=="function",o=tl(e),l=tl(s);if(!a)return!1;const u=a&&tl(jg),d=a&&(typeof Fg=="function"?(S=>w=>S.encode(w))(new Fg):async S=>new Uint8Array(await new e(S).arrayBuffer())),f=o&&u&&zg(()=>{let S=!1;const w=new e(ke.origin,{body:new jg,method:"POST",get duplex(){return S=!0,"half"}}).headers.has("Content-Type");return S&&!w}),m=l&&u&&zg(()=>G.isReadableStream(new s("").body)),y={stream:m&&(S=>S.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(S=>{!y[S]&&(y[S]=(w,x)=>{let E=w&&w[S];if(E)return E.call(w);throw new mt(`Response type '${S}' is not supported`,mt.ERR_NOT_SUPPORT,x)})});const b=async S=>{if(S==null)return 0;if(G.isBlob(S))return S.size;if(G.isSpecCompliantForm(S))return(await new e(ke.origin,{method:"POST",body:S}).arrayBuffer()).byteLength;if(G.isArrayBufferView(S)||G.isArrayBuffer(S))return S.byteLength;if(G.isURLSearchParams(S)&&(S=S+""),G.isString(S))return(await d(S)).byteLength},v=async(S,w)=>{const x=G.toFiniteNumber(S.getContentLength());return x??b(w)};return async S=>{let{url:w,method:x,data:E,signal:M,cancelToken:C,timeout:R,onDownloadProgress:k,onUploadProgress:L,responseType:P,headers:$,withCredentials:K="same-origin",fetchOptions:J}=G0(S),Z=t||fetch;P=P?(P+"").toLowerCase():"text";let ht=IS([M,C&&C.toAbortSignal()],R),St=null;const ot=ht&&ht.unsubscribe&&(()=>{ht.unsubscribe()});let et;try{if(L&&f&&x!=="get"&&x!=="head"&&(et=await v($,E))!==0){let N=new e(w,{method:"POST",body:E,duplex:"half"}),I;if(G.isFormData(E)&&(I=N.headers.get("content-type"))&&$.setContentType(I),N.body){const[Q,tt]=kg(et,yl(Og(L)));E=Bg(N.body,Pg,Q,tt)}}G.isString(K)||(K=K?"include":"omit");const O=o&&"credentials"in e.prototype,H={...J,signal:ht,method:x.toUpperCase(),headers:$.normalize().toJSON(),body:E,duplex:"half",credentials:O?K:void 0};St=o&&new e(w,H);let W=await(o?Z(St,J):Z(w,H));const pt=m&&(P==="stream"||P==="response");if(m&&(k||pt&&ot)){const N={};["status","statusText","headers"].forEach(ut=>{N[ut]=W[ut]});const I=G.toFiniteNumber(W.headers.get("content-length")),[Q,tt]=k&&kg(I,yl(Og(k),!0))||[];W=new s(Bg(W.body,Pg,Q,()=>{tt&&tt(),ot&&ot()}),N)}P=P||"text";let Et=await y[G.findKey(y,P)||"text"](W,S);return!pt&&ot&&ot(),await new Promise((N,I)=>{I0(N,I,{data:Et,headers:Ye.from(W.headers),status:W.status,statusText:W.statusText,config:S,request:St})})}catch(O){throw ot&&ot(),O&&O.name==="TypeError"&&/Load failed|fetch/i.test(O.message)?Object.assign(new mt("Network Error",mt.ERR_NETWORK,S,St,O&&O.response),{cause:O.cause||O}):mt.from(O,O&&O.code,S,St,O&&O.response)}}},YS=new Map,V0=h=>{let t=h&&h.env||{};const{fetch:e,Request:s,Response:a}=t,o=[s,a,e];let l=o.length,u=l,d,f,m=YS;for(;u--;)d=o[u],f=m.get(d),f===void 0&&m.set(d,f=u?new Map:XS(t)),m=f;return f};V0();const Yh={http:uS,xhr:US,fetch:{get:V0}};G.forEach(Yh,(h,t)=>{if(h){try{Object.defineProperty(h,"name",{value:t})}catch{}Object.defineProperty(h,"adapterName",{value:t})}});const Ug=h=>`- ${h}`,$S=h=>G.isFunction(h)||h===null||h===!1;function KS(h,t){h=G.isArray(h)?h:[h];const{length:e}=h;let s,a;const o={};for(let l=0;l<e;l++){s=h[l];let u;if(a=s,!$S(s)&&(a=Yh[(u=String(s)).toLowerCase()],a===void 0))throw new mt(`Unknown adapter '${u}'`);if(a&&(G.isFunction(a)||(a=a.get(t))))break;o[u||"#"+l]=a}if(!a){const l=Object.entries(o).map(([d,f])=>`adapter ${d} `+(f===!1?"is not supported by the environment":"is not available in the build"));let u=e?l.length>1?`since :
`+l.map(Ug).join(`
`):" "+Ug(l[0]):"as no adapter specified";throw new mt("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return a}const q0={getAdapter:KS,adapters:Yh};function hh(h){if(h.cancelToken&&h.cancelToken.throwIfRequested(),h.signal&&h.signal.aborted)throw new Nr(null,h)}function Ig(h){return hh(h),h.headers=Ye.from(h.headers),h.data=uh.call(h,h.transformRequest),["post","put","patch"].indexOf(h.method)!==-1&&h.headers.setContentType("application/x-www-form-urlencoded",!1),q0.getAdapter(h.adapter||Dr.adapter,h)(h).then(function(s){return hh(h),s.data=uh.call(h,h.transformResponse,s),s.headers=Ye.from(s.headers),s},function(s){return U0(s)||(hh(h),s&&s.response&&(s.response.data=uh.call(h,h.transformResponse,s.response),s.response.headers=Ye.from(s.response.headers))),Promise.reject(s)})}const X0="1.13.5",_l={};["object","boolean","number","function","string","symbol"].forEach((h,t)=>{_l[h]=function(s){return typeof s===h||"a"+(t<1?"n ":" ")+h}});const Hg={};_l.transitional=function(t,e,s){function a(o,l){return"[Axios v"+X0+"] Transitional option '"+o+"'"+l+(s?". "+s:"")}return(o,l,u)=>{if(t===!1)throw new mt(a(l," has been removed"+(e?" in "+e:"")),mt.ERR_DEPRECATED);return e&&!Hg[l]&&(Hg[l]=!0,console.warn(a(l," has been deprecated since v"+e+" and will be removed in the near future"))),t?t(o,l,u):!0}};_l.spelling=function(t){return(e,s)=>(console.warn(`${s} is likely a misspelling of ${t}`),!0)};function QS(h,t,e){if(typeof h!="object")throw new mt("options must be an object",mt.ERR_BAD_OPTION_VALUE);const s=Object.keys(h);let a=s.length;for(;a-- >0;){const o=s[a],l=t[o];if(l){const u=h[o],d=u===void 0||l(u,o,h);if(d!==!0)throw new mt("option "+o+" must be "+d,mt.ERR_BAD_OPTION_VALUE);continue}if(e!==!0)throw new mt("Unknown option "+o,mt.ERR_BAD_OPTION)}}const dl={assertOptions:QS,validators:_l},bn=dl.validators;let cs=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Ng,response:new Ng}}async request(t,e){try{return await this._request(t,e)}catch(s){if(s instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const o=a.stack?a.stack.replace(/^.+\n/,""):"";try{s.stack?o&&!String(s.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+o):s.stack=o}catch{}}throw s}}_request(t,e){typeof t=="string"?(e=e||{},e.url=t):e=t||{},e=us(this.defaults,e);const{transitional:s,paramsSerializer:a,headers:o}=e;s!==void 0&&dl.assertOptions(s,{silentJSONParsing:bn.transitional(bn.boolean),forcedJSONParsing:bn.transitional(bn.boolean),clarifyTimeoutError:bn.transitional(bn.boolean),legacyInterceptorReqResOrdering:bn.transitional(bn.boolean)},!1),a!=null&&(G.isFunction(a)?e.paramsSerializer={serialize:a}:dl.assertOptions(a,{encode:bn.function,serialize:bn.function},!0)),e.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?e.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:e.allowAbsoluteUrls=!0),dl.assertOptions(e,{baseUrl:bn.spelling("baseURL"),withXsrfToken:bn.spelling("withXSRFToken")},!0),e.method=(e.method||this.defaults.method||"get").toLowerCase();let l=o&&G.merge(o.common,o[e.method]);o&&G.forEach(["delete","get","head","post","put","patch","common"],S=>{delete o[S]}),e.headers=Ye.concat(l,o);const u=[];let d=!0;this.interceptors.request.forEach(function(w){if(typeof w.runWhen=="function"&&w.runWhen(e)===!1)return;d=d&&w.synchronous;const x=e.transitional||qh;x&&x.legacyInterceptorReqResOrdering?u.unshift(w.fulfilled,w.rejected):u.push(w.fulfilled,w.rejected)});const f=[];this.interceptors.response.forEach(function(w){f.push(w.fulfilled,w.rejected)});let m,y=0,b;if(!d){const S=[Ig.bind(this),void 0];for(S.unshift(...u),S.push(...f),b=S.length,m=Promise.resolve(e);y<b;)m=m.then(S[y++],S[y++]);return m}b=u.length;let v=e;for(;y<b;){const S=u[y++],w=u[y++];try{v=S(v)}catch(x){w.call(this,x);break}}try{m=Ig.call(this,v)}catch(S){return Promise.reject(S)}for(y=0,b=f.length;y<b;)m=m.then(f[y++],f[y++]);return m}getUri(t){t=us(this.defaults,t);const e=H0(t.baseURL,t.url,t.allowAbsoluteUrls);return F0(e,t.params,t.paramsSerializer)}};G.forEach(["delete","get","head","options"],function(t){cs.prototype[t]=function(e,s){return this.request(us(s||{},{method:t,url:e,data:(s||{}).data}))}});G.forEach(["post","put","patch"],function(t){function e(s){return function(o,l,u){return this.request(us(u||{},{method:t,headers:s?{"Content-Type":"multipart/form-data"}:{},url:o,data:l}))}}cs.prototype[t]=e(),cs.prototype[t+"Form"]=e(!0)});let WS=class Y0{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let e;this.promise=new Promise(function(o){e=o});const s=this;this.promise.then(a=>{if(!s._listeners)return;let o=s._listeners.length;for(;o-- >0;)s._listeners[o](a);s._listeners=null}),this.promise.then=a=>{let o;const l=new Promise(u=>{s.subscribe(u),o=u}).then(a);return l.cancel=function(){s.unsubscribe(o)},l},t(function(o,l,u){s.reason||(s.reason=new Nr(o,l,u),e(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const e=this._listeners.indexOf(t);e!==-1&&this._listeners.splice(e,1)}toAbortSignal(){const t=new AbortController,e=s=>{t.abort(s)};return this.subscribe(e),t.signal.unsubscribe=()=>this.unsubscribe(e),t.signal}static source(){let t;return{token:new Y0(function(a){t=a}),cancel:t}}};function ZS(h){return function(e){return h.apply(null,e)}}function JS(h){return G.isObject(h)&&h.isAxiosError===!0}const Eh={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Eh).forEach(([h,t])=>{Eh[t]=h});function $0(h){const t=new cs(h),e=C0(cs.prototype.request,t);return G.extend(e,cs.prototype,t,{allOwnKeys:!0}),G.extend(e,t,null,{allOwnKeys:!0}),e.create=function(a){return $0(us(h,a))},e}const $t=$0(Dr);$t.Axios=cs;$t.CanceledError=Nr;$t.CancelToken=WS;$t.isCancel=U0;$t.VERSION=X0;$t.toFormData=Tl;$t.AxiosError=mt;$t.Cancel=$t.CanceledError;$t.all=function(t){return Promise.all(t)};$t.spread=ZS;$t.isAxiosError=JS;$t.mergeConfig=us;$t.AxiosHeaders=Ye;$t.formToJSON=h=>z0(G.isHTMLForm(h)?new FormData(h):h);$t.getAdapter=q0.getAdapter;$t.HttpStatusCode=Eh;$t.default=$t;const{Axios:vE,AxiosError:AE,CanceledError:SE,isCancel:wE,CancelToken:xE,VERSION:EE,all:TE,Cancel:_E,isAxiosError:CE,spread:ME,toFormData:DE,AxiosHeaders:NE,HttpStatusCode:RE,formToJSON:kE,getAdapter:OE,mergeConfig:LE}=$t;function tw({onSelectBook:h}){const{books:t,setBooks:e,removeBook:s}=te(),[a,o]=it.useState(!0);it.useEffect(()=>{l()},[]);const l=async()=>{try{const{data:m}=await $t.get("/api/library");m.success&&e(m.books)}catch(m){console.error("Failed to load library:",m)}finally{o(!1)}},u=async(m,y)=>{m.stopPropagation();try{await $t.delete(`/api/library/${y}`),s(y)}catch(b){console.error("Failed to delete book:",b)}},d=m=>new Date(m).toLocaleDateString("en-US",{month:"short",day:"numeric"}),f=m=>m<1024?`${m} B`:m<1048576?`${(m/1024).toFixed(1)} KB`:`${(m/1048576).toFixed(1)} MB`;return a?_.jsx("div",{className:"flex items-center justify-center py-16",children:_.jsx(S0,{className:"w-8 h-8 text-primary-500 animate-spin"})}):t.length===0?null:_.jsxs("div",{className:"slide-up",children:[_.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[_.jsx(Bi,{className:"w-5 h-5 text-primary-400"}),"Your Library"]}),_.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:t.map(m=>_.jsxs("div",{onClick:()=>h(m),className:"glass rounded-xl p-4 cursor-pointer hover:scale-[1.02] transition-all duration-200 group",children:[_.jsxs("div",{className:"flex gap-3",children:[_.jsx("div",{className:"w-12 h-16 rounded-lg flex items-center justify-center shrink-0",style:{background:`linear-gradient(135deg, ${m.coverColor||"#6366f1"}, ${m.coverColor||"#6366f1"}88)`},children:_.jsx(gl,{className:"w-5 h-5 text-white"})}),_.jsxs("div",{className:"flex-1 min-w-0",children:[_.jsx("h3",{className:"font-semibold text-sm truncate",children:m.title}),_.jsx("p",{className:"text-xs text-gray-400 truncate",children:m.author}),_.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[_.jsxs("span",{className:"text-[11px] text-gray-500 flex items-center gap-1",children:[_.jsx(gl,{className:"w-3 h-3"}),m.totalPages,"p"]}),_.jsxs("span",{className:"text-[11px] text-gray-500 flex items-center gap-1",children:[_.jsx(Uh,{className:"w-3 h-3"}),"~",m.estimatedDuration,"m"]}),_.jsx("span",{className:"text-[11px] text-gray-500",children:f(m.fileSize)})]})]}),_.jsx("button",{onClick:y=>u(y,m._id),className:`w-7 h-7 rounded-lg flex items-center justify-center opacity-0 group-hover:opacity-100
                  hover:bg-red-500/20 transition-all shrink-0 self-start`,children:_.jsx(_0,{className:"w-3.5 h-3.5 text-red-400"})})]}),_.jsxs("p",{className:"text-[10px] text-gray-500 mt-2",children:["Added ",d(m.createdAt)]})]},m._id))})]})}const Le=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Th=[.001,0,0,.001,0,0],dh=1.35,an={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Oi={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Ar="pdfjs_internal_editor_",At={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Nt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},ew={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},_h={TRIANGLES:1,LATTICE:2},ye={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},fl={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},me={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},ta={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Cl={ERRORS:0,WARNINGS:1,INFOS:5},Sr={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},ur={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},nw={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Ml=Cl.WARNINGS;function iw(h){Number.isInteger(h)&&(Ml=h)}function sw(){return Ml}function Dl(h){Ml>=Cl.INFOS&&console.info(`Info: ${h}`)}function yt(h){Ml>=Cl.WARNINGS&&console.warn(`Warning: ${h}`)}function zt(h){throw new Error(h)}function Ft(h,t){h||zt(t)}function aw(h){switch(h?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function K0(h,t=null,e=null){if(!h)return null;if(e&&typeof h=="string"&&(e.addDefaultProtocol&&h.startsWith("www.")&&h.match(/\./g)?.length>=2&&(h=`http://${h}`),e.tryConvertEncoding))try{h=hw(h)}catch{}const s=t?URL.parse(h,t):URL.parse(h);return aw(s)?s:null}function Q0(h,t,e=!1){const s=URL.parse(h);return s?(s.hash=t,s.href):e&&K0(h,"http://example.com")?h.split("#",1)[0]+`${t?`#${t}`:""}`:""}function bt(h,t,e,s=!1){return Object.defineProperty(h,t,{value:e,enumerable:!s,configurable:!0,writable:!1}),e}const fs=(function(){function t(e,s){this.message=e,this.name=s}return t.prototype=new Error,t.constructor=t,t})();class Gg extends fs{constructor(t,e){super(t,"PasswordException"),this.code=e}}class fh extends fs{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class Ch extends fs{constructor(t){super(t,"InvalidPDFException")}}class bl extends fs{constructor(t,e,s){super(t,"ResponseException"),this.status=e,this.missing=s}}class rw extends fs{constructor(t){super(t,"FormatError")}}class Pi extends fs{constructor(t){super(t,"AbortException")}}function ow(h){(typeof h!="object"||h?.length===void 0)&&zt("Invalid argument for bytesToString");const t=h.length,e=8192;if(t<e)return String.fromCharCode.apply(null,h);const s=[];for(let a=0;a<t;a+=e){const o=Math.min(a+e,t),l=h.subarray(a,o);s.push(String.fromCharCode.apply(null,l))}return s.join("")}function Nl(h){typeof h!="string"&&zt("Invalid argument for stringToBytes");const t=h.length,e=new Uint8Array(t);for(let s=0;s<t;++s)e[s]=h.charCodeAt(s)&255;return e}function lw(h){return String.fromCharCode(h>>24&255,h>>16&255,h>>8&255,h&255)}function cw(){const h=new Uint8Array(4);return h[0]=1,new Uint32Array(h.buffer,0,1)[0]===1}function uw(){try{return new Function(""),!0}catch{return!1}}class be{static get isLittleEndian(){return bt(this,"isLittleEndian",cw())}static get isEvalSupported(){return bt(this,"isEvalSupported",uw())}static get isOffscreenCanvasSupported(){return bt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return bt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return bt(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return bt(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return bt(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){return bt(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const ph=Array.from(Array(256).keys(),h=>h.toString(16).padStart(2,"0"));class nt{static makeHexColor(t,e,s){return`#${ph[t]}${ph[e]}${ph[s]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,e){let s;t[0]?(t[0]<0&&(s=e[0],e[0]=e[2],e[2]=s),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(s=e[1],e[1]=e[3],e[3]=s),e[1]*=t[3],e[3]*=t[3]):(s=e[0],e[0]=e[1],e[1]=s,s=e[2],e[2]=e[3],e[3]=s,t[1]<0&&(s=e[1],e[1]=e[3],e[3]=s),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(s=e[0],e[0]=e[2],e[2]=s),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static multiplyByDOMMatrix(t,e){return[t[0]*e.a+t[2]*e.b,t[1]*e.a+t[3]*e.b,t[0]*e.c+t[2]*e.d,t[1]*e.c+t[3]*e.d,t[0]*e.e+t[2]*e.f+t[4],t[1]*e.e+t[3]*e.f+t[5]]}static applyTransform(t,e,s=0){const a=t[s],o=t[s+1];t[s]=a*e[0]+o*e[2]+e[4],t[s+1]=a*e[1]+o*e[3]+e[5]}static applyTransformToBezier(t,e,s=0){const a=e[0],o=e[1],l=e[2],u=e[3],d=e[4],f=e[5];for(let m=0;m<6;m+=2){const y=t[s+m],b=t[s+m+1];t[s+m]=y*a+b*l+d,t[s+m+1]=y*o+b*u+f}}static applyInverseTransform(t,e){const s=t[0],a=t[1],o=e[0]*e[3]-e[1]*e[2];t[0]=(s*e[3]-a*e[2]+e[2]*e[5]-e[4]*e[3])/o,t[1]=(-s*e[1]+a*e[0]+e[4]*e[1]-e[5]*e[0])/o}static axialAlignedBoundingBox(t,e,s){const a=e[0],o=e[1],l=e[2],u=e[3],d=e[4],f=e[5],m=t[0],y=t[1],b=t[2],v=t[3];let S=a*m+d,w=S,x=a*b+d,E=x,M=u*y+f,C=M,R=u*v+f,k=R;if(o!==0||l!==0){const L=o*m,P=o*b,$=l*y,K=l*v;S+=$,E+=$,x+=K,w+=K,M+=L,k+=L,R+=P,C+=P}s[0]=Math.min(s[0],S,x,w,E),s[1]=Math.min(s[1],M,R,C,k),s[2]=Math.max(s[2],S,x,w,E),s[3]=Math.max(s[3],M,R,C,k)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const s=t[0],a=t[1],o=t[2],l=t[3],u=s**2+a**2,d=s*o+a*l,f=o**2+l**2,m=(u+f)/2,y=Math.sqrt(m**2-(u*f-d**2));e[0]=Math.sqrt(m+y||1),e[1]=Math.sqrt(m-y||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const s=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),a=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(s>a)return null;const o=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),l=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return o>l?null:[s,o,a,l]}static pointBoundingBox(t,e,s){s[0]=Math.min(s[0],t),s[1]=Math.min(s[1],e),s[2]=Math.max(s[2],t),s[3]=Math.max(s[3],e)}static rectBoundingBox(t,e,s,a,o){o[0]=Math.min(o[0],t,s),o[1]=Math.min(o[1],e,a),o[2]=Math.max(o[2],t,s),o[3]=Math.max(o[3],e,a)}static#t(t,e,s,a,o,l,u,d,f,m){if(f<=0||f>=1)return;const y=1-f,b=f*f,v=b*f,S=y*(y*(y*t+3*f*e)+3*b*s)+v*a,w=y*(y*(y*o+3*f*l)+3*b*u)+v*d;m[0]=Math.min(m[0],S),m[1]=Math.min(m[1],w),m[2]=Math.max(m[2],S),m[3]=Math.max(m[3],w)}static#e(t,e,s,a,o,l,u,d,f,m,y,b){if(Math.abs(f)<1e-12){Math.abs(m)>=1e-12&&this.#t(t,e,s,a,o,l,u,d,-y/m,b);return}const v=m**2-4*y*f;if(v<0)return;const S=Math.sqrt(v),w=2*f;this.#t(t,e,s,a,o,l,u,d,(-m+S)/w,b),this.#t(t,e,s,a,o,l,u,d,(-m-S)/w,b)}static bezierBoundingBox(t,e,s,a,o,l,u,d,f){f[0]=Math.min(f[0],t,u),f[1]=Math.min(f[1],e,d),f[2]=Math.max(f[2],t,u),f[3]=Math.max(f[3],e,d),this.#e(t,s,o,u,e,a,l,d,3*(-t+3*(s-o)+u),6*(t-2*s+o),3*(s-t),f),this.#e(t,s,o,u,e,a,l,d,3*(-e+3*(a-l)+d),6*(e-2*a+l),3*(a-e),f)}}function hw(h){return decodeURIComponent(escape(h))}let mh=null,Vg=null;function dw(h){return mh||(mh=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Vg=new Map([["","t"]])),h.replaceAll(mh,(t,e,s)=>e?e.normalize("NFKC"):Vg.get(s))}function W0(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const h=new Uint8Array(32);return crypto.getRandomValues(h),ow(h)}const ia="pdfjs_internal_id_";function fw(h,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[s,a,...o]=e;if(!h(s)&&!Number.isInteger(s)||!t(a))return!1;const l=o.length;let u=!0;switch(a.name){case"XYZ":if(l<2||l>3)return!1;break;case"Fit":case"FitB":return l===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(l>1)return!1;break;case"FitR":if(l!==4)return!1;u=!1;break;default:return!1}for(const d of o)if(!(typeof d=="number"||u&&d===null))return!1;return!0}function De(h,t,e){return Math.min(Math.max(h,t),e)}typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(h){return h.reduce((t,e)=>t+e,0)});class wr{static textContent(t){const e=[],s={items:e,styles:Object.create(null)};function a(o){if(!o)return;let l=null;const u=o.name;if(u==="#text")l=o.value;else if(wr.shouldBuildText(u))o?.attributes?.textContent?l=o.attributes.textContent:o.value&&(l=o.value);else return;if(l!==null&&e.push({str:l}),!!o.children)for(const d of o.children)a(d)}return a(t),s}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}class Z0{static setupStorage(t,e,s,a,o){const l=a.getValue(e,{value:null});switch(s.name){case"textarea":if(l.value!==null&&(t.textContent=l.value),o==="print")break;t.addEventListener("input",u=>{a.setValue(e,{value:u.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(l.value===s.attributes.xfaOn?t.setAttribute("checked",!0):l.value===s.attributes.xfaOff&&t.removeAttribute("checked"),o==="print")break;t.addEventListener("change",u=>{a.setValue(e,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(l.value!==null&&t.setAttribute("value",l.value),o==="print")break;t.addEventListener("input",u=>{a.setValue(e,{value:u.target.value})})}break;case"select":if(l.value!==null){t.setAttribute("value",l.value);for(const u of s.children)u.attributes.value===l.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}t.addEventListener("input",u=>{const d=u.target.options,f=d.selectedIndex===-1?"":d[d.selectedIndex].value;a.setValue(e,{value:f})});break}}static setAttributes({html:t,element:e,storage:s=null,intent:a,linkService:o}){const{attributes:l}=e,u=t instanceof HTMLAnchorElement;l.type==="radio"&&(l.name=`${l.name}-${a}`);for(const[d,f]of Object.entries(l))if(f!=null)switch(d){case"class":f.length&&t.setAttribute(d,f.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",f);break;case"style":Object.assign(t.style,f);break;case"textContent":t.textContent=f;break;default:(!u||d!=="href"&&d!=="newWindow")&&t.setAttribute(d,f)}u&&o.addLinkAttributes(t,l.href,l.newWindow),s&&l.dataId&&this.setupStorage(t,l.dataId,e,s)}static render(t){const e=t.annotationStorage,s=t.linkService,a=t.xfaHtml,o=t.intent||"display",l=document.createElement(a.name);a.attributes&&this.setAttributes({html:l,element:a,intent:o,linkService:s});const u=o!=="richText",d=t.div;if(d.append(l),t.viewport){const y=`matrix(${t.viewport.transform.join(",")})`;d.style.transform=y}u&&d.setAttribute("class","xfaLayer xfaFont");const f=[];if(a.children.length===0){if(a.value){const y=document.createTextNode(a.value);l.append(y),u&&wr.shouldBuildText(a.name)&&f.push(y)}return{textDivs:f}}const m=[[a,-1,l]];for(;m.length>0;){const[y,b,v]=m.at(-1);if(b+1===y.children.length){m.pop();continue}const S=y.children[++m.at(-1)[1]];if(S===null)continue;const{name:w}=S;if(w==="#text"){const E=document.createTextNode(S.value);f.push(E),v.append(E);continue}const x=S?.attributes?.xmlns?document.createElementNS(S.attributes.xmlns,w):document.createElement(w);if(v.append(x),S.attributes&&this.setAttributes({html:x,element:S,storage:e,intent:o,linkService:s}),S.children?.length>0)m.push([S,-1,x]);else if(S.value){const E=document.createTextNode(S.value);u&&wr.shouldBuildText(w)&&f.push(E),x.append(E)}}for(const y of d.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))y.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const si="http://www.w3.org/2000/svg";class da{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function Rr(h,t="text"){if(gr(h,document.baseURI)){const e=await fetch(h);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,s)=>{const a=new XMLHttpRequest;a.open("GET",h,!0),a.responseType=t,a.onreadystatechange=()=>{if(a.readyState===XMLHttpRequest.DONE){if(a.status===200||a.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(a.response);return}e(a.responseText);return}s(new Error(a.statusText))}},a.send(null)})}class kr{constructor({viewBox:t,userUnit:e,scale:s,rotation:a,offsetX:o=0,offsetY:l=0,dontFlip:u=!1}){this.viewBox=t,this.userUnit=e,this.scale=s,this.rotation=a,this.offsetX=o,this.offsetY=l,s*=e;const d=(t[2]+t[0])/2,f=(t[3]+t[1])/2;let m,y,b,v;switch(a%=360,a<0&&(a+=360),a){case 180:m=-1,y=0,b=0,v=1;break;case 90:m=0,y=1,b=1,v=0;break;case 270:m=0,y=-1,b=-1,v=0;break;case 0:m=1,y=0,b=0,v=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(b=-b,v=-v);let S,w,x,E;m===0?(S=Math.abs(f-t[1])*s+o,w=Math.abs(d-t[0])*s+l,x=(t[3]-t[1])*s,E=(t[2]-t[0])*s):(S=Math.abs(d-t[0])*s+o,w=Math.abs(f-t[1])*s+l,x=(t[2]-t[0])*s,E=(t[3]-t[1])*s),this.transform=[m*s,y*s,b*s,v*s,S-m*s*d-b*s*f,w-y*s*d-v*s*f],this.width=x,this.height=E}get rawDims(){const t=this.viewBox;return bt(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:s=this.offsetX,offsetY:a=this.offsetY,dontFlip:o=!1}={}){return new kr({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:s,offsetY:a,dontFlip:o})}convertToViewportPoint(t,e){const s=[t,e];return nt.applyTransform(s,this.transform),s}convertToViewportRectangle(t){const e=[t[0],t[1]];nt.applyTransform(e,this.transform);const s=[t[2],t[3]];return nt.applyTransform(s,this.transform),[e[0],e[1],s[0],s[1]]}convertToPdfPoint(t,e){const s=[t,e];return nt.applyInverseTransform(s,this.transform),s}}class $h extends fs{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function Rl(h){const t=h.length;let e=0;for(;e<t&&h[e].trim()==="";)e++;return h.substring(e,e+5).toLowerCase()==="data:"}function Kh(h){return typeof h=="string"&&/\.pdf$/i.test(h)}function pw(h){return[h]=h.split(/[#?]/,1),h.substring(h.lastIndexOf("/")+1)}function mw(h,t="document.pdf"){if(typeof h!="string")return t;if(Rl(h))return yt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const s=(u=>{try{return new URL(u)}catch{try{return new URL(decodeURIComponent(u))}catch{try{return new URL(u,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(u),"https://foo.bar")}catch{return null}}}}})(h);if(!s)return t;const a=u=>{try{let d=decodeURIComponent(u);return d.includes("/")?(d=d.split("/").at(-1),d.test(/^\.pdf$/i)?d:u):d}catch{return u}},o=/\.pdf$/i,l=s.pathname.split("/").at(-1);if(o.test(l))return a(l);if(s.searchParams.size>0){const u=Array.from(s.searchParams.values()).reverse();for(const f of u)if(o.test(f))return a(f);const d=Array.from(s.searchParams.keys()).reverse();for(const f of d)if(o.test(f))return a(f)}if(s.hash){const d=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(s.hash);if(d)return a(d[0])}return t}class qg{started=Object.create(null);times=[];time(t){t in this.started&&yt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||yt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:s}of this.times)e=Math.max(s.length,e);for(const{name:s,start:a,end:o}of this.times)t.push(`${s.padEnd(e)} ${o-a}ms
`);return t.join("")}}function gr(h,t){const e=t?URL.parse(h,t):URL.parse(h);return e?.protocol==="http:"||e?.protocol==="https:"}function wn(h){h.preventDefault()}function ae(h){h.preventDefault(),h.stopPropagation()}function gw(h){console.log("Deprecated API usage: "+h)}class Mh{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#t.exec(t);if(!e)return null;const s=parseInt(e[1],10);let a=parseInt(e[2],10);a=a>=1&&a<=12?a-1:0;let o=parseInt(e[3],10);o=o>=1&&o<=31?o:1;let l=parseInt(e[4],10);l=l>=0&&l<=23?l:0;let u=parseInt(e[5],10);u=u>=0&&u<=59?u:0;let d=parseInt(e[6],10);d=d>=0&&d<=59?d:0;const f=e[7]||"Z";let m=parseInt(e[8],10);m=m>=0&&m<=23?m:0;let y=parseInt(e[9],10)||0;return y=y>=0&&y<=59?y:0,f==="-"?(l+=m,u+=y):f==="+"&&(l-=m,u-=y),new Date(Date.UTC(s,a,o,l,u,d))}}function yw(h,{scale:t=1,rotation:e=0}){const{width:s,height:a}=h.attributes.style,o=[0,0,parseInt(s),parseInt(a)];return new kr({viewBox:o,userUnit:1,scale:t,rotation:e})}function Or(h){if(h.startsWith("#")){const t=parseInt(h.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return h.startsWith("rgb(")?h.slice(4,-1).split(",").map(t=>parseInt(t)):h.startsWith("rgba(")?h.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(yt(`Not a valid color format: "${h}"`),[0,0,0])}function bw(h){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of h.keys()){t.style.color=e;const s=window.getComputedStyle(t).color;h.set(e,Or(s))}t.remove()}function ee(h){const{a:t,b:e,c:s,d:a,e:o,f:l}=h.getTransform();return[t,e,s,a,o,l]}function Ln(h){const{a:t,b:e,c:s,d:a,e:o,f:l}=h.getTransform().invertSelf();return[t,e,s,a,o,l]}function hs(h,t,e=!1,s=!0){if(t instanceof kr){const{pageWidth:a,pageHeight:o}=t.rawDims,{style:l}=h,u=be.isCSSRoundSupported,d=`var(--total-scale-factor) * ${a}px`,f=`var(--total-scale-factor) * ${o}px`,m=u?`round(down, ${d}, var(--scale-round-x))`:`calc(${d})`,y=u?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!e||t.rotation%180===0?(l.width=m,l.height=y):(l.width=y,l.height=m)}s&&h.setAttribute("data-main-rotation",t.rotation)}class Fn{constructor(){const{pixelRatio:t}=Fn;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,s,a,o=-1){let l=1/0,u=1/0,d=1/0;s=Fn.capPixels(s,o),s>0&&(l=Math.sqrt(s/(t*e))),a!==-1&&(u=a/t,d=a/e);const f=Math.min(l,u,d);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const s=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,s):s}return t}}const Dh=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class vw{static get isDarkMode(){return bt(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class Aw{static get commentForegroundColor(){const t=document.createElement("span");t.classList.add("comment","sidebar");const{style:e}=t;e.width=e.height="0",e.display="none",e.color="var(--comment-fg-color)",document.body.append(t);const{color:s}=window.getComputedStyle(t);return t.remove(),bt(this,"commentForegroundColor",Or(s))}}function Sw(h,t,e,s){s=Math.min(Math.max(s??1,0),1);const a=255*(1-s);return h=Math.round(h*s+a),t=Math.round(t*s+a),e=Math.round(e*s+a),[h,t,e]}function Xg(h,t){const e=h[0]/255,s=h[1]/255,a=h[2]/255,o=Math.max(e,s,a),l=Math.min(e,s,a),u=(o+l)/2;if(o===l)t[0]=t[1]=0;else{const d=o-l;switch(t[1]=u<.5?d/(o+l):d/(2-o-l),o){case e:t[0]=((s-a)/d+(s<a?6:0))*60;break;case s:t[0]=((a-e)/d+2)*60;break;case a:t[0]=((e-s)/d+4)*60;break}}t[2]=u}function Nh(h,t){const e=h[0],s=h[1],a=h[2],o=(1-Math.abs(2*a-1))*s,l=o*(1-Math.abs(e/60%2-1)),u=a-o/2;switch(Math.floor(e/60)){case 0:t[0]=o+u,t[1]=l+u,t[2]=u;break;case 1:t[0]=l+u,t[1]=o+u,t[2]=u;break;case 2:t[0]=u,t[1]=o+u,t[2]=l+u;break;case 3:t[0]=u,t[1]=l+u,t[2]=o+u;break;case 4:t[0]=l+u,t[1]=u,t[2]=o+u;break;case 5:case 6:t[0]=o+u,t[1]=u,t[2]=l+u;break}}function Yg(h){return h<=.03928?h/12.92:((h+.055)/1.055)**2.4}function $g(h,t,e){Nh(h,e),e.map(Yg);const s=.2126*e[0]+.7152*e[1]+.0722*e[2];Nh(t,e),e.map(Yg);const a=.2126*e[0]+.7152*e[1]+.0722*e[2];return s>a?(s+.05)/(a+.05):(a+.05)/(s+.05)}const Kg=new Map;function ww(h,t){const e=h[0]+h[1]*256+h[2]*65536+t[0]*16777216+t[1]*4294967296+t[2]*1099511627776;let s=Kg.get(e);if(s)return s;const a=new Float32Array(9),o=a.subarray(0,3),l=a.subarray(3,6);Xg(h,l);const u=a.subarray(6,9);Xg(t,u);const d=u[2]<.5,f=d?12:4.5;if(l[2]=d?Math.sqrt(l[2]):1-Math.sqrt(1-l[2]),$g(l,u,o)<f){let m,y;d?(m=l[2],y=1):(m=0,y=l[2]);const b=.005;for(;y-m>b;){const v=l[2]=(m+y)/2;d===$g(l,u,o)<f?m=v:y=v}l[2]=d?y:m}return Nh(l,o),s=nt.makeHexColor(Math.round(o[0]*255),Math.round(o[1]*255),Math.round(o[2]*255)),Kg.set(e,s),s}function J0({html:h,dir:t,className:e},s){const a=document.createDocumentFragment();if(typeof h=="string"){const o=document.createElement("p");o.dir=t||"auto";const l=h.split(/(?:\r\n?|\n)/);for(let u=0,d=l.length;u<d;++u){const f=l[u];o.append(document.createTextNode(f)),u<d-1&&o.append(document.createElement("br"))}a.append(o)}else Z0.render({xfaHtml:h,div:a,intent:"richText"});a.firstElementChild.classList.add("richText",e),s.append(a)}function ty(h){const t=new Path2D;if(!h)return t;for(let e=0,s=h.length;e<s;)switch(h[e++]){case ur.moveTo:t.moveTo(h[e++],h[e++]);break;case ur.lineTo:t.lineTo(h[e++],h[e++]);break;case ur.curveTo:t.bezierCurveTo(h[e++],h[e++],h[e++],h[e++],h[e++],h[e++]);break;case ur.quadraticCurveTo:t.quadraticCurveTo(h[e++],h[e++],h[e++],h[e++]);break;case ur.closePath:t.closePath();break;default:yt(`Unrecognized drawing path operator: ${h[e-1]}`);break}return t}class Pt{static#t=null;static#e=null;static#i=null;static#n=0;static#a=[];get pagesNumber(){return Pt.#n}set pagesNumber(t){Pt.#n!==t&&(Pt.#n=t,t===0&&(Pt.#e=null,Pt.#t=null))}addListener(t){Pt.#a.push(t)}removeListener(t){const e=Pt.#a.indexOf(t);e>=0&&Pt.#a.splice(e,1)}#r(){for(const t of Pt.#a)t()}#s(t){if(Pt.#e)return;const e=Pt.#n,s=new Uint32Array(3*e),a=Pt.#e=s.subarray(0,e),o=Pt.#t=s.subarray(e,2*e);if(t)for(let l=0;l<e;l++)a[l]=o[l]=l+1;Pt.#i=s.subarray(2*e)}movePages(t,e,s){this.#s(!0);const a=Pt.#e,o=Pt.#t;Pt.#i.set(o);const l=e.length,u=new Uint32Array(l);let d=0;for(let v=0;v<l;v++){const S=e[v]-1;u[v]=a[S],S<s&&(d+=1)}const f=Pt.#n;let m=s-d;const y=f-l;m=De(m,0,y);for(let v=0,S=0;v<f;v++)t.has(v+1)||(a[S++]=a[v]);a.copyWithin(m+l,m,y),a.set(u,m);let b=!1;for(let v=0,S=f;v<S;v++){const w=a[v];b||=w!==v+1,o[w-1]=v+1}this.#r(),b||(this.pagesNumber=0)}hasBeenAltered(){return Pt.#e!==null}getPageMappingForSaving(){return{pageIndices:Pt.#t?Pt.#t.map(t=>t-1):null}}getPrevPageNumber(t){return Pt.#i[Pt.#e[t-1]-1]}getPageNumber(t){return Pt.#t?.[t-1]??t}getPageId(t){return Pt.#e?.[t-1]??t}static get instance(){return bt(this,"instance",new Pt)}getMapping(){return Pt.#e.subarray(0,this.pagesNumber)}}class vr{#t=null;#e=null;#i;#n=null;#a=null;#r=null;#s=null;#o=null;static#c=null;constructor(t){this.#i=t,vr.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#i._uiManager._signal;e instanceof AbortSignal&&!e.aborted&&(t.addEventListener("contextmenu",wn,{signal:e}),t.addEventListener("pointerdown",vr.#l,{signal:e}));const s=this.#n=document.createElement("div");s.className="buttons",t.append(s);const a=this.#i.toolbarPosition;if(a){const{style:o}=t,l=this.#i._uiManager.direction==="ltr"?1-a[0]:a[0];o.insetInlineEnd=`${100*l}%`,o.top=`calc(${100*a[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#l(t){t.stopPropagation()}#d(t){this.#i._focusEventsAllowed=!1,ae(t)}#h(t){this.#i._focusEventsAllowed=!0,ae(t)}#f(t){const e=this.#i._uiManager._signal;return!(e instanceof AbortSignal)||e.aborted?!1:(t.addEventListener("focusin",this.#d.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",wn,{signal:e}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#a?.shown(),this.#r?.shown()}addDeleteButton(){const{editorType:t,_uiManager:e}=this.#i,s=document.createElement("button");s.classList.add("basic","deleteButton"),s.tabIndex=0,s.setAttribute("data-l10n-id",vr.#c[t]),this.#f(s)&&s.addEventListener("click",a=>{e.delete()},{signal:e._signal}),this.#n.append(s)}get#g(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#f(e),this.#n.append(e,this.#g),this.#a=t}addComment(t,e=null){if(this.#r)return;const s=t.renderForToolbar();if(!s)return;this.#f(s);const a=this.#s=this.#g;e?(this.#n.insertBefore(s,e),this.#n.insertBefore(a,e)):this.#n.append(s,a),this.#r=t,t.toolbar=this}addColorPicker(t){if(this.#e)return;this.#e=t;const e=t.renderButton();this.#f(e),this.#n.append(e,this.#g)}async addEditSignatureButton(t){const e=this.#o=await t.renderEditButton(this.#i);this.#f(e),this.#n.append(e,this.#g)}removeButton(t){t==="comment"&&(this.#r?.removeToolbarCommentButton(),this.#r=null,this.#s?.remove(),this.#s=null)}async addButton(t,e){switch(t){case"colorPicker":e&&this.addColorPicker(e);break;case"altText":e&&await this.addAltText(e);break;case"editSignature":e&&await this.addEditSignatureButton(e);break;case"delete":this.addDeleteButton();break;case"comment":e&&this.addComment(e);break}}async addButtonBefore(t,e,s){if(!e&&t==="comment")return;const a=this.#n.querySelector(s);a&&t==="comment"&&this.addComment(e,a)}updateEditSignatureButton(t){this.#o&&(this.#o.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class xw{#t=null;#e=null;#i;constructor(t){this.#i=t}#n(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const e=this.#i._signal;e instanceof AbortSignal&&!e.aborted&&t.addEventListener("contextmenu",wn,{signal:e});const s=this.#t=document.createElement("div");return s.className="buttons",t.append(s),this.#i.hasCommentManager()&&this.#r("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#i.commentSelection("floating_button")}),this.#r("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#i.highlightSelection("floating_button")}),t}#a(t,e){let s=0,a=0;for(const o of t){const l=o.y+o.height;if(l<s)continue;const u=o.x+(e?o.width:0);if(l>s){a=u,s=l;continue}e?u>a&&(a=u):u<a&&(a=u)}return[e?1-a:a,s]}show(t,e,s){const[a,o]=this.#a(e,s),{style:l}=this.#e||=this.#n();t.append(this.#e),l.insetInlineEnd=`${100*a}%`,l.top=`calc(${100*o}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#r(t,e,s,a){const o=document.createElement("button");o.classList.add("basic",t),o.tabIndex=0,o.setAttribute("data-l10n-id",e);const l=document.createElement("span");o.append(l),l.className="visuallyHidden",l.setAttribute("data-l10n-id",s);const u=this.#i._signal;u instanceof AbortSignal&&!u.aborted&&(o.addEventListener("contextmenu",wn,{signal:u}),o.addEventListener("click",a,{signal:u})),this.#t.append(o)}}function ey(h,t,e){for(const s of e)t.addEventListener(s,h[s].bind(h))}class jt{static#t=NaN;static#e=null;static#i=NaN;static#n=null;static initializeAndAddPointerId(t){(jt.#e||=new Set).add(t)}static setPointer(t,e){jt.#t||=e,jt.#n??=t}static setTimeStamp(t){jt.#i=t}static isSamePointerId(t){return jt.#t===t}static isSamePointerIdOrRemove(t){return jt.#t===t?!0:(jt.#e?.delete(t),!1)}static isSamePointerType(t){return jt.#n===t}static isInitializedAndDifferentPointerType(t){return jt.#n!==null&&!jt.isSamePointerType(t)}static isSameTimeStamp(t){return jt.#i===t}static isUsingMultiplePointers(){return jt.#e?.size>=1}static clearPointerType(){jt.#n=null}static clearPointerIds(){jt.#t=NaN,jt.#e=null}static clearTimeStamp(){jt.#i=NaN}}class Ew{#t=0;get id(){return`${Ar}${this.#t++}`}}class Qh{#t=W0();#e=0;#i=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),a=new Image;a.src=t;const o=a.decode().then(()=>(s.drawImage(a,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return bt(this,"_isSVGFittingCanvas",o)}async#n(t,e){this.#i||=new Map;let s=this.#i.get(t);if(s===null)return null;if(s?.bitmap)return s.refCounter+=1,s;try{s||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let a;if(typeof e=="string"?(s.url=e,a=await Rr(e,"blob")):e instanceof File?a=s.file=e:e instanceof Blob&&(a=e),a.type==="image/svg+xml"){const o=Qh._isSVGFittingCanvas,l=new FileReader,u=new Image,d=new Promise((f,m)=>{u.onload=()=>{s.bitmap=u,s.isSvg=!0,f()},l.onload=async()=>{const y=s.svgUrl=l.result;u.src=await o?`${y}#svgView(preserveAspectRatio(none))`:y},u.onerror=l.onerror=m});l.readAsDataURL(a),await d}else s.bitmap=await createImageBitmap(a);s.refCounter=1}catch(a){yt(a),s=null}return this.#i.set(t,s),s&&this.#i.set(s.id,s),s}async getFromFile(t){const{lastModified:e,name:s,size:a,type:o}=t;return this.#n(`${e}_${s}_${a}_${o}`,t)}async getFromUrl(t){return this.#n(t,t)}async getFromBlob(t,e){const s=await e;return this.#n(t,s)}async getFromId(t){this.#i||=new Map;const e=this.#i.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:s}=e;return delete e.blobPromise,this.getFromBlob(e.id,s)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#i||=new Map;let s=this.#i.get(t);if(s?.bitmap)return s.refCounter+=1,s;const a=new OffscreenCanvas(e.width,e.height);return a.getContext("2d").drawImage(e,0,0),s={bitmap:a.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#i.set(t,s),this.#i.set(s.id,s),s}getSvgUrl(t){const e=this.#i.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#i||=new Map;const e=this.#i.get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:s}=e;if(!e.url&&!e.file){const a=new OffscreenCanvas(s.width,s.height);a.getContext("bitmaprenderer").transferFromImageBitmap(s),e.blobPromise=a.convertToBlob()}s.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class Tw{#t=[];#e=!1;#i;#n=-1;constructor(t=128){this.#i=t}add({cmd:t,undo:e,post:s,mustExec:a,type:o=NaN,overwriteIfSameType:l=!1,keepUndo:u=!1}){if(a&&t(),this.#e)return;const d={cmd:t,undo:e,post:s,type:o};if(this.#n===-1){this.#t.length>0&&(this.#t.length=0),this.#n=0,this.#t.push(d);return}if(l&&this.#t[this.#n].type===o){u&&(d.undo=this.#t[this.#n].undo),this.#t[this.#n]=d;return}const f=this.#n+1;f===this.#i?this.#t.splice(0,1):(this.#n=f,f<this.#t.length&&this.#t.splice(f)),this.#t.push(d)}undo(){if(this.#n===-1)return;this.#e=!0;const{undo:t,post:e}=this.#t[this.#n];t(),e?.(),this.#e=!1,this.#n-=1}redo(){if(this.#n<this.#t.length-1){this.#n+=1,this.#e=!0;const{cmd:t,post:e}=this.#t[this.#n];t(),e?.(),this.#e=!1}}hasSomethingToUndo(){return this.#n!==-1}hasSomethingToRedo(){return this.#n<this.#t.length-1}cleanType(t){if(this.#n!==-1){for(let e=this.#n;e>=0;e--)if(this.#t[e].type!==t){this.#t.splice(e+1,this.#n-e),this.#n=e;return}this.#t.length=0,this.#n=-1}}destroy(){this.#t=null}}class Lr{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=be.platform;for(const[s,a,o={}]of t)for(const l of s){const u=l.startsWith("mac+");e&&u?(this.callbacks.set(l.slice(4),{callback:a,options:o}),this.allKeys.add(l.split("+").at(-1))):!e&&!u&&(this.callbacks.set(l,{callback:a,options:o}),this.allKeys.add(l.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const s=this.callbacks.get(this.#t(e));if(!s)return;const{callback:a,options:{bubbles:o=!1,args:l=[],checker:u=null}}=s;u&&!u(t,e)||(a.bind(t,...l,e)(),o||ae(e))}}class Wh{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return bw(t),bt(this,"_colors",t)}convert(t){const e=Or(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[s,a]of this._colors)if(a.every((o,l)=>o===e[l]))return Wh._colorsMapping.get(s);return e}getHexCode(t){const e=this._colors.get(t);return e?nt.makeHexColor(...e):t}}class ji{#t=new AbortController;#e=null;#i=null;#n=new Map;#a=new Map;#r=null;#s=null;#o=null;#c=new Tw;#l=null;#d=null;#h=null;#f=0;#g=new Set;#m=null;#u=null;#p=new Set;_editorUndoBar=null;#y=!1;#v=!1;#b=!1;#T=null;#x=null;#S=null;#C=null;#A=!1;#E=null;#N=new Ew;#M=!1;#D=!1;#j=!1;#k=null;#L=null;#F=null;#B=null;#V=null;#_=At.NONE;#w=new Set;#O=null;#z=null;#I=null;#Y=null;#X=null;#$={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#H=[0,0];#P=null;#q=null;#Z=null;#J=null;#U=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=ji.prototype,e=l=>l.#q.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&l.hasSomethingToControl(),s=(l,{target:u})=>{if(u instanceof HTMLInputElement){const{type:d}=u;return d!=="text"&&d!=="number"}return!0},a=this.TRANSLATE_SMALL,o=this.TRANSLATE_BIG;return bt(this,"_keyboardManager",new Lr([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],t.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:s}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(l,{target:u})=>!(u instanceof HTMLButtonElement)&&l.#q.contains(u)&&!l.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(l,{target:u})=>!(u instanceof HTMLButtonElement)&&l.#q.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-a,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-o,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[a,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[o,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-a],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-o],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,a],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,o],checker:e}]]))}constructor(t,e,s,a,o,l,u,d,f,m,y,b,v,S,w,x){const E=this._signal=this.#t.signal;this.#q=t,this.#Z=e,this.#J=s,this.#r=a,this.#l=o,this.#z=l,this.#X=d,this._eventBus=u,u._on("editingaction",this.onEditingAction.bind(this),{signal:E}),u._on("pagechanging",this.onPageChanging.bind(this),{signal:E}),u._on("scalechanging",this.onScaleChanging.bind(this),{signal:E}),u._on("rotationchanging",this.onRotationChanging.bind(this),{signal:E}),u._on("setpreference",this.onSetPreference.bind(this),{signal:E}),u._on("switchannotationeditorparams",M=>this.updateParams(M.type,M.value),{signal:E}),u._on("pagesedited",this.onPagesEdited.bind(this),{signal:E}),window.addEventListener("pointerdown",()=>{this.#D=!0},{capture:!0,signal:E}),window.addEventListener("pointerup",()=>{this.#D=!1},{capture:!0,signal:E}),this.#rt(),this.#dt(),this.#et(),this.#s=d.annotationStorage,this.#T=d.filterFactory,this.#I=f,this.#C=m||null,this.#y=y,this.#v=b,this.#b=v,this.#V=S||null,this.viewParameters={realScale:da.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=w||null,this._supportsPinchToZoom=x!==!1,o?.setSidebarUiManager(this)}destroy(){this.#U?.resolve(),this.#U=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#a.values())t.destroy();this.#a.clear(),this.#n.clear(),this.#p.clear(),this.#B?.clear(),this.#e=null,this.#w.clear(),this.#c.destroy(),this.#r?.destroy(),this.#l?.destroy(),this.#z?.destroy(),this.#E?.hide(),this.#E=null,this.#F?.destroy(),this.#F=null,this.#i=null,this.#x&&(clearTimeout(this.#x),this.#x=null),this.#P&&(clearTimeout(this.#P),this.#P=null),this._editorUndoBar?.destroy(),this.#X=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#V}get useNewAltTextFlow(){return this.#v}get useNewAltTextWhenAddingImage(){return this.#b}get hcmFilter(){return bt(this,"hcmFilter",this.#I?this.#T.addHCMFilter(this.#I.foreground,this.#I.background):"none")}get direction(){return bt(this,"direction",getComputedStyle(this.#q).direction)}get _highlightColors(){return bt(this,"_highlightColors",this.#C?new Map(this.#C.split(",").map(t=>(t=t.split("=").map(e=>e.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return bt(this,"highlightColors",null);const e=new Map,s=!!this.#I;for(const[a,o]of t){const l=a.endsWith("_HCM");if(s&&l){e.set(a.replace("_HCM",""),o);continue}!s&&!l&&e.set(a,o)}return bt(this,"highlightColors",e)}get highlightColorNames(){return bt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const e=this.highlightColorNames.get(t);return this._highlightColors.get(e)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#h=t}setMainHighlightColorPicker(t){this.#F=t}editAltText(t,e=!1){this.#r?.editAltText(this,t,e)}hasCommentManager(){return!!this.#l}editComment(t,e,s,a){this.#l?.showDialog(this,t,e,s,a)}selectComment(t,e){this.#a.get(t)?.getEditorByUID(e)?.toggleComment(!0,!0)}updateComment(t){this.#l?.updateComment(t.getData())}updatePopupColor(t){this.#l?.updatePopupColor(t)}removeComment(t){this.#l?.removeComments([t.uid])}deleteComment(t,e){const s=()=>{t.comment=e},a=()=>{this._editorUndoBar?.show(s,"comment"),this.toggleComment(null),t.comment=null};this.addCommands({cmd:a,undo:s,mustExec:!0})}toggleComment(t,e,s=void 0){this.#l?.toggleCommentPopup(t,e,s)}makeCommentColor(t,e){return t&&this.#l?.makeCommentColor(t,e)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(t){if(this.#a.has(t-1))return;const{resolve:e,promise:s}=Promise.withResolvers(),a=o=>{o.pageNumber===t&&(this._eventBus._off("editorsrendered",a),e())};this._eventBus.on("editorsrendered",a),await s}getSignature(t){this.#z?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#z}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){t==="enableNewAltTextWhenAddingImage"&&(this.#b=e)}onPagesEdited({pagesMapper:t}){for(const a of this.#n.values())a.updatePageIndex(t.getPrevPageNumber(a.pageIndex+1)-1);const e=this.#a,s=this.#a=new Map;for(const[a,o]of e){const l=t.getPrevPageNumber(a+1)-1;if(l===-1){o.destroy();continue}s.set(l,o),o.updatePageIndex(l)}}onPageChanging({pageNumber:t}){this.#f=t-1}focusMainContainer(){this.#q.focus()}findParent(t,e){for(const s of this.#a.values()){const{x:a,y:o,width:l,height:u}=s.div.getBoundingClientRect();if(t>=a&&t<=a+l&&e>=o&&e<=o+u)return s}return null}disableUserSelect(t=!1){this.#Z.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#p.add(t)}removeShouldRescale(t){this.#p.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*da.PDF_TO_CSS_UNITS;for(const e of this.#p)e.onScaleChanging();this.#h?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#W({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#tt(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const s of this.#a.values())if(s.hasTextLayer(t))return s;return null}highlightSelection(t="",e=!1){const s=document.getSelection();if(!s||s.isCollapsed)return;const{anchorNode:a,anchorOffset:o,focusNode:l,focusOffset:u}=s,d=s.toString(),m=this.#W(s).closest(".textLayer"),y=this.getSelectionBoxes(m);if(!y)return;s.empty();const b=this.#tt(m),v=this.#_===At.NONE,S=()=>{const w=b?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:y,anchorNode:a,anchorOffset:o,focusNode:l,focusOffset:u,text:d});v&&this.showAllEditors("highlight",!0,!0),e&&w?.editComment()};if(v){this.switchToMode(At.HIGHLIGHT,S);return}S()}commentSelection(t=""){this.highlightSelection(t,!0)}#st(){const t=document.getSelection();if(!t||t.isCollapsed)return;const s=this.#W(t).closest(".textLayer"),a=this.getSelectionBoxes(s);a&&(this.#E||=new xw(this),this.#E.show(s,a,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(t){if(!this.#s)return null;const e=`${Ar}${t}`,s=this.#s.getRawValue(e);return s&&this.#s.remove(e),s}addToAnnotationStorage(t){!t.isEmpty()&&this.#s&&!this.#s.has(t.id)&&this.#s.setValue(t.id,t)}a11yAlert(t,e=null){const s=this.#J;s&&(s.setAttribute("data-l10n-id",t),e?s.setAttribute("data-l10n-args",JSON.stringify(e)):s.removeAttribute("data-l10n-args"))}#at(){const t=document.getSelection();if(!t||t.isCollapsed){this.#O&&(this.#E?.hide(),this.#O=null,this.#R({hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===this.#O)return;const a=this.#W(t).closest(".textLayer");if(!a){this.#O&&(this.#E?.hide(),this.#O=null,this.#R({hasSelectedText:!1}));return}if(this.#E?.hide(),this.#O=e,this.#R({hasSelectedText:!0}),!(this.#_!==At.HIGHLIGHT&&this.#_!==At.NONE)&&(this.#_===At.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#A=this.isShiftKeyDown,!this.isShiftKeyDown)){const o=this.#_===At.HIGHLIGHT?this.#tt(a):null;if(o?.toggleDrawing(),this.#D){const l=new AbortController,u=this.combinedSignal(l),d=f=>{f.type==="pointerup"&&f.button!==0||(l.abort(),o?.toggleDrawing(!0),f.type==="pointerup"&&this.#K("main_toolbar"))};window.addEventListener("pointerup",d,{signal:u}),window.addEventListener("blur",d,{signal:u})}else o?.toggleDrawing(!0),this.#K("main_toolbar")}}#K(t=""){this.#_===At.HIGHLIGHT?this.highlightSelection(t):this.#y&&this.#st()}#rt(){document.addEventListener("selectionchange",this.#at.bind(this),{signal:this._signal})}#ot(){if(this.#S)return;this.#S=new AbortController;const t=this.combinedSignal(this.#S);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#lt(){this.#S?.abort(),this.#S=null}blur(){if(this.isShiftKeyDown=!1,this.#A&&(this.#A=!1,this.#K("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#w)if(e.div.contains(t)){this.#L=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#L)return;const[t,e]=this.#L;this.#L=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}#et(){if(this.#k)return;this.#k=new AbortController;const t=this.combinedSignal(this.#k);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ct(){this.#k?.abort(),this.#k=null}#ut(){if(this.#d)return;this.#d=new AbortController;const t=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#ht(){this.#d?.abort(),this.#d=null}#dt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.setEditingState(!0)}removeEditListeners(){this.#ct(),this.setEditingState(!1)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const s of this.#u)if(s.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const s of this.#u)if(s.isHandlingMimeForPasting(e.type)){s.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const s of this.#w){const a=s.serialize(!0);a&&e.push(a)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const o of e.items)for(const l of this.#u)if(l.isHandlingMimeForPasting(o.type)){l.paste(o,this.currentLayer);return}let s=e.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(o){yt(`paste: "${o.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const a=this.currentLayer;try{const o=[];for(const d of s){const f=await a.deserialize(d);if(!f)return;o.push(f)}const l=()=>{for(const d of o)this.#nt(d);this.#it(o)},u=()=>{for(const d of o)d.remove()};this.addCommands({cmd:l,undo:u,mustExec:!0})}catch(o){yt(`paste: "${o.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#_!==At.NONE&&!this.isEditorHandlingKeyboard&&ji._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#A&&(this.#A=!1,this.#K("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#R(t){Object.entries(t).some(([s,a])=>this.#$[s]!==a)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#$,t)}),this.#_===At.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#G([[Nt.HIGHLIGHT_FREE,!0]]))}#G(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#ot(),this.#ut(),this.#R({isEditing:this.#_!==At.NONE,isEmpty:this.#Q(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#lt(),this.#ht(),this.#R({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#u){this.#u=t;for(const e of this.#u)this.#G(e.defaultPropertiesToUpdate)}}getId(){return this.#N.id}get currentLayer(){return this.#a.get(this.#f)}getLayer(t){return this.#a.get(t)}get currentPageIndex(){return this.#f}addLayer(t){this.#a.set(t.pageIndex,t),this.#M?t.enable():t.disable()}removeLayer(t){this.#a.delete(t.pageIndex)}async updateMode(t,e=null,s=!1,a=!1,o=!1,l=!1){if(this.#_!==t&&!(this.#U&&(await this.#U.promise,!this.#U))){if(this.#U=Promise.withResolvers(),this.#h?.commitOrRemove(),this.#_===At.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#_=t,t===At.NONE){this.setEditingState(!1),this.#pt();for(const u of this.#n.values())u.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#U.resolve();return}for(const u of this.#n.values())u.addStandaloneCommentButton();t===At.SIGNATURE&&await this.#z?.loadSignatures(),s&&jt.clearPointerType(),this.setEditingState(!0),await this.#ft(),this.unselectAll();for(const u of this.#a.values())u.updateMode(t);if(t===At.POPUP){this.#i||=await this.#X.getAnnotationsByType(new Set(this.#u.map(f=>f._editorType)));const u=new Set,d=[];for(const f of this.#n.values()){const{annotationElementId:m,hasComment:y,deleted:b}=f;m&&u.add(m),y&&!b&&d.push(f.getData())}for(const f of this.#i){const{id:m,popupRef:y,contentsObj:b}=f;y&&b?.str&&!u.has(m)&&!this.#g.has(m)&&d.push(f)}this.#l?.showSidebar(d)}if(!e){a&&this.addNewEditorFromKeyboard(),this.#U.resolve();return}for(const u of this.#n.values())u.uid===e?(this.setSelected(u),l?u.editComment():o?u.enterInEditMode():u.focus()):u.unselect();this.#U.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#_&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if(this.#u){switch(t){case Nt.CREATE:this.currentLayer.addNewEditor(e);return;case Nt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#Y||=new Map).set(t,e),this.showAllEditors("highlight",e);break}if(this.hasSelection)for(const s of this.#w)s.updateParams(t,e);else for(const s of this.#u)s.updateDefaultParams(t,e)}}showAllEditors(t,e,s=!1){for(const o of this.#n.values())o.editorType===t&&o.show(e);(this.#Y?.get(Nt.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#G([[Nt.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#j!==t){this.#j=t;for(const e of this.#a.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#ft(){if(!this.#M){this.#M=!0;const t=[];for(const e of this.#a.values())t.push(e.enable());await Promise.all(t);for(const e of this.#n.values())e.enable()}}#pt(){if(this.unselectAll(),this.#M){this.#M=!1;for(const t of this.#a.values())t.disable();for(const t of this.#n.values())t.disable()}}*getEditors(t){for(const e of this.#n.values())e.pageIndex===t&&(yield e)}getEditor(t){return this.#n.get(t)}addEditor(t){this.#n.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#x&&clearTimeout(this.#x),this.#x=setTimeout(()=>{this.focusMainContainer(),this.#x=null},0)),this.#n.delete(t.id),t.annotationElementId&&this.#B?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#g.has(t.annotationElementId))&&this.#s?.remove(t.id)}addDeletedAnnotationElement(t){this.#g.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#g.has(t)}removeDeletedAnnotationElement(t){this.#g.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#nt(t){const e=this.#a.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#G(t.propertiesToUpdate))}get#mt(){let t=null;for(t of this.#w);return t}updateUI(t){this.#mt===t&&this.#G(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#G(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#w.has(t)){this.#w.delete(t),t.unselect(),this.#R({hasSelectedEditor:this.hasSelection});return}this.#w.add(t),t.select(),this.#G(t.propertiesToUpdate),this.#R({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.uid}),this.#h?.commitOrRemove();for(const e of this.#w)e!==t&&e.unselect();this.#w.clear(),this.#w.add(t),t.select(),this.#G(t.propertiesToUpdate),this.#R({hasSelectedEditor:!0})}isSelected(t){return this.#w.has(t)}get firstSelectedEditor(){return this.#w.values().next().value}unselect(t){t.unselect(),this.#w.delete(t),this.#R({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#w.size!==0}get isEnterHandled(){return this.#w.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#R({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#Q()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#R({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#Q()})}addCommands(t){this.#c.add(t),this.#R({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#Q()})}cleanUndoStack(t){this.#c.cleanType(t)}#Q(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const t of this.#n.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...this.#w],s=()=>{this._editorUndoBar?.show(a,e.length===1?e[0].editorType:e.length);for(const o of e)o.remove()},a=()=>{for(const o of e)this.#nt(o)};this.addCommands({cmd:s,undo:a,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#it(t){for(const e of this.#w)e.unselect();this.#w.clear();for(const e of t)e.isEmpty()||(this.#w.add(e),e.select());this.#R({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#w)t.commit();this.#it(this.#n.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#_!==At.NONE))&&!this.#h?.commitOrRemove()&&this.hasSelection){for(const t of this.#w)t.unselect();this.#w.clear(),this.#R({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;this.#H[0]+=t,this.#H[1]+=e;const[a,o]=this.#H,l=[...this.#w],u=1e3;this.#P&&clearTimeout(this.#P),this.#P=setTimeout(()=>{this.#P=null,this.#H[0]=this.#H[1]=0,this.addCommands({cmd:()=>{for(const d of l)this.#n.has(d.id)&&(d.translateInPage(a,o),d.translationDone())},undo:()=>{for(const d of l)this.#n.has(d.id)&&(d.translateInPage(-a,-o),d.translationDone())},mustExec:!1})},u);for(const d of l)d.translateInPage(t,e),d.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#m=new Map;for(const t of this.#w)this.#m.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#m)return!1;this.disableUserSelect(!1);const t=this.#m;this.#m=null;let e=!1;for(const[{x:a,y:o,pageIndex:l},u]of t)u.newX=a,u.newY=o,u.newPageIndex=l,e||=a!==u.savedX||o!==u.savedY||l!==u.savedPageIndex;if(!e)return!1;const s=(a,o,l,u)=>{if(this.#n.has(a.id)){const d=this.#a.get(u);d?a._setParentAndPosition(d,o,l):(a.pageIndex=u,a.x=o,a.y=l)}};return this.addCommands({cmd:()=>{for(const[a,{newX:o,newY:l,newPageIndex:u}]of t)s(a,o,l,u)},undo:()=>{for(const[a,{savedX:o,savedY:l,savedPageIndex:u}]of t)s(a,o,l,u)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#m)for(const s of this.#m.keys())s.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#w.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#_}isEditingMode(){return this.#_!==At.NONE}get imageManager(){return bt(this,"imageManager",new Qh)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let f=0,m=e.rangeCount;f<m;f++)if(!t.contains(e.getRangeAt(f).commonAncestorContainer))return null;const{x:s,y:a,width:o,height:l}=t.getBoundingClientRect();let u;switch(t.getAttribute("data-main-rotation")){case"90":u=(f,m,y,b)=>({x:(m-a)/l,y:1-(f+y-s)/o,width:b/l,height:y/o});break;case"180":u=(f,m,y,b)=>({x:1-(f+y-s)/o,y:1-(m+b-a)/l,width:y/o,height:b/l});break;case"270":u=(f,m,y,b)=>({x:1-(m+b-a)/l,y:(f-s)/o,width:b/l,height:y/o});break;default:u=(f,m,y,b)=>({x:(f-s)/o,y:(m-a)/l,width:y/o,height:b/l});break}const d=[];for(let f=0,m=e.rangeCount;f<m;f++){const y=e.getRangeAt(f);if(!y.collapsed)for(const{x:b,y:v,width:S,height:w}of y.getClientRects())S===0||w===0||d.push(u(b,v,S,w))}return d.length===0?null:d}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#o||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#o?.delete(t)}renderAnnotationElement(t){const e=this.#o?.get(t.data.id);if(!e)return;const s=this.#s.getRawValue(e);s&&(this.#_===At.NONE&&!s.hasBeenModified||s.renderAnnotationElement(t))}setMissingCanvas(t,e,s){const a=this.#B?.get(t);a&&(a.setCanvas(e,s),this.#B.delete(t))}addMissingCanvas(t,e){(this.#B||=new Map).set(t,e)}}class jn{#t=null;#e=!1;#i=null;#n=null;#a=null;#r=null;#s=!1;#o=null;#c=null;#l=null;#d=null;#h=!1;static#f=null;static _l10n=null;constructor(t){this.#c=t,this.#h=t._uiManager.useNewAltTextFlow,jn.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){jn._l10n??=t}async render(){const t=this.#i=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#n=document.createElement("span");t.append(e),this.#h?(t.classList.add("new"),t.setAttribute("data-l10n-id",jn.#f.missing),e.setAttribute("data-l10n-id",jn.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=this.#c._uiManager._signal;t.addEventListener("contextmenu",wn,{signal:s}),t.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:s});const a=o=>{o.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#h&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#g}})};return t.addEventListener("click",a,{capture:!0,signal:s}),t.addEventListener("keydown",o=>{o.target===t&&o.key==="Enter"&&(this.#s=!0,a(o))},{signal:s}),await this.#m(),t}get#g(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#i&&(this.#i.focus({focusVisible:this.#s}),this.#s=!1)}isEmpty(){return this.#h?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#h?this.#t!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(t){this.#t===null&&(this.#l=t,this.#d=await jn._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#m())}toggleAltTextBadge(t=!1){if(!this.#h||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const e=this.#o=document.createElement("div");e.className="noAltTextBadge",this.#c.div.append(e)}this.#o.classList.toggle("hidden",!t)}serialize(t){let e=this.#t;return!t&&this.#l===e&&(e=this.#d),{altText:e,decorative:this.#e,guessedText:this.#l,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:e,guessedText:s,textWithDisclaimer:a,cancel:o=!1}){s&&(this.#l=s,this.#d=a),!(this.#t===t&&this.#e===e)&&(o||(this.#t=t,this.#e=e),this.#m())}toggle(t=!1){this.#i&&(!t&&this.#r&&(clearTimeout(this.#r),this.#r=null),this.#i.disabled=!t)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#g}})}destroy(){this.#i?.remove(),this.#i=null,this.#n=null,this.#a=null,this.#o?.remove(),this.#o=null}async#m(){const t=this.#i;if(!t)return;if(this.#h){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",jn.#f[this.#g]),this.#n?.setAttribute("data-l10n-id",jn.#f[`${this.#g}-label`]),!this.#t){this.#a?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#a?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#a;if(!e){this.#a=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#c.id}`;const a=100,o=this.#c._uiManager._signal;o.addEventListener("abort",()=>{clearTimeout(this.#r),this.#r=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#r=setTimeout(()=>{this.#r=null,this.#a.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},a)},{signal:o}),t.addEventListener("mouseleave",()=>{this.#r&&(clearTimeout(this.#r),this.#r=null),this.#a?.classList.remove("show")},{signal:o})}this.#e?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#t),e.parentNode||t.append(e),this.#c.getElementForAltText()?.setAttribute("aria-describedby",e.id)}}class el{#t=null;#e=null;#i=!1;#n=null;#a=null;#r=null;#s=null;#o=null;#c=!1;#l=null;constructor(t){this.#n=t}renderForToolbar(){const t=this.#e=document.createElement("button");return t.className="comment",this.#d(t,!1)}renderForStandalone(){const t=this.#t=document.createElement("button");t.className="annotationCommentButton";const e=this.#n.commentButtonPosition;if(e){const{style:s}=t;s.insetInlineEnd=`calc(${100*(this.#n._uiManager.direction==="ltr"?1-e[0]:e[0])}% - var(--comment-button-dim))`,s.top=`calc(${100*e[1]}% - var(--comment-button-dim))`;const a=this.#n.commentButtonColor;a&&(s.backgroundColor=a)}return this.#d(t,!0)}focusButton(){setTimeout(()=>{(this.#t??this.#e)?.focus()},0)}onUpdatedColor(){if(!this.#t)return;const t=this.#n.commentButtonColor;t&&(this.#t.style.backgroundColor=t),this.#n._uiManager.updatePopupColor(this.#n)}get commentButtonWidth(){return(this.#t?.getBoundingClientRect().width??0)/this.#n.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#t)return null;const{x:t,y:e,height:s}=this.#t.getBoundingClientRect(),{x:a,y:o,width:l,height:u}=this.#n.parent.boundingClientRect;return[(t-a)/l,(e+s-o)/u]}set commentPopupPositionInLayer(t){this.#l=t}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#t?.remove(),this.#t=null}removeToolbarCommentButton(){this.#e?.remove(),this.#e=null}setCommentButtonStates({selected:t,hasPopup:e}){this.#t&&(this.#t.classList.toggle("selected",t),this.#t.ariaExpanded=e)}#d(t,e){if(!this.#n._uiManager.hasCommentManager())return null;t.tabIndex="0",t.ariaHasPopup="dialog",e?(t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(t.ariaControlsElements=[this.#n._uiManager.getCommentDialogElement()],t.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const s=this.#n._uiManager._signal;if(!(s instanceof AbortSignal)||s.aborted)return t;t.addEventListener("contextmenu",wn,{signal:s}),e&&(t.addEventListener("focusin",o=>{this.#n._focusEventsAllowed=!1,ae(o)},{capture:!0,signal:s}),t.addEventListener("focusout",o=>{this.#n._focusEventsAllowed=!0,ae(o)},{capture:!0,signal:s})),t.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:s});const a=o=>{o.preventDefault(),t===this.#e?this.edit():this.#n.toggleComment(!0)};return t.addEventListener("click",a,{capture:!0,signal:s}),t.addEventListener("keydown",o=>{o.target===t&&o.key==="Enter"&&(this.#i=!0,a(o))},{signal:s}),t.addEventListener("pointerenter",()=>{this.#n.toggleComment(!1,!0)},{signal:s}),t.addEventListener("pointerleave",()=>{this.#n.toggleComment(!1,!1)},{signal:s}),t}edit(t){const e=this.commentPopupPositionInLayer;let s,a;if(e)[s,a]=e;else{[s,a]=this.#n.commentButtonPosition;const{width:m,height:y,x:b,y:v}=this.#n;s=b+s*m,a=v+a*y}const o=this.#n.parent.boundingClientRect,{x:l,y:u,width:d,height:f}=o;this.#n._uiManager.editComment(this.#n,l+s*d,u+a*f,{...t,parentDimensions:o})}finish(){this.#e&&(this.#e.focus({focusVisible:this.#i}),this.#i=!1)}isDeleted(){return this.#c||this.#s===""}isEmpty(){return this.#s===null}hasBeenEdited(){return this.isDeleted()||this.#s!==this.#a}serialize(){return this.data}get data(){return{text:this.#s,richText:this.#r,date:this.#o,deleted:this.isDeleted()}}set data(t){if(t!==this.#s&&(this.#r=null),t===null){this.#s="",this.#c=!0;return}this.#s=t,this.#o=new Date,this.#c=!1}restoreData({text:t,richText:e,date:s}){this.#s=t,this.#r=e,this.#o=s,this.#c=!1}setInitialText(t,e=null){this.#a=t,this.data=t,this.#o=null,this.#r=e}shown(){}destroy(){this.#e?.remove(),this.#e=null,this.#t?.remove(),this.#t=null,this.#s="",this.#r=null,this.#o=null,this.#n=null,this.#i=!1,this.#c=!1}}class kl{#t;#e=!1;#i=null;#n;#a;#r;#s;#o=null;#c;#l=null;#d;#h=null;constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:s=null,onPinchStart:a=null,onPinching:o=null,onPinchEnd:l=null,signal:u}){this.#t=t,this.#i=s,this.#n=e,this.#a=a,this.#r=o,this.#s=l,this.#d=new AbortController,this.#c=AbortSignal.any([u,this.#d.signal]),t.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Fn.pixelRatio}#f(t){if(this.#n?.())return;if(t.touches.length===1){if(this.#o)return;const a=this.#o=new AbortController,o=AbortSignal.any([this.#c,a.signal]),l=this.#t,u={capture:!0,signal:o,passive:!1},d=f=>{f.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};l.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(ae(f),d(f))},u),l.addEventListener("pointerup",d,u),l.addEventListener("pointercancel",d,u);return}if(!this.#h){this.#h=new AbortController;const a=AbortSignal.any([this.#c,this.#h.signal]),o=this.#t,l={signal:a,capture:!1,passive:!1};o.addEventListener("touchmove",this.#g.bind(this),l);const u=this.#m.bind(this);o.addEventListener("touchend",u,l),o.addEventListener("touchcancel",u,l),l.capture=!0,o.addEventListener("pointerdown",ae,l),o.addEventListener("pointermove",ae,l),o.addEventListener("pointercancel",ae,l),o.addEventListener("pointerup",ae,l),this.#a?.()}if(ae(t),t.touches.length!==2||this.#i?.()){this.#l=null;return}let[e,s]=t.touches;e.identifier>s.identifier&&([e,s]=[s,e]),this.#l={touch0X:e.screenX,touch0Y:e.screenY,touch1X:s.screenX,touch1Y:s.screenY}}#g(t){if(!this.#l||t.touches.length!==2)return;ae(t);let[e,s]=t.touches;e.identifier>s.identifier&&([e,s]=[s,e]);const{screenX:a,screenY:o}=e,{screenX:l,screenY:u}=s,d=this.#l,{touch0X:f,touch0Y:m,touch1X:y,touch1Y:b}=d,v=y-f,S=b-m,w=l-a,x=u-o,E=Math.hypot(w,x)||1,M=Math.hypot(v,S)||1;if(!this.#e&&Math.abs(M-E)<=kl.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(d.touch0X=a,d.touch0Y=o,d.touch1X=l,d.touch1Y=u,!this.#e){this.#e=!0;return}const C=[(a+l)/2,(o+u)/2];this.#r?.(C,M,E)}#m(t){t.touches.length>=2||(this.#h&&(this.#h.abort(),this.#h=null,this.#s?.()),this.#l&&(ae(t),this.#l=null,this.#e=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#o?.abort(),this.#o=null}}class ct{#t=null;#e=null;#i=null;#n=null;#a=null;#r=!1;#s=null;#o="";#c=null;#l=null;#d=null;#h=null;#f=null;#g="";#m=!1;#u=null;#p=!1;#y=!1;#v=!1;#b=null;#T=0;#x=0;#S=null;#C=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#A=!1;#E=ct._zIndex++;static _borderLineWidth=-1;static _colorManager=new Wh;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=ct.prototype._resizeWithKeyboard,e=ji.TRANSLATE_SMALL,s=ji.TRANSLATE_BIG;return bt(this,"_resizerKeyboardManager",new Lr([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,s]}],[["Escape","mac+Escape"],ct.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null,this.creationDate=t.creationDate||new Date,this.modificationDate=t.modificationDate||null,this.canAddComment=!0;const{rotation:e,rawDims:{pageWidth:s,pageHeight:a,pageX:o,pageY:l}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,a],this.pageTranslation=[o,l];const[u,d]=this.parentDimensions;this.x=t.x/u,this.y=t.y/d,this.isAttachedToDOM=!1,this.deleted=!1}updatePageIndex(t){this.pageIndex=t}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return bt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new _w({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(ct._l10n??=t,ct._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),ct._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);ct._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){zt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#A}set _isDraggable(t){this.#A=t,this.div?.classList.toggle("draggable",t)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#E}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(this.#P(),this.#h?.remove(),this.#h=null),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#m?this.#m=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,s,a){const[o,l]=this.parentDimensions;[s,a]=this.screenToPageTranslation(s,a),this.x=(t+s)/o,this.y=(e+a)/l,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[s,a]=this.parentDimensions;this.setAt(t*s,e*a,this.width*s,this.height*a),this._onTranslated()}#N([t,e],s,a){[s,a]=this.screenToPageTranslation(s,a),this.x+=s/t,this.y+=a/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,e){this.#N(this.parentDimensions,t,e)}translateInPage(t,e){this.#u||=[this.x,this.y,this.width,this.height],this.#N(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){this.#u||=[this.x,this.y,this.width,this.height];const{div:s,parentDimensions:[a,o]}=this;if(this.x+=t/a,this.y+=e/o,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:y,y:b}=this.div.getBoundingClientRect();this.parent.findNewParent(this,y,b)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:u}=this;const[d,f]=this.getBaseTranslation();l+=d,u+=f;const{style:m}=s;m.left=`${(100*l).toFixed(2)}%`,m.top=`${(100*u).toFixed(2)}%`,this._onTranslating(l,u),s.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}get _hasBeenResized(){return!!this.#u&&(this.#u[2]!==this.width||this.#u[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:s}=ct,a=s/t,o=s/e;switch(this.rotation){case 90:return[-a,o];case 180:return[a,o];case 270:return[a,-o];default:return[-a,-o]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[s,a]}=this;let{x:o,y:l,width:u,height:d}=this;if(u*=s,d*=a,o*=s,l*=a,this._mustFixPosition)switch(t){case 0:o=De(o,0,s-u),l=De(l,0,a-d);break;case 90:o=De(o,0,s-d),l=De(l,u,a);break;case 180:o=De(o,u,s),l=De(l,d,a);break;case 270:o=De(o,d,s),l=De(l,0,a-u);break}this.x=o/=s,this.y=l/=a;const[f,m]=this.getBaseTranslation();o+=f,l+=m,e.left=`${(100*o).toFixed(2)}%`,e.top=`${(100*l).toFixed(2)}%`,this.moveInDOM()}static#M(t,e,s){switch(s){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return ct.#M(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return ct.#M(t,e,360-this.parentRotation)}#D(t){switch(t){case 90:{const[e,s]=this.pageDimensions;return[0,-e/s,s/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,s]=this.pageDimensions;return[0,e/s,-s/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,s]}=this;return[e*t,s*t]}setDims(){const{div:{style:t},width:e,height:s}=this;t.width=`${(100*e).toFixed(2)}%`,t.height=`${(100*s).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#j(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const s of t){const a=document.createElement("div");this.#c.append(a),a.classList.add("resizer",s),a.setAttribute("data-resizer-name",s),a.addEventListener("pointerdown",this.#k.bind(this,s),{signal:e}),a.addEventListener("contextmenu",wn,{signal:e}),a.tabIndex=-1}this.div.prepend(this.#c)}#k(t,e){e.preventDefault();const{isMac:s}=be.platform;if(e.button!==0||e.ctrlKey&&s)return;this.#i?.toggle(!1);const a=this._isDraggable;this._isDraggable=!1,this.#l=[e.screenX,e.screenY];const o=new AbortController,l=this._uiManager.combinedSignal(o);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#B.bind(this,t),{passive:!0,capture:!0,signal:l}),window.addEventListener("touchmove",ae,{passive:!1,signal:l}),window.addEventListener("contextmenu",wn,{signal:l}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const u=this.parent.div.style.cursor,d=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const f=()=>{o.abort(),this.parent.togglePointerEvents(!0),this.#i?.toggle(!0),this._isDraggable=a,this.parent.div.style.cursor=u,this.div.style.cursor=d,this.#F()};window.addEventListener("pointerup",f,{signal:l}),window.addEventListener("blur",f,{signal:l})}#L(t,e,s,a){this.width=s,this.height=a,this.x=t,this.y=e,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#F(){if(!this.#d)return;const{savedX:t,savedY:e,savedWidth:s,savedHeight:a}=this.#d;this.#d=null;const o=this.x,l=this.y,u=this.width,d=this.height;o===t&&l===e&&u===s&&d===a||this.addCommands({cmd:this.#L.bind(this,o,l,u,d),undo:this.#L.bind(this,t,e,s,a),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#B(t,e){const[s,a]=this.parentDimensions,o=this.x,l=this.y,u=this.width,d=this.height,f=ct.MIN_SIZE/s,m=ct.MIN_SIZE/a,y=this.#D(this.rotation),b=(O,H)=>[y[0]*O+y[2]*H,y[1]*O+y[3]*H],v=this.#D(360-this.rotation),S=(O,H)=>[v[0]*O+v[2]*H,v[1]*O+v[3]*H];let w,x,E=!1,M=!1;switch(t){case"topLeft":E=!0,w=(O,H)=>[0,0],x=(O,H)=>[O,H];break;case"topMiddle":w=(O,H)=>[O/2,0],x=(O,H)=>[O/2,H];break;case"topRight":E=!0,w=(O,H)=>[O,0],x=(O,H)=>[0,H];break;case"middleRight":M=!0,w=(O,H)=>[O,H/2],x=(O,H)=>[0,H/2];break;case"bottomRight":E=!0,w=(O,H)=>[O,H],x=(O,H)=>[0,0];break;case"bottomMiddle":w=(O,H)=>[O/2,H],x=(O,H)=>[O/2,0];break;case"bottomLeft":E=!0,w=(O,H)=>[0,H],x=(O,H)=>[O,0];break;case"middleLeft":M=!0,w=(O,H)=>[0,H/2],x=(O,H)=>[O,H/2];break}const C=w(u,d),R=x(u,d);let k=b(...R);const L=ct._round(o+k[0]),P=ct._round(l+k[1]);let $=1,K=1,J,Z;if(e.fromKeyboard)({deltaX:J,deltaY:Z}=e);else{const{screenX:O,screenY:H}=e,[W,pt]=this.#l;[J,Z]=this.screenToPageTranslation(O-W,H-pt),this.#l[0]=O,this.#l[1]=H}if([J,Z]=S(J/s,Z/a),E){const O=Math.hypot(u,d);$=K=Math.max(Math.min(Math.hypot(R[0]-C[0]-J,R[1]-C[1]-Z)/O,1/u,1/d),f/u,m/d)}else M?$=De(Math.abs(R[0]-C[0]-J),f,1)/u:K=De(Math.abs(R[1]-C[1]-Z),m,1)/d;const ht=ct._round(u*$),St=ct._round(d*K);k=b(...x(ht,St));const ot=L-k[0],et=P-k[1];this.#u||=[this.x,this.y,this.width,this.height],this.width=ht,this.height=St,this.x=ot,this.y=et,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#i?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#y)return this._editToolbar;this._editToolbar=new vr(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[e,s]of t)await this._editToolbar.addButton(e,s);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#i?.destroy()}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#i||(jn.initialize(ct._l10n),this.#i=new jn(this),this.#t&&(this.#i.data=this.#t,this.#t=null)),this.#i}get altTextData(){return this.#i?.data}set altTextData(t){this.#i&&(this.#i.data=t)}get guessedAltText(){return this.#i?.guessedText}async setGuessedAltText(t){await this.#i?.setGuessedText(t)}serializeAltText(t){return this.#i?.serialize(t)}hasAltText(){return!!this.#i&&!this.#i.isEmpty()}hasAltTextData(){return this.#i?.hasData()??!1}focusCommentButton(){this.#n?.focusButton()}addCommentButton(){return this.canAddComment?this.#n||=new el(this):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(this.#a){this._uiManager.isEditingMode()&&this.#a.classList.remove("hidden");return}this.hasComment&&(this.#a=this.#n.renderForStandalone(),this.div.append(this.#a))}}removeStandaloneCommentButton(){this.#n.removeStandaloneCommentButton(),this.#a=null}hideStandaloneCommentButton(){this.#a?.classList.add("hidden")}get comment(){if(!this.#n)return null;const{data:{richText:t,text:e,date:s,deleted:a}}=this.#n;return{text:e,richText:t,date:s,deleted:a,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(t){this.#n||=new el(this),typeof t=="object"&&t!==null?this.#n.restoreData(t):this.#n.data=t,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:t,popupRef:e,richText:s}){if(!e||(this.#n||=new el(this),this.#n.setInitialText(t,s),!this.annotationElementId))return;const a=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);a&&this.updateFromAnnotationLayer(a)}get hasEditedComment(){return this.#n?.hasBeenEdited()}get hasDeletedComment(){return this.#n?.isDeleted()}get hasComment(){return!!this.#n&&!this.#n.isEmpty()&&!this.#n.isDeleted()}async editComment(t){this.#n||=new el(this),this.#n.edit(t)}toggleComment(t,e=void 0){this.hasComment&&this._uiManager.toggleComment(this,t,e)}setSelectedCommentButton(t){this.#n.setSelectedButton(t)}addComment(t){if(this.hasEditedComment){const[,,,a]=t.rect,[o]=this.pageDimensions,[l]=this.pageTranslation,u=l+o+1,d=a-100,f=u+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[u,d,f,a]}}}updateFromAnnotationLayer({popup:{contents:t,deleted:e}}){this.#n.data=e?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#r?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#I();const[e,s]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*s/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/s).toFixed(2)}%`);const[a,o]=this.getInitialTranslation();return this.translate(a,o),ey(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#C||=new kl({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#V.bind(this),onPinching:this.#_.bind(this),onPinchEnd:this.#w.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),t}#V(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#i?.toggle(!1),this.parent.togglePointerEvents(!1)}#_(t,e,s){let o=.7*(s/e)+1-.7;if(o===1)return;const l=this.#D(this.rotation),u=(L,P)=>[l[0]*L+l[2]*P,l[1]*L+l[3]*P],[d,f]=this.parentDimensions,m=this.x,y=this.y,b=this.width,v=this.height,S=ct.MIN_SIZE/d,w=ct.MIN_SIZE/f;o=Math.max(Math.min(o,1/b,1/v),S/b,w/v);const x=ct._round(b*o),E=ct._round(v*o);if(x===b&&E===v)return;this.#u||=[m,y,b,v];const M=u(b/2,v/2),C=ct._round(m+M[0]),R=ct._round(y+M[1]),k=u(x/2,E/2);this.x=C-k[0],this.y=R-k[1],this.width=x,this.height=E,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#w(){this.#i?.toggle(!0),this.parent.togglePointerEvents(!0),this.#F()}pointerdown(t){const{isMac:e}=be.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(this.#m=!0,this._isDraggable){this.#z(t);return}this.#O(t)}#O(t){const{isMac:e}=be.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#z(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let s=!1;const a=new AbortController,o=this._uiManager.combinedSignal(a),l={capture:!0,passive:!1,signal:o},u=f=>{a.abort(),this.#s=null,this.#m=!1,this._uiManager.endDragSession()||this.#O(f),s&&this._onStopDragging()};e&&(this.#T=t.clientX,this.#x=t.clientY,this.#s=t.pointerId,this.#o=t.pointerType,window.addEventListener("pointermove",f=>{s||(s=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:m,clientY:y,pointerId:b}=f;if(b!==this.#s){ae(f);return}const[v,S]=this.screenToPageTranslation(m-this.#T,y-this.#x);this.#T=m,this.#x=y,this._uiManager.dragSelectedEditors(v,S)},l),window.addEventListener("touchmove",ae,l),window.addEventListener("pointerdown",f=>{f.pointerType===this.#o&&(this.#C||f.isPrimary)&&u(f),ae(f)},l));const d=f=>{if(!this.#s||this.#s===f.pointerId){u(f);return}ae(f)};window.addEventListener("pointerup",d,{signal:o}),window.addEventListener("blur",d,{signal:o})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#b&&clearTimeout(this.#b),this.#b=setTimeout(()=>{this.#b=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,s){t.changeParent(this),this.x=e,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,s=this.rotation){const a=this.parentScale,[o,l]=this.pageDimensions,[u,d]=this.pageTranslation,f=t/a,m=e/a,y=this.x*o,b=this.y*l,v=this.width*o,S=this.height*l;switch(s){case 0:return[y+f+u,l-b-m-S+d,y+f+v+u,l-b-m+d];case 90:return[y+m+u,l-b+f+d,y+m+S+u,l-b+f+v+d];case 180:return[y-f-v+u,l-b+m+d,y-f+u,l-b+m+S+d];case 270:return[y-m-S+u,l-b-f-v+d,y-m+u,l-b-f+d];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[s,a,o,l]=t,u=o-s,d=l-a;switch(this.rotation){case 0:return[s,e-l,u,d];case 90:return[s,e-a,d,u];case 180:return[o,e-a,u,d];case 270:return[o,e-l,d,u];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&ct._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#n?.onUpdatedColor()}getData(){const{comment:{text:t,color:e,date:s,opacity:a,deleted:o,richText:l},uid:u,pageIndex:d,creationDate:f,modificationDate:m}=this;return{id:u,pageIndex:d,rect:this.getPDFRect(),richText:l,contentsObj:{str:t},creationDate:f,modificationDate:s||m,popupRef:!o,color:e,opacity:a}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#y=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#y=!1,!0):!1}isInEditMode(){return this.#y}shouldGetKeyboardEvents(){return this.#v}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:s,right:a}=this.getClientDimensions(),{innerHeight:o,innerWidth:l}=window;return e<l&&a>0&&t<o&&s>0}#I(){if(this.#f||!this.div)return;this.#f=new AbortController;const t=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#I()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(t,e,s){const a=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:s,annotationElementId:t.annotationElementId,creationDate:t.creationDate,modificationDate:t.modificationDate});a.rotation=t.rotation,a.#t=t.accessibilityData,a._isCopy=t.isCopy||!1;const[o,l]=a.pageDimensions,[u,d,f,m]=a.getRectInCurrentCoords(t.rect,l);return a.x=u/o,a.y=d/l,a.width=f/o,a.height=m/l,a}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),this.#b&&(clearTimeout(this.#b),this.#b=null),this.#P(),this.removeEditToolbar(),this.#S){for(const t of this.#S.values())clearTimeout(t);this.#S=null}this.parent=null,this.#C?.destroy(),this.#C=null,this.#h?.remove(),this.#h=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#j(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[t,e]}=this,[s,a,o,l]=this.getPDFRect();return[ct._round(s+(o-s)*t),ct._round(a+(l-a)*(1-e))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#n.commentPopupPositionInLayer}set commentPopupPosition(t){this.#n.commentPopupPositionInLayer=t}hasDefaultPopupPosition(){return this.#n.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#n.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(t){this.#n?.setCommentButtonStates(t)}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#c.children;if(!this.#e){this.#e=Array.from(e);const l=this.#Y.bind(this),u=this.#X.bind(this),d=this._uiManager._signal;for(const f of this.#e){const m=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",l,{signal:d}),f.addEventListener("blur",u,{signal:d}),f.addEventListener("focus",this.#$.bind(this,m),{signal:d}),f.setAttribute("data-l10n-id",ct._l10nResizer[m])}}const s=this.#e[0];let a=0;for(const l of e){if(l===s)break;a++}const o=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(o!==a){if(o<a)for(let u=0;u<a-o;u++)this.#c.append(this.#c.firstElementChild);else if(o>a)for(let u=0;u<o-a;u++)this.#c.firstElementChild.before(this.#c.lastElementChild);let l=0;for(const u of e){const f=this.#e[l++].getAttribute("data-resizer-name");u.setAttribute("data-l10n-id",ct._l10nResizer[f])}}this.#H(0),this.#v=!0,this.#c.firstElementChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#Y(t){ct._resizerKeyboardManager.exec(this,t)}#X(t){this.#v&&t.relatedTarget?.parentNode!==this.#c&&this.#P()}#$(t){this.#g=this.#v?t:""}#H(t){if(this.#e)for(const e of this.#e)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#v&&this.#B(this.#g,{deltaX:t,deltaY:e,fromKeyboard:!0})}#P(){this.#v=!1,this.#H(-1),this.#F()}_stopResizingWithKeyboard(){this.#P(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#i?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#i?.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){t.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(t){this.#p=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#S||=new Map;const{action:s}=t;let a=this.#S.get(s);a&&clearTimeout(a),a=setTimeout(()=>{this._reportTelemetry(t),this.#S.delete(s),this.#S.size===0&&(this.#S=null)},ct._telemetryTimeout),this.#S.set(s,a);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#r=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#r=!0}updateFakeAnnotationElement(t){if(!this.#h&&!this.deleted){this.#h=t.addFakeAnnotation(this);return}if(this.deleted){this.#h.remove(),this.#h=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#h.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const s=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),s.before(e)}return e}resetAnnotationElement(t){const{firstElementChild:e}=t.container;e?.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}}class _w extends ct{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Qg=3285377520,vn=4294901760,Bn=65535;class ny{constructor(t){this.h1=t?t&4294967295:Qg,this.h2=t?t&4294967295:Qg}update(t){let e,s;if(typeof t=="string"){e=new Uint8Array(t.length*2),s=0;for(let w=0,x=t.length;w<x;w++){const E=t.charCodeAt(w);E<=255?e[s++]=E:(e[s++]=E>>>8,e[s++]=E&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),s=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const a=s>>2,o=s-a*4,l=new Uint32Array(e.buffer,0,a);let u=0,d=0,f=this.h1,m=this.h2;const y=3432918353,b=461845907,v=y&Bn,S=b&Bn;for(let w=0;w<a;w++)w&1?(u=l[w],u=u*y&vn|u*v&Bn,u=u<<15|u>>>17,u=u*b&vn|u*S&Bn,f^=u,f=f<<13|f>>>19,f=f*5+3864292196):(d=l[w],d=d*y&vn|d*v&Bn,d=d<<15|d>>>17,d=d*b&vn|d*S&Bn,m^=d,m=m<<13|m>>>19,m=m*5+3864292196);switch(u=0,o){case 3:u^=e[a*4+2]<<16;case 2:u^=e[a*4+1]<<8;case 1:u^=e[a*4],u=u*y&vn|u*v&Bn,u=u<<15|u>>>17,u=u*b&vn|u*S&Bn,a&1?f^=u:m^=u}this.h1=f,this.h2=m}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&vn|t*36045&Bn,e=e*4283543511&vn|((e<<16|t>>>16)*2950163797&vn)>>>16,t^=e>>>1,t=t*444984403&vn|t*60499&Bn,e=e*3301882366&vn|((e<<16|t>>>16)*3120437893&vn)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const Rh=Object.freeze({map:null,hash:"",transfer:void 0});class Zh{#t=!1;#e=null;#i=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const s=this.#n.get(t);return s===void 0?e:Object.assign(e,s)}getRawValue(t){return this.#n.get(t)}remove(t){const e=this.#n.get(t);if(e!==void 0&&(e instanceof ct&&this.#i.delete(e.annotationElementId),this.#n.delete(t),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const s of this.#n.values())if(s instanceof ct)return;this.onAnnotationEditor(null)}}setValue(t,e){const s=this.#n.get(t);let a=!1;if(s!==void 0)for(const[o,l]of Object.entries(e))s[o]!==l&&(a=!0,s[o]=l);else a=!0,this.#n.set(t,e);a&&this.#a(),e instanceof ct&&((this.#i||=new Map).set(e.annotationElementId,e),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type))}has(t){return this.#n.has(t)}get size(){return this.#n.size}#a(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new iy(this)}get serializable(){if(this.#n.size===0)return Rh;const t=new Map,e=new ny,s=[],a=Object.create(null);let o=!1;for(const[l,u]of this.#n){const d=u instanceof ct?u.serialize(!1,a):u;u.page&&(u.pageIndex=u.page._pageIndex,delete u.page),d&&(t.set(l,d),e.update(`${l}:${JSON.stringify(d)}`),o||=!!d.bitmap)}if(o)for(const l of t.values())l.bitmap&&s.push(l.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:s}:Rh}get editorStats(){let t=null;const e=new Map;let s=0,a=0;for(const o of this.#n.values()){if(!(o instanceof ct)){o.popup&&(o.popup.deleted?a+=1:s+=1);continue}o.isCommentDeleted?a+=1:o.hasEditedComment&&(s+=1);const l=o.telemetryFinalData;if(!l)continue;const{type:u}=l;e.has(u)||e.set(u,Object.getPrototypeOf(o).constructor),t||=Object.create(null);const d=t[u]||=new Map;for(const[f,m]of Object.entries(l)){if(f==="type")continue;let y=d.get(f);y||(y=new Map,d.set(f,y));const b=y.get(m)??0;y.set(m,b+1)}}if((a>0||s>0)&&(t||=Object.create(null),t.comments={deleted:a,edited:s}),!t)return null;for(const[o,l]of e)t[o]=l.computeTelemetryFinalData(t[o]);return t}resetModifiedIds(){this.#e=null}updateEditor(t,e){const s=this.#i?.get(t);return s?(s.updateFromAnnotationLayer(e),!0):!1}getEditor(t){return this.#i?.get(t)||null}get modifiedIds(){if(this.#e)return this.#e;const t=[];if(this.#i)for(const e of this.#i.values())e.serialize()&&t.push(e.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#n.entries()}}class iy extends Zh{#t;constructor(t){super();const{map:e,hash:s,transfer:a}=t.serializable,o=structuredClone(e,a?{transfer:a}:null);this.#t={map:o,hash:s,transfer:a}}get print(){zt("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return bt(this,"modifiedIds",{ids:new Set,hash:""})}}class Cw{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:s}){if(!(!t||this.#t.has(t.loadedName))){if(Ft(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:a,src:o,style:l}=t,u=new FontFace(a,o,l);this.addNativeFontFace(u);try{await u.load(),this.#t.add(a),s?.(t)}catch{yt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(u)}return}zt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const s=t.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(a){throw yt(`Failed to load font '${s.family}': '${a}'.`),t.disableFontFace=!0,a}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const a=this._queueLoadingCallback(s);this._prepareFontLoadEvent(t,a)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return bt(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return bt(this,"isSyncFontLoadingSupported",Le||be.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(Ft(!a.done,"completeRequest() cannot be called twice."),a.done=!0;s.length>0&&s[0].done;){const o=s.shift();setTimeout(o.callback,0)}}const{loadingRequests:s}=this,a={done:!1,complete:e,callback:t};return s.push(a),a}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return bt(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function s(R,k){return R.charCodeAt(k)<<24|R.charCodeAt(k+1)<<16|R.charCodeAt(k+2)<<8|R.charCodeAt(k+3)&255}function a(R,k,L,P){const $=R.substring(0,k),K=R.substring(k+L);return $+P+K}let o,l;const u=this._document.createElement("canvas");u.width=1,u.height=1;const d=u.getContext("2d");let f=0;function m(R,k){if(++f>30){yt("Load test font never loaded."),k();return}if(d.font="30px "+R,d.fillText(".",0,20),d.getImageData(0,0,1,1).data[3]>0){k();return}setTimeout(m.bind(null,R,k))}const y=`lt${Date.now()}${this.loadTestFontId++}`;let b=this._loadTestFont;b=a(b,976,y.length,y);const S=16,w=1482184792;let x=s(b,S);for(o=0,l=y.length-3;o<l;o+=4)x=x-w+s(y,o)|0;o<y.length&&(x=x-w+s(y+"XXX",o)|0),b=a(b,S,4,lw(x));const E=`url(data:font/opentype;base64,${btoa(b)});`,M=`@font-face {font-family:"${y}";src:${E}}`;this.insertRule(M);const C=this._document.createElement("div");C.style.visibility="hidden",C.style.width=C.style.height="10px",C.style.position="absolute",C.style.top=C.style.left="0px";for(const R of[t.loadedName,y]){const k=this._document.createElement("span");k.textContent="Hi",k.style.fontFamily=R,C.append(k)}this._document.body.append(C),m(y,()=>{C.remove(),e.complete()})}}class Mw{#t;constructor(t,e=null,s,a){this.compiledGlyphs=Object.create(null),this.#t=t,this._inspectFont=e,s&&Object.assign(this,s),a&&(this.charProcOperatorList=a)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${this.data.toBase64()});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${t}}`}return this._inspectFont?.(this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const s=this.loadedName+"_path_"+e;let a;try{a=t.get(s)}catch(l){yt(`getPathGenerator - ignoring character: "${l}".`)}const o=ty(a?.path);return this.fontExtraProperties||t.delete(s),this.compiledGlyphs[e]=o}get black(){return this.#t.black}get bold(){return this.#t.bold}get disableFontFace(){return this.#t.disableFontFace??!1}set disableFontFace(t){bt(this,"disableFontFace",!!t)}get fontExtraProperties(){return this.#t.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#t.isInvalidPDFjsFont}get isType3Font(){return this.#t.isType3Font}get italic(){return this.#t.italic}get missingFile(){return this.#t.missingFile}get remeasure(){return this.#t.remeasure}get vertical(){return this.#t.vertical}get ascent(){return this.#t.ascent}get defaultWidth(){return this.#t.defaultWidth}get descent(){return this.#t.descent}get bbox(){return this.#t.bbox}set bbox(t){bt(this,"bbox",t)}get fontMatrix(){return this.#t.fontMatrix}get fallbackName(){return this.#t.fallbackName}get loadedName(){return this.#t.loadedName}get mimetype(){return this.#t.mimetype}get name(){return this.#t.name}get data(){return this.#t.data}clearData(){this.#t.clearData()}get cssFontInfo(){return this.#t.cssFontInfo}get systemFontInfo(){return this.#t.systemFontInfo}get defaultVMetrics(){return this.#t.defaultVMetrics}}class ra{#t;#e;#i;static strings=["fontFamily","fontWeight","italicAngle"];static write(t){const e=new TextEncoder,s={};let a=0;for(const f of ra.strings){const m=e.encode(t[f]);s[f]=m,a+=4+m.length}const o=new ArrayBuffer(a),l=new Uint8Array(o),u=new DataView(o);let d=0;for(const f of ra.strings){const m=s[f],y=m.length;u.setUint32(d,y),l.set(m,d+4),d+=4+y}return Ft(d===o.byteLength,"CssFontInfo.write: Buffer overflow"),o}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#i=new TextDecoder}#n(t){Ft(t<ra.strings.length,"Invalid string index");let e=0;for(let a=0;a<t;a++)e+=this.#e.getUint32(e)+4;const s=this.#e.getUint32(e);return this.#i.decode(new Uint8Array(this.#t,e+4,s))}get fontFamily(){return this.#n(0)}get fontWeight(){return this.#n(1)}get italicAngle(){return this.#n(2)}}class oa{#t;#e;#i;static strings=["css","loadedName","baseFontName","src"];static write(t){const e=new TextEncoder,s={};let a=0;for(const b of oa.strings){const v=e.encode(t[b]);s[b]=v,a+=4+v.length}a+=4;let o,l,u=1+a;t.style&&(o=e.encode(t.style.style),l=e.encode(t.style.weight),u+=4+o.length+4+l.length);const d=new ArrayBuffer(u),f=new Uint8Array(d),m=new DataView(d);let y=0;m.setUint8(y++,t.guessFallback?1:0),m.setUint32(y,0),y+=4,a=0;for(const b of oa.strings){const v=s[b],S=v.length;a+=4+S,m.setUint32(y,S),f.set(v,y+4),y+=4+S}return m.setUint32(y-a-4,a),t.style&&(m.setUint32(y,o.length),f.set(o,y+4),y+=4+o.length,m.setUint32(y,l.length),f.set(l,y+4),y+=4+l.length),Ft(y<=d.byteLength,"SubstitionInfo.write: Buffer overflow"),d.transferToFixedLength(y)}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#i=new TextDecoder}get guessFallback(){return this.#e.getUint8(0)!==0}#n(t){Ft(t<oa.strings.length,"Invalid string index");let e=5;for(let a=0;a<t;a++)e+=this.#e.getUint32(e)+4;const s=this.#e.getUint32(e);return this.#i.decode(new Uint8Array(this.#t,e+4,s))}get css(){return this.#n(0)}get loadedName(){return this.#n(1)}get baseFontName(){return this.#n(2)}get src(){return this.#n(3)}get style(){let t=1;t+=4+this.#e.getUint32(t);const e=this.#e.getUint32(t),s=this.#i.decode(new Uint8Array(this.#t,t+4,e));t+=4+e;const a=this.#e.getUint32(t),o=this.#i.decode(new Uint8Array(this.#t,t+4,a));return{style:s,weight:o}}}class qt{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#t=Math.ceil(this.bools.length*2/8);static#e=this.#t+this.numbers.length*8;static#i=this.#e+1+8;static#n=this.#i+1+48;static#a=this.#n+1+6;#r;#s;#o;constructor({data:t,extra:e}){this.#r=t,this.#s=new TextDecoder,this.#o=new DataView(this.#r),e&&Object.assign(this,e)}#c(t){Ft(t<qt.bools.length,"Invalid boolean index");const e=Math.floor(t/4),s=t*2%8,a=this.#o.getUint8(e)>>s&3;return a===0?void 0:a===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(t){return Ft(t<qt.numbers.length,"Invalid number index"),this.#o.getFloat64(qt.#t+t*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let t=qt.#e;if(this.#o.getUint8(t)===0)return;t+=1;const s=[];for(let a=0;a<4;a++)s.push(this.#o.getInt16(t,!0)),t+=2;return s}get fontMatrix(){let t=qt.#i;if(this.#o.getUint8(t)===0)return;t+=1;const s=[];for(let a=0;a<6;a++)s.push(this.#o.getFloat64(t,!0)),t+=8;return s}get defaultVMetrics(){let t=qt.#n;if(this.#o.getUint8(t)===0)return;t+=1;const s=[];for(let a=0;a<3;a++)s.push(this.#o.getInt16(t,!0)),t+=2;return s}#d(t){Ft(t<qt.strings.length,"Invalid string index");let e=qt.#a+4;for(let o=0;o<t;o++)e+=this.#o.getUint32(e)+4;const s=this.#o.getUint32(e),a=new Uint8Array(s);return a.set(new Uint8Array(this.#r,e+4,s)),this.#s.decode(a)}get fallbackName(){return this.#d(0)}get loadedName(){return this.#d(1)}get mimetype(){return this.#d(2)}get name(){return this.#d(3)}get data(){let t=qt.#a;const e=this.#o.getUint32(t);t+=4+e;const s=this.#o.getUint32(t);t+=4+s;const a=this.#o.getUint32(t);t+=4+a;const o=this.#o.getUint32(t);if(o!==0)return new Uint8Array(this.#r,t+4,o)}clearData(){let t=qt.#a;const e=this.#o.getUint32(t);t+=4+e;const s=this.#o.getUint32(t);t+=4+s;const a=this.#o.getUint32(t);t+=4+a;const o=this.#o.getUint32(t);new Uint8Array(this.#r,t+4,o).fill(0),this.#o.setUint32(t,0)}get cssFontInfo(){let t=qt.#a;const e=this.#o.getUint32(t);t+=4+e;const s=this.#o.getUint32(t);t+=4+s;const a=this.#o.getUint32(t);if(a===0)return null;const o=new Uint8Array(a);return o.set(new Uint8Array(this.#r,t+4,a)),new ra(o.buffer)}get systemFontInfo(){let t=qt.#a;const e=this.#o.getUint32(t);t+=4+e;const s=this.#o.getUint32(t);if(s===0)return null;const a=new Uint8Array(s);return a.set(new Uint8Array(this.#r,t+4,s)),new oa(a.buffer)}static write(t){const e=t.systemFontInfo?oa.write(t.systemFontInfo):null,s=t.cssFontInfo?ra.write(t.cssFontInfo):null,a=new TextEncoder,o={};let l=0;for(const w of qt.strings)o[w]=a.encode(t[w]),l+=4+o[w].length;const u=qt.#a+4+l+4+(e?e.byteLength:0)+4+(s?s.byteLength:0)+4+(t.data?t.data.length:0),d=new ArrayBuffer(u),f=new Uint8Array(d),m=new DataView(d);let y=0;const b=qt.bools.length;let v=0,S=0;for(let w=0;w<b;w++){const x=t[qt.bools[w]];v|=(x===void 0?0:x?2:1)<<S,S+=2,(S===8||w===b-1)&&(m.setUint8(y++,v),v=0,S=0)}Ft(y===qt.#t,"FontInfo.write: Boolean properties offset mismatch");for(const w of qt.numbers)m.setFloat64(y,t[w]),y+=8;if(Ft(y===qt.#e,"FontInfo.write: Number properties offset mismatch"),t.bbox){m.setUint8(y++,4);for(const w of t.bbox)m.setInt16(y,w,!0),y+=2}else m.setUint8(y++,0),y+=8;if(Ft(y===qt.#i,"FontInfo.write: BBox properties offset mismatch"),t.fontMatrix){m.setUint8(y++,6);for(const w of t.fontMatrix)m.setFloat64(y,w,!0),y+=8}else m.setUint8(y++,0),y+=48;if(Ft(y===qt.#n,"FontInfo.write: FontMatrix properties offset mismatch"),t.defaultVMetrics){m.setUint8(y++,1);for(const w of t.defaultVMetrics)m.setInt16(y,w,!0),y+=2}else m.setUint8(y++,0),y+=6;Ft(y===qt.#a,"FontInfo.write: DefaultVMetrics properties offset mismatch"),m.setUint32(qt.#a,0),y+=4;for(const w of qt.strings){const x=o[w],E=x.length;m.setUint32(y,E),f.set(x,y+4),y+=4+E}if(m.setUint32(qt.#a,y-qt.#a-4),!e)m.setUint32(y,0),y+=4;else{const w=e.byteLength;m.setUint32(y,w),Ft(y+4+w<=d.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),f.set(new Uint8Array(e),y+4),y+=4+w}if(!s)m.setUint32(y,0),y+=4;else{const w=s.byteLength;m.setUint32(y,w),Ft(y+4+w<=d.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),f.set(new Uint8Array(s),y+4),y+=4+w}return t.data===void 0?(m.setUint32(y,0),y+=4):(m.setUint32(y,t.data.length),f.set(t.data,y+4),y+=4+t.data.length),Ft(y<=d.byteLength,"FontInfo.write: Buffer overflow"),d.transferToFixedLength(y)}}class Se{static#t=0;static#e=1;static#i=2;static#n=3;static#a=4;static#r=8;static#s=12;static#o=16;constructor(t){this.buffer=t,this.view=new DataView(t),this.data=new Uint8Array(t)}static write(t){let e,s=null,a=[],o=[],l=[],u=[],d=null,f=null;switch(t[0]){case"RadialAxial":e=t[1]==="axial"?1:2,s=t[2],l=t[3],e===1?a.push(...t[4],...t[5]):a.push(t[4][0],t[4][1],t[6],t[5][0],t[5][1],t[7]);break;case"Mesh":e=3,d=t[1],a=t[2],o=t[3],u=t[4]||[],s=t[6],f=t[7];break;default:throw new Error(`Unsupported pattern type: ${t[0]}`)}const m=Math.floor(a.length/2),y=Math.floor(o.length/3),b=l.length,v=u.length;let S=0;for(const k of u)S+=1,S=Math.ceil(S/4)*4,S+=4+k.coords.length*4,S+=4+k.colors.length*4,k.verticesPerRow!==void 0&&(S+=4);const w=20+m*8+y*3+b*8+(s?16:0)+(f?3:0)+S,x=new ArrayBuffer(w),E=new DataView(x),M=new Uint8Array(x);E.setUint8(Se.#t,e),E.setUint8(Se.#e,s?1:0),E.setUint8(Se.#i,f?1:0),E.setUint8(Se.#n,d),E.setUint32(Se.#a,m,!0),E.setUint32(Se.#r,y,!0),E.setUint32(Se.#s,b,!0),E.setUint32(Se.#o,v,!0);let C=20;new Float32Array(x,C,m*2).set(a),C+=m*8,M.set(o,C),C+=y*3;for(const[k,L]of l)E.setFloat32(C,k,!0),C+=4,E.setUint32(C,parseInt(L.slice(1),16),!0),C+=4;if(s)for(const k of s)E.setFloat32(C,k,!0),C+=4;f&&(M.set(f,C),C+=3);for(let k=0;k<u.length;k++){const L=u[k];E.setUint8(C,L.type),C+=1,C=Math.ceil(C/4)*4,E.setUint32(C,L.coords.length,!0),C+=4,new Int32Array(x,C,L.coords.length).set(L.coords),C+=L.coords.length*4,E.setUint32(C,L.colors.length,!0),C+=4,new Int32Array(x,C,L.colors.length).set(L.colors),C+=L.colors.length*4,L.verticesPerRow!==void 0&&(E.setUint32(C,L.verticesPerRow,!0),C+=4)}return x}getIR(){const t=this.view,e=this.data[Se.#t],s=!!this.data[Se.#e],a=!!this.data[Se.#i],o=t.getUint32(Se.#a,!0),l=t.getUint32(Se.#r,!0),u=t.getUint32(Se.#s,!0),d=t.getUint32(Se.#o,!0);let f=20;const m=new Float32Array(this.buffer,f,o*2);f+=o*8;const y=new Uint8Array(this.buffer,f,l*3);f+=l*3;const b=[];for(let x=0;x<u;++x){const E=t.getFloat32(f,!0);f+=4;const M=t.getUint32(f,!0);f+=4,b.push([E,`#${M.toString(16).padStart(6,"0")}`])}let v=null;if(s){v=[];for(let x=0;x<4;++x)v.push(t.getFloat32(f,!0)),f+=4}let S=null;a&&(S=new Uint8Array(this.buffer,f,3),f+=3);const w=[];for(let x=0;x<d;++x){const E=t.getUint8(f);f+=1,f=Math.ceil(f/4)*4;const M=t.getUint32(f,!0);f+=4;const C=new Int32Array(this.buffer,f,M);f+=M*4;const R=t.getUint32(f,!0);f+=4;const k=new Int32Array(this.buffer,f,R);f+=R*4;const L={type:E,coords:C,colors:k};E===_h.LATTICE&&(L.verticesPerRow=t.getUint32(f,!0),f+=4),w.push(L)}if(e===1)return["RadialAxial","axial",v,b,Array.from(m.slice(0,2)),Array.from(m.slice(2,4)),null,null];if(e===2)return["RadialAxial","radial",v,b,[m[0],m[1]],[m[3],m[4]],m[2],m[5]];if(e===3){const x=this.data[Se.#n];let E=null;if(m.length>0){let M=m[0],C=m[0],R=m[1],k=m[1];for(let L=0;L<m.length;L+=2){const P=m[L],$=m[L+1];M=M>P?P:M,R=R>$?$:R,C=C<P?P:C,k=k<$?$:k}E=[M,R,C,k]}return["Mesh",x,m,y,w,E,v,S]}throw new Error(`Unsupported pattern kind: ${e}`)}}class Dw{static write(t){let e,s;return be.isFloat16ArraySupported?(s=new ArrayBuffer(t.length*2),e=new Float16Array(s)):(s=new ArrayBuffer(t.length*4),e=new Float32Array(s)),e.set(t),s}#t;constructor(t){this.#t=t}get path(){return be.isFloat16ArraySupported?new Float16Array(this.#t):new Float32Array(this.#t)}}function Nw(h){if(h instanceof URL)return h.href;if(typeof h=="string"){if(Le)return h;const t=URL.parse(h,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function Rw(h){if(Le&&typeof Buffer<"u"&&h instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(h instanceof Uint8Array&&h.byteLength===h.buffer.byteLength)return h;if(typeof h=="string")return Nl(h);if(h instanceof ArrayBuffer||ArrayBuffer.isView(h)||typeof h=="object"&&!isNaN(h?.length))return new Uint8Array(h);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function nl(h){if(typeof h!="string")return null;if(h.endsWith("/"))return h;throw new Error(`Invalid factory url: "${h}" must include trailing slash.`)}const kh=h=>typeof h=="object"&&Number.isInteger(h?.num)&&h.num>=0&&Number.isInteger(h?.gen)&&h.gen>=0,kw=h=>typeof h=="object"&&typeof h?.name=="string",Ow=fw.bind(null,kh,kw);class Lw{#t=new Map;#e=Promise.resolve();postMessage(t,e){const s={data:structuredClone(t,e?{transfer:e}:null)};this.#e.then(()=>{for(const[a]of this.#t)a.call(this,s)})}addEventListener(t,e,s=null){let a=null;if(s?.signal instanceof AbortSignal){const{signal:o}=s;if(o.aborted){yt("LoopbackPort - cannot use an `aborted` signal.");return}const l=()=>this.removeEventListener(t,e);a=()=>o.removeEventListener("abort",l),o.addEventListener("abort",l)}this.#t.set(e,a)}removeEventListener(t,e){this.#t.get(e)?.(),this.#t.delete(e)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const il={DATA:1,ERROR:2},pe={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Wg(){}function Ve(h){if(h instanceof Pi||h instanceof Ch||h instanceof Gg||h instanceof bl||h instanceof fh)return h;switch(h instanceof Error||typeof h=="object"&&h!==null||zt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),h.name){case"AbortException":return new Pi(h.message);case"InvalidPDFException":return new Ch(h.message);case"PasswordException":return new Gg(h.message,h.code);case"ResponseException":return new bl(h.message,h.status,h.missing);case"UnknownErrorException":return new fh(h.message,h.details)}return new fh(h.message,h.toString())}class yr{#t=new AbortController;constructor(t,e,s){this.sourceName=t,this.targetName=e,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#n(t);return}if(t.callback){const s=t.callbackId,a=this.callbackCapabilities[s];if(!a)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],t.callback===il.DATA)a.resolve(t.data);else if(t.callback===il.ERROR)a.reject(Ve(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const s=this.sourceName,a=t.sourceName,o=this.comObj;Promise.try(e,t.data).then(function(l){o.postMessage({sourceName:s,targetName:a,callback:il.DATA,callbackId:t.callbackId,data:l})},function(l){o.postMessage({sourceName:s,targetName:a,callback:il.ERROR,callbackId:t.callbackId,reason:Ve(l)})});return}if(t.streamId){this.#i(t);return}e(t.data)}on(t,e){const s=this.actionHandler;if(s[t])throw new Error(`There is already an actionName called "${t}"`);s[t]=e}send(t,e,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},s)}sendWithPromise(t,e,s){const a=this.callbackId++,o=Promise.withResolvers();this.callbackCapabilities[a]=o;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:a,data:e},s)}catch(l){o.reject(l)}return o.promise}sendWithStream(t,e,s,a){const o=this.streamId++,l=this.sourceName,u=this.targetName,d=this.comObj;return new ReadableStream({start:f=>{const m=Promise.withResolvers();return this.streamControllers[o]={controller:f,startCall:m,pullCall:null,cancelCall:null,isClosed:!1},d.postMessage({sourceName:l,targetName:u,action:t,streamId:o,data:e,desiredSize:f.desiredSize},a),m.promise},pull:f=>{const m=Promise.withResolvers();return this.streamControllers[o].pullCall=m,d.postMessage({sourceName:l,targetName:u,stream:pe.PULL,streamId:o,desiredSize:f.desiredSize}),m.promise},cancel:f=>{Ft(f instanceof Error,"cancel must have a valid reason");const m=Promise.withResolvers();return this.streamControllers[o].cancelCall=m,this.streamControllers[o].isClosed=!0,d.postMessage({sourceName:l,targetName:u,stream:pe.CANCEL,streamId:o,reason:Ve(f)}),m.promise}},s)}#i(t){const e=t.streamId,s=this.sourceName,a=t.sourceName,o=this.comObj,l=this,u=this.actionHandler[t.action],d={enqueue(f,m=1,y){if(this.isCancelled)return;const b=this.desiredSize;this.desiredSize-=m,b>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),o.postMessage({sourceName:s,targetName:a,stream:pe.ENQUEUE,streamId:e,chunk:f},y)},close(){this.isCancelled||(this.isCancelled=!0,o.postMessage({sourceName:s,targetName:a,stream:pe.CLOSE,streamId:e}),delete l.streamSinks[e])},error(f){Ft(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,o.postMessage({sourceName:s,targetName:a,stream:pe.ERROR,streamId:e,reason:Ve(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};d.sinkCapability.resolve(),d.ready=d.sinkCapability.promise,this.streamSinks[e]=d,Promise.try(u,t.data,d).then(function(){o.postMessage({sourceName:s,targetName:a,stream:pe.START_COMPLETE,streamId:e,success:!0})},function(f){o.postMessage({sourceName:s,targetName:a,stream:pe.START_COMPLETE,streamId:e,reason:Ve(f)})})}#n(t){const e=t.streamId,s=this.sourceName,a=t.sourceName,o=this.comObj,l=this.streamControllers[e],u=this.streamSinks[e];switch(t.stream){case pe.START_COMPLETE:t.success?l.startCall.resolve():l.startCall.reject(Ve(t.reason));break;case pe.PULL_COMPLETE:t.success?l.pullCall.resolve():l.pullCall.reject(Ve(t.reason));break;case pe.PULL:if(!u){o.postMessage({sourceName:s,targetName:a,stream:pe.PULL_COMPLETE,streamId:e,success:!0});break}u.desiredSize<=0&&t.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=t.desiredSize,Promise.try(u.onPull||Wg).then(function(){o.postMessage({sourceName:s,targetName:a,stream:pe.PULL_COMPLETE,streamId:e,success:!0})},function(f){o.postMessage({sourceName:s,targetName:a,stream:pe.PULL_COMPLETE,streamId:e,reason:Ve(f)})});break;case pe.ENQUEUE:if(Ft(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(t.chunk);break;case pe.CLOSE:if(Ft(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),this.#a(l,e);break;case pe.ERROR:Ft(l,"error should have stream controller"),l.controller.error(Ve(t.reason)),this.#a(l,e);break;case pe.CANCEL_COMPLETE:t.success?l.cancelCall.resolve():l.cancelCall.reject(Ve(t.reason)),this.#a(l,e);break;case pe.CANCEL:if(!u)break;const d=Ve(t.reason);Promise.try(u.onCancel||Wg,d).then(function(){o.postMessage({sourceName:s,targetName:a,stream:pe.CANCEL_COMPLETE,streamId:e,success:!0})},function(f){o.postMessage({sourceName:s,targetName:a,stream:pe.CANCEL_COMPLETE,streamId:e,reason:Ve(f)})}),u.sinkCapability.reject(d),u.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#a(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#t?.abort(),this.#t=null}}class sy{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(t,e);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,e,s){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||s<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=s}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){zt("Abstract method `_createCanvas` called.")}}class Bw extends sy{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const s=this._document.createElement("canvas");return s.width=t,s.height=e,s}}class ay{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){zt("Abstract method `_fetch` called.")}}class Zg extends ay{async _fetch(t){const e=await Rr(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):Nl(e)}}class ry{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,s,a,o){return"none"}destroy(t=!1){}}class Pw extends ry{#t;#e;#i;#n;#a;#r;#s=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#n=t,this.#a=e}get#o(){return this.#e||=new Map}get#c(){return this.#r||=new Map}get#l(){if(!this.#i){const t=this.#a.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const s=this.#a.createElementNS(si,"svg");s.setAttribute("width",0),s.setAttribute("height",0),this.#i=this.#a.createElementNS(si,"defs"),t.append(s),s.append(this.#i),this.#a.body.append(t)}return this.#i}#d(t){if(t.length===1){const d=t[0],f=new Array(256);for(let y=0;y<256;y++)f[y]=d[y]/255;const m=f.join(",");return[m,m,m]}const[e,s,a]=t,o=new Array(256),l=new Array(256),u=new Array(256);for(let d=0;d<256;d++)o[d]=e[d]/255,l[d]=s[d]/255,u[d]=a[d]/255;return[o.join(","),l.join(","),u.join(",")]}#h(t){if(this.#t===void 0){this.#t="";const e=this.#a.URL;e!==this.#a.baseURI&&(Rl(e)?yt('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=Q0(e,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let e=this.#o.get(t);if(e)return e;const[s,a,o]=this.#d(t),l=t.length===1?s:`${s}${a}${o}`;if(e=this.#o.get(l),e)return this.#o.set(t,e),e;const u=`g_${this.#n}_transfer_map_${this.#s++}`,d=this.#h(u);this.#o.set(t,d),this.#o.set(l,d);const f=this.#m(u);return this.#p(s,a,o,f),d}addHCMFilter(t,e){const s=`${t}-${e}`,a="base";let o=this.#c.get(a);if(o?.key===s||(o?(o.filter?.remove(),o.key=s,o.url="none",o.filter=null):(o={key:s,url:"none",filter:null},this.#c.set(a,o)),!t||!e))return o.url;const l=this.#v(t);t=nt.makeHexColor(...l);const u=this.#v(e);if(e=nt.makeHexColor(...u),this.#l.style.color="",t==="#000000"&&e==="#ffffff"||t===e)return o.url;const d=new Array(256);for(let v=0;v<=255;v++){const S=v/255;d[v]=S<=.03928?S/12.92:((S+.055)/1.055)**2.4}const f=d.join(","),m=`g_${this.#n}_hcm_filter`,y=o.filter=this.#m(m);this.#p(f,f,f,y),this.#g(y);const b=(v,S)=>{const w=l[v]/255,x=u[v]/255,E=new Array(S+1);for(let M=0;M<=S;M++)E[M]=w+M/S*(x-w);return E.join(",")};return this.#p(b(0,5),b(1,5),b(2,5),y),o.url=this.#h(m),o.url}addAlphaFilter(t){let e=this.#o.get(t);if(e)return e;const[s]=this.#d([t]),a=`alpha_${s}`;if(e=this.#o.get(a),e)return this.#o.set(t,e),e;const o=`g_${this.#n}_alpha_map_${this.#s++}`,l=this.#h(o);this.#o.set(t,l),this.#o.set(a,l);const u=this.#m(o);return this.#y(s,u),l}addLuminosityFilter(t){let e=this.#o.get(t||"luminosity");if(e)return e;let s,a;if(t?([s]=this.#d([t]),a=`luminosity_${s}`):a="luminosity",e=this.#o.get(a),e)return this.#o.set(t,e),e;const o=`g_${this.#n}_luminosity_map_${this.#s++}`,l=this.#h(o);this.#o.set(t,l),this.#o.set(a,l);const u=this.#m(o);return this.#f(u),t&&this.#y(s,u),l}addHighlightHCMFilter(t,e,s,a,o){const l=`${e}-${s}-${a}-${o}`;let u=this.#c.get(t);if(u?.key===l||(u?(u.filter?.remove(),u.key=l,u.url="none",u.filter=null):(u={key:l,url:"none",filter:null},this.#c.set(t,u)),!e||!s))return u.url;const[d,f]=[e,s].map(this.#v.bind(this));let m=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),y=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[b,v]=[a,o].map(this.#v.bind(this));y<m&&([m,y,b,v]=[y,m,v,b]),this.#l.style.color="";const S=(E,M,C)=>{const R=new Array(256),k=(y-m)/C,L=E/255,P=(M-E)/(255*C);let $=0;for(let K=0;K<=C;K++){const J=Math.round(m+K*k),Z=L+K*P;for(let ht=$;ht<=J;ht++)R[ht]=Z;$=J+1}for(let K=$;K<256;K++)R[K]=R[$-1];return R.join(",")},w=`g_${this.#n}_hcm_${t}_filter`,x=u.filter=this.#m(w);return this.#g(x),this.#p(S(b[0],v[0],5),S(b[1],v[1],5),S(b[2],v[2],5),x),u.url=this.#h(w),u.url}destroy(t=!1){t&&this.#r?.size||(this.#i?.parentNode.parentNode.remove(),this.#i=null,this.#e?.clear(),this.#e=null,this.#r?.clear(),this.#r=null,this.#s=0)}#f(t){const e=this.#a.createElementNS(si,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#g(t){const e=this.#a.createElementNS(si,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#m(t){const e=this.#a.createElementNS(si,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#l.append(e),e}#u(t,e,s){const a=this.#a.createElementNS(si,e);a.setAttribute("type","discrete"),a.setAttribute("tableValues",s),t.append(a)}#p(t,e,s,a){const o=this.#a.createElementNS(si,"feComponentTransfer");a.append(o),this.#u(o,"feFuncR",t),this.#u(o,"feFuncG",e),this.#u(o,"feFuncB",s)}#y(t,e){const s=this.#a.createElementNS(si,"feComponentTransfer");e.append(s),this.#u(s,"feFuncA",t)}#v(t){return this.#l.style.color=t,Or(getComputedStyle(this.#l).getPropertyValue("color"))}}class oy{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(s=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){zt("Abstract method `_fetch` called.")}}class Jg extends oy{async _fetch(t){const e=await Rr(t,"arraybuffer");return new Uint8Array(e)}}class ly{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(s=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){zt("Abstract method `_fetch` called.")}}class t0 extends ly{async _fetch(t){const e=await Rr(t,"arraybuffer");return new Uint8Array(e)}}Le&&yt("Please use the `legacy` build in Node.js environments.");async function Jh(h){const e=await process.getBuiltinModule("fs").promises.readFile(h);return new Uint8Array(e)}class jw extends ry{}class Fw extends sy{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class zw extends ay{async _fetch(t){return Jh(t)}}class Uw extends oy{async _fetch(t){return Jh(t)}}class Iw extends ly{async _fetch(t){return Jh(t)}}const Js="__forcedDependency",{floor:e0,ceil:n0}=Math;function sl(h,t,e,s,a,o){h[t*4+0]=Math.min(h[t*4+0],e),h[t*4+1]=Math.min(h[t*4+1],s),h[t*4+2]=Math.max(h[t*4+2],a),h[t*4+3]=Math.max(h[t*4+3],o)}const Oh=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class Hw{#t;#e;constructor(t,e){this.#t=t,this.#e=e}get length(){return this.#t.length}isEmpty(t){return this.#t[t]===Oh}minX(t){return this.#e[t*4+0]/256}minY(t){return this.#e[t*4+1]/256}maxX(t){return(this.#e[t*4+2]+1)/256}maxY(t){return(this.#e[t*4+3]+1)/256}}const al=(h,t)=>{if(!h)return;let e=h.get(t);return e||(e={dependencies:new Set,isRenderingOperation:!1},h.set(t,e)),e};class Gw{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[Js]:[]};#i=new Map;#n=[];#a=[];#r=[[1,0,0,1,0,0]];#s=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#d=new Map;#h=new Map;#f;#g;#m;#u;#p;constructor(t,e,s=!1){this.#f=t.width,this.#g=t.height,this.#y(e),s&&(this.#p=new Map)}growOperationsCount(t){t>=this.#u.length&&this.#y(t,this.#u)}#y(t,e){const s=new ArrayBuffer(t*4);this.#m=new Uint8ClampedArray(s),this.#u=new Uint32Array(s),e&&e.length>0?(this.#u.set(e),this.#u.fill(Oh,e.length)):this.#u.fill(Oh)}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[Js]:{__proto__:this.#e[Js]}},this.#s={__proto__:this.#s},this.#n.push(t),this}restore(t){const e=Object.getPrototypeOf(this.#t);if(e===null)return this;this.#t=e,this.#e=Object.getPrototypeOf(this.#e),this.#s=Object.getPrototypeOf(this.#s);const s=this.#n.pop();return s!==void 0&&(al(this.#p,t)?.dependencies.add(s),this.#u[t]=this.#u[s]),this}recordOpenMarker(t){return this.#n.push(t),this}getOpenMarker(){return this.#n.length===0?null:this.#n.at(-1)}recordCloseMarker(t){const e=this.#n.pop();return e!==void 0&&(al(this.#p,t)?.dependencies.add(e),this.#u[t]=this.#u[e]),this}beginMarkedContent(t){return this.#a.push(t),this}endMarkedContent(t){const e=this.#a.pop();return e!==void 0&&(al(this.#p,t)?.dependencies.add(e),this.#u[t]=this.#u[e]),this}pushBaseTransform(t){return this.#r.push(nt.multiplyByDOMMatrix(this.#r.at(-1),t.getTransform())),this}popBaseTransform(){return this.#r.length>1&&this.#r.pop(),this}recordSimpleData(t,e){return this.#t[t]=e,this}recordIncrementalData(t,e){return this.#e[t].push(e),this}resetIncrementalData(t,e){return this.#e[t].length=0,this}recordNamedData(t,e){return this.#i.set(t,e),this}recordSimpleDataFromNamed(t,e,s){this.#t[t]=this.#i.get(e)??s}recordFutureForcedDependency(t,e){return this.recordIncrementalData(Js,e),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const e of t)e in this.#t&&this.recordFutureForcedDependency(e,this.#t[e]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#l)this.recordFutureForcedDependency(Js,t);return this}resetBBox(t){return this.#c!==t&&(this.#c=t,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0),this}recordClipBox(t,e,s,a,o,l){const u=nt.multiplyByDOMMatrix(this.#r.at(-1),e.getTransform()),d=[1/0,1/0,-1/0,-1/0];nt.axialAlignedBoundingBox([s,o,a,l],u,d);const f=nt.intersect(this.#s,d);return f?(this.#s[0]=f[0],this.#s[1]=f[1],this.#s[2]=f[2],this.#s[3]=f[3]):(this.#s[0]=this.#s[1]=1/0,this.#s[2]=this.#s[3]=-1/0),this}recordBBox(t,e,s,a,o,l){const u=this.#s;if(u[0]===1/0)return this;const d=nt.multiplyByDOMMatrix(this.#r.at(-1),e.getTransform());if(u[0]===-1/0)return nt.axialAlignedBoundingBox([s,o,a,l],d,this.#o),this;const f=[1/0,1/0,-1/0,-1/0];return nt.axialAlignedBoundingBox([s,o,a,l],d,f),this.#o[0]=Math.min(this.#o[0],Math.max(f[0],u[0])),this.#o[1]=Math.min(this.#o[1],Math.max(f[1],u[1])),this.#o[2]=Math.max(this.#o[2],Math.min(f[2],u[2])),this.#o[3]=Math.max(this.#o[3],Math.min(f[3],u[3])),this}recordCharacterBBox(t,e,s,a=1,o=0,l=0,u){const d=s.bbox;let f,m;if(d&&(f=d[2]!==d[0]&&d[3]!==d[1]&&this.#h.get(s),f!==!1&&(m=[0,0,0,0],nt.axialAlignedBoundingBox(d,s.fontMatrix,m),(a!==1||o!==0||l!==0)&&nt.scaleMinMax([a,0,0,-a,o,l],m),f)))return this.recordBBox(t,e,m[0],m[2],m[1],m[3]);if(!u)return this.recordFullPageBBox(t);const y=u();return d&&m&&f===void 0&&(f=m[0]<=o-y.actualBoundingBoxLeft&&m[2]>=o+y.actualBoundingBoxRight&&m[1]<=l-y.actualBoundingBoxAscent&&m[3]>=l+y.actualBoundingBoxDescent,this.#h.set(s,f),f)?this.recordBBox(t,e,m[0],m[2],m[1],m[3]):this.recordBBox(t,e,o-y.actualBoundingBoxLeft,o+y.actualBoundingBoxRight,l-y.actualBoundingBoxAscent,l+y.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#o[0]=Math.max(0,this.#s[0]),this.#o[1]=Math.max(0,this.#s[1]),this.#o[2]=Math.min(this.#f,this.#s[2]),this.#o[3]=Math.min(this.#g,this.#s[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,e){const s=this.#l,a=this.#t,o=this.#e;for(const l of e)l in this.#t?s.add(a[l]):l in o&&o[l].forEach(s.add,s);return this}recordNamedDependency(t,e){return this.#i.has(e)&&this.#l.add(this.#i.get(e)),this}recordOperation(t,e=!1){if(this.recordDependencies(t,[Js]),this.#p){const s=al(this.#p,t),{dependencies:a}=s;this.#l.forEach(a.add,a),this.#n.forEach(a.add,a),this.#a.forEach(a.add,a),a.delete(t),s.isRenderingOperation=!0}if(this.#c===t){const s=e0(this.#o[0]*256/this.#f),a=e0(this.#o[1]*256/this.#g),o=n0(this.#o[2]*256/this.#f),l=n0(this.#o[3]*256/this.#g);sl(this.#m,t,s,a,o,l);for(const u of this.#l)u!==t&&sl(this.#m,u,s,a,o,l);for(const u of this.#n)u!==t&&sl(this.#m,u,s,a,o,l);for(const u of this.#a)u!==t&&sl(this.#m,u,s,a,o,l);e||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(t,e=!1){const s=Array.from(this.#l);this.recordOperation(t,e),this.recordIncrementalData("sameLineText",t);for(const a of s)this.recordIncrementalData("sameLineText",a);return this}bboxToClipBoxDropOperation(t,e=!1){return this.#c===t&&(this.#c=-1,this.#s[0]=Math.max(this.#s[0],this.#o[0]),this.#s[1]=Math.max(this.#s[1],this.#o[1]),this.#s[2]=Math.min(this.#s[2],this.#o[2]),this.#s[3]=Math.min(this.#s[3],this.#o[3]),e||this.#l.clear()),this}_takePendingDependencies(){const t=this.#l;return this.#l=new Set,t}_extractOperation(t){const e=this.#d.get(t);return this.#d.delete(t),e}_pushPendingDependencies(t){for(const e of t)this.#l.add(e)}take(){return this.#h.clear(),new Hw(this.#u,this.#m)}takeDebugMetadata(){return this.#p}}class vl{#t;#e;#i;#n=0;#a=0;constructor(t,e,s){if(t instanceof vl&&t.#i===!!s)return t;this.#t=t,this.#e=e,this.#i=!!s}growOperationsCount(){throw new Error("Unreachable")}save(t){return this.#a++,this.#t.save(this.#e),this}restore(t){return this.#a>0&&(this.#t.restore(this.#e),this.#a--),this}recordOpenMarker(t){return this.#n++,this}getOpenMarker(){return this.#n>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#n--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,e){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,e){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,e){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,e){return this}recordSimpleDataFromNamed(t,e,s){return this.#t.recordSimpleDataFromNamed(t,e,this.#e),this}recordFutureForcedDependency(t,e){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#i||this.#t.resetBBox(this.#e),this}recordClipBox(t,e,s,a,o,l){return this.#i||this.#t.recordClipBox(this.#e,e,s,a,o,l),this}recordBBox(t,e,s,a,o,l){return this.#i||this.#t.recordBBox(this.#e,e,s,a,o,l),this}recordCharacterBBox(t,e,s,a,o,l,u){return this.#i||this.#t.recordCharacterBBox(this.#e,e,s,a,o,l,u),this}recordFullPageBBox(t){return this.#i||this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,e){return this.#t.recordDependencies(this.#e,e),this}recordNamedDependency(t,e){return this.#t.recordNamedDependency(this.#e,e),this}recordOperation(t){return this.#t.recordOperation(this.#e,!0),this}recordShowTextOperation(t){return this.#t.recordShowTextOperation(this.#e,!0),this}bboxToClipBoxDropOperation(t){return this.#i||this.#t.bboxToClipBoxDropOperation(this.#e,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const An={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},Ne={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Lh(h,t){if(!t)return;const e=t[2]-t[0],s=t[3]-t[1],a=new Path2D;a.rect(t[0],t[1],e,s),h.clip(a)}class td{isModifyingCurrentTransform(){return!1}getPattern(){zt("Abstract method `getPattern` called.")}}class Vw extends td{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}isOriginBased(){return this._p0[0]===0&&this._p0[1]===0&&(!this.isRadial()||this._p1[0]===0&&this._p1[1]===0)}isRadial(){return this._type==="radial"}_createGradient(t,e=null){let s,a=this._p0,o=this._p1;if(e&&(a=a.slice(),o=o.slice(),nt.applyTransform(a,e),nt.applyTransform(o,e)),this._type==="axial")s=t.createLinearGradient(a[0],a[1],o[0],o[1]);else if(this._type==="radial"){let l=this._r0,u=this._r1;if(e){const d=new Float32Array(2);nt.singularValueDecompose2dScale(e,d),l*=d[0],u*=d[0]}s=t.createRadialGradient(a[0],a[1],l,o[0],o[1],u)}for(const l of this._colorStops)s.addColorStop(l[0],l[1]);return s}getPattern(t,e,s,a){let o;if(a===Ne.STROKE||a===Ne.FILL){if(this.isOriginBased()){let b=nt.transform(s,e.baseTransform);this.matrix&&(b=nt.transform(b,this.matrix));const v=.001,S=Math.hypot(b[0],b[1]),w=Math.hypot(b[2],b[3]),x=(b[0]*b[2]+b[1]*b[3])/(S*w);if(Math.abs(x)<v)if(this.isRadial()){if(Math.abs(S-w)<v)return this._createGradient(t,b)}else return this._createGradient(t,b)}const l=e.current.getClippedPathBoundingBox(a,ee(t))||[0,0,0,0],u=Math.ceil(l[2]-l[0])||1,d=Math.ceil(l[3]-l[1])||1,f=e.cachedCanvases.getCanvas("pattern",u,d),m=f.context;m.clearRect(0,0,m.canvas.width,m.canvas.height),m.beginPath(),m.rect(0,0,m.canvas.width,m.canvas.height),m.translate(-l[0],-l[1]),s=nt.transform(s,[1,0,0,1,l[0],l[1]]),m.transform(...e.baseTransform),this.matrix&&m.transform(...this.matrix),Lh(m,this._bbox),m.fillStyle=this._createGradient(m),m.fill(),o=t.createPattern(f.canvas,"no-repeat");const y=new DOMMatrix(s);o.setTransform(y)}else Lh(t,this._bbox),o=this._createGradient(t);return o}}function gh(h,t,e,s,a,o,l,u){const d=t.coords,f=t.colors,m=h.data,y=h.width*4;let b;d[e+1]>d[s+1]&&(b=e,e=s,s=b,b=o,o=l,l=b),d[s+1]>d[a+1]&&(b=s,s=a,a=b,b=l,l=u,u=b),d[e+1]>d[s+1]&&(b=e,e=s,s=b,b=o,o=l,l=b);const v=(d[e]+t.offsetX)*t.scaleX,S=(d[e+1]+t.offsetY)*t.scaleY,w=(d[s]+t.offsetX)*t.scaleX,x=(d[s+1]+t.offsetY)*t.scaleY,E=(d[a]+t.offsetX)*t.scaleX,M=(d[a+1]+t.offsetY)*t.scaleY;if(S>=M)return;const C=f[o],R=f[o+1],k=f[o+2],L=f[l],P=f[l+1],$=f[l+2],K=f[u],J=f[u+1],Z=f[u+2],ht=Math.round(S),St=Math.round(M);let ot,et,O,H,W,pt,Et,N;for(let I=ht;I<=St;I++){if(I<x){const dt=I<S?0:(S-I)/(S-x);ot=v-(v-w)*dt,et=C-(C-L)*dt,O=R-(R-P)*dt,H=k-(k-$)*dt}else{let dt;I>M?dt=1:x===M?dt=0:dt=(x-I)/(x-M),ot=w-(w-E)*dt,et=L-(L-K)*dt,O=P-(P-J)*dt,H=$-($-Z)*dt}let Q;I<S?Q=0:I>M?Q=1:Q=(S-I)/(S-M),W=v-(v-E)*Q,pt=C-(C-K)*Q,Et=R-(R-J)*Q,N=k-(k-Z)*Q;const tt=Math.round(Math.min(ot,W)),ut=Math.round(Math.max(ot,W));let gt=y*I+tt*4;for(let dt=tt;dt<=ut;dt++)Q=(ot-dt)/(ot-W),Q<0?Q=0:Q>1&&(Q=1),m[gt++]=et-(et-pt)*Q|0,m[gt++]=O-(O-Et)*Q|0,m[gt++]=H-(H-N)*Q|0,m[gt++]=255}}function qw(h,t,e){const s=t.coords,a=t.colors;let o,l;switch(t.type){case _h.LATTICE:const u=t.verticesPerRow,d=Math.floor(s.length/u)-1,f=u-1;for(o=0;o<d;o++){let m=o*u;for(let y=0;y<f;y++,m++)gh(h,e,s[m],s[m+1],s[m+u],a[m],a[m+1],a[m+u]),gh(h,e,s[m+u+1],s[m+1],s[m+u],a[m+u+1],a[m+1],a[m+u])}break;case _h.TRIANGLES:for(o=0,l=s.length;o<l;o+=3)gh(h,e,s[o],s[o+1],s[o+2],a[o],a[o+1],a[o+2]);break;default:throw new Error("illegal figure")}}class Xw extends td{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,s){const u=Math.floor(this._bounds[0]),d=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-u,m=Math.ceil(this._bounds[3])-d,y=Math.min(Math.ceil(Math.abs(f*t[0]*1.1)),3e3),b=Math.min(Math.ceil(Math.abs(m*t[1]*1.1)),3e3),v=f/y,S=m/b,w={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-d,scaleX:1/v,scaleY:1/S},x=y+4,E=b+4,M=s.getCanvas("mesh",x,E),C=M.context,R=C.createImageData(y,b);if(e){const L=R.data;for(let P=0,$=L.length;P<$;P+=4)L[P]=e[0],L[P+1]=e[1],L[P+2]=e[2],L[P+3]=255}for(const L of this._figures)qw(R,L,w);return C.putImageData(R,2,2),{canvas:M.canvas,offsetX:u-2*v,offsetY:d-2*S,scaleX:v,scaleY:S}}isModifyingCurrentTransform(){return!0}getPattern(t,e,s,a){Lh(t,this._bbox);const o=new Float32Array(2);if(a===Ne.SHADING)nt.singularValueDecompose2dScale(ee(t),o);else if(this.matrix){nt.singularValueDecompose2dScale(this.matrix,o);const[u,d]=o;nt.singularValueDecompose2dScale(e.baseTransform,o),o[0]*=u,o[1]*=d}else nt.singularValueDecompose2dScale(e.baseTransform,o);const l=this._createMeshCanvas(o,a===Ne.SHADING?null:this._background,e.cachedCanvases);return a!==Ne.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(l.offsetX,l.offsetY),t.scale(l.scaleX,l.scaleY),t.createPattern(l.canvas,"no-repeat")}}class Yw extends td{getPattern(){return"hotpink"}}function $w(h){switch(h[0]){case"RadialAxial":return new Vw(h);case"Mesh":return new Xw(h);case"Dummy":return new Yw}throw new Error(`Unknown IR type: ${h[0]}`)}const i0={COLORED:1,UNCOLORED:2};class ed{static MAX_PATTERN_SIZE=3e3;constructor(t,e,s,a){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=s,this.baseTransform=a}createPatternCanvas(t,e){const{bbox:s,operatorList:a,paintType:o,tilingType:l,color:u,canvasGraphicsFactory:d}=this;let{xstep:f,ystep:m}=this;f=Math.abs(f),m=Math.abs(m),Dl("TilingType: "+l);const y=s[0],b=s[1],v=s[2],S=s[3],w=v-y,x=S-b,E=new Float32Array(2);nt.singularValueDecompose2dScale(this.matrix,E);const[M,C]=E;nt.singularValueDecompose2dScale(this.baseTransform,E);const R=M*E[0],k=C*E[1];let L=w,P=x,$=!1,K=!1;const J=Math.ceil(f*R),Z=Math.ceil(m*k),ht=Math.ceil(w*R),St=Math.ceil(x*k);J>=ht?L=f:$=!0,Z>=St?P=m:K=!0;const ot=this.getSizeAndScale(L,this.ctx.canvas.width,R),et=this.getSizeAndScale(P,this.ctx.canvas.height,k),O=t.cachedCanvases.getCanvas("pattern",ot.size,et.size),H=O.context,W=d.createCanvasGraphics(H,e);if(W.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(W,o,u),H.translate(-ot.scale*y,-et.scale*b),W.transform(0,ot.scale,0,0,et.scale,0,0),H.save(),W.dependencyTracker?.save(),this.clipBbox(W,y,b,v,S),W.baseTransform=ee(W.ctx),W.executeOperatorList(a),W.endDrawing(),W.dependencyTracker?.restore(),H.restore(),$||K){const pt=O.canvas;$&&(L=f),K&&(P=m);const Et=this.getSizeAndScale(L,this.ctx.canvas.width,R),N=this.getSizeAndScale(P,this.ctx.canvas.height,k),I=Et.size,Q=N.size,tt=t.cachedCanvases.getCanvas("pattern-workaround",I,Q),ut=tt.context,gt=$?Math.floor(w/f):0,dt=K?Math.floor(x/m):0;for(let re=0;re<=gt;re++)for(let Xt=0;Xt<=dt;Xt++)ut.drawImage(pt,I*re,Q*Xt,I,Q,0,0,I,Q);return{canvas:tt.canvas,scaleX:Et.scale,scaleY:N.scale,offsetX:y,offsetY:b}}return{canvas:O.canvas,scaleX:ot.scale,scaleY:et.scale,offsetX:y,offsetY:b}}getSizeAndScale(t,e,s){const a=Math.max(ed.MAX_PATTERN_SIZE,e);let o=Math.ceil(t*s);return o>=a?o=a:s=o/t,{scale:s,size:o}}clipBbox(t,e,s,a,o){const l=a-e,u=o-s;t.ctx.rect(e,s,l,u),nt.axialAlignedBoundingBox([e,s,a,o],ee(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,s){const a=t.ctx,o=t.current;switch(e){case i0.COLORED:const{fillStyle:l,strokeStyle:u}=this.ctx;a.fillStyle=o.fillColor=l,a.strokeStyle=o.strokeColor=u;break;case i0.UNCOLORED:a.fillStyle=a.strokeStyle=s,o.fillColor=o.strokeColor=s;break;default:throw new rw(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,s,a,o){let l=s;a!==Ne.SHADING&&(l=nt.transform(l,e.baseTransform),this.matrix&&(l=nt.transform(l,this.matrix)));const u=this.createPatternCanvas(e,o);let d=new DOMMatrix(l);d=d.translate(u.offsetX,u.offsetY),d=d.scale(1/u.scaleX,1/u.scaleY);const f=t.createPattern(u.canvas,"repeat");return f.setTransform(d),f}}function Kw({src:h,srcPos:t=0,dest:e,width:s,height:a,nonBlackColor:o=4294967295,inverseDecode:l=!1}){const u=be.isLittleEndian?4278190080:255,[d,f]=l?[o,u]:[u,o],m=s>>3,y=s&7,b=h.length;e=new Uint32Array(e.buffer);let v=0;for(let S=0;S<a;S++){for(const x=t+m;t<x;t++){const E=t<b?h[t]:255;e[v++]=E&128?f:d,e[v++]=E&64?f:d,e[v++]=E&32?f:d,e[v++]=E&16?f:d,e[v++]=E&8?f:d,e[v++]=E&4?f:d,e[v++]=E&2?f:d,e[v++]=E&1?f:d}if(y===0)continue;const w=t<b?h[t++]:255;for(let x=0;x<y;x++)e[v++]=w&1<<7-x?f:d}return{srcPos:t,destPos:v}}const s0=16,a0=100,Qw=15,r0=10,qe=16,yh=new DOMMatrix,on=new Float32Array(2),sa=new Float32Array([1/0,1/0,-1/0,-1/0]);function Ww(h,t){if(h._removeMirroring)throw new Error("Context is already forwarding operations.");h.__originalSave=h.save,h.__originalRestore=h.restore,h.__originalRotate=h.rotate,h.__originalScale=h.scale,h.__originalTranslate=h.translate,h.__originalTransform=h.transform,h.__originalSetTransform=h.setTransform,h.__originalResetTransform=h.resetTransform,h.__originalClip=h.clip,h.__originalMoveTo=h.moveTo,h.__originalLineTo=h.lineTo,h.__originalBezierCurveTo=h.bezierCurveTo,h.__originalRect=h.rect,h.__originalClosePath=h.closePath,h.__originalBeginPath=h.beginPath,h._removeMirroring=()=>{h.save=h.__originalSave,h.restore=h.__originalRestore,h.rotate=h.__originalRotate,h.scale=h.__originalScale,h.translate=h.__originalTranslate,h.transform=h.__originalTransform,h.setTransform=h.__originalSetTransform,h.resetTransform=h.__originalResetTransform,h.clip=h.__originalClip,h.moveTo=h.__originalMoveTo,h.lineTo=h.__originalLineTo,h.bezierCurveTo=h.__originalBezierCurveTo,h.rect=h.__originalRect,h.closePath=h.__originalClosePath,h.beginPath=h.__originalBeginPath,delete h._removeMirroring},h.save=function(){t.save(),this.__originalSave()},h.restore=function(){t.restore(),this.__originalRestore()},h.translate=function(e,s){t.translate(e,s),this.__originalTranslate(e,s)},h.scale=function(e,s){t.scale(e,s),this.__originalScale(e,s)},h.transform=function(e,s,a,o,l,u){t.transform(e,s,a,o,l,u),this.__originalTransform(e,s,a,o,l,u)},h.setTransform=function(e,s,a,o,l,u){t.setTransform(e,s,a,o,l,u),this.__originalSetTransform(e,s,a,o,l,u)},h.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},h.rotate=function(e){t.rotate(e),this.__originalRotate(e)},h.clip=function(e){t.clip(e),this.__originalClip(e)},h.moveTo=function(e,s){t.moveTo(e,s),this.__originalMoveTo(e,s)},h.lineTo=function(e,s){t.lineTo(e,s),this.__originalLineTo(e,s)},h.bezierCurveTo=function(e,s,a,o,l,u){t.bezierCurveTo(e,s,a,o,l,u),this.__originalBezierCurveTo(e,s,a,o,l,u)},h.rect=function(e,s,a,o){t.rect(e,s,a,o),this.__originalRect(e,s,a,o)},h.closePath=function(){t.closePath(),this.__originalClosePath()},h.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class Zw{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,s){let a;return this.cache[t]!==void 0?(a=this.cache[t],this.canvasFactory.reset(a,e,s)):(a=this.canvasFactory.create(e,s),this.cache[t]=a),a}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function rl(h,t,e,s,a,o,l,u,d,f){const[m,y,b,v,S,w]=ee(h);if(y===0&&b===0){const M=l*m+S,C=Math.round(M),R=u*v+w,k=Math.round(R),L=(l+d)*m+S,P=Math.abs(Math.round(L)-C)||1,$=(u+f)*v+w,K=Math.abs(Math.round($)-k)||1;return h.setTransform(Math.sign(m),0,0,Math.sign(v),C,k),h.drawImage(t,e,s,a,o,0,0,P,K),h.setTransform(m,y,b,v,S,w),[P,K]}if(m===0&&v===0){const M=u*b+S,C=Math.round(M),R=l*y+w,k=Math.round(R),L=(u+f)*b+S,P=Math.abs(Math.round(L)-C)||1,$=(l+d)*y+w,K=Math.abs(Math.round($)-k)||1;return h.setTransform(0,Math.sign(y),Math.sign(b),0,C,k),h.drawImage(t,e,s,a,o,0,0,K,P),h.setTransform(m,y,b,v,S,w),[K,P]}h.drawImage(t,e,s,a,o,l,u,d,f);const x=Math.hypot(m,y),E=Math.hypot(b,v);return[x*d,E*f]}class o0{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=Th;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=ye.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,e,s){s?.(this),this.clipBox=new Float32Array([0,0,t,e]),this.minMax=sa.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=Ne.FILL,e=null){const s=this.minMax.slice();if(t===Ne.STROKE){e||zt("Stroke bounding box must include transform."),nt.singularValueDecompose2dScale(e,on);const a=on[0]*this.lineWidth/2,o=on[1]*this.lineWidth/2;s[0]-=a,s[1]-=o,s[2]+=a,s[3]+=o}return s}updateClipFromPath(){const t=nt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(sa,0)}getClippedPathBoundingBox(t=Ne.FILL,e=null){return nt.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function l0(h,t){if(t instanceof ImageData){h.putImageData(t,0,0);return}const e=t.height,s=t.width,a=e%qe,o=(e-a)/qe,l=a===0?o:o+1,u=h.createImageData(s,qe);let d=0,f;const m=t.data,y=u.data;let b,v,S,w;if(t.kind===fl.GRAYSCALE_1BPP){const x=m.byteLength,E=new Uint32Array(y.buffer,0,y.byteLength>>2),M=E.length,C=s+7>>3,R=4294967295,k=be.isLittleEndian?4278190080:255;for(b=0;b<l;b++){for(S=b<o?qe:a,f=0,v=0;v<S;v++){const L=x-d;let P=0;const $=L>C?s:L*8-7,K=$&-8;let J=0,Z=0;for(;P<K;P+=8)Z=m[d++],E[f++]=Z&128?R:k,E[f++]=Z&64?R:k,E[f++]=Z&32?R:k,E[f++]=Z&16?R:k,E[f++]=Z&8?R:k,E[f++]=Z&4?R:k,E[f++]=Z&2?R:k,E[f++]=Z&1?R:k;for(;P<$;P++)J===0&&(Z=m[d++],J=128),E[f++]=Z&J?R:k,J>>=1}for(;f<M;)E[f++]=0;h.putImageData(u,0,b*qe)}}else if(t.kind===fl.RGBA_32BPP){for(v=0,w=s*qe*4,b=0;b<o;b++)y.set(m.subarray(d,d+w)),d+=w,h.putImageData(u,0,v),v+=qe;b<l&&(w=s*a*4,y.set(m.subarray(d,d+w)),h.putImageData(u,0,v))}else if(t.kind===fl.RGB_24BPP)for(S=qe,w=s*S,b=0;b<l;b++){for(b>=o&&(S=a,w=s*S),f=0,v=w;v--;)y[f++]=m[d++],y[f++]=m[d++],y[f++]=m[d++],y[f++]=255;h.putImageData(u,0,b*qe)}else throw new Error(`bad image kind: ${t.kind}`)}function c0(h,t){if(t.bitmap){h.drawImage(t.bitmap,0,0);return}const e=t.height,s=t.width,a=e%qe,o=(e-a)/qe,l=a===0?o:o+1,u=h.createImageData(s,qe);let d=0;const f=t.data,m=u.data;for(let y=0;y<l;y++){const b=y<o?qe:a;({srcPos:d}=Kw({src:f,srcPos:d,dest:m,width:s,height:b,nonBlackColor:0})),h.putImageData(u,0,y*qe)}}function hr(h,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of e)h[s]!==void 0&&(t[s]=h[s]);h.setLineDash!==void 0&&(t.setLineDash(h.getLineDash()),t.lineDashOffset=h.lineDashOffset)}function ol(h){h.strokeStyle=h.fillStyle="#000000",h.fillRule="nonzero",h.globalAlpha=1,h.lineWidth=1,h.lineCap="butt",h.lineJoin="miter",h.miterLimit=10,h.globalCompositeOperation="source-over",h.font="10px sans-serif",h.setLineDash!==void 0&&(h.setLineDash([]),h.lineDashOffset=0);const{filter:t}=h;t!=="none"&&t!==""&&(h.filter="none")}function u0(h,t){if(t)return!0;nt.singularValueDecompose2dScale(h,on);const e=Math.fround(Fn.pixelRatio*da.PDF_TO_CSS_UNITS);return on[0]<=e&&on[1]<=e}const Jw=["butt","round","square"],tx=["miter","round","bevel"],ex={},h0={};class la{constructor(t,e,s,a,o,{optionalContentConfig:l,markedContentStack:u=null},d,f,m){this.ctx=t,this.current=new o0(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=s,this.canvasFactory=a,this.filterFactory=o,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=l,this.cachedCanvases=new Zw(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=d,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=m??null}getObject(t,e,s=null){return typeof e=="string"?(this.dependencyTracker?.recordNamedDependency(t,e),e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e)):s}beginDrawing({transform:t,viewport:e,transparency:s=!1,background:a=null}){const o=this.ctx.canvas.width,l=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=a||"#ffffff",this.ctx.fillRect(0,0,o,l),this.ctx.fillStyle=u,s){const d=this.cachedCanvases.getCanvas("transparent",o,l);this.compositeCtx=this.ctx,this.transparentCanvas=d.canvas,this.ctx=d.context,this.ctx.save(),this.ctx.transform(...ee(this.compositeCtx))}this.ctx.save(),ol(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=ee(this.ctx)}executeOperatorList(t,e,s,a,o){const l=t.argsArray,u=t.fnArray;let d=e||0;const f=l.length;if(f===d)return d;const m=f-d>r0&&typeof s=="function",y=m?Date.now()+Qw:0;let b=0;const v=this.commonObjs,S=this.objs;let w,x;for(;;){if(a!==void 0&&d===a.nextBreakPoint)return a.breakIt(d,s),d;if(!o||o(d))if(w=u[d],x=l[d]??null,w!==Sr.dependency)x===null?this[w](d):this[w](d,...x);else for(const E of x){this.dependencyTracker?.recordNamedData(E,d);const M=E.startsWith("g_")?v:S;if(!M.has(E))return M.get(E,s),d}if(d++,d===f)return d;if(m&&++b>r0){if(Date.now()>y)return s(),d;b=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const s=t.width??t.displayWidth,a=t.height??t.displayHeight;let o=Math.max(Math.hypot(e[0],e[1]),1),l=Math.max(Math.hypot(e[2],e[3]),1),u=s,d=a,f="prescale1",m,y;for(;o>2&&u>1||l>2&&d>1;){let b=u,v=d;o>2&&u>1&&(b=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),o/=u/b),l>2&&d>1&&(v=d>=16384?Math.floor(d/2)-1||1:Math.ceil(d)/2,l/=d/v),m=this.cachedCanvases.getCanvas(f,b,v),y=m.context,y.clearRect(0,0,b,v),y.drawImage(t,0,0,u,d,0,0,b,v),t=m.canvas,u=b,d=v,f=f==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:u,paintHeight:d}}_createMaskCanvas(t,e){const s=this.ctx,{width:a,height:o}=e,l=this.current.fillColor,u=this.current.patternFill,d=ee(s);let f,m,y,b;if((e.bitmap||e.data)&&e.count>1){const J=e.bitmap||e.data.buffer;m=JSON.stringify(u?d:[d.slice(0,4),l]),f=this._cachedBitmapsMap.get(J),f||(f=new Map,this._cachedBitmapsMap.set(J,f));const Z=f.get(m);if(Z&&!u){const ht=Math.round(Math.min(d[0],d[2])+d[4]),St=Math.round(Math.min(d[1],d[3])+d[5]);return this.dependencyTracker?.recordDependencies(t,An.transformAndFill),{canvas:Z,offsetX:ht,offsetY:St}}y=Z}y||(b=this.cachedCanvases.getCanvas("maskCanvas",a,o),c0(b.context,e));let v=nt.transform(d,[1/a,0,0,-1/o,0,0]);v=nt.transform(v,[1,0,0,1,0,-o]);const S=sa.slice();nt.axialAlignedBoundingBox([0,0,a,o],v,S);const[w,x,E,M]=S,C=Math.round(E-w)||1,R=Math.round(M-x)||1,k=this.cachedCanvases.getCanvas("fillCanvas",C,R),L=k.context,P=w,$=x;L.translate(-P,-$),L.transform(...v),y||(y=this._scaleImage(b.canvas,Ln(L)),y=y.img,f&&u&&f.set(m,y)),L.imageSmoothingEnabled=u0(ee(L),e.interpolate),rl(L,y,0,0,y.width,y.height,0,0,a,o),L.globalCompositeOperation="source-in";const K=nt.transform(Ln(L),[1,0,0,1,-P,-$]);return L.fillStyle=u?l.getPattern(s,this,K,Ne.FILL,t):l,L.fillRect(0,0,a,o),f&&!u&&(this.cachedCanvases.delete("fillCanvas"),f.set(m,k.canvas)),this.dependencyTracker?.recordDependencies(t,An.transformAndFill),{canvas:k.canvas,offsetX:Math.round(P),offsetY:Math.round($)}}setLineWidth(t,e){this.dependencyTracker?.recordSimpleData("lineWidth",t),e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(t,e){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=Jw[e]}setLineJoin(t,e){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=tx[e]}setMiterLimit(t,e){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=e}setDash(t,e,s){this.dependencyTracker?.recordSimpleData("dash",t);const a=this.ctx;a.setLineDash!==void 0&&(a.setLineDash(e),a.lineDashOffset=s)}setRenderingIntent(t,e){}setFlatness(t,e){}setGState(t,e){for(const[s,a]of e)switch(s){case"LW":this.setLineWidth(t,a);break;case"LC":this.setLineCap(t,a);break;case"LJ":this.setLineJoin(t,a);break;case"ML":this.setMiterLimit(t,a);break;case"D":this.setDash(t,a[0],a[1]);break;case"RI":this.setRenderingIntent(t,a);break;case"FL":this.setFlatness(t,a);break;case"Font":this.setFont(t,a[0],a[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=a;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=a;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=a;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=a?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(a);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,s=this.ctx.canvas.height,a="smaskGroupAt"+this.groupLevel,o=this.cachedCanvases.getCanvas(a,e,s);this.suspendedCtx=this.ctx;const l=this.ctx=o.context;l.setTransform(this.suspendedCtx.getTransform()),hr(this.suspendedCtx,l),Ww(l,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),hr(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,s,a){const o=a[0],l=a[1],u=a[2]-o,d=a[3]-l;u===0||d===0||(this.genericComposeSMask(e.context,s,u,d,e.subtype,e.backdrop,e.transferMap,o,l,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(s.canvas,0,0),t.restore())}genericComposeSMask(t,e,s,a,o,l,u,d,f,m,y){let b=t.canvas,v=d-m,S=f-y;if(l)if(v<0||S<0||v+s>b.width||S+a>b.height){const x=this.cachedCanvases.getCanvas("maskExtension",s,a),E=x.context;E.drawImage(b,-v,-S),E.globalCompositeOperation="destination-atop",E.fillStyle=l,E.fillRect(0,0,s,a),E.globalCompositeOperation="source-over",b=x.canvas,v=S=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const x=new Path2D;x.rect(v,S,s,a),t.clip(x),t.globalCompositeOperation="destination-atop",t.fillStyle=l,t.fillRect(v,S,s,a),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),o==="Alpha"&&u?e.filter=this.filterFactory.addAlphaFilter(u):o==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(u));const w=new Path2D;w.rect(d,f,s,a),e.clip(w),e.globalCompositeOperation="destination-in",e.drawImage(b,v,S,s,a,d,f,s,a),e.restore()}save(t){this.inSMaskMode&&hr(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&hr(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,s,a,o,l,u){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(e,s,a,o,l,u),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,s,a){let[o]=s;if(!a){o||=s[0]=new Path2D,this[e](t,o);return}if(this.dependencyTracker!==null){const l=e===Sr.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,a[0]-l,a[2]+l,a[1]-l,a[3]+l).recordDependencies(t,["transform"])}o instanceof Path2D||(o=s[0]=ty(o)),nt.axialAlignedBoundingBox(a,ee(this.ctx),this.current.minMax),this[e](t,o),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,e,s=!0){const a=this.ctx,o=this.current.strokeColor;if(a.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof o=="object"&&o?.getPattern){const l=o.isModifyingCurrentTransform()?a.getTransform():null;if(a.save(),a.strokeStyle=o.getPattern(a,this,Ln(a),Ne.STROKE,t),l){const u=new Path2D;u.addPath(e,a.getTransform().invertSelf().multiplySelf(l)),e=u}this.rescaleAndStroke(e,!1),a.restore()}else this.rescaleAndStroke(e,!0);this.dependencyTracker?.recordDependencies(t,An.stroke),s&&this.consumePath(t,e,this.current.getClippedPathBoundingBox(Ne.STROKE,ee(this.ctx))),a.globalAlpha=this.current.fillAlpha}closeStroke(t,e){this.stroke(t,e)}fill(t,e,s=!0){const a=this.ctx,o=this.current.fillColor,l=this.current.patternFill;let u=!1;if(l){const f=o.isModifyingCurrentTransform()?a.getTransform():null;if(this.dependencyTracker?.save(t),a.save(),a.fillStyle=o.getPattern(a,this,Ln(a),Ne.FILL,t),f){const m=new Path2D;m.addPath(e,a.getTransform().invertSelf().multiplySelf(f)),e=m}u=!0}const d=this.current.getClippedPathBoundingBox();this.contentVisible&&d!==null&&(this.pendingEOFill?(a.fill(e,"evenodd"),this.pendingEOFill=!1):a.fill(e)),this.dependencyTracker?.recordDependencies(t,An.fill),u&&(a.restore(),this.dependencyTracker?.restore(t)),s&&this.consumePath(t,e,d)}eoFill(t,e){this.pendingEOFill=!0,this.fill(t,e)}fillStroke(t,e){this.fill(t,e,!1),this.stroke(t,e,!1),this.consumePath(t,e)}eoFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}closeFillStroke(t,e){this.fillStroke(t,e)}closeEOFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}endPath(t,e){this.consumePath(t,e)}rawFillPath(t,e){this.ctx.fill(e),this.dependencyTracker?.recordDependencies(t,An.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=ex}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=h0}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const e=this.pendingTextPaths,s=this.ctx;if(this.dependencyTracker){const{dependencyTracker:a}=this;e!==void 0&&a.recordFutureForcedDependency("textClip",a.getOpenMarker()).recordFutureForcedDependency("textClip",t),a.recordCloseMarker(t)}if(e!==void 0){const a=new Path2D,o=s.getTransform().invertSelf();for(const{transform:l,x:u,y:d,fontSize:f,path:m}of e)m&&a.addPath(m,new DOMMatrix(l).preMultiplySelf(o).translate(u,d).scale(f,-f));s.clip(a)}delete this.pendingTextPaths}setCharSpacing(t,e){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=e}setWordSpacing(t,e){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=e}setHScale(t,e){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=e/100}setLeading(t,e){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-e}setFont(t,e,s){this.dependencyTracker?.recordSimpleData("font",t).recordSimpleDataFromNamed("fontObj",e,t);const a=this.commonObjs.get(e),o=this.current;if(!a)throw new Error(`Can't find font for ${e}`);if(o.fontMatrix=a.fontMatrix||Th,(o.fontMatrix[0]===0||o.fontMatrix[3]===0)&&yt("Invalid font matrix for font "+e),s<0?(s=-s,o.fontDirection=-1):o.fontDirection=1,this.current.font=a,this.current.fontSize=s,a.isType3Font)return;const l=a.loadedName||"sans-serif",u=a.systemFontInfo?.css||`"${l}", ${a.fallbackName}`;let d="normal";a.black?d="900":a.bold&&(d="bold");const f=a.italic?"italic":"normal";let m=s;s<s0?m=s0:s>a0&&(m=a0),this.current.fontSizeScale=s/m,this.ctx.font=`${f} ${d} ${m}px ${u}`}setTextRenderingMode(t,e){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=e}setTextRise(t,e){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=e}moveText(t,e,s){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=s}setLeadingMoveText(t,e,s){this.setLeading(t,-s),this.moveText(t,e,s)}setTextMatrix(t,e){this.dependencyTracker?.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",t);const{current:s}=this;s.textMatrix=e,s.textMatrixScale=Math.hypot(e[0],e[1]),s.x=s.lineX=0,s.y=s.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#i(t,e,s){const a=new Path2D;return a.addPath(t,new DOMMatrix(s).invertSelf().multiplySelf(e)),a}paintChar(t,e,s,a,o,l){const u=this.ctx,d=this.current,f=d.font,m=d.textRenderingMode,y=d.fontSize/d.fontSizeScale,b=m&ye.FILL_STROKE_MASK,v=!!(m&ye.ADD_TO_PATH_FLAG),S=d.patternFill&&!f.missingFile,w=d.patternStroke&&!f.missingFile;let x;if((f.disableFontFace||v||S||w)&&!f.missingFile&&(x=f.getPathGenerator(this.commonObjs,e)),x&&(f.disableFontFace||S||w)){u.save(),u.translate(s,a),u.scale(y,-y),this.dependencyTracker?.recordCharacterBBox(t,u,f);let E;if(b===ye.FILL||b===ye.FILL_STROKE)if(o){E=u.getTransform(),u.setTransform(...o);const M=this.#i(x,E,o);u.fill(M)}else u.fill(x);if(b===ye.STROKE||b===ye.FILL_STROKE)if(l){E||=u.getTransform(),u.setTransform(...l);const{a:M,b:C,c:R,d:k}=E,L=nt.inverseTransform(l),P=nt.transform([M,C,R,k,0,0],L);nt.singularValueDecompose2dScale(P,on),u.lineWidth*=Math.max(on[0],on[1])/y,u.stroke(this.#i(x,E,l))}else u.lineWidth/=y,u.stroke(x);u.restore()}else(b===ye.FILL||b===ye.FILL_STROKE)&&(u.fillText(e,s,a),this.dependencyTracker?.recordCharacterBBox(t,u,f,y,s,a,()=>u.measureText(e))),(b===ye.STROKE||b===ye.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,u,f,y,s,a,()=>u.measureText(e)).recordDependencies(t,An.stroke),u.strokeText(e,s,a));v&&((this.pendingTextPaths||=[]).push({transform:ee(u),x:s,y:a,fontSize:y,path:x}),this.dependencyTracker?.recordCharacterBBox(t,u,f,y,s,a))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let s=!1;for(let a=3;a<e.length;a+=4)if(e[a]>0&&e[a]<255){s=!0;break}return bt(this,"isFontSubpixelAAEnabled",s)}showText(t,e){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,An.showText).resetBBox(t),this.current.textRenderingMode&ye.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const s=this.current,a=s.font;if(a.isType3Font){this.showType3Text(t,e),this.dependencyTracker?.recordShowTextOperation(t);return}const o=s.fontSize;if(o===0){this.dependencyTracker?.recordOperation(t);return}const l=this.ctx,u=s.fontSizeScale,d=s.charSpacing,f=s.wordSpacing,m=s.fontDirection,y=s.textHScale*m,b=e.length,v=a.vertical,S=v?1:-1,w=a.defaultVMetrics,x=o*s.fontMatrix[0],E=s.textRenderingMode===ye.FILL&&!a.disableFontFace&&!s.patternFill;l.save(),s.textMatrix&&l.transform(...s.textMatrix),l.translate(s.x,s.y+s.textRise),m>0?l.scale(y,-1):l.scale(y,1);let M,C;const R=s.textRenderingMode&ye.FILL_STROKE_MASK,k=R===ye.FILL||R===ye.FILL_STROKE,L=R===ye.STROKE||R===ye.FILL_STROKE;if(k&&s.patternFill){l.save();const Z=s.fillColor.getPattern(l,this,Ln(l),Ne.FILL,t);M=ee(l),l.restore(),l.fillStyle=Z}if(L&&s.patternStroke){l.save();const Z=s.strokeColor.getPattern(l,this,Ln(l),Ne.STROKE,t);C=ee(l),l.restore(),l.strokeStyle=Z}let P=s.lineWidth;const $=s.textMatrixScale;if($===0||P===0?L&&(P=this.getSinglePixelWidth()):P/=$,u!==1&&(l.scale(u,u),P/=u),l.lineWidth=P,a.isInvalidPDFjsFont){const Z=[];let ht=0;for(const ot of e)Z.push(ot.unicode),ht+=ot.width;const St=Z.join("");if(l.fillText(St,0,0),this.dependencyTracker!==null){const ot=l.measureText(St);this.dependencyTracker.recordBBox(t,this.ctx,-ot.actualBoundingBoxLeft,ot.actualBoundingBoxRight,-ot.actualBoundingBoxAscent,ot.actualBoundingBoxDescent).recordShowTextOperation(t)}s.x+=ht*x*y,l.restore(),this.compose();return}let K=0,J;for(J=0;J<b;++J){const Z=e[J];if(typeof Z=="number"){K+=S*Z*o/1e3;continue}let ht=!1;const St=(Z.isSpace?f:0)+d,ot=Z.fontChar,et=Z.accent;let O,H,W=Z.width;if(v){const N=Z.vmetric||w,I=-(Z.vmetric?N[1]:W*.5)*x,Q=N[2]*x;W=N?-N[0]:W,O=I/u,H=(K+Q)/u}else O=K/u,H=0;let pt;if(a.remeasure&&W>0){pt=l.measureText(ot);const N=pt.width*1e3/o*u;if(W<N&&this.isFontSubpixelAAEnabled){const I=W/N;ht=!0,l.save(),l.scale(I,1),O/=I}else W!==N&&(O+=(W-N)/2e3*o/u)}if(this.contentVisible&&(Z.isInFont||a.missingFile)){if(E&&!et)l.fillText(ot,O,H),this.dependencyTracker?.recordCharacterBBox(t,l,pt?{bbox:null}:a,o/u,O,H,()=>pt??l.measureText(ot));else if(this.paintChar(t,ot,O,H,M,C),et){const N=O+o*et.offset.x/u,I=H-o*et.offset.y/u;this.paintChar(t,et.fontChar,N,I,M,C)}}const Et=v?W*x-St*m:W*x+St*m;K+=Et,ht&&l.restore()}v?s.y-=K:s.x+=K*y,l.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(t)}showType3Text(t,e){const s=this.ctx,a=this.current,o=a.font,l=a.fontSize,u=a.fontDirection,d=o.vertical?1:-1,f=a.charSpacing,m=a.wordSpacing,y=a.textHScale*u,b=a.fontMatrix||Th,v=e.length,S=a.textRenderingMode===ye.INVISIBLE;let w,x,E,M;if(S||l===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,s.save(),a.textMatrix&&s.transform(...a.textMatrix),s.translate(a.x,a.y+a.textRise),s.scale(y,u);const C=this.dependencyTracker;for(this.dependencyTracker=C?new vl(C,t):null,w=0;w<v;++w){if(x=e[w],typeof x=="number"){M=d*x*l/1e3,this.ctx.translate(M,0),a.x+=M*y;continue}const R=(x.isSpace?m:0)+f,k=o.charProcOperatorList[x.operatorListId];k?this.contentVisible&&(this.save(),s.scale(l,l),s.transform(...b),this.executeOperatorList(k),this.restore()):yt(`Type3 character "${x.operatorListId}" is not available.`);const L=[x.width,0];nt.applyTransform(L,b),E=L[0]*l+R,s.translate(E,0),a.x+=E*y}s.restore(),C&&(this.dependencyTracker=C)}setCharWidth(t,e,s){}setCharWidthAndBounds(t,e,s,a,o,l,u){const d=new Path2D;d.rect(a,o,l-a,u-o),this.ctx.clip(d),this.dependencyTracker?.recordBBox(t,this.ctx,a,l,o,u).recordClipBox(t,this.ctx,a,l,o,u),this.endPath(t)}getColorN_Pattern(t,e){let s;if(e[0]==="TilingPattern"){const a=this.baseTransform||ee(this.ctx),o={createCanvasGraphics:(l,u)=>new la(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new vl(this.dependencyTracker,u,!0):null)};s=new ed(e,this.ctx,o,a)}else s=this._getPattern(t,e[1],e[2]);return s}setStrokeColorN(t,...e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,e),this.current.patternStroke=!0}setFillColorN(t,...e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,e),this.current.patternFill=!0}setStrokeRGBColor(t,e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e,s=null){let a;return this.cachedPatterns.has(e)?a=this.cachedPatterns.get(e):(a=$w(this.getObject(t,e)),this.cachedPatterns.set(e,a)),s&&(a.matrix=s),a}shadingFill(t,e){if(!this.contentVisible)return;const s=this.ctx;this.save(t);const a=this._getPattern(t,e);s.fillStyle=a.getPattern(s,this,Ln(s),Ne.SHADING,t);const o=Ln(s);if(o){const{width:l,height:u}=s.canvas,d=sa.slice();nt.axialAlignedBoundingBox([0,0,l,u],o,d);const[f,m,y,b]=d;this.ctx.fillRect(f,m,y-f,b-m)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,An.transform).recordDependencies(t,An.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){zt("Should not call beginInlineImage")}beginImageData(){zt("Should not call beginImageData")}paintFormXObjectBegin(t,e,s){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),e&&this.transform(t,...e),this.baseTransform=ee(this.ctx),s)){nt.axialAlignedBoundingBox(s,this.baseTransform,this.current.minMax);const[a,o,l,u]=s,d=new Path2D;d.rect(a,o,l-a,u-o),this.ctx.clip(d),this.dependencyTracker?.recordClipBox(t,this.ctx,a,l,o,u),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,e){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const s=this.ctx;e.isolated||Dl("TODO: Support non-isolated groups."),e.knockout&&yt("Knockout groups not supported.");const a=ee(s);if(e.matrix&&s.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let o=sa.slice();nt.axialAlignedBoundingBox(e.bbox,ee(s),o);const l=[0,0,s.canvas.width,s.canvas.height];o=nt.intersect(o,l)||[0,0,0,0];const u=Math.floor(o[0]),d=Math.floor(o[1]),f=Math.max(Math.ceil(o[2])-u,1),m=Math.max(Math.ceil(o[3])-d,1);this.current.startNewPathAndClipBox([0,0,f,m]);let y="groupAt"+this.groupLevel;e.smask&&(y+="_smask_"+this.smaskCounter++%2);const b=this.cachedCanvases.getCanvas(y,f,m),v=b.context;v.translate(-u,-d),v.transform(...a);let S=new Path2D;const[w,x,E,M]=e.bbox;if(S.rect(w,x,E-w,M-x),e.matrix){const C=new Path2D;C.addPath(S,new DOMMatrix(e.matrix)),S=C}v.clip(S),e.smask&&this.smaskStack.push({canvas:b.canvas,context:v,offsetX:u,offsetY:d,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}),(!e.smask||this.dependencyTracker)&&(s.setTransform(1,0,0,1,0,0),s.translate(u,d),s.save()),hr(s,v),this.ctx=v,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(s),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++}endGroup(t,e){if(!this.contentVisible)return;this.groupLevel--;const s=this.ctx,a=this.groupStack.pop();if(this.ctx=a,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),e.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const o=ee(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...o);const l=sa.slice();nt.axialAlignedBoundingBox([0,0,s.canvas.width,s.canvas.height],o,l),this.ctx.drawImage(s.canvas,0,0),this.ctx.restore(),this.compose(l)}}beginAnnotation(t,e,s,a,o,l){if(this.#t(),ol(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),s){const u=s[2]-s[0],d=s[3]-s[1];if(l&&this.annotationCanvasMap){a=a.slice(),a[4]-=s[0],a[5]-=s[1],s=s.slice(),s[0]=s[1]=0,s[2]=u,s[3]=d,nt.singularValueDecompose2dScale(ee(this.ctx),on);const{viewportScale:f}=this,m=Math.ceil(u*this.outputScaleX*f),y=Math.ceil(d*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(m,y);const{canvas:b,context:v}=this.annotationCanvas;this.annotationCanvasMap.set(e,b),this.annotationCanvas.savedCtx=this.ctx,this.ctx=v,this.ctx.save(),this.ctx.setTransform(on[0],0,0,-on[1],0,d*on[1]),ol(this.ctx)}else{ol(this.ctx),this.endPath(t);const f=new Path2D;f.rect(s[0],s[1],u,d),this.ctx.clip(f)}}this.current=new o0(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...a),this.transform(t,...o)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,e){if(!this.contentVisible)return;const s=e.count;e=this.getObject(t,e.data,e),e.count=s;const a=this.ctx,o=this._createMaskCanvas(t,e),l=o.canvas;a.save(),a.setTransform(1,0,0,1,0,0),a.drawImage(l,o.offsetX,o.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,o.offsetX,o.offsetX+l.width,o.offsetY,o.offsetY+l.height).recordOperation(t),a.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,s,a=0,o=0,l,u){if(!this.contentVisible)return;e=this.getObject(t,e.data,e);const d=this.ctx;d.save();const f=ee(d);d.transform(s,a,o,l,0,0);const m=this._createMaskCanvas(t,e);d.setTransform(1,0,0,1,m.offsetX-f[4],m.offsetY-f[5]),this.dependencyTracker?.resetBBox(t);for(let y=0,b=u.length;y<b;y+=2){const v=nt.transform(f,[s,a,o,l,u[y],u[y+1]]);d.drawImage(m.canvas,v[4],v[5]),this.dependencyTracker?.recordBBox(t,this.ctx,v[4],v[4]+m.canvas.width,v[5],v[5]+m.canvas.height)}d.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,e){if(!this.contentVisible)return;const s=this.ctx,a=this.current.fillColor,o=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,An.transformAndFill);for(const l of e){const{data:u,width:d,height:f,transform:m}=l,y=this.cachedCanvases.getCanvas("maskCanvas",d,f),b=y.context;b.save();const v=this.getObject(t,u,l);c0(b,v),b.globalCompositeOperation="source-in",b.fillStyle=o?a.getPattern(b,this,Ln(s),Ne.FILL,t):a,b.fillRect(0,0,d,f),b.restore(),s.save(),s.transform(...m),s.scale(1,-1),rl(s,y.canvas,0,0,d,f,0,-1,1,1),this.dependencyTracker?.recordBBox(t,s,0,d,0,f),s.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,e){if(!this.contentVisible)return;const s=this.getObject(t,e);if(!s){yt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,s)}paintImageXObjectRepeat(t,e,s,a,o){if(!this.contentVisible)return;const l=this.getObject(t,e);if(!l){yt("Dependent image isn't ready yet");return}const u=l.width,d=l.height,f=[];for(let m=0,y=o.length;m<y;m+=2)f.push({transform:[s,0,0,a,o[m],o[m+1]],x:0,y:0,w:u,h:d});this.paintInlineImageXObjectGroup(t,l,f)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:s,height:a}=t,o=this.cachedCanvases.getCanvas("inlineImage",s,a),l=o.context;return l.filter=this.current.transferMaps,l.drawImage(e,0,0),l.filter="none",o.canvas}paintInlineImageXObject(t,e){if(!this.contentVisible)return;const s=e.width,a=e.height,o=this.ctx;this.save(t);const{filter:l}=o;l!=="none"&&l!==""&&(o.filter="none"),o.scale(1/s,-1/a);let u;if(e.bitmap)u=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)u=e;else{const m=this.cachedCanvases.getCanvas("inlineImage",s,a).context;l0(m,e),u=this.applyTransferMapsToCanvas(m)}const d=this._scaleImage(u,Ln(o));o.imageSmoothingEnabled=u0(ee(o),e.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,o,0,s,-a,0).recordDependencies(t,An.imageXObject).recordOperation(t),rl(o,d.img,0,0,d.paintWidth,d.paintHeight,0,-a,s,a),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,e,s){if(!this.contentVisible)return;const a=this.ctx;let o;if(e.bitmap)o=e.bitmap;else{const l=e.width,u=e.height,f=this.cachedCanvases.getCanvas("inlineImage",l,u).context;l0(f,e),o=this.applyTransferMapsToCanvas(f)}this.dependencyTracker?.resetBBox(t);for(const l of s)a.save(),a.transform(...l.transform),a.scale(1,-1),rl(a,o,l.x,l.y,l.w,l.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,a,0,1,-1,0),a.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,An.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,e){}markPointProps(t,e,s){}beginMarkedContent(t,e){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e,s){this.dependencyTracker?.beginMarkedContent(t),e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(s)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,e,s){const a=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const o=this.ctx;this.pendingClip?(a||(this.pendingClip===h0?o.clip(e,"evenodd"):o.clip(e)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=ee(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),s=Math.hypot(t[0],t[2]),a=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(s,a)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:s,c:a,d:o}=this.ctx.getTransform();let l,u;if(s===0&&a===0){const d=Math.abs(e),f=Math.abs(o);if(d===f)if(t===0)l=u=1/d;else{const m=d*t;l=u=m<1?1/m:1}else if(t===0)l=1/d,u=1/f;else{const m=d*t,y=f*t;l=m<1?1/m:1,u=y<1?1/y:1}}else{const d=Math.abs(e*o-s*a),f=Math.hypot(e,s),m=Math.hypot(a,o);if(t===0)l=m/d,u=f/d;else{const y=t*d;l=m>y?m/y:1,u=f>y?f/y:1}}this._cachedScaleForStroking[0]=l,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:s,current:{lineWidth:a}}=this,[o,l]=this.getScaleForStroking();if(o===l){s.lineWidth=(a||1)*o,s.stroke(t);return}const u=s.getLineDash();e&&s.save(),s.scale(o,l),yh.a=1/o,yh.d=1/l;const d=new Path2D;if(d.addPath(t,yh),u.length>0){const f=Math.max(o,l);s.setLineDash(u.map(m=>m/f)),s.lineDashOffset/=f}s.lineWidth=a||1,s.stroke(d),e&&s.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const h in Sr)la.prototype[h]!==void 0&&(la.prototype[Sr[h]]=la.prototype[h]);class ca{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class nx{#t;#e;constructor({parsedData:t,rawData:e}){this.#t=t,this.#e=e}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const ea=Symbol("INTERNAL");class ix{#t=!1;#e=!1;#i=!1;#n=!0;constructor(t,{name:e,intent:s,usage:a,rbGroups:o}){this.#t=!!(t&an.DISPLAY),this.#e=!!(t&an.PRINT),this.name=e,this.intent=s,this.usage=a,this.rbGroups=o}get visible(){if(this.#i)return this.#n;if(!this.#n)return!1;const{print:t,view:e}=this.usage;return this.#t?e?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,e,s=!1){t!==ea&&zt("Internal method `_setVisible` called."),this.#i=s,this.#n=e}}class sx{#t=null;#e=new Map;#i=null;#n=null;constructor(t,e=an.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#n=t.order;for(const s of t.groups)this.#e.set(s.id,new ix(e,s));if(t.baseState==="OFF")for(const s of this.#e.values())s._setVisible(ea,!1);for(const s of t.on)this.#e.get(s)._setVisible(ea,!0);for(const s of t.off)this.#e.get(s)._setVisible(ea,!1);this.#i=this.getHash()}}#a(t){const e=t.length;if(e<2)return!0;const s=t[0];for(let a=1;a<e;a++){const o=t[a];let l;if(Array.isArray(o))l=this.#a(o);else if(this.#e.has(o))l=this.#e.get(o).visible;else return yt(`Optional content group not found: ${o}`),!0;switch(s){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return s==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return Dl("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(yt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#a(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!this.#e.has(e))return yt(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!this.#e.has(e))return yt(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!this.#e.has(e))return yt(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!this.#e.has(e))return yt(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return yt(`Unknown optional content policy ${t.policy}.`),!0}return yt(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,s=!0){const a=this.#e.get(t);if(!a){yt(`Optional content group not found: ${t}`);return}if(s&&e&&a.rbGroups.length)for(const o of a.rbGroups)for(const l of o)l!==t&&this.#e.get(l)?._setVisible(ea,!1,!0);a._setVisible(ea,!!e,!0),this.#t=null}setOCGState({state:t,preserveRB:e}){let s;for(const a of t){switch(a){case"ON":case"OFF":case"Toggle":s=a;continue}const o=this.#e.get(a);if(o)switch(s){case"ON":this.setVisibility(a,!0,e);break;case"OFF":this.setVisibility(a,!1,e);break;case"Toggle":this.setVisibility(a,!o.visible,e);break}}this.#t=null}get hasInitialVisibility(){return this.#i===null||this.getHash()===this.#i}getOrder(){return this.#e.size?this.#n?this.#n.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new ny;for(const[e,s]of this.#e)t.update(`${e}:${s.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class Ol{#t=null;#e=null;_fullReader=null;_rangeReaders=new Set;_source=null;constructor(t,e,s){this._source=t,this.#t=e,this.#e=s}get _progressiveDataLength(){return this._fullReader?._loaded??0}getFullReader(){return Ft(!this._fullReader,"BasePDFStream.getFullReader can only be called once."),this._fullReader=new this.#t(this)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const s=new this.#e(this,t,e);return this._rangeReaders.add(s),s}cancelAllRequests(t){this._fullReader?.cancel(t);for(const e of new Set(this._rangeReaders))e.cancel(t)}}class Ll{onProgress=null;_contentLength=0;_filename=null;_headersCapability=Promise.withResolvers();_isRangeSupported=!1;_isStreamingSupported=!1;_loaded=0;_stream=null;constructor(t){this._stream=t}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){zt("Abstract method `read` called")}cancel(t){zt("Abstract method `cancel` called")}}class Bl{_stream=null;constructor(t,e,s){this._stream=t}async read(){zt("Abstract method `read` called")}cancel(t){zt("Abstract method `cancel` called")}}function d0(h){return h instanceof Uint8Array&&h.byteLength===h.buffer.byteLength?h.buffer:new Uint8Array(h).buffer}class ax extends Ol{_progressiveDone=!1;_queuedChunks=[];constructor(t){super(t,rx,ox);const{pdfDataRangeTransport:e}=t,{initialData:s,progressiveDone:a}=e;if(s?.length>0){const o=d0(s);this._queuedChunks.push(o)}this._progressiveDone=a,e.addRangeListener((o,l)=>{this.#t(o,l)}),e.addProgressListener((o,l)=>{l!==void 0&&this._fullReader?.onProgress?.({loaded:o,total:l})}),e.addProgressiveReadListener(o=>{this.#t(void 0,o)}),e.addProgressiveDoneListener(()=>{this._fullReader?.progressiveDone(),this._progressiveDone=!0}),e.transportReady()}#t(t,e){const s=d0(e);if(t===void 0)this._fullReader?this._fullReader._enqueue(s):this._queuedChunks.push(s);else{const a=this._rangeReaders.keys().find(o=>o._begin===t);Ft(a,"#onReceiveData - no `PDFDataTransportStreamRangeReader` instance found."),a._enqueue(s)}}getFullReader(){const t=super.getFullReader();return this._queuedChunks=null,t}getRangeReader(t,e){const s=super.getRangeReader(t,e);return s&&(s.onDone=()=>this._rangeReaders.delete(s),this._source.pdfDataRangeTransport.requestDataRange(t,e)),s}cancelAllRequests(t){super.cancelAllRequests(t),this._source.pdfDataRangeTransport.abort()}}class rx extends Ll{_done=!1;_queuedChunks=null;_requests=[];constructor(t){super(t);const{pdfDataRangeTransport:e,disableRange:s,disableStream:a}=t._source,{length:o,contentDispositionFilename:l}=e;this._queuedChunks=t._queuedChunks||[];for(const u of this._queuedChunks)this._loaded+=u.byteLength;this._done=t._progressiveDone,this._contentLength=o,this._isStreamingSupported=!a,this._isRangeSupported=!s,Kh(l)&&(this._filename=l),this._headersCapability.resolve()}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||=!0}}class ox extends Bl{onDone=null;_begin=-1;_done=!1;_queuedChunk=null;_requests=[];constructor(t,e,s){super(t,e,s),this._begin=e}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this.onDone?.()}}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this.onDone?.()}}function lx(h){let t=!0,e=s("filename\\*","i").exec(h);if(e){e=e[1];let m=u(e);return m=unescape(m),m=d(m),m=f(m),o(m)}if(e=l(h),e){const m=f(e);return o(m)}if(e=s("filename","i").exec(h),e){e=e[1];let m=u(e);return m=f(m),o(m)}function s(m,y){return new RegExp("(?:^|;)\\s*"+m+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',y)}function a(m,y){if(m){if(!/^[\x00-\xFF]+$/.test(y))return y;try{const b=new TextDecoder(m,{fatal:!0}),v=Nl(y);y=b.decode(v),t=!1}catch{}}return y}function o(m){return t&&/[\x80-\xff]/.test(m)&&(m=a("utf-8",m),t&&(m=a("iso-8859-1",m))),m}function l(m){const y=[];let b;const v=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(b=v.exec(m))!==null;){let[,w,x,E]=b;if(w=parseInt(w,10),w in y){if(w===0)break;continue}y[w]=[x,E]}const S=[];for(let w=0;w<y.length&&w in y;++w){let[x,E]=y[w];E=u(E),x&&(E=unescape(E),w===0&&(E=d(E))),S.push(E)}return S.join("")}function u(m){if(m.startsWith('"')){const y=m.slice(1).split('\\"');for(let b=0;b<y.length;++b){const v=y[b].indexOf('"');v!==-1&&(y[b]=y[b].slice(0,v),y.length=b+1),y[b]=y[b].replaceAll(/\\(.)/g,"$1")}m=y.join('"')}return m}function d(m){const y=m.indexOf("'");if(y===-1)return m;const b=m.slice(0,y),S=m.slice(y+1).replace(/^[^']*'/,"");return a(b,S)}function f(m){return!m.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(m)?m:m.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(y,b,v,S){if(v==="q"||v==="Q")return S=S.replaceAll("_"," "),S=S.replaceAll(/=([0-9a-fA-F]{2})/g,function(w,x){return String.fromCharCode(parseInt(x,16))}),a(b,S);try{S=atob(S)}catch{}return a(b,S)})}return""}function cy(h,t){const e=new Headers;if(!h||!t||typeof t!="object")return e;for(const s in t){const a=t[s];a!==void 0&&e.append(s,a)}return e}function Pl(h){return URL.parse(h)?.origin??null}function uy({responseHeaders:h,isHttp:t,rangeChunkSize:e,disableRange:s}){const a={allowRangeRequests:!1,suggestedLength:void 0},o=parseInt(h.get("Content-Length"),10);return!Number.isInteger(o)||(a.suggestedLength=o,o<=2*e)||s||!t||h.get("Accept-Ranges")!=="bytes"||(h.get("Content-Encoding")||"identity")!=="identity"||(a.allowRangeRequests=!0),a}function hy(h){const t=h.get("Content-Disposition");if(t){let e=lx(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(Kh(e))return e}return null}function jl(h,t){return new bl(`Unexpected server response (${h}) while retrieving PDF "${t}".`,h,h===404||h===0&&t.startsWith("file:"))}function dy(h,t){if(h!==t)throw new Error(`Expected range response-origin "${h}" to match "${t}".`)}function fy(h,t,e,s){return fetch(h,{method:"GET",headers:t,signal:s.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"})}function py(h,t){if(h!==200&&h!==206)throw jl(h,t)}function my(h){return h instanceof Uint8Array?h.buffer:h instanceof ArrayBuffer?h:(yt(`getArrayBuffer - unexpected data format: ${h}`),new Uint8Array(h).buffer)}class cx extends Ol{_responseOrigin=null;constructor(t){super(t,ux,hx),this.isHttp=/^https?:/i.test(t.url),this.headers=cy(this.isHttp,t.httpHeaders)}}class ux extends Ll{_abortController=new AbortController;_reader=null;constructor(t){super(t);const{disableRange:e,disableStream:s,length:a,rangeChunkSize:o,url:l,withCredentials:u}=t._source;this._contentLength=a,this._isStreamingSupported=!s,this._isRangeSupported=!e;const d=new Headers(t.headers);fy(l,d,u,this._abortController).then(f=>{t._responseOrigin=Pl(f.url),py(f.status,l),this._reader=f.body.getReader();const m=f.headers,{allowRangeRequests:y,suggestedLength:b}=uy({responseHeaders:m,isHttp:t.isHttp,rangeChunkSize:o,disableRange:e});this._isRangeSupported=y,this._contentLength=b||this._contentLength,this._filename=hy(m),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Pi("Streaming is disabled.")),this._headersCapability.resolve()}).catch(this._headersCapability.reject)}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:my(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class hx extends Bl{_abortController=new AbortController;_readCapability=Promise.withResolvers();_reader=null;constructor(t,e,s){super(t,e,s);const{url:a,withCredentials:o}=t._source,l=new Headers(t.headers);l.append("Range",`bytes=${e}-${s-1}`),fy(a,l,o,this._abortController).then(u=>{const d=Pl(u.url);dy(d,t._responseOrigin),py(u.status,a),this._reader=u.body.getReader(),this._readCapability.resolve()}).catch(this._readCapability.reject)}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:{value:my(t),done:!1}}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const bh=200,f0=206;function dx(h){return typeof h!="string"?h:Nl(h).buffer}class fx extends Ol{#t=new WeakMap;_responseOrigin=null;constructor(t){super(t,px,mx),this.url=t.url,this.isHttp=/^https?:/i.test(this.url),this.headers=cy(this.isHttp,t.httpHeaders)}_request(t){const e=new XMLHttpRequest,s={validateStatus:null,onHeadersReceived:t.onHeadersReceived,onDone:t.onDone,onError:t.onError,onProgress:t.onProgress};this.#t.set(e,s),e.open("GET",this.url),e.withCredentials=this._source.withCredentials;for(const[a,o]of this.headers)e.setRequestHeader(a,o);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),s.validateStatus=a=>a===f0||a===bh):s.validateStatus=a=>a===bh,e.responseType="arraybuffer",Ft(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>t.onError(e.status),e.onreadystatechange=this.#i.bind(this,e),e.onprogress=this.#e.bind(this,e),e.send(null),e}#e(t,e){this.#t.get(t)?.onProgress?.(e)}#i(t,e){const s=this.#t.get(t);if(!s||(t.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),t.readyState!==4)||!this.#t.has(t))return;if(this.#t.delete(t),t.status===0&&this.isHttp){s.onError(t.status);return}const a=t.status||bh;if(!s.validateStatus(a)){s.onError(t.status);return}const o=dx(t.response);if(a===f0){const l=t.getResponseHeader("Content-Range");/bytes (\d+)-(\d+)\/(\d+)/.test(l)?s.onDone(o):(yt('Missing or invalid "Content-Range" header.'),s.onError(0))}else o?s.onDone(o):s.onError(t.status)}_abortRequest(t){this.#t.has(t)&&(this.#t.delete(t),t.abort())}getRangeReader(t,e){const s=super.getRangeReader(t,e);return s&&(s.onClosed=()=>this._rangeReaders.delete(s)),s}}class px extends Ll{_cachedChunks=[];_done=!1;_requests=[];_storedError=null;constructor(t){super(t);const{length:e}=t._source;this._contentLength=e,this._fullRequestXhr=t._request({onHeadersReceived:this.#t.bind(this),onDone:this.#e.bind(this),onError:this.#i.bind(this),onProgress:this.#n.bind(this)})}#t(){const t=this._stream,{disableRange:e,rangeChunkSize:s}=t._source,a=this._fullRequestXhr;t._responseOrigin=Pl(a.responseURL);const o=a.getAllResponseHeaders(),l=new Headers(o?o.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(f=>{const[m,...y]=f.split(": ");return[m,y.join(": ")]}):[]),{allowRangeRequests:u,suggestedLength:d}=uy({responseHeaders:l,isHttp:t.isHttp,rangeChunkSize:s,disableRange:e});u&&(this._isRangeSupported=!0),this._contentLength=d||this._contentLength,this._filename=hy(l),this._isRangeSupported&&t._abortRequest(a),this._headersCapability.resolve()}#e(t){if(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._cachedChunks.push(t),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}#i(t){this._storedError=jl(t,this._stream.url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}#n(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._abortRequest(this._fullRequestXhr),this._fullRequestXhr=null}}class mx extends Bl{onClosed=null;_done=!1;_queuedChunk=null;_requests=[];_storedError=null;constructor(t,e,s){super(t,e,s),this._requestXhr=t._request({begin:e,end:s,onHeadersReceived:this.#t.bind(this),onDone:this.#e.bind(this),onError:this.#i.bind(this),onProgress:null})}#t(){const t=Pl(this._requestXhr?.responseURL);try{dy(t,this._stream._responseOrigin)}catch(e){this._storedError=e,this.#i(0)}}#e(t){this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this.onClosed?.()}#i(t){this._storedError??=jl(t,this._stream.url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._abortRequest(this._requestXhr),this.onClosed?.()}}const gx=/^[a-z][a-z0-9\-+.]+:/i;function yx(h){if(gx.test(h))return new URL(h);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(h))}function gy(h){const{Readable:t}=process.getBuiltinModule("stream");return typeof t.toWeb=="function"?t.toWeb(h):process.getBuiltinModule("module").createRequire(import.meta.url)("node-readable-to-web-readable-stream").makeDefaultReadableStreamFromNodeReadable(h)}function yy(h){return h instanceof Uint8Array?h.buffer:h instanceof ArrayBuffer?h:(yt(`getArrayBuffer - unexpected data format: ${h}`),new Uint8Array(h).buffer)}class bx extends Ol{constructor(t){super(t,vx,Ax),this.url=yx(t.url),Ft(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs.")}}class vx extends Ll{_reader=null;constructor(t){super(t);const{disableRange:e,disableStream:s,length:a,rangeChunkSize:o}=t._source;this._contentLength=a,this._isStreamingSupported=!s,this._isRangeSupported=!e;const l=t.url,u=process.getBuiltinModule("fs");u.promises.lstat(l).then(d=>{const f=u.createReadStream(l),m=gy(f);this._reader=m.getReader();const{size:y}=d;y<=2*o&&(this._isRangeSupported=!1),this._contentLength=y,!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Pi("Streaming is disabled.")),this._headersCapability.resolve()}).catch(d=>{d.code==="ENOENT"&&(d=jl(0,l.href)),this._headersCapability.reject(d)})}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:yy(t),done:!1})}cancel(t){this._reader?.cancel(t)}}class Ax extends Bl{_readCapability=Promise.withResolvers();_reader=null;constructor(t,e,s){super(t,e,s);const a=t.url,o=process.getBuiltinModule("fs");try{const l=o.createReadStream(a,{start:e,end:s-1}),u=gy(l);this._reader=u.getReader(),this._readCapability.resolve()}catch(l){this._readCapability.reject(l)}}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:{value:yy(t),done:!1}}cancel(t){this._reader?.cancel(t)}}const dr=Symbol("INITIAL_DATA");class by{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:dr}}get(t,e=null){if(e){const a=this.#e(t);return a.promise.then(()=>e(a.data)),null}const s=this.#t[t];if(!s||s.data===dr)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return s.data}has(t){const e=this.#t[t];return!!e&&e.data!==dr}delete(t){const e=this.#t[t];return!e||e.data===dr?!1:(delete this.#t[t],!0)}resolve(t,e=null){const s=this.#e(t);s.data=e,s.resolve()}clear(){for(const t in this.#t){const{data:e}=this.#t[t];e?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:e}=this.#t[t];e!==dr&&(yield[t,e])}}}const Sx=1e5,p0=30;class rn{#t=Promise.withResolvers();#e=null;#i=!1;#n=!!globalThis.FontInspector?.enabled;#a=null;#r=null;#s=0;#o=0;#c=null;#l=null;#d=0;#h=0;#f=Object.create(null);#g=[];#m=null;#u=[];#p=new WeakMap;#y=null;static#v=new Map;static#b=new Map;static#T=new WeakMap;static#x=null;static#S=new Set;constructor({textContentSource:t,container:e,viewport:s}){if(t instanceof ReadableStream)this.#m=t;else if(typeof t=="object")this.#m=new ReadableStream({start(d){d.enqueue(t),d.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#l=e,this.#h=s.scale*Fn.pixelRatio,this.#d=s.rotation,this.#r={div:null,properties:null,ctx:null};const{pageWidth:a,pageHeight:o,pageX:l,pageY:u}=s.rawDims;this.#y=[1,0,0,-1,-l,u+o],this.#o=a,this.#s=o,rn.#D(),e.style.setProperty("--min-font-size",rn.#x),hs(e,s),this.#t.promise.finally(()=>{rn.#S.delete(this),this.#r=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=be.platform;return bt(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#c.read().then(({value:e,done:s})=>{if(s){this.#t.resolve();return}this.#a??=e.lang,Object.assign(this.#f,e.styles),this.#C(e.items),t()},this.#t.reject)};return this.#c=this.#m.getReader(),rn.#S.add(this),t(),this.#t.promise}update({viewport:t,onBefore:e=null}){const s=t.scale*Fn.pixelRatio,a=t.rotation;if(a!==this.#d&&(e?.(),this.#d=a,hs(this.#l,{rotation:a})),s!==this.#h){e?.(),this.#h=s;const o={div:null,properties:null,ctx:rn.#N(this.#a)};for(const l of this.#u)o.properties=this.#p.get(l),o.div=l,this.#E(o)}}cancel(){const t=new Pi("TextLayer task cancelled.");this.#c?.cancel(t).catch(()=>{}),this.#c=null,this.#t.reject(t)}get textDivs(){return this.#u}get textContentItemsStr(){return this.#g}#C(t){if(this.#i)return;this.#r.ctx??=rn.#N(this.#a);const e=this.#u,s=this.#g;for(const a of t){if(e.length>Sx){yt("Ignoring additional textDivs for performance reasons."),this.#i=!0;return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),a.id&&this.#e.setAttribute("id",`${a.id}`),a.tag==="Artifact"&&(this.#e.ariaHidden=!0),o.append(this.#e)}else a.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}s.push(a.str),this.#A(a)}}#A(t){const e=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#u.push(e);const a=nt.transform(this.#y,t.transform);let o=Math.atan2(a[1],a[0]);const l=this.#f[t.fontName];l.vertical&&(o+=Math.PI/2);let u=this.#n&&l.fontSubstitution||l.fontFamily;u=rn.fontFamilyMap.get(u)||u;const d=Math.hypot(a[2],a[3]),f=d*rn.#j(u,l,this.#a);let m,y;o===0?(m=a[4],y=a[5]-f):(m=a[4]+f*Math.sin(o),y=a[5]-f*Math.cos(o));const b=e.style;b.left=`${(100*m/this.#o).toFixed(2)}%`,b.top=`${(100*y/this.#s).toFixed(2)}%`,b.setProperty("--font-height",`${d.toFixed(2)}px`),b.fontFamily=u,s.fontSize=d,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#n&&(e.dataset.fontName=l.fontSubstitutionLoadedName||t.fontName),o!==0&&(s.angle=o*(180/Math.PI));let v=!1;if(t.str.length>1)v=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const S=Math.abs(t.transform[0]),w=Math.abs(t.transform[3]);S!==w&&Math.max(S,w)/Math.min(S,w)>1.5&&(v=!0)}if(v&&(s.canvasWidth=l.vertical?t.height:t.width),this.#p.set(e,s),this.#r.div=e,this.#r.properties=s,this.#E(this.#r),s.hasText&&this.#e.append(e),s.hasEOL){const S=document.createElement("br");S.setAttribute("role","presentation"),this.#e.append(S)}}#E(t){const{div:e,properties:s,ctx:a}=t,{style:o}=e;if(s.canvasWidth!==0&&s.hasText){const{fontFamily:l}=o,{canvasWidth:u,fontSize:d}=s;rn.#M(a,d*this.#h,l);const{width:f}=a.measureText(e.textContent);f>0&&o.setProperty("--scale-x",u*this.#h/f)}s.angle!==0&&o.setProperty("--rotate",`${s.angle}deg`)}static cleanup(){if(!(this.#S.size>0)){this.#v.clear();for(const{canvas:t}of this.#b.values())t.remove();this.#b.clear()}}static#N(t=null){let e=this.#b.get(t||="");if(!e){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=t,document.body.append(s),e=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#b.set(t,e),this.#T.set(e,{size:0,family:""})}return e}static#M(t,e,s){const a=this.#T.get(t);e===a.size&&s===a.family||(t.font=`${e}px ${s}`,a.size=e,a.family=s)}static#D(){if(this.#x!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#x=t.getBoundingClientRect().height,t.remove()}static#j(t,e,s){const a=this.#v.get(t);if(a)return a;const o=this.#N(s);o.canvas.width=o.canvas.height=p0,this.#M(o,p0,t);const l=o.measureText(""),u=l.fontBoundingBoxAscent,d=Math.abs(l.fontBoundingBoxDescent);o.canvas.width=o.canvas.height=0;let f=.8;return u?f=u/(u+d):(be.platform.isFirefox&&yt("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?f=e.ascent:e.descent&&(f=1+e.descent)),this.#v.set(t,f),f}}const wx=100;function vy(h={}){typeof h=="string"||h instanceof URL?h={url:h}:(h instanceof ArrayBuffer||ArrayBuffer.isView(h))&&(h={data:h});const t=new nd,{docId:e}=t,s=h.url?Nw(h.url):null,a=h.data?Rw(h.data):null,o=h.httpHeaders||null,l=h.withCredentials===!0,u=h.password??null,d=h.range instanceof Ay?h.range:null,f=Number.isInteger(h.rangeChunkSize)&&h.rangeChunkSize>0?h.rangeChunkSize:2**16;let m=h.worker instanceof xr?h.worker:null;const y=h.verbosity,b=typeof h.docBaseUrl=="string"&&!Rl(h.docBaseUrl)?h.docBaseUrl:null,v=nl(h.cMapUrl),S=h.cMapPacked!==!1,w=h.CMapReaderFactory||(Le?zw:Zg),x=nl(h.iccUrl),E=nl(h.standardFontDataUrl),M=h.StandardFontDataFactory||(Le?Uw:Jg),C=nl(h.wasmUrl),R=h.WasmFactory||(Le?Iw:t0),k=h.stopAtErrors!==!0,L=Number.isInteger(h.maxImageSize)&&h.maxImageSize>-1?h.maxImageSize:-1,P=h.isEvalSupported!==!1,$=typeof h.isOffscreenCanvasSupported=="boolean"?h.isOffscreenCanvasSupported:!Le,K=typeof h.isImageDecoderSupported=="boolean"?h.isImageDecoderSupported:!Le&&(be.platform.isFirefox||!globalThis.chrome),J=Number.isInteger(h.canvasMaxAreaInBytes)?h.canvasMaxAreaInBytes:-1,Z=typeof h.disableFontFace=="boolean"?h.disableFontFace:Le,ht=h.fontExtraProperties===!0,St=h.enableXfa===!0,ot=h.ownerDocument||globalThis.document,et=h.disableRange===!0,O=h.disableStream===!0,H=h.disableAutoFetch===!0,W=h.pdfBug===!0,pt=h.CanvasFactory||(Le?Fw:Bw),Et=h.FilterFactory||(Le?jw:Pw),N=h.enableHWA===!0,I=h.useWasm!==!1,Q=d?d.length:h.length??NaN,tt=typeof h.useSystemFonts=="boolean"?h.useSystemFonts:!Le&&!Z,ut=typeof h.useWorkerFetch=="boolean"?h.useWorkerFetch:!!(w===Zg&&M===Jg&&R===t0&&v&&E&&C&&gr(v,document.baseURI)&&gr(E,document.baseURI)&&gr(C,document.baseURI)),gt=null;iw(y);const dt={canvasFactory:new pt({ownerDocument:ot,enableHWA:N}),filterFactory:new Et({docId:e,ownerDocument:ot}),cMapReaderFactory:ut?null:new w({baseUrl:v,isCompressed:S}),standardFontDataFactory:ut?null:new M({baseUrl:E}),wasmFactory:ut?null:new R({baseUrl:C})};m||(m=xr.create({verbosity:y,port:ca.workerPort}),t._worker=m);const re={docId:e,apiVersion:"5.4.624",data:a,password:u,disableAutoFetch:H,rangeChunkSize:f,length:Q,docBaseUrl:b,enableXfa:St,evaluatorOptions:{maxImageSize:L,disableFontFace:Z,ignoreErrors:k,isEvalSupported:P,isOffscreenCanvasSupported:$,isImageDecoderSupported:K,canvasMaxAreaInBytes:J,fontExtraProperties:ht,useSystemFonts:tt,useWasm:I,useWorkerFetch:ut,cMapUrl:v,iccUrl:x,standardFontDataUrl:E,wasmUrl:C}},Xt={ownerDocument:ot,pdfBug:W,styleElement:gt,enableHWA:N,loadingParams:{disableAutoFetch:H,enableXfa:St}};return m.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(m.destroyed)throw new Error("Worker was destroyed");const Fi=m.messageHandler.sendWithPromise("GetDocRequest",re,a?[a.buffer]:null);let oi;if(d)oi=new ax({pdfDataRangeTransport:d,disableRange:et,disableStream:O});else if(!a){if(!s)throw new Error("getDocument - no `url` parameter provided.");const zi=gr(s)?cx:Le?bx:fx;oi=new zi({url:s,length:Q,httpHeaders:o,withCredentials:l,rangeChunkSize:f,disableRange:et,disableStream:O})}return Fi.then(zi=>{if(t.destroyed)throw new Error("Loading aborted");if(m.destroyed)throw new Error("Worker was destroyed");const pa=new yr(e,zi,m.port),zn=new Tx(pa,t,oi,Xt,dt);t._transport=zn,pa.send("Ready",null)})}).catch(t._capability.reject),t}class nd{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${nd.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class Ay{#t=Promise.withResolvers();#e=[];#i=[];#n=[];#a=[];constructor(t,e,s=!1,a=null){this.length=t,this.initialData=e,this.progressiveDone=s,this.contentDispositionFilename=a}addRangeListener(t){this.#a.push(t)}addProgressListener(t){this.#n.push(t)}addProgressiveReadListener(t){this.#i.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,e){for(const s of this.#a)s(t,e)}onDataProgress(t,e){this.#t.promise.then(()=>{for(const s of this.#n)s(t,e)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const e of this.#i)e(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,e){zt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class xx{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return bt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,e){return this._transport.getAnnotationsByType(t,e)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(t){return this._transport.extractPages(t)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class Ex{#t=!1;#e=Pt.instance;constructor(t,e,s,a=!1){this._pageIndex=t,this._pageInfo=e,this._transport=s,this._stats=a?new qg:null,this._pdfBug=a,this.commonObjs=s.commonObjs,this.objs=new by,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}set pageNumber(t){this._pageIndex=t-1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:s=0,offsetY:a=0,dontFlip:o=!1}={}){return new kr({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:s,offsetY:a,dontFlip:o})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return bt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:e=t.canvas,viewport:s,intent:a="display",annotationMode:o=Oi.ENABLE,transform:l=null,background:u=null,optionalContentConfigPromise:d=null,annotationCanvasMap:f=null,pageColors:m=null,printAnnotationStorage:y=null,isEditing:b=!1,recordOperations:v=!1,operationsFilter:S=null}){this._stats?.time("Overall");const w=this._transport.getRenderingIntent(a,o,y,b),{renderingIntent:x,cacheKey:E}=w;this.#t=!1,d||=this._transport.getOptionalContentConfig(x);let M=this._intentStates.get(E);M||(M=Object.create(null),this._intentStates.set(E,M)),M.streamReaderCancelTimeout&&(clearTimeout(M.streamReaderCancelTimeout),M.streamReaderCancelTimeout=null);const C=!!(x&an.PRINT);M.displayReadyCapability||(M.displayReadyCapability=Promise.withResolvers(),M.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(w));const R=!!(this._pdfBug&&globalThis.StepperManager?.enabled),k=!this.recordedBBoxes&&(v||R),L=K=>{if(M.renderTasks.delete(P),k){const J=P.gfx?.dependencyTracker.take();J&&(P.stepper&&P.stepper.setOperatorBBoxes(J,P.gfx.dependencyTracker.takeDebugMetadata()),v&&(this.recordedBBoxes=J))}C&&(this.#t=!0),this.#i(),K?(P.capability.reject(K),this._abortOperatorList({intentState:M,reason:K instanceof Error?K:new Error(K)})):P.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},P=new aa({callback:L,params:{canvas:e,canvasContext:t,dependencyTracker:k?new Gw(e,M.operatorList.length,R):null,viewport:s,transform:l,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:M.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!C,pdfBug:this._pdfBug,pageColors:m,enableHWA:this._transport.enableHWA,operationsFilter:S});(M.renderTasks||=new Set).add(P);const $=P.task;return Promise.all([M.displayReadyCapability.promise,d]).then(([K,J])=>{if(this.destroyed){L();return}if(this._stats?.time("Rendering"),!(J.renderingIntent&x))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");P.initializeGraphics({transparency:K,optionalContentConfig:J}),P.operatorListChanged()}).catch(L),$}getOperatorList({intent:t="display",annotationMode:e=Oi.ENABLE,printAnnotationStorage:s=null,isEditing:a=!1}={}){function o(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(d))}const l=this._transport.getRenderingIntent(t,e,s,a,!0);let u=this._intentStates.get(l.cacheKey);u||(u=Object.create(null),this._intentStates.set(l.cacheKey,u));let d;return u.opListReadCapability||(d=Object.create(null),d.operatorListChanged=o,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||=new Set).add(d),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(l)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageId:this.#e.getPageId(this._pageIndex+1)-1,pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(a){return a.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>wr.textContent(s));const e=this.streamTextContent(t);return new Promise(function(s,a){function o(){l.read().then(function({value:d,done:f}){if(f){s(u);return}u.lang??=d.lang,Object.assign(u.styles,d.styles),u.items.push(...d.items),o()},a)}const l=e.getReader(),u={items:[],styles:Object.create(null),lang:null};o()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const s of e.renderTasks)t.push(s.completed),s.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const e=this.#i();return t&&e&&(this._stats&&=new qg),e}#i(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,e){const s=this._intentStates.get(e);s&&(this._stats?.timeEnd("Page Request"),s.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let s=0,a=t.length;s<a;s++)e.operatorList.fnArray.push(t.fnArray[s]),e.operatorList.argsArray.push(t.argsArray[s]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const s of e.renderTasks)s.operatorListChanged();t.lastChunk&&this.#i()}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:s,modifiedIds:a}){const{map:o,transfer:l}=s,d=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageId:this.#e.getPageId(this._pageIndex+1)-1,pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:o,modifiedIds:a},l).getReader(),f=this._intentStates.get(e);f.streamReader=d;const m=()=>{d.read().then(({value:y,done:b})=>{if(b){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(y,f),m())},y=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const b of f.renderTasks)b.operatorListChanged();this.#i()}if(f.displayReadyCapability)f.displayReadyCapability.reject(y);else if(f.opListReadCapability)f.opListReadCapability.reject(y);else throw y}})};m()}_abortOperatorList({intentState:t,reason:e,force:s=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!s){if(t.renderTasks.size>0)return;if(e instanceof $h){let a=wx;e.extraDelay>0&&e.extraDelay<1e3&&(a+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},a);return}}if(t.streamReader.cancel(new Pi(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[a,o]of this._intentStates)if(o===t){this._intentStates.delete(a);break}this.cleanup()}}}get stats(){return this._stats}}var Li,_n,ri,rs,Sl,os,ls,Be,pl,Sy,wy,br,ua,ml;const Jt=class Jt{constructor({name:t=null,port:e=null,verbosity:s=sw()}={}){kn(this,Be);kn(this,Li,Promise.withResolvers());kn(this,_n,null);kn(this,ri,null);kn(this,rs,null);if(this.name=t,this.destroyed=!1,this.verbosity=s,e){if(Zt(Jt,ls).has(e))throw new Error("Cannot use more than one PDFWorker per port.");Zt(Jt,ls).set(e,this),On(this,Be,Sy).call(this,e)}else On(this,Be,wy).call(this)}get promise(){return Zt(this,Li).promise}get port(){return Zt(this,ri)}get messageHandler(){return Zt(this,_n)}destroy(){this.destroyed=!0,Zt(this,rs)?.terminate(),Ge(this,rs,null),Zt(Jt,ls).delete(Zt(this,ri)),Ge(this,ri,null),Zt(this,_n)?.destroy(),Ge(this,_n,null)}static create(t){const e=Zt(this,ls).get(t?.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new Jt(t)}static get workerSrc(){if(ca.workerSrc)return ca.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return bt(this,"_setupFakeWorkerGlobal",(async()=>Zt(this,ua,ml)?Zt(this,ua,ml):(await import(this.workerSrc)).WorkerMessageHandler)())}};Li=new WeakMap,_n=new WeakMap,ri=new WeakMap,rs=new WeakMap,Sl=new WeakMap,os=new WeakMap,ls=new WeakMap,Be=new WeakSet,pl=function(){Zt(this,Li).resolve(),Zt(this,_n).send("configure",{verbosity:this.verbosity})},Sy=function(t){Ge(this,ri,t),Ge(this,_n,new yr("main","worker",t)),Zt(this,_n).on("ready",()=>{}),On(this,Be,pl).call(this)},wy=function(){if(Zt(Jt,os)||Zt(Jt,ua,ml)){On(this,Be,br).call(this);return}let{workerSrc:t}=Jt;try{Jt._isSameOrigin(window.location,t)||(t=Jt._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),s=new yr("main","worker",e),a=()=>{o.abort(),s.destroy(),e.terminate(),this.destroyed?Zt(this,Li).reject(new Error("Worker was destroyed")):On(this,Be,br).call(this)},o=new AbortController;e.addEventListener("error",()=>{Zt(this,rs)||a()},{signal:o.signal}),s.on("test",u=>{if(o.abort(),this.destroyed||!u){a();return}Ge(this,_n,s),Ge(this,ri,e),Ge(this,rs,e),On(this,Be,pl).call(this)}),s.on("ready",u=>{if(o.abort(),this.destroyed){a();return}try{l()}catch{On(this,Be,br).call(this)}});const l=()=>{const u=new Uint8Array;s.send("test",u,[u.buffer])};l();return}catch{Dl("The worker has been disabled.")}On(this,Be,br).call(this)},br=function(){Zt(Jt,os)||(yt("Setting up fake worker."),Ge(Jt,os,!0)),Jt._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){Zt(this,Li).reject(new Error("Worker was destroyed"));return}const e=new Lw;Ge(this,ri,e);const s=`fake${hg(Jt,Sl)._++}`,a=new yr(s+"_worker",s,e);t.setup(a,e),Ge(this,_n,new yr(s,s+"_worker",e)),On(this,Be,pl).call(this)}).catch(t=>{Zt(this,Li).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},ua=new WeakSet,ml=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},kn(Jt,ua),kn(Jt,Sl,0),kn(Jt,os,!1),kn(Jt,ls,new WeakMap),Le&&(Ge(Jt,os,!0),ca.workerSrc||="./pdf.worker.mjs"),Jt._isSameOrigin=(t,e)=>{const s=URL.parse(t);if(!s?.origin||s.origin==="null")return!1;const a=new URL(e,s);return s.origin===a.origin},Jt._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},Jt.fromPort=t=>{if(gw("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return Jt.create(t)};let xr=Jt;class Tx{downloadInfoCapability=Promise.withResolvers();#t=null;#e=new Map;#i=null;#n=new Map;#a=new Map;#r=new Map;#s=null;#o=Pt.instance;constructor(t,e,s,a,o){this.messageHandler=t,this.loadingTask=e,this.#i=s,this.commonObjs=new by,this.fontLoader=new Cw({ownerDocument:a.ownerDocument,styleElement:a.styleElement}),this.enableHWA=a.enableHWA,this.loadingParams=a.loadingParams,this._params=a,this.canvasFactory=o.canvasFactory,this.filterFactory=o.filterFactory,this.cMapReaderFactory=o.cMapReaderFactory,this.standardFontDataFactory=o.standardFontDataFactory,this.wasmFactory=o.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this.setupMessageHandler(),this.#o.addListener(this.#c.bind(this))}#c(){const t=new Map,e=new Map;for(let s=0,a=this.#o.pagesNumber;s<a;s++){const o=this.#o.getPrevPageNumber(s+1)-1,l=this.#n.get(o);l&&t.set(s,l);const u=this.#a.get(o);u&&e.set(s,u)}this.#n=t,this.#a=e}#l(t,e=null){const s=this.#e.get(t);if(s)return s;const a=this.messageHandler.sendWithPromise(t,e);return this.#e.set(t,a),a}#d({loaded:t,total:e}){this.loadingTask.onProgress?.({loaded:t,total:e,percent:De(Math.round(t/e*100),0,100)})}get annotationStorage(){return bt(this,"annotationStorage",new Zh)}getRenderingIntent(t,e=Oi.ENABLE,s=null,a=!1,o=!1){let l=an.DISPLAY,u=Rh;switch(t){case"any":l=an.ANY;break;case"display":break;case"print":l=an.PRINT;break;default:yt(`getRenderingIntent - invalid intent: ${t}`)}const d=l&an.PRINT&&s instanceof iy?s:this.annotationStorage;switch(e){case Oi.DISABLE:l+=an.ANNOTATIONS_DISABLE;break;case Oi.ENABLE:break;case Oi.ENABLE_FORMS:l+=an.ANNOTATIONS_FORMS;break;case Oi.ENABLE_STORAGE:l+=an.ANNOTATIONS_STORAGE,u=d.serializable;break;default:yt(`getRenderingIntent - invalid annotationMode: ${e}`)}a&&(l+=an.IS_EDITING),o&&(l+=an.OPLIST);const{ids:f,hash:m}=d.modifiedIds,y=[l,u.hash,m];return{renderingIntent:l,cacheKey:y.join("_"),annotationStorageSerializable:u,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#s?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const s of this.#n.values())t.push(s._destroy());this.#n.clear(),this.#a.clear(),this.#r.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),rn.cleanup(),this.#i?.cancelAllRequests(new Pi("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(s,a)=>{Ft(this.#i,"GetReader - no `BasePDFStream` instance available."),this.#t=this.#i.getFullReader(),this.#t.onProgress=o=>this.#d(o),a.onPull=()=>{this.#t.read().then(function({value:o,done:l}){if(l){a.close();return}Ft(o instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{a.error(o)})},a.onCancel=o=>{this.#t.cancel(o),a.ready.catch(l=>{if(!this.destroyed)throw l})}}),t.on("ReaderHeadersReady",async s=>{await this.#t.headersReady;const{isStreamingSupported:a,isRangeSupported:o,contentLength:l}=this.#t;return a&&o&&(this.#t.onProgress=null),{isStreamingSupported:a,isRangeSupported:o,contentLength:l}}),t.on("GetRangeReader",(s,a)=>{Ft(this.#i,"GetRangeReader - no `BasePDFStream` instance available.");const o=this.#i.getRangeReader(s.begin,s.end);if(!o){a.close();return}a.onPull=()=>{o.read().then(function({value:l,done:u}){if(u){a.close();return}Ft(l instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{a.error(l)})},a.onCancel=l=>{o.cancel(l),a.ready.catch(u=>{if(!this.destroyed)throw u})}}),t.on("GetDoc",({pdfInfo:s})=>{this.#o.pagesNumber=s.numPages,this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,e._capability.resolve(new xx(s,this))}),t.on("DocException",s=>{e._capability.reject(Ve(s))}),t.on("PasswordRequest",s=>{this.#s=Promise.withResolvers();try{if(!e.onPassword)throw Ve(s);const a=o=>{o instanceof Error?this.#s.reject(o):this.#s.resolve({password:o})};e.onPassword(a,s.code)}catch(a){this.#s.reject(a)}return this.#s.promise}),t.on("DataLoaded",s=>{this.#d({loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),t.on("StartRenderPage",s=>{if(this.destroyed)return;this.#n.get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),t.on("commonobj",([s,a,o])=>{if(this.destroyed||this.commonObjs.has(s))return null;switch(a){case"Font":if("error"in o){const y=o.error;yt(`Error during font loading: ${y}`),this.commonObjs.resolve(s,y);break}const l=new qt(o),u=this._params.pdfBug&&globalThis.FontInspector?.enabled?(y,b)=>globalThis.FontInspector.fontAdded(y,b):null,d=new Mw(l,u,o.extra,o.charProcOperatorList);this.fontLoader.bind(d).catch(()=>t.sendWithPromise("FontFallback",{id:s})).finally(()=>{!d.fontExtraProperties&&d.data&&d.clearData(),this.commonObjs.resolve(s,d)});break;case"CopyLocalImage":const{imageRef:f}=o;Ft(f,"The imageRef must be defined.");for(const y of this.#n.values())for(const[,b]of y.objs)if(b?.ref===f)return b.dataLen?(this.commonObjs.resolve(s,structuredClone(b)),b.dataLen):null;break;case"FontPath":this.commonObjs.resolve(s,new Dw(o));break;case"Image":this.commonObjs.resolve(s,o);break;case"Pattern":const m=new Se(o);this.commonObjs.resolve(s,m.getIR());break;default:throw new Error(`Got unknown common object type ${a}`)}return null}),t.on("obj",([s,a,o,l])=>{if(this.destroyed)return;const u=this.#n.get(a);if(!u.objs.has(s)){if(u._intentStates.size===0){l?.bitmap?.close();return}switch(o){case"Image":case"Pattern":u.objs.resolve(s,l);break;default:throw new Error(`Got unknown object type ${o}`)}}}),t.on("DocProgress",s=>{this.destroyed||this.#d(s)}),t.on("FetchBinaryData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");const a=this[s.type];if(!a)throw new Error(`${s.type} not initialized, see the \`useWorkerFetch\` parameter.`);return a.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&yt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this.#t?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}extractPages(t){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:t})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this.#o.pagesNumber)return Promise.reject(new Error("Invalid page request."));const e=t-1,s=this.#o.getPageId(t)-1,a=this.#a.get(e);if(a)return a;const o=this.messageHandler.sendWithPromise("GetPage",{pageIndex:s}).then(l=>{if(this.destroyed)throw new Error("Transport destroyed");l.refStr&&this.#r.set(l.refStr,s);const u=new Ex(e,l,this,this._params.pdfBug);return this.#n.set(e,u),u});return this.#a.set(e,o),o}async getPageIndex(t){if(!kh(t))throw new Error("Invalid pageIndex request.");const e=await this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen});return this.#o.getPageNumber(e+1)-1}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:this.#o.getPageId(t+1)-1,intent:e})}getFieldObjects(){return this.#l("GetFieldObjects")}hasJSActions(){return this.#l("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,e){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:e})}getDocJSActions(){return this.#l("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:this.#o.getPageId(t+1)-1})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:this.#o.getPageId(t+1)-1})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#l("GetOptionalContentConfig").then(e=>new sx(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#e.get(t);if(e)return e;const s=this.messageHandler.sendWithPromise(t,null).then(a=>({info:a[0],metadata:a[1]?new nx(a[1]):null,contentDispositionFilename:this.#t?.filename??null,contentLength:this.#t?.contentLength??null,hasStructTree:a[2]}));return this.#e.set(t,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#n.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),rn.cleanup()}}cachedPageNumber(t){if(!kh(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`,s=this.#r.get(e);return s>=0?this.#o.getPageNumber(s+1):null}}class _x{_internalRenderTask=null;onContinue=null;onError=null;constructor(t){this._internalRenderTask=t}get promise(){return this._internalRenderTask.capability.promise}cancel(t=0){this._internalRenderTask.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this._internalRenderTask.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this._internalRenderTask;return t.form||t.canvas&&e?.size>0}}class aa{#t=null;static#e=new WeakSet;constructor({callback:t,params:e,objs:s,commonObjs:a,annotationCanvasMap:o,operatorList:l,pageIndex:u,canvasFactory:d,filterFactory:f,useRequestAnimationFrame:m=!1,pdfBug:y=!1,pageColors:b=null,enableHWA:v=!1,operationsFilter:S=null}){this.callback=t,this.params=e,this.objs=s,this.commonObjs=a,this.annotationCanvasMap=o,this.operatorListIdx=null,this.operatorList=l,this._pageIndex=u,this.canvasFactory=d,this.filterFactory=f,this._pdfBug=y,this.pageColors=b,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=m===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new _x(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvas,this._canvasContext=e.canvas?null:e.canvasContext,this._enableHWA=v,this._dependencyTracker=e.dependencyTracker,this._operationsFilter=S}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(aa.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");aa.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:s,transform:a,background:o,dependencyTracker:l}=this.params,u=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new la(u,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors,l),this.gfx.beginDrawing({transform:a,viewport:s,transparency:t,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),aa.#e.delete(this._canvas),t||=new $h(`Rendering cancelled, page ${this._pageIndex+1}`,e),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),aa.#e.delete(this._canvas),this.callback())))}}const xy="5.4.624",Cx="384c6208b";class Sn{#t=null;#e=null;#i;#n=null;#a=!1;#r=!1;#s=null;#o;#c=null;#l=null;static#d=null;static get _keyboardManager(){return bt(this,"_keyboardManager",new Lr([[["Escape","mac+Escape"],Sn.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Sn.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Sn.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Sn.prototype._moveToPrevious],[["Home","mac+Home"],Sn.prototype._moveToBeginning],[["End","mac+End"],Sn.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#r=!1,this.#s=t):this.#r=!0,this.#l=t?._uiManager||e,this.#o=this.#l._eventBus,this.#i=t?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",Sn.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#s&&(t.ariaControls=`${this.#s.id}_colorpicker_dropdown`);const e=this.#l._signal;t.addEventListener("click",this.#m.bind(this),{signal:e}),t.addEventListener("keydown",this.#g.bind(this),{signal:e});const s=this.#e=document.createElement("span");return s.className="swatch",s.ariaHidden="true",s.style.backgroundColor=this.#i,t.append(s),t}renderMainDropdown(){const t=this.#n=this.#h();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#h(){const t=document.createElement("div"),e=this.#l._signal;t.addEventListener("contextmenu",wn,{signal:e}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#s&&(t.id=`${this.#s.id}_colorpicker_dropdown`);for(const[s,a]of this.#l.highlightColors){const o=document.createElement("button");o.tabIndex="0",o.role="option",o.setAttribute("data-color",a),o.title=s,o.setAttribute("data-l10n-id",Sn.#d[s]);const l=document.createElement("span");o.append(l),l.className="swatch",l.style.backgroundColor=a,o.ariaSelected=a===this.#i,o.addEventListener("click",this.#f.bind(this,a),{signal:e}),t.append(o)}return t.addEventListener("keydown",this.#g.bind(this),{signal:e}),t}#f(t,e){e.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:Nt.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#m(t);return}const e=t.target.getAttribute("data-color");e&&this.#f(e,t)}_moveToNext(t){if(!this.#p){this.#m(t);return}if(t.target===this.#t){this.#n.firstElementChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#n?.firstElementChild||t.target===this.#t){this.#p&&this._hideDropdownFromKeyboard();return}this.#p||this.#m(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#p){this.#m(t);return}this.#n.firstElementChild?.focus()}_moveToEnd(t){if(!this.#p){this.#m(t);return}this.#n.lastElementChild?.focus()}#g(t){Sn._keyboardManager.exec(this,t)}#m(t){if(this.#p){this.hideDropdown();return}if(this.#a=t.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#u.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#t.ariaExpanded="true",this.#n){this.#n.classList.remove("hidden");return}const e=this.#n=this.#h();this.#t.append(e)}#u(t){this.#n?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#n?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#p(){return this.#n&&!this.#n.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#r){if(!this.#p){this.#s?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#a})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#n)return;const e=this.#l.highlightColors.values();for(const s of this.#n.children)s.ariaSelected=e.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#n?.remove(),this.#n=null}}class Er{#t=null;#e=null;#i=null;static#n=null;constructor(t){this.#e=t,this.#i=t._uiManager,Er.#n||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:e,color:s}=this.#e,a=this.#t=document.createElement("input");return a.type="color",a.value=s||"#000000",a.className="basicColorPicker",a.tabIndex=0,a.setAttribute("data-l10n-id",Er.#n[t]),a.addEventListener("input",()=>{this.#i.updateParams(e,a.value)},{signal:this.#i._signal}),a}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}function m0(h){return Math.floor(Math.max(0,Math.min(1,h))*255).toString(16).padStart(2,"0")}function fr(h){return Math.max(0,Math.min(255,255*h))}class g0{static CMYK_G([t,e,s,a]){return["G",1-Math.min(1,.3*t+.59*s+.11*e+a)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=fr(t),[t,t,t]}static G_HTML([t]){const e=m0(t);return`#${e}${e}${e}`}static RGB_G([t,e,s]){return["G",.3*t+.59*e+.11*s]}static RGB_rgb(t){return t.map(fr)}static RGB_HTML(t){return`#${t.map(m0).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,s,a]){return["RGB",1-Math.min(1,t+a),1-Math.min(1,s+a),1-Math.min(1,e+a)]}static CMYK_rgb([t,e,s,a]){return[fr(1-Math.min(1,t+a)),fr(1-Math.min(1,s+a)),fr(1-Math.min(1,e+a))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,s]){const a=1-t,o=1-e,l=1-s,u=Math.min(a,o,l);return["CMYK",a,o,l,u]}}class Mx{create(t,e,s=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const a=this._createSVG("svg:svg");return a.setAttribute("version","1.1"),s||(a.setAttribute("width",`${t}px`),a.setAttribute("height",`${e}px`)),a.setAttribute("preserveAspectRatio","none"),a.setAttribute("viewBox",`0 0 ${t} ${e}`),a}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){zt("Abstract method `_createSVG` called.")}}class Al extends Mx{_createSVG(t){return document.createElementNS(si,t)}}const Dx=9,ds=new WeakSet,Nx=new Date().getTimezoneOffset()*60*1e3;class vh{static create(t){switch(t.data.annotationType){case me.LINK:return new id(t);case me.TEXT:return new kx(t);case me.WIDGET:switch(t.data.fieldType){case"Tx":return new Ox(t);case"Btn":return t.data.radioButton?new Ey(t):t.data.checkBox?new Bx(t):new Px(t);case"Ch":return new jx(t);case"Sig":return new Lx(t)}return new ps(t);case me.POPUP:return new Bh(t);case me.FREETEXT:return new Ty(t);case me.LINE:return new zx(t);case me.SQUARE:return new Ux(t);case me.CIRCLE:return new Ix(t);case me.POLYLINE:return new _y(t);case me.CARET:return new Gx(t);case me.INK:return new sd(t);case me.POLYGON:return new Hx(t);case me.HIGHLIGHT:return new Cy(t);case me.UNDERLINE:return new Vx(t);case me.SQUIGGLY:return new qx(t);case me.STRIKEOUT:return new Xx(t);case me.STAMP:return new My(t);case me.FILEATTACHMENT:return new Yx(t);default:return new ne(t)}}}class ne{#t=null;#e=!1;#i=null;constructor(t,{isRenderable:e=!1,ignoreBorder:s=!1,createQuadrilaterals:a=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,this.hasOwnCommentButton=!1,e&&(this.contentElement=this.container=this._createContainer(s)),a&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:e}){return!!(t?.str||e?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return ne._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:t}=this,e=this.annotationStorage?.getEditor(t.id);return e?e.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const t=this.annotationStorage?.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:e,inkLists:s,rect:a}=this.data;let o=-1/0,l=-1/0;if(e?.length>=8){for(let u=0;u<e.length;u+=8)e[u+1]>l?(l=e[u+1],o=e[u+2]):e[u+1]===l&&(o=Math.max(o,e[u+2]));return[o,l]}if(s?.length>=1){for(const u of s)for(let d=0,f=u.length;d<f;d+=2)u[d+1]>l?(l=u[d+1],o=u[d]):u[d+1]===l&&(o=Math.max(o,u[d]));if(o!==1/0)return[o,l]}return a?[a[2],a[3]]:null}_normalizePoint(t){const{page:{view:e},viewport:{rawDims:{pageWidth:s,pageHeight:a,pageX:o,pageY:l}}}=this.parent;return t[1]=e[3]-t[1]+e[1],t[0]=100*(t[0]-o)/s,t[1]=100*(t[1]-l)/a,t}get commentText(){const{data:t}=this;return this.annotationStorage.getRawValue(`${Ar}${t.id}`)?.popup?.contents||t.contentsObj?.str||""}set commentText(t){const{data:e}=this,s={deleted:!t,contents:t||""};this.annotationStorage.updateEditor(e.id,{popup:s})||this.annotationStorage.setValue(`${Ar}${e.id}`,{id:e.id,annotationType:e.annotationType,page:this.parent.page,popup:s,popupRef:e.popupRef,modificationDate:new Date}),t||this.removePopup()}removePopup(){(this.#i?.popup||this.popup)?.remove(),this.#i=this.popup=null}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:e,popup:s}=t;e&&this.#n(e);let a=this.#i?.popup||this.popup;!a&&s?.text&&(this._createPopup(s),a=this.#i.popup),a&&(a.updateEdited(t),s?.deleted&&(a.remove(),this.#i=null,this.popup=null))}resetEdited(){this.#t&&(this.#n(this.#t.rect),this.#i?.popup.resetEdited(),this.#t=null)}#n(t){const{container:{style:e},data:{rect:s,rotation:a},parent:{viewport:{rawDims:{pageWidth:o,pageHeight:l,pageX:u,pageY:d}}}}=this;s?.splice(0,4,...t),e.left=`${100*(t[0]-u)/o}%`,e.top=`${100*(l-t[3]+d)/l}%`,a===0?(e.width=`${100*(t[2]-t[0])/o}%`,e.height=`${100*(t[3]-t[1])/l}%`):this.setRotation(a)}_createContainer(t){const{data:e,parent:{page:s,viewport:a}}=this,o=document.createElement("section");o.setAttribute("data-annotation-id",e.id),!(this instanceof ps)&&!(this instanceof id)&&(o.tabIndex=0);const{style:l}=o;if(l.zIndex=this.parent.zIndex,this.parent.zIndex+=2,e.alternativeText&&(o.title=e.alternativeText),e.noRotate&&o.classList.add("norotate"),!e.rect||this instanceof Bh){const{rotation:w}=e;return!e.hasOwnCanvas&&w!==0&&this.setRotation(w,o),o}const{width:u,height:d}=this;if(!t&&e.borderStyle.width>0){l.borderWidth=`${e.borderStyle.width}px`;const w=e.borderStyle.horizontalCornerRadius,x=e.borderStyle.verticalCornerRadius;if(w>0||x>0){const M=`calc(${w}px * var(--total-scale-factor)) / calc(${x}px * var(--total-scale-factor))`;l.borderRadius=M}else if(this instanceof Ey){const M=`calc(${u}px * var(--total-scale-factor)) / calc(${d}px * var(--total-scale-factor))`;l.borderRadius=M}switch(e.borderStyle.style){case ta.SOLID:l.borderStyle="solid";break;case ta.DASHED:l.borderStyle="dashed";break;case ta.BEVELED:yt("Unimplemented border style: beveled");break;case ta.INSET:yt("Unimplemented border style: inset");break;case ta.UNDERLINE:l.borderBottomStyle="solid";break}const E=e.borderColor||null;E?(this.#e=!0,l.borderColor=nt.makeHexColor(E[0]|0,E[1]|0,E[2]|0)):l.borderWidth=0}const f=nt.normalizeRect([e.rect[0],s.view[3]-e.rect[1]+s.view[1],e.rect[2],s.view[3]-e.rect[3]+s.view[1]]),{pageWidth:m,pageHeight:y,pageX:b,pageY:v}=a.rawDims;l.left=`${100*(f[0]-b)/m}%`,l.top=`${100*(f[1]-v)/y}%`;const{rotation:S}=e;return e.hasOwnCanvas||S===0?(l.width=`${100*u/m}%`,l.height=`${100*d/y}%`):this.setRotation(S,o),o}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:a}=this.parent.viewport.rawDims;let{width:o,height:l}=this;t%180!==0&&([o,l]=[l,o]),e.style.width=`${100*o/s}%`,e.style.height=`${100*l/a}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,s,a)=>{const o=a.detail[e],l=o[0],u=o.slice(1);a.target.style[s]=g0[`${l}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[s]:g0[`${l}_rgb`](u)})};return bt(this,"_commonActions",{display:e=>{const{display:s}=e.detail,a=s%2===1;this.container.style.visibility=a?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:a,noPrint:s===1||s===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:s}=e.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const s=e.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(t,e){const s=this._commonActions;for(const a of Object.keys(e.detail))(t[a]||s[a])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const s=this._commonActions;for(const[a,o]of Object.entries(e)){const l=s[a];if(l){const u={detail:{[a]:o},target:t};l(u),delete e[a]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,s,a,o]=this.data.rect.map(w=>Math.fround(w));if(t.length===8){const[w,x,E,M]=t.subarray(2,6);if(a===w&&o===x&&e===E&&s===M)return}const{style:l}=this.container;let u;if(this.#e){const{borderColor:w,borderWidth:x}=l;l.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${w}" stroke-width="${x}">`],this.container.classList.add("hasBorder")}const d=a-e,f=o-s,{svgFactory:m}=this,y=m.createElement("svg");y.classList.add("quadrilateralsContainer"),y.setAttribute("width",0),y.setAttribute("height",0),y.role="none";const b=m.createElement("defs");y.append(b);const v=m.createElement("clipPath"),S=`clippath_${this.data.id}`;v.setAttribute("id",S),v.setAttribute("clipPathUnits","objectBoundingBox"),b.append(v);for(let w=2,x=t.length;w<x;w+=8){const E=t[w],M=t[w+1],C=t[w+2],R=t[w+3],k=m.createElement("rect"),L=(C-e)/d,P=(o-M)/f,$=(E-C)/d,K=(M-R)/f;k.setAttribute("x",L),k.setAttribute("y",P),k.setAttribute("width",$),k.setAttribute("height",K),v.append(k),u?.push(`<rect vector-effect="non-scaling-stroke" x="${L}" y="${P}" width="${$}" height="${K}"/>`)}this.#e&&(u.push("</g></svg>')"),l.backgroundImage=u.join("")),this.container.append(y),this.container.style.clipPath=`url(#${S})`}_createPopup(t=null){const{data:e}=this;let s,a;t?(s={str:t.text},a=t.date):(s=e.contentsObj,a=e.modificationDate),this.#i=new Bh({data:{color:e.color,titleObj:e.titleObj,modificationDate:a,contentsObj:s,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]})}get hasPopupElement(){return!!(this.#i||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#i}render(){zt("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const s=[];if(this._fieldObjects){const a=this._fieldObjects[t];if(a)for(const{page:o,id:l,exportValues:u}of a){if(o===-1||l===e)continue;const d=typeof u=="string"?u:null,f=document.querySelector(`[data-element-id="${l}"]`);if(f&&!ds.has(f)){yt(`_getElementsByName - element not allowed: ${l}`);continue}s.push({id:l,exportValue:d,domElement:f})}return s}for(const a of document.getElementsByName(t)){const{exportValue:o}=a,l=a.getAttribute("data-element-id");l!==e&&ds.has(a)&&s.push({id:l,exportValue:o,domElement:a})}return s}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class Rx extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.editor=t.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:t}=this;t.hasComment&&this._createPopup(t.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(t){this.editor.comment=t,t||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}class id extends ne{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,s=document.createElement("a");s.setAttribute("data-element-id",t.id);let a=!1;return t.url?(e.addLinkAttributes(s,t.url,t.newWindow),a=!0):t.action?(this._bindNamedAction(s,t.action,t.overlaidText),a=!0):t.attachment?(this.#e(s,t.attachment,t.overlaidText,t.attachmentDest),a=!0):t.setOCGState?(this.#i(s,t.setOCGState,t.overlaidText),a=!0):t.dest?(this._bindLink(s,t.dest,t.overlaidText),a=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,t),a=!0),t.resetForm?(this._bindResetFormAction(s,t.resetForm),a=!0):this.isTooltipOnly&&!a&&(this._bindLink(s,""),a=!0)),this.container.classList.add("linkAnnotation"),a&&(this.contentElement=s,this.container.append(s)),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e,s=""){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&this.#t(),s&&(t.title=s)}_bindNamedAction(t,e,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),s&&(t.title=s),this.#t()}#e(t,e,s="",a=null){t.href=this.linkService.getAnchorUrl(""),e.description?t.title=e.description:s&&(t.title=s),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,a),!1),this.#t()}#i(t,e,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),s&&(t.title=s),this.#t()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const a of Object.keys(e.actions)){const o=s.get(a);o&&(t[o]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:a}}),!1))}e.overlaidText&&(t.title=e.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,e){const s=t.onclick;if(s||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){yt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(t.onclick=()=>!1);return}t.onclick=()=>{s?.();const{fields:a,refs:o,include:l}=e,u=[];if(a.length!==0||o.length!==0){const m=new Set(o);for(const y of a){const b=this._fieldObjects[y]||[];for(const{id:v}of b)m.add(v)}for(const y of Object.values(this._fieldObjects))for(const b of y)m.has(b.id)===l&&u.push(b)}else for(const m of Object.values(this._fieldObjects))u.push(...m);const d=this.annotationStorage,f=[];for(const m of u){const{id:y}=m;switch(f.push(y),m.type){case"text":{const v=m.defaultValue||"";d.setValue(y,{value:v});break}case"checkbox":case"radiobutton":{const v=m.defaultValue===m.exportValues;d.setValue(y,{value:v});break}case"combobox":case"listbox":{const v=m.defaultValue||"";d.setValue(y,{value:v});break}default:continue}const b=document.querySelector(`[data-element-id="${y}"]`);if(b){if(!ds.has(b)){yt(`_bindResetFormAction - element not allowed: ${y}`);continue}}else continue;b.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class kx extends ne{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(t),this.container}}class ps extends ne{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return be.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,s,a,o){s.includes("mouse")?t.addEventListener(s,l=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:a,value:o(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):t.addEventListener(s,l=>{if(s==="blur"){if(!e.focused||!l.relatedTarget)return;e.focused=!1}else if(s==="focus"){if(e.focused)return;e.focused=!0}o&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:a,value:o(l)}})})}_setEventListeners(t,e,s,a){for(const[o,l]of s)(l==="Action"||this.data.actions?.[l])&&((l==="Focus"||l==="Blur")&&(e||={focused:!1}),this._setEventListener(t,e,o,l,a),l==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,e,"blur","Blur",null):l==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":nt.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,a=this.data.defaultAppearanceData.fontSize||Dx,o=t.style;let l;const u=2,d=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u),m=Math.round(f/(dh*a))||1,y=f/m;l=Math.min(a,d(y/dh))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u);l=Math.min(a,d(f/dh))}o.fontSize=`calc(${l}px * var(--total-scale-factor))`,o.color=nt.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(o.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class Ox extends ps{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,s,a){const o=this.annotationStorage;for(const l of this._getElementsByName(t.name,t.id))l.domElement&&(l.domElement[e]=s),o.setValue(l.id,{[a]:s})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const a=t.getValue(e,{value:this.data.fieldValue});let o=a.value||"";const l=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let u=a.formattedValue||this.data.textContent?.join(`
`)||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const d={userValue:o,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=u??o,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type=this.data.password?"password":"text",s.setAttribute("value",u??o),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),ds.add(s),this.contentElement=s,s.setAttribute("data-element-id",e),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=0;const{datetimeFormat:f,datetimeType:m,timeStep:y}=this.data,b=!!m&&this.enableScripting;f&&(s.title=f),this._setRequired(s,this.data.required),l&&(s.maxLength=l),s.addEventListener("input",S=>{t.setValue(e,{value:S.target.value}),this.setPropertyOnSiblings(s,"value",S.target.value,"value"),d.formattedValue=null}),s.addEventListener("resetform",S=>{const w=this.data.defaultFieldValue??"";s.value=d.userValue=w,d.formattedValue=null});let v=S=>{const{formattedValue:w}=d;w!=null&&(S.target.value=w),S.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",w=>{if(d.focused)return;const{target:x}=w;if(b&&(x.type=m,y&&(x.step=y)),d.userValue){const E=d.userValue;if(b)if(m==="time"){const M=new Date(E),C=[M.getHours(),M.getMinutes(),M.getSeconds()];x.value=C.map(R=>R.toString().padStart(2,"0")).join(":")}else x.value=new Date(E-Nx).toISOString().split(m==="date"?"T":".",1)[0];else x.value=E}d.lastCommittedValue=x.value,d.commitKey=1,this.data.actions?.Focus||(d.focused=!0)}),s.addEventListener("updatefromsandbox",w=>{this.showElementAndHideCanvas(w.target);const x={value(E){d.userValue=E.detail.value??"",b||t.setValue(e,{value:d.userValue.toString()}),E.target.value=d.userValue},formattedValue(E){const{formattedValue:M}=E.detail;d.formattedValue=M,M!=null&&E.target!==document.activeElement&&(E.target.value=M);const C={formattedValue:M};b&&(C.value=M),t.setValue(e,C)},selRange(E){E.target.setSelectionRange(...E.detail.selRange)},charLimit:E=>{const{charLimit:M}=E.detail,{target:C}=E;if(M===0){C.removeAttribute("maxLength");return}C.setAttribute("maxLength",M);let R=d.userValue;!R||R.length<=M||(R=R.slice(0,M),C.value=d.userValue=R,t.setValue(e,{value:R}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:R,willCommit:!0,commitKey:1,selStart:C.selectionStart,selEnd:C.selectionEnd}}))}};this._dispatchEventFromSandbox(x,w)}),s.addEventListener("keydown",w=>{d.commitKey=1;let x=-1;if(w.key==="Escape"?x=0:w.key==="Enter"&&!this.data.multiLine?x=2:w.key==="Tab"&&(d.commitKey=3),x===-1)return;const{value:E}=w.target;d.lastCommittedValue!==E&&(d.lastCommittedValue=E,d.userValue=E,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:E,willCommit:!0,commitKey:x,selStart:w.target.selectionStart,selEnd:w.target.selectionEnd}}))});const S=v;v=null,s.addEventListener("blur",w=>{if(!d.focused||!w.relatedTarget)return;this.data.actions?.Blur||(d.focused=!1);const{target:x}=w;let{value:E}=x;if(b){if(E&&m==="time"){const M=E.split(":").map(C=>parseInt(C,10));E=new Date(2e3,0,1,M[0],M[1],M[2]||0).valueOf(),x.step=""}else E.includes("T")||(E=`${E}T00:00`),E=new Date(E).valueOf();x.type="text"}d.userValue=E,d.lastCommittedValue!==E&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:E,willCommit:!0,commitKey:d.commitKey,selStart:w.target.selectionStart,selEnd:w.target.selectionEnd}}),S(w)}),this.data.actions?.Keystroke&&s.addEventListener("beforeinput",w=>{d.lastCommittedValue=null;const{data:x,target:E}=w,{value:M,selectionStart:C,selectionEnd:R}=E;let k=C,L=R;switch(w.inputType){case"deleteWordBackward":{const P=M.substring(0,C).match(/\w*[^\w]*$/);P&&(k-=P[0].length);break}case"deleteWordForward":{const P=M.substring(C).match(/^[^\w]*\w*/);P&&(L+=P[0].length);break}case"deleteContentBackward":C===R&&(k-=1);break;case"deleteContentForward":C===R&&(L+=1);break}w.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:M,change:x||"",willCommit:!1,selStart:k,selEnd:L}})}),this._setEventListeners(s,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],w=>w.target.value)}if(v&&s.addEventListener("blur",v),this.data.comb){const w=(this.data.rect[2]-this.data.rect[0])/l;s.classList.add("comb"),s.style.letterSpacing=`calc(${w}px * var(--total-scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class Lx extends ps{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class Bx extends ps{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,s=e.id;let a=t.getValue(s,{value:e.exportValue===e.fieldValue}).value;typeof a=="string"&&(a=a!=="Off",t.setValue(s,{value:a})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const o=document.createElement("input");return ds.add(o),o.setAttribute("data-element-id",s),o.disabled=e.readOnly,this._setRequired(o,this.data.required),o.type="checkbox",o.name=e.fieldName,a&&o.setAttribute("checked",!0),o.setAttribute("exportValue",e.exportValue),o.tabIndex=0,o.addEventListener("change",l=>{const{name:u,checked:d}=l.target;for(const f of this._getElementsByName(u,s)){const m=d&&f.exportValue===e.exportValue;f.domElement&&(f.domElement.checked=m),t.setValue(f.id,{value:m})}t.setValue(s,{value:d})}),o.addEventListener("resetform",l=>{const u=e.defaultFieldValue||"Off";l.target.checked=u===e.exportValue}),this.enableScripting&&this.hasJSActions&&(o.addEventListener("updatefromsandbox",l=>{const u={value(d){d.target.checked=d.detail.value!=="Off",t.setValue(s,{value:d.target.checked})}};this._dispatchEventFromSandbox(u,l)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)),this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class Ey extends ps{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,s=e.id;let a=t.getValue(s,{value:e.fieldValue===e.buttonValue}).value;if(typeof a=="string"&&(a=a!==e.buttonValue,t.setValue(s,{value:a})),a)for(const l of this._getElementsByName(e.fieldName,s))t.setValue(l.id,{value:!1});const o=document.createElement("input");if(ds.add(o),o.setAttribute("data-element-id",s),o.disabled=e.readOnly,this._setRequired(o,this.data.required),o.type="radio",o.name=e.fieldName,a&&o.setAttribute("checked",!0),o.tabIndex=0,o.addEventListener("change",l=>{const{name:u,checked:d}=l.target;for(const f of this._getElementsByName(u,s))t.setValue(f.id,{value:!1});t.setValue(s,{value:d})}),o.addEventListener("resetform",l=>{const u=e.defaultFieldValue;l.target.checked=u!=null&&u===e.buttonValue}),this.enableScripting&&this.hasJSActions){const l=e.buttonValue;o.addEventListener("updatefromsandbox",u=>{const d={value:f=>{const m=l===f.detail.value;for(const y of this._getElementsByName(f.target.name)){const b=m&&y.id===s;y.domElement&&(y.domElement.checked=b),t.setValue(y.id,{value:b})}}};this._dispatchEventFromSandbox(d,u)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class Px extends id{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),t}}class jx extends ps{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,s=t.getValue(e,{value:this.data.fieldValue}),a=document.createElement("select");ds.add(a),a.setAttribute("data-element-id",e),a.disabled=this.data.readOnly,this._setRequired(a,this.data.required),a.name=this.data.fieldName,a.tabIndex=0;let o=this.data.combo&&this.data.options.length>0;this.data.combo||(a.size=this.data.options.length,this.data.multiSelect&&(a.multiple=!0)),a.addEventListener("resetform",m=>{const y=this.data.defaultFieldValue;for(const b of a.options)b.selected=b.value===y});for(const m of this.data.options){const y=document.createElement("option");y.textContent=m.displayValue,y.value=m.exportValue,s.value.includes(m.exportValue)&&(y.setAttribute("selected",!0),o=!1),a.append(y)}let l=null;if(o){const m=document.createElement("option");m.value=" ",m.setAttribute("hidden",!0),m.setAttribute("selected",!0),a.prepend(m),l=()=>{m.remove(),a.removeEventListener("input",l),l=null},a.addEventListener("input",l)}const u=m=>{const y=m?"value":"textContent",{options:b,multiple:v}=a;return v?Array.prototype.filter.call(b,S=>S.selected).map(S=>S[y]):b.selectedIndex===-1?null:b[b.selectedIndex][y]};let d=u(!1);const f=m=>{const y=m.target.options;return Array.prototype.map.call(y,b=>({displayValue:b.textContent,exportValue:b.value}))};return this.enableScripting&&this.hasJSActions?(a.addEventListener("updatefromsandbox",m=>{const y={value(b){l?.();const v=b.detail.value,S=new Set(Array.isArray(v)?v:[v]);for(const w of a.options)w.selected=S.has(w.value);t.setValue(e,{value:u(!0)}),d=u(!1)},multipleSelection(b){a.multiple=!0},remove(b){const v=a.options,S=b.detail.remove;v[S].selected=!1,a.remove(S),v.length>0&&Array.prototype.findIndex.call(v,x=>x.selected)===-1&&(v[0].selected=!0),t.setValue(e,{value:u(!0),items:f(b)}),d=u(!1)},clear(b){for(;a.length!==0;)a.remove(0);t.setValue(e,{value:null,items:[]}),d=u(!1)},insert(b){const{index:v,displayValue:S,exportValue:w}=b.detail.insert,x=a.children[v],E=document.createElement("option");E.textContent=S,E.value=w,x?x.before(E):a.append(E),t.setValue(e,{value:u(!0),items:f(b)}),d=u(!1)},items(b){const{items:v}=b.detail;for(;a.length!==0;)a.remove(0);for(const S of v){const{displayValue:w,exportValue:x}=S,E=document.createElement("option");E.textContent=w,E.value=x,a.append(E)}a.options.length>0&&(a.options[0].selected=!0),t.setValue(e,{value:u(!0),items:f(b)}),d=u(!1)},indices(b){const v=new Set(b.detail.indices);for(const S of b.target.options)S.selected=v.has(S.index);t.setValue(e,{value:u(!0)}),d=u(!1)},editable(b){b.target.disabled=!b.detail.editable}};this._dispatchEventFromSandbox(y,m)}),a.addEventListener("input",m=>{const y=u(!0),b=u(!1);t.setValue(e,{value:y}),m.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:d,change:b,changeEx:y,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(a,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],m=>m.target.value)):a.addEventListener("input",function(m){t.setValue(e,{value:u(!0)})}),this.data.combo&&this._setTextStyle(a),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class Bh extends ne{constructor(t){const{data:e,elements:s,parent:a}=t,o=!!a._commentManager;if(super(t,{isRenderable:!o&&ne._hasPopupData(e)}),this.elements=s,o&&ne._hasPopupData(e)){const l=this.popup=this.#t();for(const u of s)u.popup=l}else this.popup=null}#t(){return new Fx({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const e=this.popup=this.#t(),s=[];for(const a of this.elements)a.popup=e,a.container.ariaHasPopup="dialog",s.push(a.data.id),a.addHighlightArea();return this.container.setAttribute("aria-controls",s.map(a=>`${ia}${a}`).join(",")),this.container}}class Fx{#t=null;#e=this.#V.bind(this);#i=this.#z.bind(this);#n=this.#O.bind(this);#a=this.#w.bind(this);#r=null;#s=null;#o=null;#c=null;#l=null;#d=null;#h=null;#f=!1;#g=null;#m=null;#u=null;#p=null;#y=null;#v=null;#b=null;#T=null;#x=null;#S=null;#C=!1;#A=null;#E=null;constructor({container:t,color:e,elements:s,titleObj:a,modificationDate:o,contentsObj:l,richText:u,parent:d,rect:f,parentRect:m,open:y,commentManager:b=null}){this.#s=t,this.#x=a,this.#o=l,this.#T=u,this.#d=d,this.#r=e,this.#b=f,this.#h=m,this.#l=s,this.#t=b,this.#A=s[0],this.#c=Mh.toDateObject(o),this.trigger=s.flatMap(v=>v.getElementsToTriggerPopup()),b||(this.#N(),this.#s.hidden=!0,y&&this.#w())}#N(){if(this.#m)return;this.#m=new AbortController;const{signal:t}=this.#m;for(const e of this.trigger)e.addEventListener("click",this.#a,{signal:t}),e.addEventListener("pointerenter",this.#n,{signal:t}),e.addEventListener("pointerleave",this.#i,{signal:t}),e.classList.add("popupTriggerArea");for(const e of this.#l)e.container?.addEventListener("keydown",this.#e,{signal:t})}#M(){const t=this.#l.find(e=>e.hasCommentButton);t&&(this.#y=t._normalizePoint(t.commentButtonPosition))}renderCommentButton(){if(this.#p){this.#p.parentNode||this.#A.container.after(this.#p);return}if(this.#y||this.#M(),!this.#y)return;const{signal:t}=this.#m=new AbortController,e=this.#A.hasOwnCommentButton,s=()=>{this.#t.toggleCommentPopup(this,!0,void 0,!e)},a=()=>{this.#t.toggleCommentPopup(this,!1,!0,!e)},o=()=>{this.#t.toggleCommentPopup(this,!1,!1)};if(e){this.#p=this.#A.container;for(const l of this.trigger)l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.addEventListener("keydown",this.#e,{signal:t}),l.addEventListener("click",s,{signal:t}),l.addEventListener("pointerenter",a,{signal:t}),l.addEventListener("pointerleave",o,{signal:t}),l.classList.add("popupTriggerArea")}else{const l=this.#p=document.createElement("button");l.className="annotationCommentButton";const u=this.#A.container;l.style.zIndex=u.style.zIndex+1,l.tabIndex=0,l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#j(),this.#D(),l.addEventListener("keydown",this.#e,{signal:t}),l.addEventListener("click",s,{signal:t}),l.addEventListener("pointerenter",a,{signal:t}),l.addEventListener("pointerleave",o,{signal:t}),u.after(l)}}#D(){if(this.#A.extraPopupElement&&!this.#A.editor)return;this.#p||this.renderCommentButton();const[t,e]=this.#y,{style:s}=this.#p;s.left=`calc(${t}%)`,s.top=`calc(${e}% - var(--comment-button-dim))`}#j(){this.#A.extraPopupElement||(this.#p||this.renderCommentButton(),this.#p.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:t,opacity:e}=this.#A.commentData;return t?this.#d._commentManager.makeCommentColor(t,e):null}focusCommentButton(){setTimeout(()=>{this.#p?.focus()},0)}getData(){const{richText:t,color:e,opacity:s,creationDate:a,modificationDate:o}=this.#A.commentData;return{contentsObj:{str:this.comment},richText:t,color:e,opacity:s,creationDate:a,modificationDate:o}}get elementBeforePopup(){return this.#p}get comment(){return this.#E||=this.#A.commentText,this.#E}set comment(t){t!==this.comment&&(this.#A.commentText=this.#E=t)}focus(){this.#A.container?.focus()}get parentBoundingClientRect(){return this.#A.layer.getBoundingClientRect()}setCommentButtonStates({selected:t,hasPopup:e}){this.#p&&(this.#p.classList.toggle("selected",t),this.#p.ariaExpanded=e)}setSelectedCommentButton(t){this.#p.classList.toggle("selected",t)}get commentPopupPosition(){if(this.#v)return this.#v;const{x:t,y:e,height:s}=this.#p.getBoundingClientRect(),{x:a,y:o,width:l,height:u}=this.#A.layer.getBoundingClientRect();return[(t-a)/l,(e+s-o)/u]}set commentPopupPosition(t){this.#v=t}hasDefaultPopupPosition(){return this.#v===null}get commentButtonPosition(){return this.#y}get commentButtonWidth(){return this.#p.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(t){const[e,s]=this.#v||this.commentButtonPosition.map(f=>f/100),a=this.parentBoundingClientRect,{x:o,y:l,width:u,height:d}=a;this.#t.showDialog(null,this,o+e*u,l+s*d,{...t,parentDimensions:a})}render(){if(this.#g)return;const t=this.#g=document.createElement("div");if(t.className="popup",this.#r){const s=t.style.outlineColor=nt.makeHexColor(...this.#r);t.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const e=document.createElement("span");if(e.className="header",this.#x?.str){const s=document.createElement("span");s.className="title",e.append(s),{dir:s.dir,str:s.textContent}=this.#x}if(t.append(e),this.#c){const s=document.createElement("time");s.className="popupDate",s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),s.dateTime=this.#c.toISOString(),e.append(s)}J0({html:this.#k||this.#o.str,dir:this.#o?.dir,className:"popupContent"},t),this.#s.append(t)}get#k(){const t=this.#T,e=this.#o;return t?.str&&(!e?.str||e.str===t.str)&&this.#T.html||null}get#L(){return this.#k?.attributes?.style?.fontSize||0}get#F(){return this.#k?.attributes?.style?.color||null}#B(t){const e=[],s={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},a={style:{color:this.#F,fontSize:this.#L?`calc(${this.#L}px * var(--total-scale-factor))`:""}};for(const o of t.split(`
`))e.push({name:"span",value:o,attributes:a});return s}#V(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#f)&&this.#w()}updateEdited({rect:t,popup:e,deleted:s}){if(this.#t){s?(this.remove(),this.#E=null):e&&(e.deleted?this.remove():(this.#j(),this.#E=e.text)),t&&(this.#y=null,this.#M(),this.#D());return}if(s||e?.deleted){this.remove();return}this.#N(),this.#S||={contentsObj:this.#o,richText:this.#T},t&&(this.#u=null),e&&e.text&&(this.#T=this.#B(e.text),this.#c=Mh.toDateObject(e.date),this.#o=null),this.#g?.remove(),this.#g=null}resetEdited(){this.#S&&({contentsObj:this.#o,richText:this.#T}=this.#S,this.#S=null,this.#g?.remove(),this.#g=null,this.#u=null)}remove(){if(this.#m?.abort(),this.#m=null,this.#g?.remove(),this.#g=null,this.#C=!1,this.#f=!1,this.#p?.remove(),this.#p=null,this.trigger)for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#_(){if(this.#u!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:s,pageX:a,pageY:o}}}=this.#d;let l=!!this.#h,u=l?this.#h:this.#b;for(const S of this.#l)if(!u||nt.intersect(S.data.rect,u)!==null){u=S.data.rect,l=!0;break}const d=nt.normalizeRect([u[0],t[3]-u[1]+t[1],u[2],t[3]-u[3]+t[1]]),m=l?u[2]-u[0]+5:0,y=d[0]+m,b=d[1];this.#u=[100*(y-a)/e,100*(b-o)/s];const{style:v}=this.#s;v.left=`${this.#u[0]}%`,v.top=`${this.#u[1]}%`}#w(){if(this.#t){this.#t.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#O(),this.#s.addEventListener("click",this.#a),this.#s.addEventListener("keydown",this.#e)):(this.#z(),this.#s.removeEventListener("click",this.#a),this.#s.removeEventListener("keydown",this.#e))}#O(){this.#g||this.render(),this.isVisible?this.#f&&this.#s.classList.add("focused"):(this.#_(),this.#s.hidden=!1,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)+1e3)}#z(){this.#s.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#s.hidden=!0,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)-1e3)}forceHide(){this.#C=this.isVisible,this.#C&&(this.#s.hidden=!0)}maybeShow(){this.#t||(this.#N(),this.#C&&(this.#g||this.#O(),this.#C=!1,this.#s.hidden=!1))}get isVisible(){return this.#t?!1:this.#s.hidden===!1}}class Ty extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=At.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=this.contentElement=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const s=document.createElement("span");s.textContent=e,t.append(s)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class zx extends ne{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:e,height:s}=this,a=this.svgFactory.create(e,s,!0),o=this.#t=this.svgFactory.createElement("svg:line");return o.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),o.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),o.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),o.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),o.setAttribute("stroke-width",t.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),a.append(o),this.container.append(a),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Ux extends ne{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:e,height:s}=this,a=this.svgFactory.create(e,s,!0),o=t.borderStyle.width,l=this.#t=this.svgFactory.createElement("svg:rect");return l.setAttribute("x",o/2),l.setAttribute("y",o/2),l.setAttribute("width",e-o),l.setAttribute("height",s-o),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),a.append(l),this.container.append(a),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Ix extends ne{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:e,height:s}=this,a=this.svgFactory.create(e,s,!0),o=t.borderStyle.width,l=this.#t=this.svgFactory.createElement("svg:ellipse");return l.setAttribute("cx",e/2),l.setAttribute("cy",s/2),l.setAttribute("rx",e/2-o/2),l.setAttribute("ry",s/2-o/2),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),a.append(l),this.container.append(a),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class _y extends ne{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:s,popupRef:a},width:o,height:l}=this;if(!e)return this.container;const u=this.svgFactory.create(o,l,!0);let d=[];for(let m=0,y=e.length;m<y;m+=2){const b=e[m]-t[0],v=t[3]-e[m+1];d.push(`${b},${v}`)}d=d.join(" ");const f=this.#t=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",d),f.setAttribute("stroke-width",s.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),u.append(f),this.container.append(u),!a&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Hx extends _y{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Gx extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}class sd extends ne{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?At.HIGHLIGHT:At.INK}#i(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:s,borderStyle:a,popupRef:o}}=this,{transform:l,width:u,height:d}=this.#i(e,t),f=this.svgFactory.create(u,d,!0),m=this.#t=this.svgFactory.createElement("svg:g");f.append(m),m.setAttribute("stroke-width",a.width||1),m.setAttribute("stroke-linecap","round"),m.setAttribute("stroke-linejoin","round"),m.setAttribute("stroke-miterlimit",10),m.setAttribute("stroke","transparent"),m.setAttribute("fill","transparent"),m.setAttribute("transform",l);for(let y=0,b=s.length;y<b;y++){const v=this.svgFactory.createElement(this.svgElementName);this.#e.push(v),v.setAttribute("points",s[y].join(",")),m.append(v)}return!o&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:s,rect:a}=t,o=this.#t;if(e>=0&&o.setAttribute("stroke-width",e||1),s)for(let l=0,u=this.#e.length;l<u;l++)this.#e[l].setAttribute("points",s[l].join(","));if(a){const{transform:l,width:u,height:d}=this.#i(this.data.rotation,a);o.parentElement.setAttribute("viewBox",`0 0 ${u} ${d}`),o.setAttribute("transform",l)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class Cy extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=At.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const s=document.createElement("mark");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class Vx extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),t){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class qx extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),t){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class Xx extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),t){const s=document.createElement("s");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class My extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=At.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class Yx extends ne{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let s;e.hasAppearance||e.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),s.addEventListener("dblclick",this.#e.bind(this)),this.#t=s;const{isMac:a}=be.platform;return t.addEventListener("keydown",o=>{o.key==="Enter"&&(a?o.metaKey:o.ctrlKey)&&this.#e()}),!e.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):s.classList.add("popupTriggerArea"),t.append(s),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class ad{#t=null;#e=null;#i=null;#n=new Map;#a=null;#r=null;#s=[];#o=!1;constructor({div:t,accessibilityManager:e,annotationCanvasMap:s,annotationEditorUIManager:a,page:o,viewport:l,structTreeLayer:u,commentManager:d,linkService:f,annotationStorage:m}){this.div=t,this.#t=e,this.#e=s,this.#a=u||null,this.#r=f||null,this.#i=m||new Zh,this.page=o,this.viewport=l,this.zIndex=0,this._annotationEditorUIManager=a,this._commentManager=d||null}hasEditableAnnotations(){return this.#n.size>0}async render(t){const{annotations:e}=t,s=this.div;hs(s,this.viewport);const a=new Map,o=[],l={data:null,layer:s,linkService:this.#r,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Al,annotationStorage:this.#i,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const u of e){if(u.noHTML)continue;const d=u.annotationType===me.POPUP;if(d){const y=a.get(u.id);if(!y)continue;if(!this._commentManager){o.push(u);continue}l.elements=y}else if(u.rect[2]===u.rect[0]||u.rect[3]===u.rect[1])continue;l.data=u;const f=vh.create(l);if(!f.isRenderable)continue;if(!d&&(this.#s.push(f),u.popupRef)){const y=a.get(u.popupRef);y?y.push(f):a.set(u.popupRef,[f])}const m=f.render();u.hidden&&(m.style.visibility="hidden"),f._isEditable&&(this.#n.set(f.data.id,f),this._annotationEditorUIManager?.renderAnnotationElement(f))}await this.#c();for(const u of o){const d=l.elements=a.get(u.id);l.data=u;const f=vh.create(l);if(!f.isRenderable)continue;const m=f.render();f.contentElement.id=`${ia}${u.id}`,u.hidden&&(m.style.visibility="hidden"),d.at(-1).container.after(m)}this.#l()}async#c(){if(this.#s.length===0)return;this.div.replaceChildren();const t=[];if(!this.#o){this.#o=!0;for(const{contentElement:s,data:{id:a}}of this.#s){const o=s.id=`${ia}${a}`;t.push(this.#a?.getAriaAttributes(o).then(l=>{if(l)for(const[u,d]of l)s.setAttribute(u,d)}))}}this.#s.sort(({data:{rect:[s,a,o,l]}},{data:{rect:[u,d,f,m]}})=>{if(s===o&&a===l)return 1;if(u===f&&d===m)return-1;const y=l,b=a,v=(a+l)/2,S=m,w=d,x=(d+m)/2;if(v>=S&&x<=b)return-1;if(x>=y&&v<=w)return 1;const E=(s+o)/2,M=(u+f)/2;return E-M});const e=document.createDocumentFragment();for(const s of this.#s)e.append(s.container),this._commentManager?(s.extraPopupElement?.popup||s.popup)?.renderCommentButton():s.extraPopupElement&&e.append(s.extraPopupElement.render());if(this.div.append(e),await Promise.all(t),this.#t)for(const s of this.#s)this.#t.addPointerInTextLayer(s.contentElement,!1)}async addLinkAnnotations(t){const e={data:null,layer:this.div,linkService:this.#r,svgFactory:new Al,parent:this};for(const s of t){s.borderStyle||=ad._defaultBorderStyle,e.data=s;const a=vh.create(e);a.isRenderable&&(a.render(),a.contentElement.id=`${ia}${s.id}`,this.#s.push(a))}await this.#c()}update({viewport:t}){const e=this.div;this.viewport=t,hs(e,{rotation:t.rotation}),this.#l(),e.hidden=!1}#l(){if(!this.#e)return;const t=this.div;for(const[e,s]of this.#e){const a=t.querySelector(`[data-annotation-id="${e}"]`);if(!a)continue;s.className="annotationContent";const{firstChild:o}=a;o?o.nodeName==="CANVAS"?o.replaceWith(s):o.classList.contains("annotationContent")?o.after(s):o.before(s):a.append(s);const l=this.#n.get(e);l&&(l._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(e,a.id,s),l._hasNoCanvas=!1):l.canvas=s)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(t){return this.#n.get(t)}addFakeAnnotation(t){const{div:e}=this,{id:s,rotation:a}=t,o=new Rx({data:{id:s,rect:t.getPDFRect(),rotation:a},editor:t,layer:e,parent:this,enableComment:!!this._commentManager,linkService:this.#r,annotationStorage:this.#i});return o.render(),o.contentElement.id=`${ia}${s}`,o.createOrUpdatePopup(),this.#s.push(o),o}removeAnnotation(t){const e=this.#s.findIndex(a=>a.data.id===t);if(e<0)return;const[s]=this.#s.splice(e,1);this.#t?.removePointerInTextLayer(s.contentElement)}updateFakeAnnotations(t){if(t.length!==0){for(const e of t)e.updateFakeAnnotationElement(this);this.#c()}}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}static get _defaultBorderStyle(){return bt(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:ta.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const ll=/\r\n?|\n/g;class we extends ct{#t="";#e=`${this.id}-editor`;#i=null;#n;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=we.prototype,e=o=>o.isEmpty(),s=ji.TRANSLATE_SMALL,a=ji.TRANSLATE_BIG;return bt(this,"_keyboardManager",new Lr([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-a,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[s,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[a,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-a],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,s],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,a],checker:e}]]))}static _type="freetext";static _editorType=At.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.color=t.color||we._defaultColor||ct._defaultLineColor,this.#n=t.fontSize||we._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static initialize(t,e){ct.initialize(t,e);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case Nt.FREETEXT_SIZE:we._defaultFontSize=e;break;case Nt.FREETEXT_COLOR:we._defaultColor=e;break}}updateParams(t,e){switch(t){case Nt.FREETEXT_SIZE:this.#a(e);break;case Nt.FREETEXT_COLOR:this.#r(e);break}}static get defaultPropertiesToUpdate(){return[[Nt.FREETEXT_SIZE,we._defaultFontSize],[Nt.FREETEXT_COLOR,we._defaultColor||ct._defaultLineColor]]}get propertiesToUpdate(){return[[Nt.FREETEXT_SIZE,this.#n],[Nt.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new Er(this),[["colorPicker",this._colorPicker]]}get colorType(){return Nt.FREETEXT_COLOR}#a(t){const e=a=>{this.editorDiv.style.fontSize=`calc(${a}px * var(--total-scale-factor))`,this.translate(0,-(a-this.#n)*this.parentScale),this.#n=a,this.#o()},s=this.#n;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Nt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#r(t){const e=a=>{this.color=a,this.onUpdatedColor()},s=this.color;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Nt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-we._internalPadding*t,-(we._internalPadding+this.#n)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#i=new AbortController;const t=this._uiManager.combinedSignal(this.#i);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#e),this._isDraggable=!0,this.#i?.abort(),this.#i=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#s(){const t=[];this.editorDiv.normalize();let e=null;for(const s of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&s.nodeName==="BR"||(t.push(we.#c(s)),e=s);return t.join(`
`)}#o(){const[t,e]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:a,div:o}=this,l=o.style.display,u=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",a.div.append(this.div),s=o.getBoundingClientRect(),o.remove(),o.style.display=l,o.classList.toggle("hidden",u)}this.rotation%180===this.parentRotation%180?(this.width=s.width/t,this.height=s.height/e):(this.width=s.height/t,this.height=s.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#t,e=this.#t=this.#s().trimEnd();if(t===e)return;const s=a=>{if(this.#t=a,!a){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{s(e)},undo:()=>{s(t)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){we._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,e;(this._isCopy||this.annotationElementId)&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#e),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,s.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[a,o]=this.parentDimensions;if(this.annotationElementId){const{position:l}=this._initialData;let[u,d]=this.getInitialTranslation();[u,d]=this.pageTranslationToScreen(u,d);const[f,m]=this.pageDimensions,[y,b]=this.pageTranslation;let v,S;switch(this.rotation){case 0:v=t+(l[0]-y)/f,S=e+this.height-(l[1]-b)/m;break;case 90:v=t+(l[0]-y)/f,S=e-(l[1]-b)/m,[u,d]=[d,-u];break;case 180:v=t-this.width+(l[0]-y)/f,S=e-(l[1]-b)/m,[u,d]=[-u,-d];break;case 270:v=t+(l[0]-y-this.height*m)/f,S=e+(l[1]-b-this.width*f)/m,[u,d]=[-d,u];break}this.setAt(v*a,S*o,u,d)}else this._moveAfterPaste(t,e);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(ll,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:s}=e;if(s.length===1&&s[0]==="text/plain")return;t.preventDefault();const a=we.#h(e.getData("text")||"").replaceAll(ll,`
`);if(!a)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const l=o.getRangeAt(0);if(!a.includes(`
`)){l.insertNode(document.createTextNode(a)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:u,startOffset:d}=l,f=[],m=[];if(u.nodeType===Node.TEXT_NODE){const v=u.parentElement;if(m.push(u.nodeValue.slice(d).replaceAll(ll,"")),v!==this.editorDiv){let S=f;for(const w of this.editorDiv.childNodes){if(w===v){S=m;continue}S.push(we.#c(w))}}f.push(u.nodeValue.slice(0,d).replaceAll(ll,""))}else if(u===this.editorDiv){let v=f,S=0;for(const w of this.editorDiv.childNodes)S++===d&&(v=m),v.push(we.#c(w))}this.#t=`${f.join(`
`)}${a}${m.join(`
`)}`,this.#l();const y=new Range;let b=Math.sumPrecise(f.map(v=>v.length));for(const{firstChild:v}of this.editorDiv.childNodes)if(v.nodeType===Node.TEXT_NODE){const S=v.nodeValue.length;if(b<=S){y.setStart(v,b),y.setEnd(v,b);break}b-=S}o.removeAllRanges(),o.addRange(y)}#l(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const t of this.#t.split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#d(){return this.#t.replaceAll(""," ")}static#h(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=we._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,e,s){let a=null;if(t instanceof Ty){const{data:{defaultAppearanceData:{fontSize:l,fontColor:u},rect:d,rotation:f,id:m,popupRef:y,richText:b,contentsObj:v,creationDate:S,modificationDate:w},textContent:x,textPosition:E,parent:{page:{pageNumber:M}}}=t;if(!x||x.length===0)return null;a=t={annotationType:At.FREETEXT,color:Array.from(u),fontSize:l,value:x.join(`
`),position:E,pageIndex:M-1,rect:d.slice(0),rotation:f,annotationElementId:m,id:m,deleted:!1,popupRef:y,comment:v?.str||null,richText:b,creationDate:S,modificationDate:w}}const o=await super.deserialize(t,e,s);return o.#n=t.fontSize,o.color=nt.makeHexColor(...t.color),o.#t=we.#h(t.value),o._initialData=a,t.comment&&o.setCommentData(t),o}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=ct._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),s=Object.assign(super.serialize(t),{color:e,fontSize:this.#n,value:this.#d()});return this.addComment(s),t?(s.isCopy=!0,s):this.annotationElementId&&!this.#f(s)?null:(s.id=this.annotationElementId,s)}#f(t){const{value:e,fontSize:s,color:a,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==e||t.fontSize!==s||t.color.some((l,u)=>l!==a[u])||t.pageIndex!==o}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(!e)return null;const{style:s}=e;s.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,s.color=this.color,e.replaceChildren();for(const a of this.#t.split(`
`)){const o=document.createElement("div");o.append(a?document.createTextNode(a):document.createElement("br")),e.append(o)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#t}}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class st{static PRECISION=1e-4;toSVGPath(){zt("Abstract method `toSVGPath` must be implemented.")}get box(){zt("Abstract getter `box` must be implemented.")}serialize(t,e){zt("Abstract method `serialize` must be implemented.")}static _rescale(t,e,s,a,o,l){l||=new Float32Array(t.length);for(let u=0,d=t.length;u<d;u+=2)l[u]=e+t[u]*a,l[u+1]=s+t[u+1]*o;return l}static _rescaleAndSwap(t,e,s,a,o,l){l||=new Float32Array(t.length);for(let u=0,d=t.length;u<d;u+=2)l[u]=e+t[u+1]*a,l[u+1]=s+t[u]*o;return l}static _translate(t,e,s,a){a||=new Float32Array(t.length);for(let o=0,l=t.length;o<l;o+=2)a[o]=e+t[o],a[o+1]=s+t[o+1];return a}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,s,a,o){switch(o){case 90:return[1-e/s,t/a];case 180:return[1-t/s,1-e/a];case 270:return[e/s,1-t/a];default:return[t/s,e/a]}}static _normalizePagePoint(t,e,s){switch(s){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,s,a,o,l){return[(t+5*s)/6,(e+5*a)/6,(5*s+o)/6,(5*a+l)/6,(s+o)/2,(a+l)/2]}}class as{#t;#e=[];#i;#n;#a=[];#r=new Float32Array(18);#s;#o;#c;#l;#d;#h;#f=[];static#g=8;static#m=2;static#u=as.#g+as.#m;constructor({x:t,y:e},s,a,o,l,u=0){this.#t=s,this.#h=o*a,this.#n=l,this.#r.set([NaN,NaN,NaN,NaN,t,e],6),this.#i=u,this.#l=as.#g*a,this.#c=as.#u*a,this.#d=a,this.#f.push(t,e)}isEmpty(){return isNaN(this.#r[8])}#p(){const t=this.#r.subarray(4,6),e=this.#r.subarray(16,18),[s,a,o,l]=this.#t;return[(this.#s+(t[0]-e[0])/2-s)/o,(this.#o+(t[1]-e[1])/2-a)/l,(this.#s+(e[0]-t[0])/2-s)/o,(this.#o+(e[1]-t[1])/2-a)/l]}add({x:t,y:e}){this.#s=t,this.#o=e;const[s,a,o,l]=this.#t;let[u,d,f,m]=this.#r.subarray(8,12);const y=t-f,b=e-m,v=Math.hypot(y,b);if(v<this.#c)return!1;const S=v-this.#l,w=S/v,x=w*y,E=w*b;let M=u,C=d;u=f,d=m,f+=x,m+=E,this.#f?.push(t,e);const R=-E/S,k=x/S,L=R*this.#h,P=k*this.#h;return this.#r.set(this.#r.subarray(2,8),0),this.#r.set([f+L,m+P],4),this.#r.set(this.#r.subarray(14,18),12),this.#r.set([f-L,m-P],16),isNaN(this.#r[6])?(this.#a.length===0&&(this.#r.set([u+L,d+P],2),this.#a.push(NaN,NaN,NaN,NaN,(u+L-s)/o,(d+P-a)/l),this.#r.set([u-L,d-P],14),this.#e.push(NaN,NaN,NaN,NaN,(u-L-s)/o,(d-P-a)/l)),this.#r.set([M,C,u,d,f,m],6),!this.isEmpty()):(this.#r.set([M,C,u,d,f,m],6),Math.abs(Math.atan2(C-d,M-u)-Math.atan2(E,x))<Math.PI/2?([u,d,f,m]=this.#r.subarray(2,6),this.#a.push(NaN,NaN,NaN,NaN,((u+f)/2-s)/o,((d+m)/2-a)/l),[u,d,M,C]=this.#r.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((M+u)/2-s)/o,((C+d)/2-a)/l),!0):([M,C,u,d,f,m]=this.#r.subarray(0,6),this.#a.push(((M+5*u)/6-s)/o,((C+5*d)/6-a)/l,((5*u+f)/6-s)/o,((5*d+m)/6-a)/l,((u+f)/2-s)/o,((d+m)/2-a)/l),[f,m,u,d,M,C]=this.#r.subarray(12,18),this.#e.push(((M+5*u)/6-s)/o,((C+5*d)/6-a)/l,((5*u+f)/6-s)/o,((5*d+m)/6-a)/l,((u+f)/2-s)/o,((d+m)/2-a)/l),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#a,e=this.#e;if(isNaN(this.#r[6])&&!this.isEmpty())return this.#y();const s=[];s.push(`M${t[4]} ${t[5]}`);for(let a=6;a<t.length;a+=6)isNaN(t[a])?s.push(`L${t[a+4]} ${t[a+5]}`):s.push(`C${t[a]} ${t[a+1]} ${t[a+2]} ${t[a+3]} ${t[a+4]} ${t[a+5]}`);this.#b(s);for(let a=e.length-6;a>=6;a-=6)isNaN(e[a])?s.push(`L${e[a+4]} ${e[a+5]}`):s.push(`C${e[a]} ${e[a+1]} ${e[a+2]} ${e[a+3]} ${e[a+4]} ${e[a+5]}`);return this.#v(s),s.join(" ")}#y(){const[t,e,s,a]=this.#t,[o,l,u,d]=this.#p();return`M${(this.#r[2]-t)/s} ${(this.#r[3]-e)/a} L${(this.#r[4]-t)/s} ${(this.#r[5]-e)/a} L${o} ${l} L${u} ${d} L${(this.#r[16]-t)/s} ${(this.#r[17]-e)/a} L${(this.#r[14]-t)/s} ${(this.#r[15]-e)/a} Z`}#v(t){const e=this.#e;t.push(`L${e[4]} ${e[5]} Z`)}#b(t){const[e,s,a,o]=this.#t,l=this.#r.subarray(4,6),u=this.#r.subarray(16,18),[d,f,m,y]=this.#p();t.push(`L${(l[0]-e)/a} ${(l[1]-s)/o} L${d} ${f} L${m} ${y} L${(u[0]-e)/a} ${(u[1]-s)/o}`)}newFreeDrawOutline(t,e,s,a,o,l){return new Dy(t,e,s,a,o,l)}getOutlines(){const t=this.#a,e=this.#e,s=this.#r,[a,o,l,u]=this.#t,d=new Float32Array((this.#f?.length??0)+2);for(let y=0,b=d.length-2;y<b;y+=2)d[y]=(this.#f[y]-a)/l,d[y+1]=(this.#f[y+1]-o)/u;if(d[d.length-2]=(this.#s-a)/l,d[d.length-1]=(this.#o-o)/u,isNaN(s[6])&&!this.isEmpty())return this.#T(d);const f=new Float32Array(this.#a.length+24+this.#e.length);let m=t.length;for(let y=0;y<m;y+=2){if(isNaN(t[y])){f[y]=f[y+1]=NaN;continue}f[y]=t[y],f[y+1]=t[y+1]}m=this.#S(f,m);for(let y=e.length-6;y>=6;y-=6)for(let b=0;b<6;b+=2){if(isNaN(e[y+b])){f[m]=f[m+1]=NaN,m+=2;continue}f[m]=e[y+b],f[m+1]=e[y+b+1],m+=2}return this.#x(f,m),this.newFreeDrawOutline(f,d,this.#t,this.#d,this.#i,this.#n)}#T(t){const e=this.#r,[s,a,o,l]=this.#t,[u,d,f,m]=this.#p(),y=new Float32Array(36);return y.set([NaN,NaN,NaN,NaN,(e[2]-s)/o,(e[3]-a)/l,NaN,NaN,NaN,NaN,(e[4]-s)/o,(e[5]-a)/l,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,f,m,NaN,NaN,NaN,NaN,(e[16]-s)/o,(e[17]-a)/l,NaN,NaN,NaN,NaN,(e[14]-s)/o,(e[15]-a)/l],0),this.newFreeDrawOutline(y,t,this.#t,this.#d,this.#i,this.#n)}#x(t,e){const s=this.#e;return t.set([NaN,NaN,NaN,NaN,s[4],s[5]],e),e+=6}#S(t,e){const s=this.#r.subarray(4,6),a=this.#r.subarray(16,18),[o,l,u,d]=this.#t,[f,m,y,b]=this.#p();return t.set([NaN,NaN,NaN,NaN,(s[0]-o)/u,(s[1]-l)/d,NaN,NaN,NaN,NaN,f,m,NaN,NaN,NaN,NaN,y,b,NaN,NaN,NaN,NaN,(a[0]-o)/u,(a[1]-l)/d],e),e+=24}}class Dy extends st{#t;#e=new Float32Array(4);#i;#n;#a;#r;#s;constructor(t,e,s,a,o,l){super(),this.#s=t,this.#a=e,this.#t=s,this.#r=a,this.#i=o,this.#n=l,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#o(l);const[u,d,f,m]=this.#e;for(let y=0,b=t.length;y<b;y+=2)t[y]=(t[y]-u)/f,t[y+1]=(t[y+1]-d)/m;for(let y=0,b=e.length;y<b;y+=2)e[y]=(e[y]-u)/f,e[y+1]=(e[y+1]-d)/m}toSVGPath(){const t=[`M${this.#s[4]} ${this.#s[5]}`];for(let e=6,s=this.#s.length;e<s;e+=6){if(isNaN(this.#s[e])){t.push(`L${this.#s[e+4]} ${this.#s[e+5]}`);continue}t.push(`C${this.#s[e]} ${this.#s[e+1]} ${this.#s[e+2]} ${this.#s[e+3]} ${this.#s[e+4]} ${this.#s[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,s,a],o){const l=s-t,u=a-e;let d,f;switch(o){case 0:d=st._rescale(this.#s,t,a,l,-u),f=st._rescale(this.#a,t,a,l,-u);break;case 90:d=st._rescaleAndSwap(this.#s,t,e,l,u),f=st._rescaleAndSwap(this.#a,t,e,l,u);break;case 180:d=st._rescale(this.#s,s,e,-l,u),f=st._rescale(this.#a,s,e,-l,u);break;case 270:d=st._rescaleAndSwap(this.#s,s,a,-l,-u),f=st._rescaleAndSwap(this.#a,s,a,-l,-u);break}return{outline:Array.from(d),points:[Array.from(f)]}}#o(t){const e=this.#s;let s=e[4],a=e[5];const o=[s,a,s,a];let l=s,u=a,d=s,f=a;const m=t?Math.max:Math.min,y=new Float32Array(4);for(let v=6,S=e.length;v<S;v+=6){const w=e[v+4],x=e[v+5];isNaN(e[v])?(nt.pointBoundingBox(w,x,o),u>x?(l=w,u=x):u===x&&(l=m(l,w)),f<x?(d=w,f=x):f===x&&(d=m(d,w))):(y[0]=y[1]=1/0,y[2]=y[3]=-1/0,nt.bezierBoundingBox(s,a,...e.slice(v,v+6),y),nt.rectBoundingBox(y[0],y[1],y[2],y[3],o),u>y[1]?(l=y[0],u=y[1]):u===y[1]&&(l=m(l,y[0])),f<y[3]?(d=y[2],f=y[3]):f===y[3]&&(d=m(d,y[2]))),s=w,a=x}const b=this.#e;b[0]=o[0]-this.#i,b[1]=o[1]-this.#i,b[2]=o[2]-o[0]+2*this.#i,b[3]=o[3]-o[1]+2*this.#i,this.firstPoint=[l,u],this.lastPoint=[d,f]}get box(){return this.#e}newOutliner(t,e,s,a,o,l=0){return new as(t,e,s,a,o,l)}getNewOutline(t,e){const[s,a,o,l]=this.#e,[u,d,f,m]=this.#t,y=o*f,b=l*m,v=s*f+u,S=a*m+d,w=this.newOutliner({x:this.#a[0]*y+v,y:this.#a[1]*b+S},this.#t,this.#r,t,this.#n,e??this.#i);for(let x=2;x<this.#a.length;x+=2)w.add({x:this.#a[x]*y+v,y:this.#a[x+1]*b+S});return w.getOutlines()}}class Ph{#t;#e;#i;#n=[];#a=[];constructor(t,e=0,s=0,a=!0){const o=[1/0,1/0,-1/0,-1/0],l=10**-4;for(const{x:w,y:x,width:E,height:M}of t){const C=Math.floor((w-e)/l)*l,R=Math.ceil((w+E+e)/l)*l,k=Math.floor((x-e)/l)*l,L=Math.ceil((x+M+e)/l)*l,P=[C,k,L,!0],$=[R,k,L,!1];this.#n.push(P,$),nt.rectBoundingBox(C,k,R,L,o)}const u=o[2]-o[0]+2*s,d=o[3]-o[1]+2*s,f=o[0]-s,m=o[1]-s;let y=a?-1/0:1/0,b=1/0;const v=this.#n.at(a?-1:-2),S=[v[0],v[2]];for(const w of this.#n){const[x,E,M,C]=w;!C&&a?E<b?(b=E,y=x):E===b&&(y=Math.max(y,x)):C&&!a&&(E<b?(b=E,y=x):E===b&&(y=Math.min(y,x))),w[0]=(x-f)/u,w[1]=(E-m)/d,w[2]=(M-m)/d}this.#t=new Float32Array([f,m,u,d]),this.#e=[y,b],this.#i=S}getOutlines(){this.#n.sort((e,s)=>e[0]-s[0]||e[1]-s[1]||e[2]-s[2]);const t=[];for(const e of this.#n)e[3]?(t.push(...this.#l(e)),this.#o(e)):(this.#c(e),t.push(...this.#l(e)));return this.#r(t)}#r(t){const e=[],s=new Set;for(const l of t){const[u,d,f]=l;e.push([u,d,l],[u,f,l])}e.sort((l,u)=>l[1]-u[1]||l[0]-u[0]);for(let l=0,u=e.length;l<u;l+=2){const d=e[l][2],f=e[l+1][2];d.push(f),f.push(d),s.add(d),s.add(f)}const a=[];let o;for(;s.size>0;){const l=s.values().next().value;let[u,d,f,m,y]=l;s.delete(l);let b=u,v=d;for(o=[u,f],a.push(o);;){let S;if(s.has(m))S=m;else if(s.has(y))S=y;else break;s.delete(S),[u,d,f,m,y]=S,b!==u&&(o.push(b,v,u,v===d?d:f),b=u),v=v===d?f:d}o.push(b,v)}return new $x(a,this.#t,this.#e,this.#i)}#s(t){const e=this.#a;let s=0,a=e.length-1;for(;s<=a;){const o=s+a>>1,l=e[o][0];if(l===t)return o;l<t?s=o+1:a=o-1}return a+1}#o([,t,e]){const s=this.#s(t);this.#a.splice(s,0,[t,e])}#c([,t,e]){const s=this.#s(t);for(let a=s;a<this.#a.length;a++){const[o,l]=this.#a[a];if(o!==t)break;if(o===t&&l===e){this.#a.splice(a,1);return}}for(let a=s-1;a>=0;a--){const[o,l]=this.#a[a];if(o!==t)break;if(o===t&&l===e){this.#a.splice(a,1);return}}}#l(t){const[e,s,a]=t,o=[[e,s,a]],l=this.#s(a);for(let u=0;u<l;u++){const[d,f]=this.#a[u];for(let m=0,y=o.length;m<y;m++){const[,b,v]=o[m];if(!(f<=b||v<=d)){if(b>=d){if(v>f)o[m][1]=f;else{if(y===1)return[];o.splice(m,1),m--,y--}continue}o[m][2]=d,v>f&&o.push([e,f,v])}}}return o}}class $x extends st{#t;#e;constructor(t,e,s,a){super(),this.#e=t,this.#t=e,this.firstPoint=s,this.lastPoint=a}toSVGPath(){const t=[];for(const e of this.#e){let[s,a]=e;t.push(`M${s} ${a}`);for(let o=2;o<e.length;o+=2){const l=e[o],u=e[o+1];l===s?(t.push(`V${u}`),a=u):u===a&&(t.push(`H${l}`),s=l)}t.push("Z")}return t.join(" ")}serialize([t,e,s,a],o){const l=[],u=s-t,d=a-e;for(const f of this.#e){const m=new Array(f.length);for(let y=0;y<f.length;y+=2)m[y]=t+f[y]*u,m[y+1]=a-f[y+1]*d;l.push(m)}return l}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class jh extends as{newFreeDrawOutline(t,e,s,a,o,l){return new Kx(t,e,s,a,o,l)}}class Kx extends Dy{newOutliner(t,e,s,a,o,l=0){return new jh(t,e,s,a,o,l)}}class ce extends ct{#t=null;#e=0;#i;#n=null;#a=null;#r=null;#s=null;#o=0;#c=null;#l=null;#d=null;#h=!1;#f=null;#g=null;#m=null;#u="";#p;#y="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=At.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=ce.prototype;return bt(this,"_keyboardManager",new Lr([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||ce._defaultColor,this.#p=t.thickness||ce._defaultThickness,this.opacity=t.opacity||ce._defaultOpacity,this.#i=t.boxes||null,this.#y=t.methodOfCreation||"",this.#u=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#h=!0,this.#b(t),this.#A()):this.#i&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#s=t.focusNode,this.#o=t.focusOffset,this.#v(),this.#A(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#p,methodOfCreation:this.#y}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#v(){const t=new Ph(this.#i,.001);this.#l=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const e=new Ph(this.#i,.0025,.001,this._uiManager.direction==="ltr");this.#r=e.getOutlines();const{firstPoint:s}=this.#l;this.#f=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height];const{lastPoint:a}=this.#r;this.#g=[(a[0]-this.x)/this.width,(a[1]-this.y)/this.height]}#b({highlightOutlines:t,highlightId:e,clipPathId:s}){this.#l=t;const a=1.5;if(this.#r=t.getNewOutline(this.#p/2+a,.0025),e>=0)this.#d=e,this.#n=s,this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#m=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},!0);else if(this.parent){const y=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:ce.#E(this.#l.box,(y-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#m,{bbox:ce.#E(this.#r.box,y),path:{d:this.#r.toSVGPath()}})}const[o,l,u,d]=t.box;switch(this.rotation){case 0:this.x=o,this.y=l,this.width=u,this.height=d;break;case 90:{const[y,b]=this.parentDimensions;this.x=l,this.y=1-o,this.width=u*b/y,this.height=d*y/b;break}case 180:this.x=1-o,this.y=1-l,this.width=u,this.height=d;break;case 270:{const[y,b]=this.parentDimensions;this.x=1-l,this.y=o,this.width=u*b/y,this.height=d*y/b;break}}const{firstPoint:f}=t;this.#f=[(f[0]-o)/u,(f[1]-l)/d];const{lastPoint:m}=this.#r;this.#g=[(m[0]-o)/u,(m[1]-l)/d]}static initialize(t,e){ct.initialize(t,e),ce._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case Nt.HIGHLIGHT_COLOR:ce._defaultColor=e;break;case Nt.HIGHLIGHT_THICKNESS:ce._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#g}get commentButtonPosition(){return this.#f}updateParams(t,e){switch(t){case Nt.HIGHLIGHT_COLOR:this.#T(e);break;case Nt.HIGHLIGHT_THICKNESS:this.#x(e);break}}static get defaultPropertiesToUpdate(){return[[Nt.HIGHLIGHT_COLOR,ce._defaultColor],[Nt.HIGHLIGHT_THICKNESS,ce._defaultThickness]]}get propertiesToUpdate(){return[[Nt.HIGHLIGHT_COLOR,this.color||ce._defaultColor],[Nt.HIGHLIGHT_THICKNESS,this.#p||ce._defaultThickness],[Nt.HIGHLIGHT_FREE,this.#h]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#a?.updateColor(this.color),super.onUpdatedColor()}#T(t){const e=(o,l)=>{this.color=o,this.opacity=l,this.onUpdatedColor()},s=this.color,a=this.opacity;this.addCommands({cmd:e.bind(this,t,ce._defaultOpacity),undo:e.bind(this,s,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Nt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#x(t){const e=this.#p,s=a=>{this.#p=a,this.#S(a)};this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Nt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#a=new Sn({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#D())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#D())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#C(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#A(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#C():t&&(this.#A(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#S(t){this.#h&&(this.#b({highlightOutlines:this.#l.getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims())}#C(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#m),this.#m=null)}#A(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#n}=t.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#h},path:{d:this.#l.toSVGPath()}},!1,!0),this.#m=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#h},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},this.#h),this.#c&&(this.#c.style.clipPath=this.#n))}static#E([t,e,s,a],o){switch(o){case 90:return[1-e-a,t,a,s];case 180:return[1-t-s,1-e-a,s,a];case 270:return[e,1-t-s,a,s]}return[t,e,s,a]}rotate(t){const{drawLayer:e}=this.parent;let s;this.#h?(t=(t-this.rotation+360)%360,s=ce.#E(this.#l.box,t)):s=ce.#E([this.x,this.y,this.width,this.height],t),e.updateProperties(this.#d,{bbox:s,root:{"data-main-rotation":t}}),e.updateProperties(this.#m,{bbox:ce.#E(this.#r.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#u&&(t.setAttribute("aria-label",this.#u),t.setAttribute("role","mark")),this.#h?t.classList.add("free"):this.div.addEventListener("keydown",this.#N.bind(this),{signal:this._uiManager._signal});const e=this.#c=document.createElement("div");return t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#n,this.setDims(),ey(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!1}})}#N(t){ce._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#M(!0);break;case 1:case 3:this.#M(!1);break}}#M(t){if(!this.#t)return;const e=window.getSelection();t?e.setPosition(this.#t,this.#e):e.setPosition(this.#s,this.#o)}select(){super.select(),this.#m&&this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#m&&(this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{selected:!1}}),this.#h||this.#M(!1))}get _mustFixPosition(){return!this.#h}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#m,{rootClass:{hidden:!t}}))}#D(){return this.#h?this.rotation:0}#j(){if(this.#h)return null;const[t,e]=this.pageDimensions,[s,a]=this.pageTranslation,o=this.#i,l=new Float32Array(o.length*8);let u=0;for(const{x:d,y:f,width:m,height:y}of o){const b=d*t+s,v=(1-f)*e+a;l[u]=l[u+4]=b,l[u+1]=l[u+3]=v,l[u+2]=l[u+6]=b+m*t,l[u+5]=l[u+7]=v-y*e,u+=8}return l}#k(t){return this.#l.serialize(t,this.#D())}static startHighlighting(t,e,{target:s,x:a,y:o}){const{x:l,y:u,width:d,height:f}=s.getBoundingClientRect(),m=new AbortController,y=t.combinedSignal(m),b=v=>{m.abort(),this.#F(t,v)};window.addEventListener("blur",b,{signal:y}),window.addEventListener("pointerup",b,{signal:y}),window.addEventListener("pointerdown",ae,{capture:!0,passive:!1,signal:y}),window.addEventListener("contextmenu",wn,{signal:y}),s.addEventListener("pointermove",this.#L.bind(this,t),{signal:y}),this._freeHighlight=new jh({x:a,y:o},[l,u,d,f],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#L(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#F(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,s){let a=null;if(t instanceof Cy){const{data:{quadPoints:S,rect:w,rotation:x,id:E,color:M,opacity:C,popupRef:R,richText:k,contentsObj:L,creationDate:P,modificationDate:$},parent:{page:{pageNumber:K}}}=t;a=t={annotationType:At.HIGHLIGHT,color:Array.from(M),opacity:C,quadPoints:S,boxes:null,pageIndex:K-1,rect:w.slice(0),rotation:x,annotationElementId:E,id:E,deleted:!1,popupRef:R,richText:k,comment:L?.str||null,creationDate:P,modificationDate:$}}else if(t instanceof sd){const{data:{inkLists:S,rect:w,rotation:x,id:E,color:M,borderStyle:{rawWidth:C},popupRef:R,richText:k,contentsObj:L,creationDate:P,modificationDate:$},parent:{page:{pageNumber:K}}}=t;a=t={annotationType:At.HIGHLIGHT,color:Array.from(M),thickness:C,inkLists:S,boxes:null,pageIndex:K-1,rect:w.slice(0),rotation:x,annotationElementId:E,id:E,deleted:!1,popupRef:R,richText:k,comment:L?.str||null,creationDate:P,modificationDate:$}}const{color:o,quadPoints:l,inkLists:u,opacity:d}=t,f=await super.deserialize(t,e,s);f.color=nt.makeHexColor(...o),f.opacity=d||1,u&&(f.#p=t.thickness),f._initialData=a,t.comment&&f.setCommentData(t);const[m,y]=f.pageDimensions,[b,v]=f.pageTranslation;if(l){const S=f.#i=[];for(let w=0;w<l.length;w+=8)S.push({x:(l[w]-b)/m,y:1-(l[w+1]-v)/y,width:(l[w+2]-l[w])/m,height:(l[w+1]-l[w+5])/y});f.#v(),f.#A(),f.rotate(f.rotation)}else if(u){f.#h=!0;const S=u[0],w={x:S[0]-b,y:y-(S[1]-v)},x=new jh(w,[0,0,m,y],1,f.#p/2,!0,.001);for(let C=0,R=S.length;C<R;C+=2)w.x=S[C]-b,w.y=y-(S[C+1]-v),x.add(w);const{id:E,clipPathId:M}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:x.toSVGPath()}},!0,!0);f.#b({highlightOutlines:x.getOutlines(),highlightId:E,clipPathId:M}),f.#A(),f.rotate(f.parentRotation)}return f}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=ct._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),s=super.serialize(t);return Object.assign(s,{color:e,opacity:this.opacity,thickness:this.#p,quadPoints:this.#j(),outlines:this.#k(s.rect)}),this.addComment(s),this.annotationElementId&&!this.#B(s)?null:(s.id=this.annotationElementId,s)}#B(t){const{color:e}=this._initialData;return this.hasEditedComment||t.color.some((s,a)=>s!==e[a])}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class Ny{#t=Object.create(null);updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,s]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,s)}updateSVGProperty(t,e){this.#t[t]=e}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){zt("Not implemented")}}class Bt extends ct{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#i=null;static#n=null;static#a=null;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(this.#r(t),this.#c())}#r({drawOutlines:t,drawId:e,drawingOptions:s}){this.#t=t,this._drawingOptions||=s,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=this.#s(t,this.parent),this.#h(t.box)}#s(t,e){const{id:s}=e.drawLayer.draw(Bt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return s}static _mergeSVGProperties(t,e){const s=new Set(Object.keys(t));for(const[a,o]of Object.entries(e))s.has(a)?Object.assign(t[a],o):t[a]=o;return t}static getDefaultDrawingOptions(t){zt("Not implemented")}static get typesMap(){zt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const s=this.typesMap.get(t);s&&this._defaultDrawingOptions.updateProperty(s,e),this._currentParent&&(Bt.#i.updateProperty(s,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const s=this.constructor.typesMap.get(t);s&&this._updateProperty(t,s,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[s,a]of this.typesMap)t.push([s,e[a]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[s,a]of this.constructor.typesMap)t.push([s,e[a]]);return t}_updateProperty(t,e,s){const a=this._drawingOptions,o=a[e],l=u=>{a.updateProperty(e,u);const d=this.#t.updateProperty(e,u);d&&this.#h(d),this.parent?.drawLayer.updateProperties(this._drawId,a.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:l.bind(this,s),undo:l.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,Bt._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#d()),{bbox:this.#f()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,Bt._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#d()),{bbox:this.#f()}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#f()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,Bt._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#d(),this.parentDimensions),{bbox:this.#f()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#o(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#c(),this.#h(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#o()):t&&(this._uiManager.addShouldRescale(this),this.#c(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}#o(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#c(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#s(this.#t,t)}}#l([t,e,s,a]){const{parentDimensions:[o,l],rotation:u}=this;switch(u){case 90:return[e,1-t,s*(l/o),a*(o/l)];case 180:return[1-t,1-e,s,a];case 270:return[1-e,t,s*(l/o),a*(o/l)];default:return[t,e,s,a]}}#d(){const{x:t,y:e,width:s,height:a,parentDimensions:[o,l],rotation:u}=this;switch(u){case 90:return[1-e,t,s*(o/l),a*(l/o)];case 180:return[1-t,1-e,s,a];case 270:return[e,1-t,s*(o/l),a*(l/o)];default:return[t,e,s,a]}}#h(t){[this.x,this.y,this.width,this.height]=this.#l(t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#f(){const{x:t,y:e,width:s,height:a,rotation:o,parentRotation:l,parentDimensions:[u,d]}=this;switch((o*4+l)/90){case 1:return[1-e-a,t,a,s];case 2:return[1-t-s,1-e-a,s,a];case 3:return[e,1-t-s,a,s];case 4:return[t,e-s*(u/d),a*(d/u),s*(u/d)];case 5:return[1-e,t,s*(u/d),a*(d/u)];case 6:return[1-t-a*(d/u),1-e,a*(d/u),s*(u/d)];case 7:return[e-s*(u/d),1-t-a*(d/u),s*(u/d),a*(d/u)];case 8:return[t-s,e-a,s,a];case 9:return[1-e,t-s,a,s];case 10:return[1-t,1-e,s,a];case 11:return[e-a,1-t,a,s];case 12:return[t-a*(d/u),e,a*(d/u),s*(u/d)];case 13:return[1-e-s*(u/d),t-a*(d/u),s*(u/d),a*(d/u)];case 14:return[1-t,1-e-s*(u/d),a*(d/u),s*(u/d)];case 15:return[e,1-t,s*(u/d),a*(d/u)];default:return[t,e,s,a]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Bt._mergeSVGProperties({bbox:this.#f()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,e;this._isCopy&&(t=this.x,e=this.y);const s=super.render();s.classList.add("draw");const a=document.createElement("div");return s.append(a),a.setAttribute("aria-hidden","true"),a.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,e),s}static createDrawerInstance(t,e,s,a,o){zt("Not implemented")}static startDrawing(t,e,s,a){const{target:o,offsetX:l,offsetY:u,pointerId:d,pointerType:f}=a;if(jt.isInitializedAndDifferentPointerType(f))return;const{viewport:{rotation:m}}=t,{width:y,height:b}=o.getBoundingClientRect(),v=Bt.#n=new AbortController,S=t.combinedSignal(v);if(jt.setPointer(f,d),window.addEventListener("pointerup",w=>{jt.isSamePointerIdOrRemove(w.pointerId)&&this._endDraw(w)},{signal:S}),window.addEventListener("pointercancel",w=>{jt.isSamePointerIdOrRemove(w.pointerId)&&this._currentParent.endDrawingSession()},{signal:S}),window.addEventListener("pointerdown",w=>{jt.isSamePointerType(w.pointerType)&&(jt.initializeAndAddPointerId(w.pointerId),Bt.#i.isCancellable()&&(Bt.#i.removeLastElement(),Bt.#i.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:S}),window.addEventListener("contextmenu",wn,{signal:S}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:S}),o.addEventListener("touchmove",w=>{jt.isSameTimeStamp(w.timeStamp)&&ae(w)},{signal:S}),t.toggleDrawing(),e._editorUndoBar?.hide(),Bt.#i){t.drawLayer.updateProperties(this._currentDrawId,Bt.#i.startNew(l,u,y,b,m));return}e.updateUIForDefaultProperties(this),Bt.#i=this.createDrawerInstance(l,u,y,b,m),Bt.#a=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(Bt.#a.toSVGProperties(),Bt.#i.defaultSVGProperties),!0,!1)}static _drawMove(t){if(jt.isSameTimeStamp(t.timeStamp),!Bt.#i)return;const{offsetX:e,offsetY:s,pointerId:a}=t;if(jt.isSamePointerId(a)){if(jt.isUsingMultiplePointers()){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,Bt.#i.add(e,s)),jt.setTimeStamp(t.timeStamp),ae(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,Bt.#i=null,Bt.#a=null,jt.clearTimeStamp()),Bt.#n&&(Bt.#n.abort(),Bt.#n=null,jt.clearPointerIds())}static _endDraw(t){const e=this._currentParent;if(e){if(e.toggleDrawing(!0),this._cleanup(!1),t?.target===e.div&&e.drawLayer.updateProperties(this._currentDrawId,Bt.#i.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const s=Bt.#i,a=this._currentDrawId,o=s.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(a,s.setLastElement(o))},undo:()=>{e.drawLayer.updateProperties(a,s.removeLastElement())},mustExec:!1,type:Nt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(Nt.DRAW_STEP),!Bt.#i.isEmpty()){const{pageDimensions:[s,a],scale:o}=e,l=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:Bt.#i.getOutlines(s*o,a*o,o,this._INNER_MARGIN),drawingOptions:Bt.#a,mustBeCommitted:!t});return this._cleanup(!0),l}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,s,a,o,l){zt("Not implemented")}static async deserialize(t,e,s){const{rawDims:{pageWidth:a,pageHeight:o,pageX:l,pageY:u}}=e.viewport,d=this.deserializeDraw(l,u,a,o,this._INNER_MARGIN,t),f=await super.deserialize(t,e,s);return f.createDrawingOptions(t),f.#r({drawOutlines:d}),f.#c(),f.onScaleChanging(),f.rotate(),f}serializeDraw(t){const[e,s]=this.pageTranslation,[a,o]=this.pageDimensions;return this.#t.serialize([e,s,a,o],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class Qx{#t=new Float64Array(6);#e;#i;#n;#a;#r;#s="";#o=0;#c=new Br;#l;#d;constructor(t,e,s,a,o,l){this.#l=s,this.#d=a,this.#n=o,this.#a=l,[t,e]=this.#h(t,e);const u=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#r=[t,e],this.#i=[{line:u,points:this.#r}],this.#t.set(u,0)}updateProperty(t,e){t==="stroke-width"&&(this.#a=e)}#h(t,e){return st._normalizePoint(t,e,this.#l,this.#d,this.#n)}isEmpty(){return!this.#i||this.#i.length===0}isCancellable(){return this.#r.length<=10}add(t,e){[t,e]=this.#h(t,e);const[s,a,o,l]=this.#t.subarray(2,6),u=t-o,d=e-l;return Math.hypot(this.#l*u,this.#d*d)<=2?null:(this.#r.push(t,e),isNaN(s)?(this.#t.set([o,l,t,e],2),this.#e.push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([s,a,o,l,t,e],0),this.#e.push(...st.createBezierPoints(s,a,o,l,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const s=this.add(t,e);return s||(this.#r.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,s,a,o){this.#l=s,this.#d=a,this.#n=o,[t,e]=this.#h(t,e);const l=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#r=[t,e];const u=this.#i.at(-1);return u&&(u.line=new Float32Array(u.line),u.points=new Float32Array(u.points)),this.#i.push({line:l,points:this.#r}),this.#t.set(l,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#i.at(-1)}setLastElement(t){return this.#i?(this.#i.push(t),this.#e=t.line,this.#r=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(t)}removeLastElement(){if(!this.#i)return this.#c.removeLastElement();this.#i.pop(),this.#s="";for(let t=0,e=this.#i.length;t<e;t++){const{line:s,points:a}=this.#i[t];this.#e=s,this.#r=a,this.#o=0,this.toSVGPath()}return{path:{d:this.#s}}}toSVGPath(){const t=st.svgRound(this.#e[4]),e=st.svgRound(this.#e[5]);if(this.#r.length===2)return this.#s=`${this.#s} M ${t} ${e} Z`,this.#s;if(this.#r.length<=6){const a=this.#s.lastIndexOf("M");this.#s=`${this.#s.slice(0,a)} M ${t} ${e}`,this.#o=6}if(this.#r.length===4){const a=st.svgRound(this.#e[10]),o=st.svgRound(this.#e[11]);return this.#s=`${this.#s} L ${a} ${o}`,this.#o=12,this.#s}const s=[];this.#o===0&&(s.push(`M ${t} ${e}`),this.#o=6);for(let a=this.#o,o=this.#e.length;a<o;a+=6){const[l,u,d,f,m,y]=this.#e.slice(a,a+6).map(st.svgRound);s.push(`C${l} ${u} ${d} ${f} ${m} ${y}`)}return this.#s+=s.join(" "),this.#o=this.#e.length,this.#s}getOutlines(t,e,s,a){const o=this.#i.at(-1);return o.line=new Float32Array(o.line),o.points=new Float32Array(o.points),this.#c.build(this.#i,t,e,s,this.#n,this.#a,a),this.#t=null,this.#e=null,this.#i=null,this.#s=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class Br extends st{#t;#e=0;#i;#n;#a;#r;#s;#o;#c;build(t,e,s,a,o,l,u){this.#a=e,this.#r=s,this.#s=a,this.#o=o,this.#c=l,this.#i=u??0,this.#n=t,this.#h()}get thickness(){return this.#c}setLastElement(t){return this.#n.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#n.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of this.#n){if(t.push(`M${st.svgRound(e[4])} ${st.svgRound(e[5])}`),e.length===6){t.push("Z");continue}if(e.length===12&&isNaN(e[6])){t.push(`L${st.svgRound(e[10])} ${st.svgRound(e[11])}`);continue}for(let s=6,a=e.length;s<a;s+=6){const[o,l,u,d,f,m]=e.subarray(s,s+6).map(st.svgRound);t.push(`C${o} ${l} ${u} ${d} ${f} ${m}`)}}return t.join("")}serialize([t,e,s,a],o){const l=[],u=[],[d,f,m,y]=this.#d();let b,v,S,w,x,E,M,C,R;switch(this.#o){case 0:R=st._rescale,b=t,v=e+a,S=s,w=-a,x=t+d*s,E=e+(1-f-y)*a,M=t+(d+m)*s,C=e+(1-f)*a;break;case 90:R=st._rescaleAndSwap,b=t,v=e,S=s,w=a,x=t+f*s,E=e+d*a,M=t+(f+y)*s,C=e+(d+m)*a;break;case 180:R=st._rescale,b=t+s,v=e,S=-s,w=a,x=t+(1-d-m)*s,E=e+f*a,M=t+(1-d)*s,C=e+(f+y)*a;break;case 270:R=st._rescaleAndSwap,b=t+s,v=e+a,S=-s,w=-a,x=t+(1-f-y)*s,E=e+(1-d-m)*a,M=t+(1-f)*s,C=e+(1-d)*a;break}for(const{line:k,points:L}of this.#n)l.push(R(k,b,v,S,w,o?new Array(k.length):null)),u.push(R(L,b,v,S,w,o?new Array(L.length):null));return{lines:l,points:u,rect:[x,E,M,C]}}static deserialize(t,e,s,a,o,{paths:{lines:l,points:u},rotation:d,thickness:f}){const m=[];let y,b,v,S,w;switch(d){case 0:w=st._rescale,y=-t/s,b=e/a+1,v=1/s,S=-1/a;break;case 90:w=st._rescaleAndSwap,y=-e/a,b=-t/s,v=1/a,S=1/s;break;case 180:w=st._rescale,y=t/s+1,b=-e/a,v=-1/s,S=1/a;break;case 270:w=st._rescaleAndSwap,y=e/a+1,b=t/s+1,v=-1/a,S=-1/s;break}if(!l){l=[];for(const E of u){const M=E.length;if(M===2){l.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1]]));continue}if(M===4){l.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1],NaN,NaN,NaN,NaN,E[2],E[3]]));continue}const C=new Float32Array(3*(M-2));l.push(C);let[R,k,L,P]=E.subarray(0,4);C.set([NaN,NaN,NaN,NaN,R,k],0);for(let $=4;$<M;$+=2){const K=E[$],J=E[$+1];C.set(st.createBezierPoints(R,k,L,P,K,J),($-2)*3),[R,k,L,P]=[L,P,K,J]}}}for(let E=0,M=l.length;E<M;E++)m.push({line:w(l[E].map(C=>C??NaN),y,b,v,S),points:w(u[E].map(C=>C??NaN),y,b,v,S)});const x=new this.prototype.constructor;return x.build(m,s,a,1,d,f,o),x}#l(t=this.#c){const e=this.#i+t/2*this.#s;return this.#o%180===0?[e/this.#a,e/this.#r]:[e/this.#r,e/this.#a]}#d(){const[t,e,s,a]=this.#t,[o,l]=this.#l(0);return[t+o,e+l,s-2*o,a-2*l]}#h(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:a}of this.#n){if(a.length<=12){for(let u=4,d=a.length;u<d;u+=6)nt.pointBoundingBox(a[u],a[u+1],t);continue}let o=a[4],l=a[5];for(let u=6,d=a.length;u<d;u+=6){const[f,m,y,b,v,S]=a.subarray(u,u+6);nt.bezierBoundingBox(o,l,f,m,y,b,v,S,t),o=v,l=S}}const[e,s]=this.#l();t[0]=De(t[0]-e,0,1),t[1]=De(t[1]-s,0,1),t[2]=De(t[2]+e,0,1),t[3]=De(t[3]+s,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,e){return t==="stroke-width"?this.#f(e):null}#f(t){const[e,s]=this.#l();this.#c=t;const[a,o]=this.#l(),[l,u]=[a-e,o-s],d=this.#t;return d[0]-=l,d[1]-=u,d[2]+=2*l,d[3]+=2*u,d}updateParentDimensions([t,e],s){const[a,o]=this.#l();this.#a=t,this.#r=e,this.#s=s;const[l,u]=this.#l(),d=l-a,f=u-o,m=this.#t;return m[0]-=d,m[1]-=f,m[2]+=2*d,m[3]+=2*f,m}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(st.svgRound).join(" ")}get defaultProperties(){const[t,e]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${st.svgRound(t)} ${st.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=this.#t;let s=0,a=0,o=0,l=0,u=0,d=0;switch(this.#e){case 90:a=e/t,o=-t/e,u=t;break;case 180:s=-1,l=-1,u=t,d=e;break;case 270:a=-e/t,o=t/e,d=e;break;default:return""}return`matrix(${s} ${a} ${o} ${l} ${st.svgRound(u)} ${st.svgRound(d)})`}getPathResizingSVGProperties([t,e,s,a]){const[o,l]=this.#l(),[u,d,f,m]=this.#t;if(Math.abs(f-o)<=st.PRECISION||Math.abs(m-l)<=st.PRECISION){const w=t+s/2-(u+f/2),x=e+a/2-(d+m/2);return{path:{"transform-origin":`${st.svgRound(t)} ${st.svgRound(e)}`,transform:`${this.rotationTransform} translate(${w} ${x})`}}}const y=(s-2*o)/(f-2*o),b=(a-2*l)/(m-2*l),v=f/s,S=m/a;return{path:{"transform-origin":`${st.svgRound(u)} ${st.svgRound(d)}`,transform:`${this.rotationTransform} scale(${v} ${S}) translate(${st.svgRound(o)} ${st.svgRound(l)}) scale(${y} ${b}) translate(${st.svgRound(-o)} ${st.svgRound(-l)})`}}}getPathResizedSVGProperties([t,e,s,a]){const[o,l]=this.#l(),u=this.#t,[d,f,m,y]=u;if(u[0]=t,u[1]=e,u[2]=s,u[3]=a,Math.abs(m-o)<=st.PRECISION||Math.abs(y-l)<=st.PRECISION){const x=t+s/2-(d+m/2),E=e+a/2-(f+y/2);for(const{line:M,points:C}of this.#n)st._translate(M,x,E,M),st._translate(C,x,E,C);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${st.svgRound(t)} ${st.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const b=(s-2*o)/(m-2*o),v=(a-2*l)/(y-2*l),S=-b*(d+o)+t+o,w=-v*(f+l)+e+l;if(b!==1||v!==1||S!==0||w!==0)for(const{line:x,points:E}of this.#n)st._rescale(x,S,w,b,v,x),st._rescale(E,S,w,b,v,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${st.svgRound(t)} ${st.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],s){const[a,o]=s,l=this.#t,u=t-l[0],d=e-l[1];if(this.#a===a&&this.#r===o)for(const{line:f,points:m}of this.#n)st._translate(f,u,d,f),st._translate(m,u,d,m);else{const f=this.#a/a,m=this.#r/o;this.#a=a,this.#r=o;for(const{line:y,points:b}of this.#n)st._rescale(y,u,d,f,m,y),st._rescale(b,u,d,f,m,b);l[2]*=f,l[3]*=m}return l[0]=t,l[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${st.svgRound(t)} ${st.svgRound(e)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${st.svgRound(t[0])} ${st.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class Fl extends Ny{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:ct._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??=this["stroke-width"],e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new Fl(this._viewParameters);return t.updateAll(this),t}}class rd extends Bt{static _type="ink";static _editorType=At.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,e){ct.initialize(t,e),this._defaultDrawingOptions=new Fl(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return bt(this,"typesMap",new Map([[Nt.INK_THICKNESS,"stroke-width"],[Nt.INK_COLOR,"stroke"],[Nt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,s,a,o){return new Qx(t,e,s,a,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,s,a,o,l){return Br.deserialize(t,e,s,a,o,l)}static async deserialize(t,e,s){let a=null;if(t instanceof sd){const{data:{inkLists:l,rect:u,rotation:d,id:f,color:m,opacity:y,borderStyle:{rawWidth:b},popupRef:v,richText:S,contentsObj:w,creationDate:x,modificationDate:E},parent:{page:{pageNumber:M}}}=t;a=t={annotationType:At.INK,color:Array.from(m),thickness:b,opacity:y,paths:{points:l},boxes:null,pageIndex:M-1,rect:u.slice(0),rotation:d,annotationElementId:f,id:f,deleted:!1,popupRef:v,richText:S,comment:w?.str||null,creationDate:x,modificationDate:E}}const o=await super.deserialize(t,e,s);return o._initialData=a,t.comment&&o.setCommentData(t),o}get toolbarButtons(){return this._colorPicker||=new Er(this),[["colorPicker",this._colorPicker]]}get colorType(){return Nt.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:s}=this;e.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:e,opacity:s}){this._drawingOptions=rd.getDefaultDrawingOptions({stroke:nt.makeHexColor(...t),"stroke-width":e,"stroke-opacity":s})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:s}=this.serializeDraw(t),{_drawingOptions:{stroke:a,"stroke-opacity":o,"stroke-width":l}}=this,u=Object.assign(super.serialize(t),{color:ct._colorManager.convert(a),opacity:o,thickness:l,paths:{lines:e,points:s}});return this.addComment(u),t?(u.isCopy=!0,u):this.annotationElementId&&!this.#t(u)?null:(u.id=this.annotationElementId,u)}#t(t){const{color:e,thickness:s,opacity:a,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((l,u)=>l!==e[u])||t.thickness!==s||t.opacity!==a||t.pageIndex!==o}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:e,rect:s}=this.serializeDraw(!1);return t.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:e,popup:this.comment}),null}}class Fh extends Br{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const cl=8,pr=3;class na{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,e,s,a){return s-=t,a-=e,s===0?a>0?0:4:s===1?a+6:2-a}static#i=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#n(t,e,s,a,o,l,u){const d=this.#e(s,a,o,l);for(let f=0;f<8;f++){const m=(-f+d-u+16)%8,y=this.#i[2*m],b=this.#i[2*m+1];if(t[(s+y)*e+(a+b)]!==0)return m}return-1}static#a(t,e,s,a,o,l,u){const d=this.#e(s,a,o,l);for(let f=0;f<8;f++){const m=(f+d+u+16)%8,y=this.#i[2*m],b=this.#i[2*m+1];if(t[(s+y)*e+(a+b)]!==0)return m}return-1}static#r(t,e,s,a){const o=t.length,l=new Int32Array(o);for(let m=0;m<o;m++)l[m]=t[m]<=a?1:0;for(let m=1;m<s-1;m++)l[m*e]=l[m*e+e-1]=0;for(let m=0;m<e;m++)l[m]=l[e*s-1-m]=0;let u=1,d;const f=[];for(let m=1;m<s-1;m++){d=1;for(let y=1;y<e-1;y++){const b=m*e+y,v=l[b];if(v===0)continue;let S=m,w=y;if(v===1&&l[b-1]===0)u+=1,w-=1;else if(v>=1&&l[b+1]===0)u+=1,w+=1,v>1&&(d=v);else{v!==1&&(d=Math.abs(v));continue}const x=[y,m],E=w===y+1,M={isHole:E,points:x,id:u,parent:0};f.push(M);let C;for(const Z of f)if(Z.id===d){C=Z;break}C?C.isHole?M.parent=E?C.parent:d:M.parent=E?d:C.parent:M.parent=E?d:0;const R=this.#n(l,e,m,y,S,w,0);if(R===-1){l[b]=-u,l[b]!==1&&(d=Math.abs(l[b]));continue}let k=this.#i[2*R],L=this.#i[2*R+1];const P=m+k,$=y+L;S=P,w=$;let K=m,J=y;for(;;){const Z=this.#a(l,e,K,J,S,w,1);k=this.#i[2*Z],L=this.#i[2*Z+1];const ht=K+k,St=J+L;x.push(St,ht);const ot=K*e+J;if(l[ot+1]===0?l[ot]=-u:l[ot]===1&&(l[ot]=u),ht===m&&St===y&&K===P&&J===$){l[b]!==1&&(d=Math.abs(l[b]));break}else S=K,w=J,K=ht,J=St}}}return f}static#s(t,e,s,a){if(s-e<=4){for(let P=e;P<s-2;P+=2)a.push(t[P],t[P+1]);return}const o=t[e],l=t[e+1],u=t[s-4]-o,d=t[s-3]-l,f=Math.hypot(u,d),m=u/f,y=d/f,b=m*l-y*o,v=d/u,S=1/f,w=Math.atan(v),x=Math.cos(w),E=Math.sin(w),M=S*(Math.abs(x)+Math.abs(E)),C=S*(1-M+M**2),R=Math.max(Math.atan(Math.abs(E+x)*C),Math.atan(Math.abs(E-x)*C));let k=0,L=e;for(let P=e+2;P<s-2;P+=2){const $=Math.abs(b-m*t[P+1]+y*t[P]);$>k&&(L=P,k=$)}k>(f*R)**2?(this.#s(t,e,L+2,a),this.#s(t,L,s,a)):a.push(o,l)}static#o(t){const e=[],s=t.length;return this.#s(t,0,s,e),e.push(t[s-2],t[s-1]),e.length<=4?null:e}static#c(t,e,s,a,o,l){const u=new Float32Array(l**2),d=-2*a**2,f=l>>1;for(let w=0;w<l;w++){const x=(w-f)**2;for(let E=0;E<l;E++)u[w*l+E]=Math.exp((x+(E-f)**2)/d)}const m=new Float32Array(256),y=-2*o**2;for(let w=0;w<256;w++)m[w]=Math.exp(w**2/y);const b=t.length,v=new Uint8Array(b),S=new Uint32Array(256);for(let w=0;w<s;w++)for(let x=0;x<e;x++){const E=w*e+x,M=t[E];let C=0,R=0;for(let L=0;L<l;L++){const P=w+L-f;if(!(P<0||P>=s))for(let $=0;$<l;$++){const K=x+$-f;if(K<0||K>=e)continue;const J=t[P*e+K],Z=u[L*l+$]*m[Math.abs(J-M)];C+=J*Z,R+=Z}}const k=v[E]=Math.round(C/R);S[k]++}return[v,S]}static#l(t){const e=new Uint32Array(256);for(const s of t)e[s]++;return e}static#d(t){const e=t.length,s=new Uint8ClampedArray(e>>2);let a=-1/0,o=1/0;for(let u=0,d=s.length;u<d;u++){const f=s[u]=t[u<<2];a=Math.max(a,f),o=Math.min(o,f)}const l=255/(a-o);for(let u=0,d=s.length;u<d;u++)s[u]=(s[u]-o)*l;return s}static#h(t){let e,s=-1/0,a=-1/0;const o=t.findIndex(d=>d!==0);let l=o,u=o;for(e=o;e<256;e++){const d=t[e];d>s&&(e-l>a&&(a=e-l,u=e-1),s=d,l=e)}for(e=u-1;e>=0&&!(t[e]>t[e+1]);e--);return e}static#f(t){const e=t,{width:s,height:a}=t,{maxDim:o}=this.#t;let l=s,u=a;if(s>o||a>o){let b=s,v=a,S=Math.log2(Math.max(s,a)/o);const w=Math.floor(S);S=S===w?w-1:w;for(let E=0;E<S;E++){l=Math.ceil(b/2),u=Math.ceil(v/2);const M=new OffscreenCanvas(l,u);M.getContext("2d").drawImage(t,0,0,b,v,0,0,l,u),b=l,v=u,t!==e&&t.close(),t=M.transferToImageBitmap()}const x=Math.min(o/l,o/u);l=Math.round(l*x),u=Math.round(u*x)}const f=new OffscreenCanvas(l,u).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,l,u),f.filter="grayscale(1)",f.drawImage(t,0,0,t.width,t.height,0,0,l,u);const m=f.getImageData(0,0,l,u).data;return[this.#d(m),l,u]}static extractContoursFromText(t,{fontFamily:e,fontStyle:s,fontWeight:a},o,l,u,d){let f=new OffscreenCanvas(1,1),m=f.getContext("2d",{alpha:!1});const y=200,b=m.font=`${s} ${a} ${y}px ${e}`,{actualBoundingBoxLeft:v,actualBoundingBoxRight:S,actualBoundingBoxAscent:w,actualBoundingBoxDescent:x,fontBoundingBoxAscent:E,fontBoundingBoxDescent:M,width:C}=m.measureText(t),R=1.5,k=Math.ceil(Math.max(Math.abs(v)+Math.abs(S)||0,C)*R),L=Math.ceil(Math.max(Math.abs(w)+Math.abs(x)||y,Math.abs(E)+Math.abs(M)||y)*R);f=new OffscreenCanvas(k,L),m=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),m.font=b,m.filter="grayscale(1)",m.fillStyle="white",m.fillRect(0,0,k,L),m.fillStyle="black",m.fillText(t,k*(R-1)/2,L*(3-R)/2);const P=this.#d(m.getImageData(0,0,k,L).data),$=this.#l(P),K=this.#h($),J=this.#r(P,k,L,K);return this.processDrawnLines({lines:{curves:J,width:k,height:L},pageWidth:o,pageHeight:l,rotation:u,innerMargin:d,mustSmooth:!0,areContours:!0})}static process(t,e,s,a,o){const[l,u,d]=this.#f(t),[f,m]=this.#c(l,u,d,Math.hypot(u,d)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),y=this.#h(m),b=this.#r(f,u,d,y);return this.processDrawnLines({lines:{curves:b,width:u,height:d},pageWidth:e,pageHeight:s,rotation:a,innerMargin:o,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:s,rotation:a,innerMargin:o,mustSmooth:l,areContours:u}){a%180!==0&&([e,s]=[s,e]);const{curves:d,width:f,height:m}=t,y=t.thickness??0,b=[],v=Math.min(e/f,s/m),S=v/e,w=v/s,x=[];for(const{points:M}of d){const C=l?this.#o(M):M;if(!C)continue;x.push(C);const R=C.length,k=new Float32Array(R),L=new Float32Array(3*(R===2?2:R-2));if(b.push({line:L,points:k}),R===2){k[0]=C[0]*S,k[1]=C[1]*w,L.set([NaN,NaN,NaN,NaN,k[0],k[1]],0);continue}let[P,$,K,J]=C;P*=S,$*=w,K*=S,J*=w,k.set([P,$,K,J],0),L.set([NaN,NaN,NaN,NaN,P,$],0);for(let Z=4;Z<R;Z+=2){const ht=k[Z]=C[Z]*S,St=k[Z+1]=C[Z+1]*w;L.set(st.createBezierPoints(P,$,K,J,ht,St),(Z-2)*3),[P,$,K,J]=[K,J,ht,St]}}if(b.length===0)return null;const E=u?new Fh:new Br;return E.build(b,e,s,1,a,u?0:y,o),{outline:E,newCurves:x,areContours:u,thickness:y,width:f,height:m}}static async compressSignature({outlines:t,areContours:e,thickness:s,width:a,height:o}){let l=1/0,u=-1/0,d=0;for(const C of t){d+=C.length;for(let R=2,k=C.length;R<k;R++){const L=C[R]-C[R-2];l=Math.min(l,L),u=Math.max(u,L)}}let f;l>=-128&&u<=127?f=Int8Array:l>=-32768&&u<=32767?f=Int16Array:f=Int32Array;const m=t.length,y=cl+pr*m,b=new Uint32Array(y);let v=0;b[v++]=y*Uint32Array.BYTES_PER_ELEMENT+(d-2*m)*f.BYTES_PER_ELEMENT,b[v++]=0,b[v++]=a,b[v++]=o,b[v++]=e?0:1,b[v++]=Math.max(0,Math.floor(s??0)),b[v++]=m,b[v++]=f.BYTES_PER_ELEMENT;for(const C of t)b[v++]=C.length-2,b[v++]=C[0],b[v++]=C[1];const S=new CompressionStream("deflate-raw"),w=S.writable.getWriter();await w.ready,w.write(b);const x=f.prototype.constructor;for(const C of t){const R=new x(C.length-2);for(let k=2,L=C.length;k<L;k++)R[k-2]=C[k]-C[k-2];w.write(R)}w.close();const E=await new Response(S.readable).arrayBuffer();return new Uint8Array(E).toBase64()}static async decompressSignature(t){try{const e=Uint8Array.fromBase64(t),{readable:s,writable:a}=new DecompressionStream("deflate-raw"),o=a.getWriter();await o.ready,o.write(e).then(async()=>{await o.ready,await o.close()}).catch(()=>{});let l=null,u=0;for await(const C of s)l||=new Uint8Array(new Uint32Array(C.buffer,0,4)[0]),l.set(C,u),u+=C.length;const d=new Uint32Array(l.buffer,0,l.length>>2),f=d[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const m=d[2],y=d[3],b=d[4]===0,v=d[5],S=d[6],w=d[7],x=[],E=(cl+pr*S)*Uint32Array.BYTES_PER_ELEMENT;let M;switch(w){case Int8Array.BYTES_PER_ELEMENT:M=new Int8Array(l.buffer,E);break;case Int16Array.BYTES_PER_ELEMENT:M=new Int16Array(l.buffer,E);break;case Int32Array.BYTES_PER_ELEMENT:M=new Int32Array(l.buffer,E);break}u=0;for(let C=0;C<S;C++){const R=d[pr*C+cl],k=new Float32Array(R+2);x.push(k);for(let L=0;L<pr-1;L++)k[L]=d[pr*C+cl+L+1];for(let L=0;L<R;L++)k[L+2]=k[L]+M[u++]}return{areContours:b,thickness:v,outlines:x,width:m,height:y}}catch(e){return yt(`decompressSignature: ${e}`),null}}}class od extends Ny{constructor(){super(),super.updateProperties({fill:ct._defaultLineColor,"stroke-width":0})}clone(){const t=new od;return t.updateAll(this),t}}class ld extends Fl{constructor(t){super(t),super.updateProperties({stroke:ct._defaultLineColor,"stroke-width":1})}clone(){const t=new ld(this._viewParameters);return t.updateAll(this),t}}class Pn extends Bt{#t=!1;#e=null;#i=null;#n=null;static _type="signature";static _editorType=At.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#i=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,e){ct.initialize(t,e),this._defaultDrawingOptions=new od,this._defaultDrawnSignatureOptions=new ld(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!1}static get typesMap(){return bt(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const e=t.get("hasDescription");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,e;const{_isCopy:s}=this;if(s&&(this._isCopy=!1,t=this.x,e=this.y),super.render(),this._drawId===null)if(this.#i){const{lines:a,mustSmooth:o,areContours:l,description:u,uuid:d,heightInPage:f}=this.#i,{rawDims:{pageWidth:m,pageHeight:y},rotation:b}=this.parent.viewport,v=na.processDrawnLines({lines:a,pageWidth:m,pageHeight:y,rotation:b,innerMargin:Pn._INNER_MARGIN,mustSmooth:o,areContours:l});this.addSignature(v,f,u,d)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return s&&(this._isCopy=!0,this._moveAfterPaste(t,e)),this.div}setUuid(t){this.#n=t,this.addEditToolbar()}getUuid(){return this.#n}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(e=>{e?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:e,thickness:s,width:a,height:o}=this.#i,l=Math.max(a,o),u=na.processDrawnLines({lines:{curves:t.map(d=>({points:d})),thickness:s,width:a,height:o},pageWidth:l,pageHeight:l,rotation:0,innerMargin:0,mustSmooth:!1,areContours:e});return{areContours:e,outline:u.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,e,s,a){const{x:o,y:l}=this,{outline:u}=this.#i=t;this.#t=u instanceof Fh,this.description=s;let d;this.#t?d=Pn.getDefaultDrawingOptions():(d=Pn._defaultDrawnSignatureOptions.clone(),d.updateProperties({"stroke-width":u.thickness})),this._addOutlines({drawOutlines:u,drawingOptions:d});const[,f]=this.pageDimensions;let m=e/f;m=m>=1?.5:m,this.width*=m/this.height,this.width>=1&&(m*=.9/this.width,this.width=.9),this.height=m,this.setDims(),this.x=o,this.y=l,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(a),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!a,hasDescription:!!s}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:e,pageHeight:s},rotation:a}=this.parent.viewport;return na.process(t,e,s,a,Pn._INNER_MARGIN)}getFromText(t,e){const{rawDims:{pageWidth:s,pageHeight:a},rotation:o}=this.parent.viewport;return na.extractContoursFromText(t,e,s,a,o,Pn._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:e,pageHeight:s},rotation:a}=this.parent.viewport;return na.processDrawnLines({lines:t,pageWidth:e,pageHeight:s,rotation:a,innerMargin:Pn._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:e}){t?this._drawingOptions=Pn.getDefaultDrawingOptions():(this._drawingOptions=Pn._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":e}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:e,points:s}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":a}}=this,o=Object.assign(super.serialize(t),{isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:a});return this.addComment(o),t?(o.paths={lines:e,points:s},o.uuid=this.#n,o.isCopy=!0):o.lines=e,this.#e&&(o.accessibilityData={type:"Figure",alt:this.#e}),o}static deserializeDraw(t,e,s,a,o,l){return l.areContours?Fh.deserialize(t,e,s,a,o,l):Br.deserialize(t,e,s,a,o,l)}static async deserialize(t,e,s){const a=await super.deserialize(t,e,s);return a.#t=t.areContours,a.description=t.accessibilityData?.alt||"",a.#n=t.uuid,a}}class Wx extends ct{#t=null;#e=null;#i=null;#n=null;#a=null;#r="";#s=null;#o=!1;#c=null;#l=!1;#d=!1;static _type="stamp";static _editorType=At.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#n=t.bitmapUrl,this.#a=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,e){ct.initialize(t,e)}static isHandlingMimeForPasting(t){return Dh.includes(t)}static paste(t,e){e.pasteEditor({mode:At.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#h(t,e=!1){if(!t){this.remove();return}this.#t=t.bitmap,e||(this.#e=t.id,this.#l=t.isSvg),t.file&&(this.#r=t.file.name),this.#m()}#f(){if(this.#i=null,this._uiManager.enableWaiting(!1),!!this.#s){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:a,width:o,height:l}=t||this.copyCanvas(null,null,!0).imageData,u=await s.guess({name:"altText",request:{data:a,width:o,height:l,channels:a.length/(o*l)}});if(!u)throw new Error("No response from the AI service.");if(u.error)throw new Error("Error from the AI service.");if(u.cancel)return null;if(!u.output)throw new Error("No valid response from the AI service.");const d=u.output;return await this.setGuessedAltText(d),e&&!this.hasAltTextData()&&(this.altTextData={alt:d,decorative:!1}),d}#g(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(s=>this.#h(s,!0)).finally(()=>this.#f());return}if(this.#n){const s=this.#n;this.#n=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromUrl(s).then(a=>this.#h(a)).finally(()=>this.#f());return}if(this.#a){const s=this.#a;this.#a=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromFile(s).then(a=>this.#h(a)).finally(()=>this.#f());return}const t=document.createElement("input");t.type="file",t.accept=Dh.join(",");const e=this._uiManager._signal;this.#i=new Promise(s=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const a=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(a)}s()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),s()},{signal:e})}).finally(()=>this.#f()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#s?.remove(),this.#s=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#g();return}super.rebuild(),this.div!==null&&(this.#e&&this.#s===null&&this.#g(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#i||this.#t||this.#n||this.#a||this.#e||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;return this._isCopy&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#t?this.#m():this.#g()),this._isCopy&&this._moveAfterPaste(t,e),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,e){const{id:s,bitmap:a}=this._uiManager.imageManager.getFromCanvas(t,e);e.remove(),s&&this._uiManager.imageManager.isValidId(s)&&(this.#e=s,a&&(this.#t=a),this.#o=!1,this.#m())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const t=200;this.#c=setTimeout(()=>{this.#c=null,this.#p()},t)}#m(){const{div:t}=this;let{width:e,height:s}=this.#t;const[a,o]=this.pageDimensions,l=.75;if(this.width)e=this.width*a,s=this.height*o;else if(e>l*a||s>l*o){const d=Math.min(l*a/e,l*o/s);e*=d,s*=d}this._uiManager.enableWaiting(!1);const u=this.#s=document.createElement("canvas");u.setAttribute("role","img"),this.addContainer(u),this.width=e/a,this.height=s/o,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#p(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#r&&this.div.setAttribute("aria-description",this.#r),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,e,s=!1){t||(t=224);const{width:a,height:o}=this.#t,l=new Fn;let u=this.#t,d=a,f=o,m=null;if(e){if(a>e||o>e){const L=Math.min(e/a,e/o);d=Math.floor(a*L),f=Math.floor(o*L)}m=document.createElement("canvas");const b=m.width=Math.ceil(d*l.sx),v=m.height=Math.ceil(f*l.sy);this.#l||(u=this.#u(b,v));const S=m.getContext("2d");S.filter=this._uiManager.hcmFilter;let w="white",x="#cfcfd8";this._uiManager.hcmFilter!=="none"?x="black":vw.isDarkMode&&(w="#8f8f9d",x="#42414d");const E=15,M=E*l.sx,C=E*l.sy,R=new OffscreenCanvas(M*2,C*2),k=R.getContext("2d");k.fillStyle=w,k.fillRect(0,0,M*2,C*2),k.fillStyle=x,k.fillRect(0,0,M,C),k.fillRect(M,C,M,C),S.fillStyle=S.createPattern(R,"repeat"),S.fillRect(0,0,b,v),S.drawImage(u,0,0,u.width,u.height,0,0,b,v)}let y=null;if(s){let b,v;if(l.symmetric&&u.width<t&&u.height<t)b=u.width,v=u.height;else if(u=this.#t,a>t||o>t){const x=Math.min(t/a,t/o);b=Math.floor(a*x),v=Math.floor(o*x),this.#l||(u=this.#u(b,v))}const w=new OffscreenCanvas(b,v).getContext("2d",{willReadFrequently:!0});w.drawImage(u,0,0,u.width,u.height,0,0,b,v),y={width:b,height:v,data:w.getImageData(0,0,b,v).data}}return{canvas:m,width:d,height:f,imageData:y}}#u(t,e){const{width:s,height:a}=this.#t;let o=s,l=a,u=this.#t;for(;o>2*t||l>2*e;){const d=o,f=l;o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),l>2*e&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2));const m=new OffscreenCanvas(o,l);m.getContext("2d").drawImage(u,0,0,d,f,0,0,o,l),u=m.transferToImageBitmap()}return u}#p(){const[t,e]=this.parentDimensions,{width:s,height:a}=this,o=new Fn,l=Math.ceil(s*t*o.sx),u=Math.ceil(a*e*o.sy),d=this.#s;if(!d||d.width===l&&d.height===u)return;d.width=l,d.height=u;const f=this.#l?this.#t:this.#u(l,u),m=d.getContext("2d");m.filter=this._uiManager.hcmFilter,m.drawImage(f,0,0,f.width,f.height,0,0,l,u)}#y(t){if(t){if(this.#l){const a=this._uiManager.imageManager.getSvgUrl(this.#e);if(a)return a}const e=document.createElement("canvas");return{width:e.width,height:e.height}=this.#t,e.getContext("2d").drawImage(this.#t,0,0),e.toDataURL()}if(this.#l){const[e,s]=this.pageDimensions,a=Math.round(this.width*e*da.PDF_TO_CSS_UNITS),o=Math.round(this.height*s*da.PDF_TO_CSS_UNITS),l=new OffscreenCanvas(a,o);return l.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,a,o),l.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,e,s){let a=null,o=!1;if(t instanceof My){const{data:{rect:w,rotation:x,id:E,structParent:M,popupRef:C,richText:R,contentsObj:k,creationDate:L,modificationDate:P},container:$,parent:{page:{pageNumber:K}},canvas:J}=t;let Z,ht;J?(delete t.canvas,{id:Z,bitmap:ht}=s.imageManager.getFromCanvas($.id,J),J.remove()):(o=!0,t._hasNoCanvas=!0);const St=(await e._structTree.getAriaAttributes(`${ia}${E}`))?.get("aria-label")||"";a=t={annotationType:At.STAMP,bitmapId:Z,bitmap:ht,pageIndex:K-1,rect:w.slice(0),rotation:x,annotationElementId:E,id:E,deleted:!1,accessibilityData:{decorative:!1,altText:St},isSvg:!1,structParent:M,popupRef:C,richText:R,comment:k?.str||null,creationDate:L,modificationDate:P}}const l=await super.deserialize(t,e,s),{rect:u,bitmap:d,bitmapUrl:f,bitmapId:m,isSvg:y,accessibilityData:b}=t;o?(s.addMissingCanvas(t.id,l),l.#o=!0):m&&s.imageManager.isValidId(m)?(l.#e=m,d&&(l.#t=d)):l.#n=f,l.#l=y;const[v,S]=l.pageDimensions;return l.width=(u[2]-u[0])/v,l.height=(u[3]-u[1])/S,b&&(l.altTextData=b),l._initialData=a,t.comment&&l.setCommentData(t),l.#d=!!a,l}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=Object.assign(super.serialize(t),{bitmapId:this.#e,isSvg:this.#l});if(this.addComment(s),t)return s.bitmapUrl=this.#y(!0),s.accessibilityData=this.serializeAltText(!0),s.isCopy=!0,s;const{decorative:a,altText:o}=this.serializeAltText(!1);if(!a&&o&&(s.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const u=this.#v(s);return u.isSame?null:(u.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1,s.id=this.annotationElementId,delete s.bitmapId,s)}if(e===null)return s;e.stamps||=new Map;const l=this.#l?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!e.stamps.has(this.#e))e.stamps.set(this.#e,{area:l,serialized:s}),s.bitmap=this.#y(!1);else if(this.#l){const u=e.stamps.get(this.#e);l>u.area&&(u.area=l,u.serialized.bitmap.close(),u.serialized.bitmap=this.#y(!1))}return s}#v(t){const{pageIndex:e,accessibilityData:{altText:s}}=this._initialData,a=t.pageIndex===e,o=(t.accessibilityData?.alt||"")===s;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&a&&o,isSameAltText:o}}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class ai{#t;#e=!1;#i=null;#n=null;#a=null;#r=new Map;#s=!1;#o=!1;#c=!1;#l=null;#d=null;#h=null;#f=null;#g=null;#m=-1;#u;static _initialized=!1;static#p=new Map([we,rd,Wx,ce,Pn].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:e,div:s,structTreeLayer:a,accessibilityManager:o,annotationLayer:l,drawLayer:u,textLayer:d,viewport:f,l10n:m}){const y=[...ai.#p.values()];if(!ai._initialized){ai._initialized=!0;for(const b of y)b.initialize(m,t)}t.registerEditorTypes(y),this.#u=t,this.pageIndex=e,this.div=s,this.#t=o,this.#i=l,this.viewport=f,this.#h=d,this.drawLayer=u,this._structTree=a,this.#u.addLayer(this)}updatePageIndex(t){this.pageIndex=t}get isEmpty(){return this.#r.size===0}get isInvisible(){return this.isEmpty&&this.#u.getMode()===At.NONE}updateToolbar(t){this.#u.updateToolbar(t)}updateMode(t=this.#u.getMode()){switch(this.#S(),t){case At.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case At.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case At.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;if(e.toggle("nonEditing",!1),t===At.POPUP)e.toggle("commentEditing",!0);else{e.toggle("commentEditing",!1);for(const s of ai.#p.values())e.toggle(`${s._type}Editing`,t===s._editorType)}this.div.hidden=!1}hasTextLayer(t){return t===this.#h?.div}setEditingState(t){this.#u.setEditingState(t)}addCommands(t){this.#u.addCommands(t)}cleanUndoStack(t){this.#u.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#i?.togglePointerEvents(t)}get#y(){return this.#r.size!==0?this.#r.values():this.#u.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#g?.abort(),this.#g=null;const t=new Set;for(const s of this.#y)s.enableEditing(),s.show(!0),s.annotationElementId&&(this.#u.removeChangedExistingAnnotation(s),t.add(s.annotationElementId));const e=this.#i;if(e)for(const s of e.getEditableAnnotations()){if(s.hide(),this.#u.isDeletedAnnotationElement(s.data.id)||t.has(s.data.id))continue;const a=await this.deserialize(s);a&&(this.addOrRebuild(a),a.enableEditing())}this.#c=!1,this.#u._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#h&&!this.#g){this.#g=new AbortController;const a=this.#u.combinedSignal(this.#g);this.#h.div.addEventListener("pointerdown",o=>{const{clientX:u,clientY:d,timeStamp:f}=o,m=this.#m;if(f-m>500){this.#m=f;return}this.#m=-1;const{classList:y}=this.div;y.toggle("getElements",!0);const b=document.elementsFromPoint(u,d);if(y.toggle("getElements",!1),!this.div.contains(b[0]))return;let v;const S=new RegExp(`^${Ar}[0-9]+$`);for(const x of b)if(S.test(x.id)){v=x.id;break}if(!v)return;const w=this.#r.get(v);w?.annotationElementId===null&&(o.stopPropagation(),o.preventDefault(),w.dblclick(o))},{signal:a,capture:!0})}const t=this.#i,e=[];if(t){const a=new Map,o=new Map;for(const u of this.#y){if(u.disableEditing(),!u.annotationElementId){e.push(u);continue}if(u.serialize()!==null){a.set(u.annotationElementId,u);continue}else o.set(u.annotationElementId,u);this.getEditableAnnotation(u.annotationElementId)?.show(),u.remove()}const l=t.getEditableAnnotations();for(const u of l){const{id:d}=u.data;if(this.#u.isDeletedAnnotationElement(d)){u.updateEdited({deleted:!0});continue}let f=o.get(d);if(f){f.resetAnnotationElement(u),f.show(!1),u.show();continue}f=a.get(d),f&&(this.#u.addChangedExistingAnnotation(f),f.renderAnnotationElement(u)&&f.show(!1)),u.show()}}this.#S(),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const a of ai.#p.values())s.remove(`${a._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),t?.updateFakeAnnotations(e),this.#o=!1}getEditableAnnotation(t){return this.#i?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#u.getActive()!==t&&this.#u.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#h?.div&&!this.#f){this.#f=new AbortController;const t=this.#u.combinedSignal(this.#f);this.#h.div.addEventListener("pointerdown",this.#v.bind(this),{signal:t}),this.#h.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#h.div.classList.remove("highlighting"))}#v(t){this.#u.unselectAll();const{target:e}=t;if(e===this.#h.div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&this.#h.div.contains(e)){const{isMac:s}=be.platform;if(t.button!==0||t.ctrlKey&&s)return;this.#u.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),this.toggleDrawing(),ce.startHighlighting(this,this.#u.direction==="ltr",{target:this.#h.div,x:t.x,y:t.y}),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#u._signal}),t.preventDefault()}}enableClick(){if(this.#n)return;this.#n=new AbortController;const t=this.#u.combinedSignal(this.#n);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){this.#n?.abort(),this.#n=null}attach(t){this.#r.set(t.id,t);const{annotationElementId:e}=t;e&&this.#u.isDeletedAnnotationElement(e)&&this.#u.removeDeletedAnnotationElement(t)}detach(t){this.#r.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#u.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#u.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#u.addDeletedAnnotationElement(t),ct.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#u.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#c),this.#u.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#a&&(t._focusEventsAllowed=!1,this.#a=setTimeout(()=>{this.#a=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#u._signal}),e.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),s=()=>{t.remove()};this.addCommands({cmd:e,undo:s,mustExec:!1})}getEditorByUID(t){for(const e of this.#r.values())if(e.uid===t)return e;return null}getNextId(){return this.#u.getId()}get#b(){return ai.#p.get(this.#u.getMode())}combinedSignal(t){return this.#u.combinedSignal(t)}#T(t){const e=this.#b;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#b?.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await this.#u.updateMode(t.mode);const{offsetX:s,offsetY:a}=this.#x(),o=this.getNextId(),l=this.#T({parent:this,id:o,x:s,y:a,uiManager:this.#u,isCentered:!0,...e});l&&this.add(l)}async deserialize(t){return await ai.#p.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#u)||null}createAndAddNewEditor(t,e,s={}){const a=this.getNextId(),o=this.#T({parent:this,id:a,x:t.offsetX,y:t.offsetY,uiManager:this.#u,isCentered:e,...s});return o&&this.add(o),o}get boundingClientRect(){return this.div.getBoundingClientRect()}#x(){const{x:t,y:e,width:s,height:a}=this.boundingClientRect,o=Math.max(0,t),l=Math.max(0,e),u=Math.min(window.innerWidth,t+s),d=Math.min(window.innerHeight,e+a),f=(o+u)/2-t,m=(l+d)/2-e,[y,b]=this.viewport.rotation%180===0?[f,m]:[m,f];return{offsetX:y,offsetY:b}}addNewEditor(t={}){this.createAndAddNewEditor(this.#x(),!0,t)}setSelected(t){this.#u.setSelected(t)}toggleSelected(t){this.#u.toggleSelected(t)}unselect(t){this.#u.unselect(t)}pointerup(t){const{isMac:e}=be.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!this.#s||(this.#s=!1,this.#b?.isDrawer&&this.#b.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const s=this.#u.getMode();if(s===At.STAMP||s===At.SIGNATURE){this.#u.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#u.getMode()===At.HIGHLIGHT&&this.enableTextSelection(),this.#s){this.#s=!1;return}const{isMac:e}=be.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(this.#s=!0,this.#b?.isDrawer){this.startDrawingSession(t);return}const s=this.#u.getActive();this.#e=!s||s.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#l){this.#b.startDrawing(this,this.#u,!1,t);return}this.#u.setCurrentDrawingSession(this),this.#l=new AbortController;const e=this.#u.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(this.#d=null,this.commitOrRemove())},{signal:e}),this.#b.startDrawing(this,this.#u,!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&(this.#d=e);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#l?(this.#u.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#d=null,this.#b.endDrawing(t)):null}findNewParent(t,e,s){const a=this.#u.findParent(e,s);return a===null||a===this?!1:(a.changeParent(t),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#b.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#u.getActive()?.parent===this&&(this.#u.commitOrRemove(),this.#u.setActiveEditor(null)),this.#a&&(clearTimeout(this.#a),this.#a=null);for(const t of this.#r.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#r.clear(),this.#u.removeLayer(this)}#S(){for(const t of this.#r.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,hs(this.div,t);for(const e of this.#u.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#u.commitOrRemove(),this.#S();const e=this.viewport.rotation,s=t.rotation;if(this.viewport=t,hs(this.div,{rotation:s}),e!==s)for(const a of this.#r.values())a.rotate(s)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#u.viewParameters.realScale}}class Me{#t=null;#e=new Map;#i=new Map;static#n=0;setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const e of this.#e.values())e.remove(),t.append(e);this.#t=t}}static get _svgFactory(){return bt(this,"_svgFactory",new Al)}static#a(t,[e,s,a,o]){const{style:l}=t;l.top=`${100*s}%`,l.left=`${100*e}%`,l.width=`${100*a}%`,l.height=`${100*o}%`}#r(){const t=Me._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#s(t,e){const s=Me._svgFactory.createElement("clipPath");t.append(s);const a=`clip_${e}`;s.setAttribute("id",a),s.setAttribute("clipPathUnits","objectBoundingBox");const o=Me._svgFactory.createElement("use");return s.append(o),o.setAttribute("href",`#${e}`),o.classList.add("clip"),a}#o(t,e){for(const[s,a]of Object.entries(e))a===null?t.removeAttribute(s):t.setAttribute(s,a)}draw(t,e=!1,s=!1){const a=Me.#n++,o=this.#r(),l=Me._svgFactory.createElement("defs");o.append(l);const u=Me._svgFactory.createElement("path");l.append(u);const d=`path_${a}`;u.setAttribute("id",d),u.setAttribute("vector-effect","non-scaling-stroke"),e&&this.#i.set(a,u);const f=s?this.#s(l,d):null,m=Me._svgFactory.createElement("use");return o.append(m),m.setAttribute("href",`#${d}`),this.updateProperties(o,t),this.#e.set(a,o),{id:a,clipPathId:`url(#${f})`}}drawOutline(t,e){const s=Me.#n++,a=this.#r(),o=Me._svgFactory.createElement("defs");a.append(o);const l=Me._svgFactory.createElement("path");o.append(l);const u=`path_${s}`;l.setAttribute("id",u),l.setAttribute("vector-effect","non-scaling-stroke");let d;if(e){const y=Me._svgFactory.createElement("mask");o.append(y),d=`mask_${s}`,y.setAttribute("id",d),y.setAttribute("maskUnits","objectBoundingBox");const b=Me._svgFactory.createElement("rect");y.append(b),b.setAttribute("width","1"),b.setAttribute("height","1"),b.setAttribute("fill","white");const v=Me._svgFactory.createElement("use");y.append(v),v.setAttribute("href",`#${u}`),v.setAttribute("stroke","none"),v.setAttribute("fill","black"),v.setAttribute("fill-rule","nonzero"),v.classList.add("mask")}const f=Me._svgFactory.createElement("use");a.append(f),f.setAttribute("href",`#${u}`),d&&f.setAttribute("mask",`url(#${d})`);const m=f.cloneNode();return a.append(m),f.classList.add("mainOutline"),m.classList.add("secondaryOutline"),this.updateProperties(a,t),this.#e.set(s,a),s}finalizeDraw(t,e){this.#i.delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:s,bbox:a,rootClass:o,path:l}=e,u=typeof t=="number"?this.#e.get(t):t;if(u){if(s&&this.#o(u,s),a&&Me.#a(u,a),o){const{classList:d}=u;for(const[f,m]of Object.entries(o))d.toggle(f,m)}if(l){const f=u.firstElementChild.firstElementChild;this.#o(f,l)}}}updateParent(t,e){if(e===this)return;const s=this.#e.get(t);s&&(e.#t.append(s),this.#e.delete(t),e.#e.set(t,s))}remove(t){this.#i.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#i.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:Ph};globalThis.pdfjsLib={AbortException:Pi,AnnotationEditorLayer:ai,AnnotationEditorParamsType:Nt,AnnotationEditorType:At,AnnotationEditorUIManager:ji,AnnotationLayer:ad,AnnotationMode:Oi,AnnotationType:me,applyOpacity:Sw,build:Cx,ColorPicker:Sn,createValidAbsoluteUrl:K0,CSSConstants:Aw,DOMSVGFactory:Al,DrawLayer:Me,FeatureTest:be,fetchData:Rr,findContrastColor:ww,getDocument:vy,getFilenameFromUrl:pw,getPdfFilenameFromUrl:mw,getRGB:Or,getUuid:W0,getXfaPageViewport:yw,GlobalWorkerOptions:ca,ImageKind:fl,InvalidPDFException:Ch,isDataScheme:Rl,isPdfFile:Kh,isValidExplicitDest:Ow,MathClamp:De,noContextMenu:wn,normalizeUnicode:dw,OPS:Sr,OutputScale:Fn,PagesMapper:Pt,PasswordResponses:nw,PDFDataRangeTransport:Ay,PDFDateString:Mh,PDFWorker:xr,PermissionFlag:ew,PixelsPerInch:da,RenderingCancelledException:$h,renderRichText:J0,ResponseException:bl,setLayerDimensions:hs,shadow:bt,SignatureExtractor:na,stopEvent:ae,SupportedImageMimeTypes:Dh,TextLayer:rn,TouchManager:kl,updateUrlHash:Q0,Util:nt,VerbosityLevel:Cl,version:xy,XfaLayer:Z0};ca.workerSrc=`https://cdnjs.cloudflare.com/ajax/libs/pdf.js/${xy}/pdf.worker.min.mjs`;function y0(h){if(!h)return"";let t=h;return t=t.replace(/\f/g,`
`),t=t.replace(/page\s+\d+\s+of\s+\d+/gi,""),t=t.replace(/\n\s*-\s*\d+\s*-\s*\n/g,`
`),t=t.replace(/\n\s*\d{1,4}\s*\n/g,`
`),t=t.replace(/(\w+)-\s*\n\s*(\w+)/g,"$1$2"),t=t.replace(/[ \t]+/g," "),t=t.replace(/\n{3,}/g,`

`),t=t.split(`
`).map(e=>e.trim()).join(`
`).trim(),t}function Zx(h){const t=h.split(`
`),e={};return t.forEach(s=>{const a=s.trim();a.length>3&&a.length<100&&(e[a]=(e[a]||0)+1)}),t.filter(s=>{const a=s.trim();return!(e[a]&&e[a]>3)}).join(`
`)}function Jx(){const[h,t]=it.useState([]),[e,s]=it.useState(""),[a,o]=it.useState(!1),[l,u]=it.useState(null),[d,f]=it.useState(0),m=it.useRef(!1),y=it.useCallback(async v=>{o(!0),u(null),f(0),m.current=!1;try{const S=await v.arrayBuffer(),w=await vy({data:S}).promise,x=w.numPages,E=[];let M="";for(let R=1;R<=x&&!m.current;R++){const L=await(await w.getPage(R)).getTextContent();let P="",$=null;for(const J of L.items)$!==null&&Math.abs($-J.transform[5])>5&&(P+=`
`),P+=J.str,$=J.transform[5];const K=y0(P);E.push({pageNumber:R,text:K}),M+=K+`

`,f(Math.round(R/x*100))}const C=Zx(y0(M));return t(E),s(C),o(!1),{pages:E,fullText:C,numPages:x}}catch(S){throw u(S.message),o(!1),S}},[]),b=it.useCallback(()=>{m.current=!0},[]);return{parsePDF:y,pages:h,fullText:e,isLoading:a,error:l,progress:d,abort:b}}function tE(){const{setCurrentBook:h,setActiveView:t,addBook:e,setIsUploading:s,setUploadProgress:a,setCurrentPage:o,resetPlayer:l}=te(),{parsePDF:u}=Jx(),[d,f]=it.useState(""),m=it.useCallback(async b=>{f(""),s(!0),a(10);try{const v=new FormData;v.append("pdf",b),a(30);const{data:S}=await $t.post("/api/upload",v,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:w=>{const x=Math.round(w.loaded/w.total*50)+20;a(x)}});if(a(80),S.success){const w=S.book;e(w),h(w),l(),o(0),a(100),setTimeout(()=>{t("reader"),s(!1)},500)}}catch(v){console.error("Upload failed:",v),f(v.response?.data?.error||"Failed to upload PDF. Please try again."),s(!1),a(0)}},[h,t,e,s,a,o,l,u]),y=it.useCallback(async b=>{try{const{data:v}=await $t.get(`/api/library/${b._id}`);if(v.success){h(v.book),l(),o(0);try{const{data:S}=await $t.get(`/api/progress/${b._id}`);S.success&&S.progress&&o(S.progress.currentPage||0)}catch{}t("reader")}}catch(v){console.error("Failed to load book:",v)}},[h,t,l,o]);return _.jsxs("div",{className:"space-y-10",children:[_.jsxs("div",{className:"text-center pt-8 pb-4",children:[_.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-1.5 rounded-full glass text-xs font-medium mb-6",children:[_.jsx(Eg,{className:"w-3.5 h-3.5 text-primary-400"}),_.jsx("span",{children:"Powered by advanced text-to-speech"})]}),_.jsxs("h1",{className:"text-4xl sm:text-5xl font-extrabold mb-4 leading-tight",children:["Turn any ",_.jsx("span",{className:"gradient-text",children:"PDF"})," into",_.jsx("br",{}),"an ",_.jsx("span",{className:"gradient-text",children:"audiobook"})]}),_.jsx("p",{className:"text-gray-400 max-w-lg mx-auto text-base sm:text-lg mb-8",children:"Upload your PDF documents and listen to them with a premium audiobook experience. Background playback, bookmarks, and more."})]}),_.jsx(EA,{onFileSelect:m}),d&&_.jsx("div",{className:"max-w-2xl mx-auto p-4 rounded-xl bg-red-500/10 border border-red-500/20 text-red-400 text-sm text-center",children:d}),_.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3 max-w-2xl mx-auto",children:[{icon:Ih,text:"Background Play",desc:"Listen with screen off"},{icon:mA,text:"Smart Cleaning",desc:"No page numbers or junk"},{icon:Bi,text:"Bookmarks",desc:"Save your place"},{icon:Uh,text:"Sleep Timer",desc:"Auto-stop playback"},{icon:Z1,text:"Privacy First",desc:"Files stay on your device"},{icon:Eg,text:"Variable Speed",desc:"0.5x to 2x playback"}].map(({icon:b,text:v,desc:S})=>_.jsxs("div",{className:"glass rounded-xl p-4 text-center",children:[_.jsx(b,{className:"w-6 h-6 text-primary-400 mx-auto mb-2"}),_.jsx("p",{className:"text-sm font-semibold",children:v}),_.jsx("p",{className:"text-xs text-gray-400 mt-0.5",children:S})]},v))}),_.jsx(tw,{onSelectBook:y})]})}function eE({tts:h,onToggleText:t,onToggleBookmarks:e,onToggleSleepTimer:s,onToggleVoice:a}){const{isPlaying:o,currentBook:l,playbackSpeed:u,setPlaybackSpeed:d,currentSentenceIndex:f,totalSentences:m,volume:y,setVolume:b,currentPage:v,totalPages:S,bookmarks:w,addBookmark:x}=te(),E=[.5,.75,1,1.25,1.5,1.75,2],M=()=>{const P=(E.indexOf(u)+1)%E.length;d(E[P])},C=it.useMemo(()=>m===0?0:Math.round(f/m*100),[f,m]),R=()=>{x({page:v,position:f,snippet:`Sentence ${f+1}`,note:""})},k=L=>{const P=parseInt(L.target.value);h?.jumpToSentence(P)};return l?_.jsxs("div",{className:"glass rounded-2xl p-5 slide-up",children:[_.jsxs("div",{className:"flex items-center gap-4 mb-5",children:[_.jsx("div",{className:"w-14 h-14 rounded-xl flex items-center justify-center shrink-0",style:{background:`linear-gradient(135deg, ${l.coverColor}, ${l.coverColor}88)`},children:_.jsx(Bi,{className:"w-7 h-7 text-white"})}),_.jsxs("div",{className:"min-w-0 flex-1",children:[_.jsx("h3",{className:"font-bold text-base truncate",children:l.title}),_.jsx("p",{className:"text-sm text-gray-400 truncate",children:l.author})]}),_.jsxs("span",{className:"text-xs px-3 py-1 rounded-full bg-primary-500/20 text-primary-300 font-medium whitespace-nowrap",children:[C,"%"]})]}),_.jsxs("div",{className:"mb-4",children:[_.jsx("input",{type:"range",min:0,max:Math.max(m-1,0),value:f,onChange:k,className:"w-full",style:{background:`linear-gradient(to right, #8b5cf6 ${C}%, rgba(139,92,246,0.15) ${C}%)`}}),_.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[_.jsxs("span",{children:["Sentence ",f+1]}),_.jsxs("span",{children:[m," total"]})]})]}),_.jsxs("div",{className:"flex items-center justify-center gap-4 mb-5",children:[_.jsx("button",{onClick:()=>h?.skipBackward(),className:`w-11 h-11 rounded-full flex items-center justify-center
            hover:bg-white/10 transition-all duration-200 active:scale-95`,title:"Skip back",children:_.jsx(tA,{className:"w-5 h-5"})}),_.jsx("button",{onClick:()=>h?.togglePlayPause(),className:`w-16 h-16 rounded-full flex items-center justify-center
            transition-all duration-200 active:scale-95
            ${o?"gradient-bg glow-purple":"bg-primary-600 hover:bg-primary-500 glow-purple"}`,children:o?_.jsx(x0,{className:"w-7 h-7 text-white",fill:"white"}):_.jsx(Hh,{className:"w-7 h-7 text-white ml-1",fill:"white"})}),_.jsx("button",{onClick:()=>h?.skipForward(),className:`w-11 h-11 rounded-full flex items-center justify-center
            hover:bg-white/10 transition-all duration-200 active:scale-95`,title:"Skip forward",children:_.jsx(E0,{className:"w-5 h-5"})})]}),_.jsxs("div",{className:"flex items-center justify-between gap-2",children:[_.jsxs("button",{onClick:M,className:`flex items-center gap-1.5 px-3 py-2 rounded-xl
            hover:bg-white/10 transition-all text-sm font-semibold`,title:"Playback speed",children:[_.jsx(z1,{className:"w-4 h-4 text-primary-400"}),_.jsxs("span",{children:[u,"x"]})]}),_.jsxs("div",{className:"flex items-center gap-1",children:[_.jsx("button",{onClick:R,className:"w-9 h-9 rounded-lg flex items-center justify-center hover:bg-white/10 transition-all",title:"Add bookmark",children:_.jsx(S1,{className:"w-4 h-4 text-primary-400"})}),_.jsxs("button",{onClick:e,className:"w-9 h-9 rounded-lg flex items-center justify-center hover:bg-white/10 transition-all relative",title:"View bookmarks",children:[_.jsx(Bi,{className:"w-4 h-4 text-primary-400"}),w.length>0&&_.jsx("span",{className:"absolute -top-0.5 -right-0.5 w-4 h-4 rounded-full bg-accent-500 text-[10px] font-bold flex items-center justify-center text-white",children:w.length})]}),_.jsx("button",{onClick:s,className:"w-9 h-9 rounded-lg flex items-center justify-center hover:bg-white/10 transition-all",title:"Sleep timer",children:_.jsx(T0,{className:"w-4 h-4 text-primary-400"})}),_.jsx("button",{onClick:a,className:"w-9 h-9 rounded-lg flex items-center justify-center hover:bg-white/10 transition-all",title:"Select voice",children:_.jsx(w0,{className:"w-4 h-4 text-primary-400"})}),_.jsx("button",{onClick:t,className:"w-9 h-9 rounded-lg flex items-center justify-center hover:bg-white/10 transition-all",title:"Toggle text view",children:_.jsx(Bi,{className:"w-4 h-4 text-accent-400"})})]}),_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("button",{onClick:()=>b(y===0?1:0),className:"w-9 h-9 rounded-lg flex items-center justify-center hover:bg-white/10 transition-all",children:y===0?_.jsx(dA,{className:"w-4 h-4 text-gray-400"}):_.jsx(uA,{className:"w-4 h-4 text-primary-400"})}),_.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:y,onChange:L=>b(parseFloat(L.target.value)),className:"w-16 hidden sm:block",style:{background:`linear-gradient(to right, #8b5cf6 ${y*100}%, rgba(139,92,246,0.15) ${y*100}%)`}})]})]})]}):null}function nE(h){if(!h)return[];const t=h.match(/[^.!?]*[.!?]+[\s]*/g)||[h],e=[];let s="";for(const a of t)s+=a,s.trim().length>20&&(e.push(s.trim()),s="");return s.trim()&&e.push(s.trim()),e}function iE({text:h}){const{currentSentenceIndex:t,showTextViewer:e}=te(),s=it.useRef(null),a=it.useRef(null),o=it.useMemo(()=>nE(h),[h]);return it.useEffect(()=>{a.current&&s.current&&a.current.scrollIntoView({behavior:"smooth",block:"center"})},[t]),!e||!h?null:_.jsxs("div",{className:"glass rounded-2xl overflow-hidden slide-up",children:[_.jsxs("div",{className:"flex items-center justify-between px-5 py-3 border-b border-white/5",children:[_.jsx("h3",{className:"text-sm font-semibold text-primary-400",children:"Reading Along"}),_.jsxs("span",{className:"text-xs text-gray-400",children:[t+1," / ",o.length]})]}),_.jsx("div",{ref:s,className:"p-5 max-h-[50vh] overflow-y-auto text-base leading-relaxed",style:{fontFamily:'"Inter", Georgia, serif'},children:o.map((l,u)=>_.jsxs("span",{ref:u===t?a:null,className:`
              inline transition-all duration-300 cursor-pointer
              ${u===t?"sentence-active font-medium":u<t?"text-gray-500":""}
            `,children:[l," "]},u))})]})}function sE({pages:h,onClose:t}){const{currentPage:e,setCurrentPage:s}=te();return!h||h.length===0?null:_.jsxs("div",{className:"glass rounded-2xl p-5 slide-up",children:[_.jsxs("div",{className:"flex items-center justify-between mb-4",children:[_.jsx("h3",{className:"font-semibold",children:"Pages"}),_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsxs("span",{className:"text-sm text-gray-400",children:[e+1," / ",h.length]}),t&&_.jsx("button",{onClick:t,className:"w-8 h-8 rounded-lg flex items-center justify-center hover:bg-white/10",children:_.jsx(Tr,{className:"w-4 h-4"})})]})]}),_.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[_.jsxs("button",{onClick:()=>s(Math.max(0,e-1)),disabled:e===0,className:`flex-1 flex items-center justify-center gap-1 py-2.5 rounded-xl
            hover:bg-white/10 transition-all disabled:opacity-30 disabled:cursor-not-allowed
            border border-white/5`,children:[_.jsx(C1,{className:"w-4 h-4"}),_.jsx("span",{className:"text-sm",children:"Previous"})]}),_.jsxs("button",{onClick:()=>s(Math.min(h.length-1,e+1)),disabled:e===h.length-1,className:`flex-1 flex items-center justify-center gap-1 py-2.5 rounded-xl
            hover:bg-white/10 transition-all disabled:opacity-30 disabled:cursor-not-allowed
            border border-white/5`,children:[_.jsx("span",{className:"text-sm",children:"Next"}),_.jsx(D1,{className:"w-4 h-4"})]})]}),_.jsx("div",{className:"grid grid-cols-5 sm:grid-cols-8 gap-1.5 max-h-[30vh] overflow-y-auto",children:h.map((a,o)=>_.jsx("button",{onClick:()=>s(o),className:`py-2 rounded-lg text-xs font-medium transition-all
              ${o===e?"gradient-bg text-white glow-purple":"hover:bg-white/10 border border-white/5"}`,children:o+1},o))})]})}function aE({onClose:h}){const{sleepTimerEnd:t,sleepTimerActive:e,setSleepTimer:s,clearSleepTimer:a}=te(),[o,l]=it.useState(null),u=[{label:"15 min",value:15},{label:"30 min",value:30},{label:"45 min",value:45},{label:"60 min",value:60},{label:"90 min",value:90}];it.useEffect(()=>{if(!e||!t){l(null);return}const f=setInterval(()=>{const m=Math.max(0,t-Date.now());l(m),m===0&&clearInterval(f)},1e3);return()=>clearInterval(f)},[e,t]);const d=f=>{if(!f)return"0:00";const m=Math.floor(f/6e4),y=Math.floor(f%6e4/1e3);return`${m}:${y.toString().padStart(2,"0")}`};return _.jsxs("div",{className:"glass rounded-2xl p-5 slide-up",children:[_.jsxs("div",{className:"flex items-center justify-between mb-4",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(T0,{className:"w-5 h-5 text-primary-400"}),_.jsx("h3",{className:"font-semibold",children:"Sleep Timer"})]}),_.jsx("button",{onClick:h,className:"w-8 h-8 rounded-lg flex items-center justify-center hover:bg-white/10",children:_.jsx(Tr,{className:"w-4 h-4"})})]}),e&&o!==null?_.jsxs("div",{className:"text-center py-4",children:[_.jsxs("div",{className:"relative w-28 h-28 mx-auto mb-4",children:[_.jsxs("svg",{className:"w-full h-full -rotate-90",viewBox:"0 0 100 100",children:[_.jsx("circle",{cx:"50",cy:"50",r:"42",fill:"none",stroke:"rgba(139,92,246,0.1)",strokeWidth:"6"}),_.jsx("circle",{cx:"50",cy:"50",r:"42",fill:"none",stroke:"url(#timerGradient)",strokeWidth:"6",strokeLinecap:"round",strokeDasharray:`${2*Math.PI*42}`,strokeDashoffset:`${2*Math.PI*42*(1-o/(te.getState().sleepTimerMinutes*6e4))}`,className:"transition-all duration-1000"}),_.jsx("defs",{children:_.jsxs("linearGradient",{id:"timerGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[_.jsx("stop",{offset:"0%",stopColor:"#8b5cf6"}),_.jsx("stop",{offset:"100%",stopColor:"#ec4899"})]})})]}),_.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:_.jsx("span",{className:"text-2xl font-bold gradient-text",children:d(o)})})]}),_.jsx("button",{onClick:()=>{a()},className:"px-6 py-2 rounded-xl bg-red-500/20 text-red-400 hover:bg-red-500/30 transition-all text-sm font-medium",children:"Cancel Timer"})]}):_.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[u.map(({label:f,value:m})=>_.jsx("button",{onClick:()=>s(m),className:`px-4 py-3 rounded-xl hover:bg-primary-500/20 transition-all text-sm font-medium
                border border-white/5 hover:border-primary-500/30`,children:f},m)),_.jsx("button",{onClick:()=>s(120),className:`px-4 py-3 rounded-xl hover:bg-primary-500/20 transition-all text-sm font-medium
              border border-white/5 hover:border-primary-500/30`,children:"2 hrs"})]})]})}function rE({tts:h,onClose:t}){const{bookmarks:e,removeBookmark:s}=te(),a=o=>{h?.jumpToSentence(o.position)};return _.jsxs("div",{className:"glass rounded-2xl p-5 slide-up",children:[_.jsxs("div",{className:"flex items-center justify-between mb-4",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(xg,{className:"w-5 h-5 text-primary-400"}),_.jsx("h3",{className:"font-semibold",children:"Bookmarks"}),_.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-primary-500/20 text-primary-300",children:e.length})]}),_.jsx("button",{onClick:t,className:"w-8 h-8 rounded-lg flex items-center justify-center hover:bg-white/10",children:_.jsx(Tr,{className:"w-4 h-4"})})]}),e.length===0?_.jsxs("div",{className:"text-center py-8 text-gray-400",children:[_.jsx(xg,{className:"w-10 h-10 mx-auto mb-3 opacity-30"}),_.jsx("p",{className:"text-sm",children:"No bookmarks yet"}),_.jsx("p",{className:"text-xs mt-1",children:"Tap the bookmark icon while listening to save your position"})]}):_.jsx("div",{className:"space-y-2 max-h-[40vh] overflow-y-auto",children:e.map(o=>_.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-xl hover:bg-white/5 transition-all cursor-pointer group",onClick:()=>a(o),children:[_.jsx("div",{className:"w-8 h-8 rounded-lg bg-primary-500/20 flex items-center justify-center shrink-0",children:_.jsx(q1,{className:"w-4 h-4 text-primary-400"})}),_.jsxs("div",{className:"flex-1 min-w-0",children:[_.jsxs("p",{className:"text-sm font-medium truncate",children:["Page ",o.page+1,"  ",o.snippet]}),_.jsxs("p",{className:"text-xs text-gray-400",children:[new Date(o.createdAt).toLocaleDateString()," at"," ",new Date(o.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),_.jsx("button",{onClick:l=>{l.stopPropagation(),s(o.id)},className:`w-7 h-7 rounded-lg flex items-center justify-center opacity-0 group-hover:opacity-100
                  hover:bg-red-500/20 transition-all`,children:_.jsx(_0,{className:"w-3.5 h-3.5 text-red-400"})})]},o.id))})]})}function oE({onClose:h}){const{selectedVoice:t,setSelectedVoice:e}=te(),[s,a]=it.useState([]),[o,l]=it.useState(null),[u,d]=it.useState("");it.useEffect(()=>{const b=()=>{const v=window.speechSynthesis.getVoices();a(v)};return b(),window.speechSynthesis.onvoiceschanged=b,()=>{window.speechSynthesis.onvoiceschanged=null}},[]);const f=it.useCallback(b=>{window.speechSynthesis.cancel();const v=new SpeechSynthesisUtterance("Hello! This is how I sound when reading your book.");v.voice=b,v.rate=1,window.speechSynthesis.speak(v),l(b.name),v.onend=()=>l(null)},[]),m=s.reduce((b,v)=>{const S=v.lang.split("-")[0].toUpperCase();return b[S]||(b[S]=[]),b[S].push(v),b},{}),y=Object.entries(m).filter(([b,v])=>{if(!u)return!0;const S=u.toLowerCase();return b.toLowerCase().includes(S)||v.some(w=>w.name.toLowerCase().includes(S))});return _.jsxs("div",{className:"glass rounded-2xl p-5 slide-up",children:[_.jsxs("div",{className:"flex items-center justify-between mb-4",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(w0,{className:"w-5 h-5 text-primary-400"}),_.jsx("h3",{className:"font-semibold",children:"Voice Selection"})]}),_.jsx("button",{onClick:h,className:"w-8 h-8 rounded-lg flex items-center justify-center hover:bg-white/10",children:_.jsx(Tr,{className:"w-4 h-4"})})]}),_.jsx("input",{type:"text",placeholder:"Search voices...",value:u,onChange:b=>d(b.target.value),className:`w-full px-4 py-2.5 rounded-xl bg-white/5 border border-white/10 mb-4 text-sm
          focus:outline-none focus:border-primary-500/50 transition-all placeholder-gray-500`}),_.jsx("div",{className:"max-h-[40vh] overflow-y-auto space-y-4",children:y.map(([b,v])=>_.jsxs("div",{children:[_.jsx("h4",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2",children:b}),_.jsx("div",{className:"space-y-1",children:v.map(S=>_.jsxs("div",{className:`flex items-center gap-3 p-2.5 rounded-xl cursor-pointer transition-all
                    ${t===S.name?"bg-primary-500/20 border border-primary-500/30":"hover:bg-white/5 border border-transparent"}`,onClick:()=>e(S.name),children:[_.jsxs("div",{className:"flex-1 min-w-0",children:[_.jsx("p",{className:"text-sm font-medium truncate",children:S.name}),_.jsxs("p",{className:"text-xs text-gray-400",children:[S.lang," ",S.localService?" Local":" Network"]})]}),_.jsx("button",{onClick:w=>{w.stopPropagation(),f(S)},className:"w-7 h-7 rounded-full flex items-center justify-center hover:bg-white/10 transition-all shrink-0",children:o===S.name?_.jsx("div",{className:"w-3 h-3 rounded-full gradient-bg animate-pulse"}):_.jsx(Hh,{className:"w-3 h-3 ml-0.5",fill:"currentColor"})}),t===S.name&&_.jsx(T1,{className:"w-4 h-4 text-primary-400 shrink-0"})]},S.name))})]},b))})]})}function lE(h){if(!h)return[];const t=h.match(/[^.!?]*[.!?]+[\s]*/g)||[h],e=[];let s="";for(const a of t)s+=a,s.trim().length>20&&(e.push(s.trim()),s="");return s.trim()&&e.push(s.trim()),e}function Ry(){const h=it.useRef(window.speechSynthesis),t=it.useRef(null),e=it.useRef([]),s=it.useRef(0),a=it.useRef(!1),o=it.useRef(null),{isPlaying:l,setIsPlaying:u,playbackSpeed:d,currentSentenceIndex:f,setCurrentSentenceIndex:m,setTotalSentences:y,selectedVoice:b,volume:v,incrementListeningTime:S,sleepTimerEnd:w,sleepTimerActive:x,clearSleepTimer:E,setIsPlaying:M}=te();it.useEffect(()=>{let et;return l&&(et=setInterval(()=>{S(1)},1e3)),()=>clearInterval(et)},[l,S]),it.useEffect(()=>{if(!x||!w)return;const et=setInterval(()=>{Date.now()>=w&&(K(),E())},1e3);return()=>clearInterval(et)},[x,w,E]);const C=it.useCallback(()=>{const et=h.current.getVoices();if(b){const O=et.find(H=>H.name===b);if(O)return O}return et.find(O=>O.lang.startsWith("en")&&O.localService)||et.find(O=>O.lang.startsWith("en"))||et[0]},[b]),R=it.useCallback(et=>{if(et>=e.current.length){u(!1),a.current=!1;return}const O=h.current;O.cancel();const H=new SpeechSynthesisUtterance(e.current[et]);H.rate=d,H.volume=v,H.pitch=1;const W=C();W&&(H.voice=W),H.onend=()=>{a.current&&(s.current=et+1,m(et+1),R(et+1))},H.onerror=pt=>{pt.error==="canceled"||pt.error==="interrupted"||console.error("TTS error:",pt)},t.current=H,s.current=et,m(et),O.speak(H),clearInterval(o.current),o.current=setInterval(()=>{O.speaking&&!O.paused&&(O.pause(),O.resume())},1e4)},[d,v,C,u,m]),k=it.useCallback(et=>{const O=lE(et);return e.current=O,y(O.length),O},[y]),L=it.useCallback((et,O=0)=>{et&&k(et),a.current=!0,u(!0),R(O)},[k,u,R]),P=it.useCallback(()=>{h.current.pause(),a.current=!1,u(!1),clearInterval(o.current)},[u]),$=it.useCallback(()=>{h.current.paused?(h.current.resume(),a.current=!0,u(!0),clearInterval(o.current),o.current=setInterval(()=>{h.current.speaking&&!h.current.paused&&(h.current.pause(),h.current.resume())},1e4)):L(null,s.current)},[u,L]),K=it.useCallback(()=>{h.current.cancel(),a.current=!1,u(!1),clearInterval(o.current)},[u]),J=it.useCallback(et=>{l?P():h.current.paused?$():L(et,s.current)},[l,P,$,L]),Z=it.useCallback(()=>{const et=Math.min(s.current+3,e.current.length-1);a.current||l?(K(),L(null,et)):(s.current=et,m(et))},[l,K,L,m]),ht=it.useCallback(()=>{const et=Math.max(s.current-3,0);a.current||l?(K(),L(null,et)):(s.current=et,m(et))},[l,K,L,m]),St=it.useCallback(et=>{a.current||l?(K(),L(null,et)):(s.current=et,m(et))},[l,K,L,m]),ot=it.useCallback(()=>h.current.getVoices(),[]);return it.useEffect(()=>()=>{h.current.cancel(),clearInterval(o.current)},[]),{play:L,pause:P,resume:$,stop:K,togglePlayPause:J,skipForward:Z,skipBackward:ht,jumpToSentence:St,loadText:k,getAvailableVoices:ot,sentences:e.current,currentIndex:s.current}}function cE(h){const{currentBook:t,isPlaying:e}=te();it.useEffect(()=>{"mediaSession"in navigator&&(navigator.mediaSession.metadata=new MediaMetadata({title:t?.title||"Audiolize",artist:t?.author||"PDF Audiobook",album:"Audiolize",artwork:[{src:"/favicon.svg",sizes:"96x96",type:"image/svg+xml"}]}),navigator.mediaSession.playbackState=e?"playing":"paused",navigator.mediaSession.setActionHandler("play",()=>{h?.resume()}),navigator.mediaSession.setActionHandler("pause",()=>{h?.pause()}),navigator.mediaSession.setActionHandler("previoustrack",()=>{h?.skipBackward()}),navigator.mediaSession.setActionHandler("nexttrack",()=>{h?.skipForward()}),navigator.mediaSession.setActionHandler("seekforward",()=>{h?.skipForward()}),navigator.mediaSession.setActionHandler("seekbackward",()=>{h?.skipBackward()}),navigator.mediaSession.setActionHandler("stop",()=>{h?.stop()}))},[t,e,h])}function uE(){const{currentBook:h,currentPage:t,setActiveView:e,setShowMiniPlayer:s,showTextViewer:a,setShowTextViewer:o,showBookmarks:l,setShowBookmarks:u,currentSentenceIndex:d,totalSentences:f}=te(),m=Ry();cE(m);const[y,b]=it.useState(!1),[v,S]=it.useState(!1),[w,x]=it.useState(!1),E=it.useMemo(()=>h?h.pages&&h.pages.length>0?h.pages[t]?.text||"":h.cleanedText||"":"",[h,t]);it.useEffect(()=>{E&&m.loadText(E)},[E]),it.useEffect(()=>{if(!h?._id)return;const R=setTimeout(()=>{const k={bookId:h._id,currentPage:t,currentPosition:d,playbackSpeed:te.getState().playbackSpeed,completionPercentage:f>0?Math.round(d/f*100):0,totalListeningTime:te.getState().totalListeningTime,bookmarks:te.getState().bookmarks};$t.post("/api/progress",k).catch(()=>{})},3e3);return()=>clearTimeout(R)},[h,t,d,f]),it.useEffect(()=>{const R=k=>{if(!(k.target.tagName==="INPUT"||k.target.tagName==="TEXTAREA"))switch(k.code){case"Space":k.preventDefault(),m.togglePlayPause(E);break;case"ArrowRight":k.preventDefault(),m.skipForward();break;case"ArrowLeft":k.preventDefault(),m.skipBackward();break;case"ArrowUp":k.preventDefault();const L=te.getState().playbackSpeed;te.getState().setPlaybackSpeed(Math.min(2,L+.25));break;case"ArrowDown":k.preventDefault();const P=te.getState().playbackSpeed;te.getState().setPlaybackSpeed(Math.max(.5,P-.25));break}};return window.addEventListener("keydown",R),()=>window.removeEventListener("keydown",R)},[m,E]);const M=()=>{m.stop(),s(!0),e("home")},C=async()=>{try{const R=h.cleanedText||E,k=new Blob([R],{type:"text/plain"}),L=URL.createObjectURL(k),P=document.createElement("a");P.href=L,P.download=`${h.title}.txt`,P.click(),URL.revokeObjectURL(L)}catch(R){console.error("Download failed:",R)}};return h?_.jsxs("div",{className:"space-y-4",children:[_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsxs("button",{onClick:M,className:"flex items-center gap-2 text-sm hover:text-primary-400 transition-all",children:[_.jsx(b1,{className:"w-4 h-4"}),"Back"]}),_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsxs("button",{onClick:()=>x(!w),className:`flex items-center gap-1 px-3 py-1.5 rounded-lg text-xs transition-all
              ${w?"bg-primary-500/20 text-primary-300":"hover:bg-white/10"}`,children:[_.jsx(gl,{className:"w-3.5 h-3.5"}),"Pages"]}),_.jsxs("button",{onClick:C,className:"flex items-center gap-1 px-3 py-1.5 rounded-lg text-xs hover:bg-white/10 transition-all",children:[_.jsx(L1,{className:"w-3.5 h-3.5"}),"Export"]})]})]}),w&&_.jsx(sE,{pages:h.pages,onClose:()=>x(!1)}),_.jsx(eE,{tts:m,onToggleText:()=>o(!a),onToggleBookmarks:()=>u(!l),onToggleSleepTimer:()=>b(!y),onToggleVoice:()=>S(!v)}),y&&_.jsx(aE,{onClose:()=>b(!1)}),l&&_.jsx(rE,{tts:m,onClose:()=>u(!1)}),v&&_.jsx(oE,{onClose:()=>S(!1)}),_.jsx(iE,{text:E}),_.jsxs("div",{className:"text-center text-xs text-gray-500 hidden sm:block",children:[_.jsx("span",{className:"px-2 py-0.5 rounded bg-white/5 mr-2",children:"Space"})," Play/Pause",_.jsx("span",{className:"px-2 py-0.5 rounded bg-white/5 mx-2",children:""})," Skip",_.jsx("span",{className:"px-2 py-0.5 rounded bg-white/5 mx-2",children:""})," Speed"]})]}):_.jsxs("div",{className:"text-center py-16",children:[_.jsx(Bi,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),_.jsx("p",{className:"text-gray-400",children:"No book selected"}),_.jsx("button",{onClick:()=>e("home"),className:"mt-4 px-4 py-2 rounded-xl gradient-bg text-white text-sm font-medium",children:"Upload a PDF"})]})}function hE(){const{totalListeningTime:h,books:t,bookmarks:e,stats:s}=te(),a=it.useMemo(()=>{const l=Math.floor(h/3600),u=Math.floor(h%3600/60);return l>0?`${l}h ${u}m`:`${u}m`},[h]),o=[{icon:Uh,label:"Listening Time",value:a,color:"#8b5cf6",bgColor:"rgba(139, 92, 246, 0.15)"},{icon:Bi,label:"Books Uploaded",value:t.length.toString(),color:"#ec4899",bgColor:"rgba(236, 72, 153, 0.15)"},{icon:Ih,label:"Bookmarks",value:e.length.toString(),color:"#f97316",bgColor:"rgba(249, 115, 22, 0.15)"},{icon:j1,label:"Daily Streak",value:`${s.dailyStreak||0} days`,color:"#22c55e",bgColor:"rgba(34, 197, 94, 0.15)"}];return _.jsxs("div",{className:"slide-up",children:[_.jsx("h2",{className:"text-2xl font-bold mb-6",children:_.jsx("span",{className:"gradient-text",children:"Your Stats"})}),_.jsx("div",{className:"grid grid-cols-2 gap-3 mb-6",children:o.map(({icon:l,label:u,value:d,color:f,bgColor:m})=>_.jsxs("div",{className:"glass rounded-2xl p-4",children:[_.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center mb-3",style:{background:m},children:_.jsx(l,{className:"w-5 h-5",style:{color:f}})}),_.jsx("p",{className:"text-2xl font-bold",children:d}),_.jsx("p",{className:"text-xs text-gray-400 mt-0.5",children:u})]},u))}),_.jsxs("div",{className:"glass rounded-2xl p-5",children:[_.jsxs("h3",{className:"font-semibold mb-4 flex items-center gap-2",children:[_.jsx(A0,{className:"w-4 h-4 text-primary-400"}),"Recent Activity"]}),_.jsx("div",{className:"flex items-end gap-1 h-24",children:Array.from({length:7},(l,u)=>{const d=Math.random()*80+20,f=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];return _.jsxs("div",{className:"flex-1 flex flex-col items-center gap-1",children:[_.jsx("div",{className:"w-full rounded-t-lg transition-all duration-500",style:{height:`${d}%`,background:`linear-gradient(to top, rgba(139,92,246,0.3), rgba(139,92,246,${.4+d/200}))`}}),_.jsx("span",{className:"text-[10px] text-gray-500",children:f[u]})]},u)})})]})]})}function dE(){return _.jsx("div",{className:"py-4",children:_.jsx(hE,{})})}function fE({tts:h}){const{isPlaying:t,currentBook:e,currentSentenceIndex:s,totalSentences:a,showMiniPlayer:o,setShowMiniPlayer:l,setActiveView:u}=te();if(!o||!e)return null;const d=a>0?s/a*100:0;return _.jsxs("div",{className:"fixed bottom-0 left-0 right-0 z-50 safe-bottom slide-up",children:[_.jsx("div",{className:"h-0.5 bg-surface-700",children:_.jsx("div",{className:"h-full gradient-bg transition-all duration-300",style:{width:`${d}%`}})}),_.jsxs("div",{className:"glass px-4 py-3 flex items-center gap-3",style:{borderTop:"1px solid rgba(139,92,246,0.15)"},children:[_.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center shrink-0 cursor-pointer",style:{background:`linear-gradient(135deg, ${e.coverColor}, ${e.coverColor}88)`},onClick:()=>{u("reader"),l(!1)},children:_.jsx("span",{className:"text-white text-xs font-bold",children:e.title.charAt(0)})}),_.jsxs("div",{className:"flex-1 min-w-0 cursor-pointer",onClick:()=>{u("reader"),l(!1)},children:[_.jsx("p",{className:"text-sm font-semibold truncate",children:e.title}),_.jsxs("p",{className:"text-xs text-gray-400",children:[Math.round(d),"% complete"]})]}),_.jsxs("div",{className:"flex items-center gap-1",children:[_.jsx("button",{onClick:()=>h?.togglePlayPause(),className:"w-10 h-10 rounded-full gradient-bg flex items-center justify-center",children:t?_.jsx(x0,{className:"w-5 h-5 text-white",fill:"white"}):_.jsx(Hh,{className:"w-5 h-5 text-white ml-0.5",fill:"white"})}),_.jsx("button",{onClick:()=>h?.skipForward(),className:"w-9 h-9 rounded-full flex items-center justify-center hover:bg-white/10 transition-all",children:_.jsx(E0,{className:"w-4 h-4"})}),_.jsx("button",{onClick:()=>l(!1),className:"w-8 h-8 rounded-full flex items-center justify-center hover:bg-white/10 transition-all",children:_.jsx(Tr,{className:"w-4 h-4 text-gray-400"})})]})]})]})}function pE(){const{activeView:h}=te(),t=Ry(),e=()=>{switch(h){case"reader":return _.jsx(uE,{});case"stats":return _.jsx(dE,{});default:return _.jsx(tE,{})}};return _.jsxs(xA,{children:[e(),h!=="reader"&&_.jsx(fE,{tts:t})]})}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(h=>console.log(" Service Worker registered:",h.scope)).catch(h=>console.log("SW registration failed:",h))});h1.createRoot(document.getElementById("root")).render(_.jsx(mr.StrictMode,{children:_.jsx(pE,{})}));
